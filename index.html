<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skills Registry</title>
    <style>
        :root {
            --bg-color: #0d1117;
            --card-bg: #161b22;
            --text-main: #c9d1d9;
            --text-muted: #8b949e;
            --accent-green: #238636;
            --accent-blue: #58a6ff;
            --border-color: #30363d;
            --font-mono: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            line-height: 1.5;
            padding: 2rem;
        }
        header {
            max-width: 1200px;
            margin: 0 auto 2rem;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        h1 {
            font-family: var(--font-mono);
            font-size: 1.5rem;
            color: var(--text-main);
        }
        .meta-bar {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
            font-size: 0.85rem;
            color: var(--text-muted);
            max-width: 1200px;
            margin: 0 auto 1.5rem;
        }
        .refs {
            max-width: 1200px;
            margin: 0 auto 2rem;
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background-color: rgba(13, 17, 23, 0.6);
        }
        .refs h2 {
            font-size: 1rem;
            margin-bottom: 0.75rem;
            font-family: var(--font-mono);
        }
        .refs ul {
            list-style: none;
            display: grid;
            gap: 0.4rem;
        }
        .refs a {
            color: var(--accent-blue);
            text-decoration: none;
        }
        .refs a:hover {
            text-decoration: underline;
        }
        .banner {
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 0.5rem 0.75rem;
            background-color: rgba(56, 139, 253, 0.08);
        }
        .banner a {
            color: var(--accent-blue);
            text-decoration: none;
        }
        .banner a:hover {
            text-decoration: underline;
        }
        .search-container { flex-grow: 1; max-width: 400px; }
        #search-input {
            width: 100%;
            padding: 0.5rem 1rem;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-main);
            font-family: var(--font-mono);
            font-size: 0.9rem;
        }
        #search-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.3);
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        .card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            transition: transform 0.2s, border-color 0.2s;
        }
        .card:hover {
            border-color: var(--accent-blue);
            transform: translateY(-2px);
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
            gap: 0.75rem;
        }
        .skill-title {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--accent-blue);
            font-family: var(--font-mono);
            word-break: break-word;
        }
        .copy-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: color 0.2s, background-color 0.2s;
        }
        .copy-btn:hover {
            color: var(--text-main);
            background-color: var(--border-color);
        }
        .card-body {
            flex-grow: 1;
            font-size: 0.95rem;
            color: var(--text-main);
            margin-bottom: 1.5rem;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 4;
            -webkit-box-orient: vertical;
        }
        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid var(--border-color);
            padding-top: 1rem;
            font-size: 0.85rem;
        }
        .badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            background-color: rgba(56, 139, 253, 0.15);
            color: var(--accent-blue);
            border: 1px solid rgba(56, 139, 253, 0.4);
            font-family: var(--font-mono);
            font-size: 0.75rem;
        }
        .badge.muted {
            background-color: rgba(139, 148, 158, 0.15);
            color: var(--text-muted);
            border-color: rgba(139, 148, 158, 0.4);
        }
        .pill {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            background-color: rgba(35, 134, 54, 0.15);
            color: var(--accent-green);
            border: 1px solid rgba(35, 134, 54, 0.4);
            font-family: var(--font-mono);
            font-size: 0.75rem;
        }
        .info-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        .skill-content {
            background-color: rgba(22, 27, 34, 0.6);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 0.75rem;
            font-family: var(--font-mono);
            font-size: 0.78rem;
            white-space: pre-wrap;
            max-height: 260px;
            overflow: auto;
        }
        details summary {
            cursor: pointer;
            color: var(--accent-blue);
            font-family: var(--font-mono);
        }
        details summary:hover {
            text-decoration: underline;
        }
        .source-link {
            color: var(--text-muted);
            text-decoration: none;
            transition: color 0.2s;
        }
        .source-link:hover {
            color: var(--accent-blue);
            text-decoration: underline;
        }
        .link-group {
            display: flex;
            gap: 0.75rem;
            align-items: center;
            flex-wrap: wrap;
        }
        .link-group a {
            color: var(--accent-blue);
            text-decoration: none;
            font-size: 0.85rem;
        }
        .link-group a:hover {
            text-decoration: underline;
        }
        .hidden { display: none !important; }
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--accent-green);
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            font-family: var(--font-mono);
        }
        .toast.show { opacity: 1; }
    </style>
</head>
<body>
    <header>
        <h1>Skills Registry</h1>
        <div class="search-container">
            <input type="text" id="search-input" placeholder="Filter skills by name, content, provider, license, or source..." autofocus>
        </div>
    </header>
    <div class="meta-bar">
        <div id="registry-banner" class="banner"></div>
        <div id="skills-count"></div>
    </div>
    <section class="refs">
        <h2>Official References</h2>
        <ul>
            <li><a href="https://code.claude.com/docs/en/skills" target="_blank" rel="noopener">https://code.claude.com/docs/en/skills</a></li>
            <li><a href="https://github.com/anthropics/skills" target="_blank" rel="noopener">https://github.com/anthropics/skills</a></li>
            <li><a href="https://platform.claude.com/docs/en/agents-and-tools/agent-skills/overview" target="_blank" rel="noopener">https://platform.claude.com/docs/en/agents-and-tools/agent-skills/overview</a></li>
            <li><a href="https://agentskills.io/home" target="_blank" rel="noopener">https://agentskills.io/home</a></li>
            <li><a href="https://github.com/agentskills/agentskills/tree/main/skills-ref" target="_blank" rel="noopener">https://github.com/agentskills/agentskills/tree/main/skills-ref</a></li>
            <li><a href="https://github.com/openai/skills" target="_blank" rel="noopener">https://github.com/openai/skills</a></li>
            <li><a href="https://github.com/vercel-labs/agent-skills" target="_blank" rel="noopener">https://github.com/vercel-labs/agent-skills</a></li>
            <li><a href="https://github.com/langchain-ai/deepagents/tree/f878123eebf245dc609dea49a6a95714153f9b65/libs/deepagents-cli/examples/skills" target="_blank" rel="noopener">https://github.com/langchain-ai/deepagents/tree/f878123eebf245dc609dea49a6a95714153f9b65/libs/deepagents-cli/examples/skills</a></li>
            <li><a href="https://github.com/langchain-ai/deepagents/tree/f878123eebf245dc609dea49a6a95714153f9b65/examples/content-builder-agent/skills" target="_blank" rel="noopener">https://github.com/langchain-ai/deepagents/tree/f878123eebf245dc609dea49a6a95714153f9b65/examples/content-builder-agent/skills</a></li>
        </ul>
    </section>
    <main class="grid" id="skills-grid">
        
        <article class="card" data-search="__init__ Imported skill __init__ from agentskills agentskills /a0/tmp/skills_research/agentskills/skills-ref/src/skills_ref/__init__.py Unknown skills-ref/LICENSE sources/agentskills/__init__/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">__init__</div>
                <button class="copy-btn" onclick="copyToClipboard('__init__')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">agentskills</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: skills-ref/LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill __init__ from agentskills</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Reference library for Agent Skills.&quot;&quot;&quot;

from .errors import ParseError, SkillError, ValidationError
from .models import SkillProperties
from .parser import find_skill_md, read_properties
from .prompt import to_prompt
from .validator import validate

__all__ = [
    &quot;SkillError&quot;,
    &quot;ParseError&quot;,
    &quot;ValidationError&quot;,
    &quot;SkillProperties&quot;,
    &quot;find_skill_md&quot;,
    &quot;validate&quot;,
    &quot;read_properties&quot;,
    &quot;to_prompt&quot;,
]

__version__ = &quot;0.1.0&quot;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/agentskills/__init__/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/src/skills_ref/__init__.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/LICENSE" class="source-link" target="_blank" rel="noopener">License: skills-ref/LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="claude Imported skill claude from agentskills agentskills /a0/tmp/skills_research/agentskills/docs/CLAUDE.md Unknown skills-ref/LICENSE sources/agentskills/claude/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">claude</div>
                <button class="copy-btn" onclick="copyToClipboard('claude')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">agentskills</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: skills-ref/LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill claude from agentskills</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository. The project defines an open format for teaching AI agents specialized workflows through SKILL.md files.

## Documentation

The Agent Skills documentation site, defined in the `docs/` directory, is built with [Mintlify](https://mintlify.com). 

### Quick Start Commands

```bash
# Install Mintlify CLI (required for local development)
npm i -g mint

# Run local development server (run from /docs directory)
cd docs &amp;&amp; mint dev

# Update Mintlify CLI if dev server issues occur
mint update
```

Local preview available at `http://localhost:3000`

### Development Notes

- **Navigation**: Defined in `docs/docs.json` under `navigation.pages` array
- **Adding pages**: Create new `.mdx` file in `/docs`, add filename (without extension) to navigation
- **Deployment**: Automatic on push to `main` branch
- **Troubleshooting**: If page shows 404, ensure you&#x27;re running `mint dev` from directory containing `docs.json`</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/agentskills/claude/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/agentskills/agentskills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/LICENSE" class="source-link" target="_blank" rel="noopener">License: skills-ref/LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="cli Imported skill cli from agentskills agentskills /a0/tmp/skills_research/agentskills/skills-ref/src/skills_ref/cli.py Unknown skills-ref/LICENSE sources/agentskills/cli/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">cli</div>
                <button class="copy-btn" onclick="copyToClipboard('cli')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">agentskills</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: skills-ref/LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill cli from agentskills</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;CLI for skills-ref library.&quot;&quot;&quot;

import json
import sys
from pathlib import Path

import click

from .errors import SkillError
from .parser import read_properties
from .prompt import to_prompt
from .validator import validate


def _is_skill_md_file(path: Path) -&gt; bool:
    &quot;&quot;&quot;Check if path points directly to a SKILL.md or skill.md file.&quot;&quot;&quot;
    return path.is_file() and path.name.lower() == &quot;skill.md&quot;


@click.group()
@click.version_option()
def main():
    &quot;&quot;&quot;Reference library for Agent Skills.&quot;&quot;&quot;
    pass


@main.command(&quot;validate&quot;)
@click.argument(&quot;skill_path&quot;, type=click.Path(exists=True, path_type=Path))
def validate_cmd(skill_path: Path):
    &quot;&quot;&quot;Validate a skill directory.

    Checks that the skill has a valid SKILL.md with proper frontmatter,
    correct naming conventions, and required fields.

    Exit codes:
        0: Valid skill
        1: Validation errors found
    &quot;&quot;&quot;
    if _is_skill_md_file(skill_path):
        skill_path = skill_path.parent

    errors = validate(skill_path)

    if errors:
        click.echo(f&quot;Validation failed for {skill_path}:&quot;, err=True)
        for error in errors:
            click.echo(f&quot;  - {error}&quot;, err=True)
        sys.exit(1)
    else:
        click.echo(f&quot;Valid skill: {skill_path}&quot;)


@main.command(&quot;read-properties&quot;)
@click.argument(&quot;skill_path&quot;, type=click.Path(exists=True, path_type=Path))
def read_properties_cmd(skill_path: Path):
    &quot;&quot;&quot;Read and print skill properties as JSON.

    Parses the YAML frontmatter from SKILL.md and outputs the
    properties as JSON.

    Exit codes:
        0: Success
        1: Parse error
    &quot;&quot;&quot;
    try:
        if _is_skill_md_file(skill_path):
            skill_path = skill_path.parent

        props = read_properties(skill_path)
        click.echo(json.dumps(props.to_dict(), indent=2))
    except SkillError as e:
        click.echo(f&quot;Error: {e}&quot;, err=True)
        sys.exit(1)


@main.command(&quot;to-prompt&quot;)
@click.argument(
    &quot;skill_paths&quot;, type=click.Path(exists=True, path_type=Path), nargs=-1, required=True
)
def to_prompt_cmd(skill_paths: tuple[Path, ...]):
    &quot;&quot;&quot;Generate &lt;available_skills&gt; XML for agent prompts.

    Accepts one or more skill directories.

    Exit codes:
        0: Success
        1: Error
    &quot;&quot;&quot;
    try:
        resolved_paths = []
        for skill_path in skill_paths:
            if _is_skill_md_file(skill_path):
                resolved_paths.append(skill_path.parent)
            else:
                resolved_paths.append(skill_path)

        output = to_prompt(resolved_paths)
        click.echo(output)
    except SkillError as e:
        click.echo(f&quot;Error: {e}&quot;, err=True)
        sys.exit(1)


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/agentskills/cli/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/src/skills_ref/cli.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/LICENSE" class="source-link" target="_blank" rel="noopener">License: skills-ref/LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="docs Imported skill docs from agentskills agentskills /a0/tmp/skills_research/agentskills/docs/docs.json Unknown skills-ref/LICENSE sources/agentskills/docs/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">docs</div>
                <button class="copy-btn" onclick="copyToClipboard('docs')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">agentskills</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: skills-ref/LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill docs from agentskills</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;$schema&quot;: &quot;https://mintlify.com/docs.json&quot;,
  &quot;theme&quot;: &quot;mint&quot;,
  &quot;name&quot;: &quot;Agent Skills&quot;,
  &quot;colors&quot;: {
    &quot;primary&quot;: &quot;#7f7f7f&quot;,
    &quot;light&quot;: &quot;#bfbfbf&quot;,
    &quot;dark&quot;: &quot;#404040&quot;
  },
  &quot;favicon&quot;: &quot;/favicon.svg&quot;,
  &quot;navbar&quot;: {
    &quot;primary&quot;: {
      &quot;type&quot;: &quot;github&quot;,
      &quot;href&quot;: &quot;https://github.com/agentskills/agentskills&quot;
    }
  },
  &quot;navigation&quot;: {
    &quot;pages&quot;: [
      &quot;home&quot;,
      &quot;what-are-skills&quot;,
      &quot;specification&quot;,
      &quot;integrate-skills&quot;
    ]
  },
  &quot;contextual&quot;: {
    &quot;options&quot;: [
      &quot;copy&quot;,
      &quot;view&quot;,
      &quot;chatgpt&quot;,
      &quot;claude&quot;,
      &quot;perplexity&quot;,
      &quot;mcp&quot;,
      &quot;cursor&quot;,
      &quot;vscode&quot;
    ]
  }
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/agentskills/docs/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/agentskills/agentskills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/LICENSE" class="source-link" target="_blank" rel="noopener">License: skills-ref/LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="errors Imported skill errors from agentskills agentskills /a0/tmp/skills_research/agentskills/skills-ref/src/skills_ref/errors.py Unknown skills-ref/LICENSE sources/agentskills/errors/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">errors</div>
                <button class="copy-btn" onclick="copyToClipboard('errors')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">agentskills</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: skills-ref/LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill errors from agentskills</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Skill-related exceptions.&quot;&quot;&quot;


class SkillError(Exception):
    &quot;&quot;&quot;Base exception for all skill-related errors.&quot;&quot;&quot;

    pass


class ParseError(SkillError):
    &quot;&quot;&quot;Raised when SKILL.md parsing fails.&quot;&quot;&quot;

    pass


class ValidationError(SkillError):
    &quot;&quot;&quot;Raised when skill properties are invalid.

    Attributes:
        errors: List of validation error messages (may contain just one)
    &quot;&quot;&quot;

    def __init__(self, message: str, errors: list[str] | None = None):
        super().__init__(message)
        self.errors = errors if errors is not None else [message]</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/agentskills/errors/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/src/skills_ref/errors.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/LICENSE" class="source-link" target="_blank" rel="noopener">License: skills-ref/LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="models Imported skill models from agentskills agentskills /a0/tmp/skills_research/agentskills/skills-ref/src/skills_ref/models.py Unknown skills-ref/LICENSE sources/agentskills/models/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">models</div>
                <button class="copy-btn" onclick="copyToClipboard('models')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">agentskills</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: skills-ref/LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill models from agentskills</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Data models for Agent Skills.&quot;&quot;&quot;

from dataclasses import dataclass, field
from typing import Optional


@dataclass
class SkillProperties:
    &quot;&quot;&quot;Properties parsed from a skill&#x27;s SKILL.md frontmatter.

    Attributes:
        name: Skill name in kebab-case (required)
        description: What the skill does and when the model should use it (required)
        license: License for the skill (optional)
        compatibility: Compatibility information for the skill (optional)
        allowed_tools: Tool patterns the skill requires (optional, experimental)
        metadata: Key-value pairs for client-specific properties (defaults to
            empty dict; omitted from to_dict() output when empty)
    &quot;&quot;&quot;

    name: str
    description: str
    license: Optional[str] = None
    compatibility: Optional[str] = None
    allowed_tools: Optional[str] = None
    metadata: dict[str, str] = field(default_factory=dict)

    def to_dict(self) -&gt; dict:
        &quot;&quot;&quot;Convert to dictionary, excluding None values.&quot;&quot;&quot;
        result = {&quot;name&quot;: self.name, &quot;description&quot;: self.description}
        if self.license is not None:
            result[&quot;license&quot;] = self.license
        if self.compatibility is not None:
            result[&quot;compatibility&quot;] = self.compatibility
        if self.allowed_tools is not None:
            result[&quot;allowed-tools&quot;] = self.allowed_tools
        if self.metadata:
            result[&quot;metadata&quot;] = self.metadata
        return result</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/agentskills/models/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/src/skills_ref/models.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/LICENSE" class="source-link" target="_blank" rel="noopener">License: skills-ref/LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="parser Imported skill parser from agentskills agentskills /a0/tmp/skills_research/agentskills/skills-ref/src/skills_ref/parser.py Unknown skills-ref/LICENSE sources/agentskills/parser/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">parser</div>
                <button class="copy-btn" onclick="copyToClipboard('parser')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">agentskills</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: skills-ref/LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill parser from agentskills</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;YAML frontmatter parsing for SKILL.md files.&quot;&quot;&quot;

from pathlib import Path
from typing import Optional

import strictyaml

from .errors import ParseError, ValidationError
from .models import SkillProperties


def find_skill_md(skill_dir: Path) -&gt; Optional[Path]:
    &quot;&quot;&quot;Find the SKILL.md file in a skill directory.

    Prefers SKILL.md (uppercase) but accepts skill.md (lowercase).

    Args:
        skill_dir: Path to the skill directory

    Returns:
        Path to the SKILL.md file, or None if not found
    &quot;&quot;&quot;
    for name in (&quot;SKILL.md&quot;, &quot;skill.md&quot;):
        path = skill_dir / name
        if path.exists():
            return path
    return None


def parse_frontmatter(content: str) -&gt; tuple[dict, str]:
    &quot;&quot;&quot;Parse YAML frontmatter from SKILL.md content.

    Args:
        content: Raw content of SKILL.md file

    Returns:
        Tuple of (metadata dict, markdown body)

    Raises:
        ParseError: If frontmatter is missing or invalid
    &quot;&quot;&quot;
    if not content.startswith(&quot;---&quot;):
        raise ParseError(&quot;SKILL.md must start with YAML frontmatter (---)&quot;)

    parts = content.split(&quot;---&quot;, 2)
    if len(parts) &lt; 3:
        raise ParseError(&quot;SKILL.md frontmatter not properly closed with ---&quot;)

    frontmatter_str = parts[1]
    body = parts[2].strip()

    try:
        parsed = strictyaml.load(frontmatter_str)
        metadata = parsed.data
    except strictyaml.YAMLError as e:
        raise ParseError(f&quot;Invalid YAML in frontmatter: {e}&quot;)

    if not isinstance(metadata, dict):
        raise ParseError(&quot;SKILL.md frontmatter must be a YAML mapping&quot;)

    if &quot;metadata&quot; in metadata and isinstance(metadata[&quot;metadata&quot;], dict):
        metadata[&quot;metadata&quot;] = {str(k): str(v) for k, v in metadata[&quot;metadata&quot;].items()}

    return metadata, body


def read_properties(skill_dir: Path) -&gt; SkillProperties:
    &quot;&quot;&quot;Read skill properties from SKILL.md frontmatter.

    This function parses the frontmatter and returns properties.
    It does NOT perform full validation. Use validate() for that.

    Args:
        skill_dir: Path to the skill directory

    Returns:
        SkillProperties with parsed metadata

    Raises:
        ParseError: If SKILL.md is missing or has invalid YAML
        ValidationError: If required fields (name, description) are missing
    &quot;&quot;&quot;
    skill_dir = Path(skill_dir)
    skill_md = find_skill_md(skill_dir)

    if skill_md is None:
        raise ParseError(f&quot;SKILL.md not found in {skill_dir}&quot;)

    content = skill_md.read_text()
    metadata, _ = parse_frontmatter(content)

    if &quot;name&quot; not in metadata:
        raise ValidationError(&quot;Missing required field in frontmatter: name&quot;)
    if &quot;description&quot; not in metadata:
        raise ValidationError(&quot;Missing required field in frontmatter: description&quot;)

    name = metadata[&quot;name&quot;]
    description = metadata[&quot;description&quot;]

    if not isinstance(name, str) or not name.strip():
        raise ValidationError(&quot;Field &#x27;name&#x27; must be a non-empty string&quot;)
    if not isinstance(description, str) or not description.strip():
        raise ValidationError(&quot;Field &#x27;description&#x27; must be a non-empty string&quot;)

    return SkillProperties(
        name=name.strip(),
        description=description.strip(),
        license=metadata.get(&quot;license&quot;),
        compatibility=metadata.get(&quot;compatibility&quot;),
        allowed_tools=metadata.get(&quot;allowed-tools&quot;),
        metadata=metadata.get(&quot;metadata&quot;),
    )</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/agentskills/parser/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/src/skills_ref/parser.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/LICENSE" class="source-link" target="_blank" rel="noopener">License: skills-ref/LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="prompt Imported skill prompt from agentskills agentskills /a0/tmp/skills_research/agentskills/skills-ref/src/skills_ref/prompt.py Unknown skills-ref/LICENSE sources/agentskills/prompt/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">prompt</div>
                <button class="copy-btn" onclick="copyToClipboard('prompt')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">agentskills</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: skills-ref/LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill prompt from agentskills</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Generate &lt;available_skills&gt; XML prompt block for agent system prompts.&quot;&quot;&quot;

import html
from pathlib import Path

from .parser import find_skill_md, read_properties


def to_prompt(skill_dirs: list[Path]) -&gt; str:
    &quot;&quot;&quot;Generate the &lt;available_skills&gt; XML block for inclusion in agent prompts.

    This XML format is what Anthropic uses and recommends for Claude models.
    Skill Clients may format skill information differently to suit their
    models or preferences.

    Args:
        skill_dirs: List of paths to skill directories

    Returns:
        XML string with &lt;available_skills&gt; block containing each skill&#x27;s
        name, description, and location.

    Example output:
        &lt;available_skills&gt;
        &lt;skill&gt;
        &lt;name&gt;pdf-reader&lt;/name&gt;
        &lt;description&gt;Read and extract text from PDF files&lt;/description&gt;
        &lt;location&gt;/path/to/pdf-reader/SKILL.md&lt;/location&gt;
        &lt;/skill&gt;
        &lt;/available_skills&gt;
    &quot;&quot;&quot;
    if not skill_dirs:
        return &quot;&lt;available_skills&gt;\n&lt;/available_skills&gt;&quot;

    lines = [&quot;&lt;available_skills&gt;&quot;]

    for skill_dir in skill_dirs:
        skill_dir = Path(skill_dir).resolve()
        props = read_properties(skill_dir)

        lines.append(&quot;&lt;skill&gt;&quot;)
        lines.append(&quot;&lt;name&gt;&quot;)
        lines.append(html.escape(props.name))
        lines.append(&quot;&lt;/name&gt;&quot;)
        lines.append(&quot;&lt;description&gt;&quot;)
        lines.append(html.escape(props.description))
        lines.append(&quot;&lt;/description&gt;&quot;)

        skill_md_path = find_skill_md(skill_dir)
        lines.append(&quot;&lt;location&gt;&quot;)
        lines.append(str(skill_md_path))
        lines.append(&quot;&lt;/location&gt;&quot;)

        lines.append(&quot;&lt;/skill&gt;&quot;)

    lines.append(&quot;&lt;/available_skills&gt;&quot;)

    return &quot;\n&quot;.join(lines)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/agentskills/prompt/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/src/skills_ref/prompt.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/LICENSE" class="source-link" target="_blank" rel="noopener">License: skills-ref/LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="readme Imported skill readme from agentskills agentskills /a0/tmp/skills_research/agentskills/docs/README.md Unknown skills-ref/LICENSE sources/agentskills/readme/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">readme</div>
                <button class="copy-btn" onclick="copyToClipboard('readme')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">agentskills</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: skills-ref/LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill readme from agentskills</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Agent Skills Documentation

This directory contains the source code for the Agent Skills documentation site, which is built using [Mintlify](https://mintlify.com).

## Development

Install the [Mintlify CLI](https://www.npmjs.com/package/mint) to preview your documentation changes locally. To install, use the following command:

```
npm i -g mint
```

Run the following command at the root of your documentation, where your `docs.json` is located:

```
mint dev
```

View your local preview at `http://localhost:3000`.

## Publishing changes

Changes are deployed to production automatically after pushing to the default branch.

## Need help?

### Troubleshooting

- If your dev environment isn&#x27;t running: Run `mint update` to ensure you have the most recent version of the CLI.
- If a page loads as a 404: Make sure you are running in a folder with a valid `docs.json`.

### Resources
- [Mintlify documentation](https://mintlify.com/docs)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/agentskills/readme/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/agentskills/agentskills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/LICENSE" class="source-link" target="_blank" rel="noopener">License: skills-ref/LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="settings Imported skill settings from agentskills agentskills /a0/tmp/skills_research/agentskills/.claude/settings.json Unknown skills-ref/LICENSE sources/agentskills/settings/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">settings</div>
                <button class="copy-btn" onclick="copyToClipboard('settings')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">agentskills</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: skills-ref/LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill settings from agentskills</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;hooks&quot;: {
    &quot;SessionStart&quot;: [
      {
        &quot;hooks&quot;: [
          {
            &quot;type&quot;: &quot;command&quot;,
            &quot;command&quot;: &quot;.claude/hooks/session-start.sh&quot;
          }
        ]
      }
    ]
  }
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/agentskills/settings/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/agentskills/agentskills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/LICENSE" class="source-link" target="_blank" rel="noopener">License: skills-ref/LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="validator Imported skill validator from agentskills agentskills /a0/tmp/skills_research/agentskills/skills-ref/src/skills_ref/validator.py Unknown skills-ref/LICENSE sources/agentskills/validator/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">validator</div>
                <button class="copy-btn" onclick="copyToClipboard('validator')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">agentskills</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: skills-ref/LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill validator from agentskills</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Skill validation logic.&quot;&quot;&quot;

import unicodedata
from pathlib import Path
from typing import Optional

from .errors import ParseError
from .parser import find_skill_md, parse_frontmatter

MAX_SKILL_NAME_LENGTH = 64
MAX_DESCRIPTION_LENGTH = 1024
MAX_COMPATIBILITY_LENGTH = 500

# Allowed frontmatter fields per Agent Skills Spec
ALLOWED_FIELDS = {
    &quot;name&quot;,
    &quot;description&quot;,
    &quot;license&quot;,
    &quot;allowed-tools&quot;,
    &quot;metadata&quot;,
    &quot;compatibility&quot;,
}


def _validate_name(name: str, skill_dir: Path) -&gt; list[str]:
    &quot;&quot;&quot;Validate skill name format and directory match.

    Skill names support i18n characters (Unicode letters) plus hyphens.
    Names must be lowercase and cannot start/end with hyphens.
    &quot;&quot;&quot;
    errors = []

    if not name or not isinstance(name, str) or not name.strip():
        errors.append(&quot;Field &#x27;name&#x27; must be a non-empty string&quot;)
        return errors

    name = unicodedata.normalize(&quot;NFKC&quot;, name.strip())

    if len(name) &gt; MAX_SKILL_NAME_LENGTH:
        errors.append(
            f&quot;Skill name &#x27;{name}&#x27; exceeds {MAX_SKILL_NAME_LENGTH} character limit &quot;
            f&quot;({len(name)} chars)&quot;
        )

    if name != name.lower():
        errors.append(f&quot;Skill name &#x27;{name}&#x27; must be lowercase&quot;)

    if name.startswith(&quot;-&quot;) or name.endswith(&quot;-&quot;):
        errors.append(&quot;Skill name cannot start or end with a hyphen&quot;)

    if &quot;--&quot; in name:
        errors.append(&quot;Skill name cannot contain consecutive hyphens&quot;)

    if not all(c.isalnum() or c == &quot;-&quot; for c in name):
        errors.append(
            f&quot;Skill name &#x27;{name}&#x27; contains invalid characters. &quot;
            &quot;Only letters, digits, and hyphens are allowed.&quot;
        )

    if skill_dir:
        dir_name = unicodedata.normalize(&quot;NFKC&quot;, skill_dir.name)
        if dir_name != name:
            errors.append(
                f&quot;Directory name &#x27;{skill_dir.name}&#x27; must match skill name &#x27;{name}&#x27;&quot;
            )

    return errors


def _validate_description(description: str) -&gt; list[str]:
    &quot;&quot;&quot;Validate description format.&quot;&quot;&quot;
    errors = []

    if not description or not isinstance(description, str) or not description.strip():
        errors.append(&quot;Field &#x27;description&#x27; must be a non-empty string&quot;)
        return errors

    if len(description) &gt; MAX_DESCRIPTION_LENGTH:
        errors.append(
            f&quot;Description exceeds {MAX_DESCRIPTION_LENGTH} character limit &quot;
            f&quot;({len(description)} chars)&quot;
        )

    return errors


def _validate_compatibility(compatibility: str) -&gt; list[str]:
    &quot;&quot;&quot;Validate compatibility format.&quot;&quot;&quot;
    errors = []

    if not isinstance(compatibility, str):
        errors.append(&quot;Field &#x27;compatibility&#x27; must be a string&quot;)
        return errors

    if len(compatibility) &gt; MAX_COMPATIBILITY_LENGTH:
        errors.append(
            f&quot;Compatibility exceeds {MAX_COMPATIBILITY_LENGTH} character limit &quot;
            f&quot;({len(compatibility)} chars)&quot;
        )

    return errors


def _validate_metadata_fields(metadata: dict) -&gt; list[str]:
    &quot;&quot;&quot;Validate that only allowed fields are present.&quot;&quot;&quot;
    errors = []

    extra_fields = set(metadata.keys()) - ALLOWED_FIELDS
    if extra_fields:
        errors.append(
            f&quot;Unexpected fields in frontmatter: {&#x27;, &#x27;.join(sorted(extra_fields))}. &quot;
            f&quot;Only {sorted(ALLOWED_FIELDS)} are allowed.&quot;
        )

    return errors


def validate_metadata(metadata: dict, skill_dir: Optional[Path] = None) -&gt; list[str]:
    &quot;&quot;&quot;Validate parsed skill metadata.

    This is the core validation function that works on already-parsed metadata,
    avoiding duplicate file I/O when called from the parser.

    Args:
        metadata: Parsed YAML frontmatter dictionary
        skill_dir: Optional path to skill directory (for name-directory match check)

    Returns:
        List of validation error messages. Empty list means valid.
    &quot;&quot;&quot;
    errors = []
    errors.extend(_validate_metadata_fields(metadata))

    if &quot;name&quot; not in metadata:
        errors.append(&quot;Missing required field in frontmatter: name&quot;)
    else:
        errors.extend(_validate_name(metadata[&quot;name&quot;], skill_dir))

    if &quot;description&quot; not in metadata:
        errors.append(&quot;Missing required field in frontmatter: description&quot;)
    else:
        errors.extend(_validate_description(metadata[&quot;description&quot;]))

    if &quot;compatibility&quot; in metadata:
        errors.extend(_validate_compatibility(metadata[&quot;compatibility&quot;]))

    return errors


def validate(skill_dir: Path) -&gt; list[str]:
    &quot;&quot;&quot;Validate a skill directory.

    Args:
        skill_dir: Path to the skill directory

    Returns:
        List of validation error messages. Empty list means valid.
    &quot;&quot;&quot;
    skill_dir = Path(skill_dir)

    if not skill_dir.exists():
        return [f&quot;Path does not exist: {skill_dir}&quot;]

    if not skill_dir.is_dir():
        return [f&quot;Not a directory: {skill_dir}&quot;]

    skill_md = find_skill_md(skill_dir)
    if skill_md is None:
        return [&quot;Missing required file: SKILL.md&quot;]

    try:
        content = skill_md.read_text()
        metadata, _ = parse_frontmatter(content)
    except ParseError as e:
        return [str(e)]

    return validate_metadata(metadata, skill_dir)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/agentskills/validator/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/src/skills_ref/validator.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/agentskills/agentskills/blob/main/skills-ref/LICENSE" class="source-link" target="_blank" rel="noopener">License: skills-ref/LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="3p_updates Imported skill 3p_updates from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/internal-comms/examples/3p-updates.md Unknown LICENSE.txt sources/anthropic/3p_updates/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">3p_updates</div>
                <button class="copy-btn" onclick="copyToClipboard('3p_updates')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill 3p_updates from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">## Instructions
You are being asked to write a 3P update. 3P updates stand for &quot;Progress, Plans, Problems.&quot; The main audience is for executives, leadership, other teammates, etc. They&#x27;re meant to be very succinct and to-the-point: think something you can read in 30-60sec or less. They&#x27;re also for people with some, but not a lot of context on what the team does.

3Ps can cover a team of any size, ranging all the way up to the entire company. The bigger the team, the less granular the tasks should be. For example, &quot;mobile team&quot; might have &quot;shipped feature&quot; or &quot;fixed bugs,&quot; whereas the company might have really meaty 3Ps, like &quot;hired 20 new people&quot; or &quot;closed 10 new deals.&quot; 

They represent the work of the team across a time period, almost always one week. They include three sections:
1) Progress: what the team has accomplished over the next time period. Focus mainly on things shipped, milestones achieved, tasks created, etc.
2) Plans: what the team plans to do over the next time period. Focus on what things are top-of-mind, really high priority, etc. for the team.
3) Problems: anything that is slowing the team down. This could be things like too few people, bugs or blockers that are preventing the team from moving forward, some deal that fell through, etc.

Before writing them, make sure that you know the team name. If it&#x27;s not specified, you can ask explicitly what the team name you&#x27;re writing for is.


## Tools Available
Whenever possible, try to pull from available sources to get the information you need:
- Slack: posts from team members with their updates - ideally look for posts in large channels with lots of reactions
- Google Drive: docs written from critical team members with lots of views
- Email: emails with lots of responses of lots of content that seems relevant
- Calendar: non-recurring meetings that have a lot of importance, like product reviews, etc.


Try to gather as much context as you can, focusing on the things that covered the time period you&#x27;re writing for:
- Progress: anything between a week ago and today
- Plans: anything from today to the next week
- Problems: anything between a week ago and today


If you don&#x27;t have access, you can ask the user for things they want to cover. They might also include these things to you directly, in which case you&#x27;re mostly just formatting for this particular format.

## Workflow

1. **Clarify scope**: Confirm the team name and time period (usually past week for Progress/Problems, next
week for Plans)
2. **Gather information**: Use available tools or ask the user directly
3. **Draft the update**: Follow the strict formatting guidelines
4. **Review**: Ensure it&#x27;s concise (30-60 seconds to read) and data-driven

## Formatting

The format is always the same, very strict formatting. Never use any formatting other than this. Pick an emoji that is fun and captures the vibe of the team and update.

[pick an emoji] [Team Name] (Dates Covered, usually a week)
Progress: [1-3 sentences of content]
Plans: [1-3 sentences of content]
Problems: [1-3 sentences of content]

Each section should be no more than 1-3 sentences: clear, to the point. It should be data-driven, and generally include metrics where possible. The tone should be very matter-of-fact, not super prose-heavy.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/3p_updates/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/internal-comms/examples/3p-updates.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/internal-comms/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="__init__ Imported skill __init__ from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/ooxml/scripts/validation/__init__.py Unknown LICENSE.txt sources/anthropic/__init__/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">__init__</div>
                <button class="copy-btn" onclick="copyToClipboard('__init__')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill __init__ from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;
Validation modules for Word document processing.
&quot;&quot;&quot;

from .base import BaseSchemaValidator
from .docx import DOCXSchemaValidator
from .pptx import PPTXSchemaValidator
from .redlining import RedliningValidator

__all__ = [
    &quot;BaseSchemaValidator&quot;,
    &quot;DOCXSchemaValidator&quot;,
    &quot;PPTXSchemaValidator&quot;,
    &quot;RedliningValidator&quot;,
]</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/__init__/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/ooxml/scripts/validation/__init__.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="agent_skills_spec Imported skill agent_skills_spec from anthropic anthropic /a0/tmp/skills_research/anthropic/spec/agent-skills-spec.md Unknown LICENSE.txt sources/anthropic/agent_skills_spec/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">agent_skills_spec</div>
                <button class="copy-btn" onclick="copyToClipboard('agent_skills_spec')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill agent_skills_spec from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Agent Skills Spec

The spec is now located at &lt;https://agentskills.io/specification&gt;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/agent_skills_spec/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/anthropics/skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <span class="badge muted">License: LICENSE.txt</span>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="anthropic.calculator export function calculate(expr) { try { return eval(expr.replace(/[^0-9+\-*/().]/g, &#x27;&#x27;)); } catch { return &#x27;Error&#x27;; } } anthropic https://github.com/anthropics/anthropic-cookbook 1.0.0 MIT sources/anthropic/calculator.js js">
            <div class="card-header">
                <div class="skill-title">anthropic.calculator</div>
                <button class="copy-btn" onclick="copyToClipboard('anthropic.calculator')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">js</span>
                <span class="badge muted">License: MIT</span>
                <span class="badge muted">Version: 1.0.0</span>
            </div>
            <div class="card-body">export function calculate(expr) { try { return eval(expr.replace(/[^0-9+\-*/().]/g, &#x27;&#x27;)); } catch { return &#x27;Error&#x27;; } }</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">export function calculate(expr) { try { return eval(expr.replace(/[^0-9+\-*/().]/g, &#x27;&#x27;)); } catch { return &#x27;Error&#x27;; } }</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/calculator.js" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/anthropic-cookbook" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://spdx.org/licenses/MIT.html" class="source-link" target="_blank" rel="noopener">License: MIT</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="anthropic.customer-info export function getCustomerInfo(id) { const db = { &quot;C1&quot;: {name: &quot;John&quot;, email: &quot;j@x.com&quot;} }; return db[id] || &quot;Not found&quot;; } anthropic https://github.com/anthropics/anthropic-cookbook 1.0.0 MIT sources/anthropic/customer-info.js js">
            <div class="card-header">
                <div class="skill-title">anthropic.customer-info</div>
                <button class="copy-btn" onclick="copyToClipboard('anthropic.customer-info')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">js</span>
                <span class="badge muted">License: MIT</span>
                <span class="badge muted">Version: 1.0.0</span>
            </div>
            <div class="card-body">export function getCustomerInfo(id) { const db = { &quot;C1&quot;: {name: &quot;John&quot;, email: &quot;j@x.com&quot;} }; return db[id] || &quot;Not found&quot;; }</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">export function getCustomerInfo(id) { const db = { &quot;C1&quot;: {name: &quot;John&quot;, email: &quot;j@x.com&quot;} }; return db[id] || &quot;Not found&quot;; }</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/customer-info.js" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/anthropic-cookbook" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://spdx.org/licenses/MIT.html" class="source-link" target="_blank" rel="noopener">License: MIT</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="anthropic.order-details export function getOrderDetails(id) { const db = { &quot;O1&quot;: {product: &quot;Widget&quot;, price: 19.99} }; return db[id] || &quot;Not found&quot;; } anthropic https://github.com/anthropics/anthropic-cookbook 1.0.0 MIT sources/anthropic/order-details.js js">
            <div class="card-header">
                <div class="skill-title">anthropic.order-details</div>
                <button class="copy-btn" onclick="copyToClipboard('anthropic.order-details')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">js</span>
                <span class="badge muted">License: MIT</span>
                <span class="badge muted">Version: 1.0.0</span>
            </div>
            <div class="card-body">export function getOrderDetails(id) { const db = { &quot;O1&quot;: {product: &quot;Widget&quot;, price: 19.99} }; return db[id] || &quot;Not found&quot;; }</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">export function getOrderDetails(id) { const db = { &quot;O1&quot;: {product: &quot;Widget&quot;, price: 19.99} }; return db[id] || &quot;Not found&quot;; }</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/order-details.js" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/anthropic-cookbook" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://spdx.org/licenses/MIT.html" class="source-link" target="_blank" rel="noopener">License: MIT</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="arctic_frost Imported skill arctic_frost from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/theme-factory/themes/arctic-frost.md Unknown LICENSE.txt sources/anthropic/arctic_frost/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">arctic_frost</div>
                <button class="copy-btn" onclick="copyToClipboard('arctic_frost')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill arctic_frost from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Arctic Frost

A cool and crisp winter-inspired theme that conveys clarity, precision, and professionalism.

## Color Palette

- **Ice Blue**: `#d4e4f7` - Light backgrounds and highlights
- **Steel Blue**: `#4a6fa5` - Primary accent color
- **Silver**: `#c0c0c0` - Metallic accent elements
- **Crisp White**: `#fafafa` - Clean backgrounds and text

## Typography

- **Headers**: DejaVu Sans Bold
- **Body Text**: DejaVu Sans

## Best Used For

Healthcare presentations, technology solutions, winter sports, clean tech, pharmaceutical content.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/arctic_frost/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/themes/arctic-frost.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="arsenalsc_ofl Imported skill arsenalsc_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/ArsenalSC-OFL.txt Unknown LICENSE.txt sources/anthropic/arsenalsc_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">arsenalsc_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('arsenalsc_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill arsenalsc_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2012 The Arsenal Project Authors (andrij.design@gmail.com)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/arsenalsc_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/ArsenalSC-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="base Imported skill base from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/ooxml/scripts/validation/base.py Unknown LICENSE.txt sources/anthropic/base/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">base</div>
                <button class="copy-btn" onclick="copyToClipboard('base')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill base from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;
Base validator with common validation logic for document files.
&quot;&quot;&quot;

import re
from pathlib import Path

import lxml.etree


class BaseSchemaValidator:
    &quot;&quot;&quot;Base validator with common validation logic for document files.&quot;&quot;&quot;

    # Elements whose &#x27;id&#x27; attributes must be unique within their file
    # Format: element_name -&gt; (attribute_name, scope)
    # scope can be &#x27;file&#x27; (unique within file) or &#x27;global&#x27; (unique across all files)
    UNIQUE_ID_REQUIREMENTS = {
        # Word elements
        &quot;comment&quot;: (&quot;id&quot;, &quot;file&quot;),  # Comment IDs in comments.xml
        &quot;commentrangestart&quot;: (&quot;id&quot;, &quot;file&quot;),  # Must match comment IDs
        &quot;commentrangeend&quot;: (&quot;id&quot;, &quot;file&quot;),  # Must match comment IDs
        &quot;bookmarkstart&quot;: (&quot;id&quot;, &quot;file&quot;),  # Bookmark start IDs
        &quot;bookmarkend&quot;: (&quot;id&quot;, &quot;file&quot;),  # Bookmark end IDs
        # Note: ins and del (track changes) can share IDs when part of same revision
        # PowerPoint elements
        &quot;sldid&quot;: (&quot;id&quot;, &quot;file&quot;),  # Slide IDs in presentation.xml
        &quot;sldmasterid&quot;: (&quot;id&quot;, &quot;global&quot;),  # Slide master IDs must be globally unique
        &quot;sldlayoutid&quot;: (&quot;id&quot;, &quot;global&quot;),  # Slide layout IDs must be globally unique
        &quot;cm&quot;: (&quot;authorid&quot;, &quot;file&quot;),  # Comment author IDs
        # Excel elements
        &quot;sheet&quot;: (&quot;sheetid&quot;, &quot;file&quot;),  # Sheet IDs in workbook.xml
        &quot;definedname&quot;: (&quot;id&quot;, &quot;file&quot;),  # Named range IDs
        # Drawing/Shape elements (all formats)
        &quot;cxnsp&quot;: (&quot;id&quot;, &quot;file&quot;),  # Connection shape IDs
        &quot;sp&quot;: (&quot;id&quot;, &quot;file&quot;),  # Shape IDs
        &quot;pic&quot;: (&quot;id&quot;, &quot;file&quot;),  # Picture IDs
        &quot;grpsp&quot;: (&quot;id&quot;, &quot;file&quot;),  # Group shape IDs
    }

    # Mapping of element names to expected relationship types
    # Subclasses should override this with format-specific mappings
    ELEMENT_RELATIONSHIP_TYPES = {}

    # Unified schema mappings for all Office document types
    SCHEMA_MAPPINGS = {
        # Document type specific schemas
        &quot;word&quot;: &quot;ISO-IEC29500-4_2016/wml.xsd&quot;,  # Word documents
        &quot;ppt&quot;: &quot;ISO-IEC29500-4_2016/pml.xsd&quot;,  # PowerPoint presentations
        &quot;xl&quot;: &quot;ISO-IEC29500-4_2016/sml.xsd&quot;,  # Excel spreadsheets
        # Common file types
        &quot;[Content_Types].xml&quot;: &quot;ecma/fouth-edition/opc-contentTypes.xsd&quot;,
        &quot;app.xml&quot;: &quot;ISO-IEC29500-4_2016/shared-documentPropertiesExtended.xsd&quot;,
        &quot;core.xml&quot;: &quot;ecma/fouth-edition/opc-coreProperties.xsd&quot;,
        &quot;custom.xml&quot;: &quot;ISO-IEC29500-4_2016/shared-documentPropertiesCustom.xsd&quot;,
        &quot;.rels&quot;: &quot;ecma/fouth-edition/opc-relationships.xsd&quot;,
        # Word-specific files
        &quot;people.xml&quot;: &quot;microsoft/wml-2012.xsd&quot;,
        &quot;commentsIds.xml&quot;: &quot;microsoft/wml-cid-2016.xsd&quot;,
        &quot;commentsExtensible.xml&quot;: &quot;microsoft/wml-cex-2018.xsd&quot;,
        &quot;commentsExtended.xml&quot;: &quot;microsoft/wml-2012.xsd&quot;,
        # Chart files (common across document types)
        &quot;chart&quot;: &quot;ISO-IEC29500-4_2016/dml-chart.xsd&quot;,
        # Theme files (common across document types)
        &quot;theme&quot;: &quot;ISO-IEC29500-4_2016/dml-main.xsd&quot;,
        # Drawing and media files
        &quot;drawing&quot;: &quot;ISO-IEC29500-4_2016/dml-main.xsd&quot;,
    }

    # Unified namespace constants
    MC_NAMESPACE = &quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;
    XML_NAMESPACE = &quot;http://www.w3.org/XML/1998/namespace&quot;

    # Common OOXML namespaces used across validators
    PACKAGE_RELATIONSHIPS_NAMESPACE = (
        &quot;http://schemas.openxmlformats.org/package/2006/relationships&quot;
    )
    OFFICE_RELATIONSHIPS_NAMESPACE = (
        &quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships&quot;
    )
    CONTENT_TYPES_NAMESPACE = (
        &quot;http://schemas.openxmlformats.org/package/2006/content-types&quot;
    )

    # Folders where we should clean ignorable namespaces
    MAIN_CONTENT_FOLDERS = {&quot;word&quot;, &quot;ppt&quot;, &quot;xl&quot;}

    # All allowed OOXML namespaces (superset of all document types)
    OOXML_NAMESPACES = {
        &quot;http://schemas.openxmlformats.org/officeDocument/2006/math&quot;,
        &quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships&quot;,
        &quot;http://schemas.openxmlformats.org/schemaLibrary/2006/main&quot;,
        &quot;http://schemas.openxmlformats.org/drawingml/2006/main&quot;,
        &quot;http://schemas.openxmlformats.org/drawingml/2006/chart&quot;,
        &quot;http://schemas.openxmlformats.org/drawingml/2006/chartDrawing&quot;,
        &quot;http://schemas.openxmlformats.org/drawingml/2006/diagram&quot;,
        &quot;http://schemas.openxmlformats.org/drawingml/2006/picture&quot;,
        &quot;http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing&quot;,
        &quot;http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing&quot;,
        &quot;http://schemas.openxmlformats.org/wordprocessingml/2006/main&quot;,
        &quot;http://schemas.openxmlformats.org/presentationml/2006/main&quot;,
        &quot;http://schemas.openxmlformats.org/spreadsheetml/2006/main&quot;,
        &quot;http://schemas.openxmlformats.org/officeDocument/2006/sharedTypes&quot;,
        &quot;http://www.w3.org/XML/1998/namespace&quot;,
    }

    def __init__(self, unpacked_dir, original_file, verbose=False):
        self.unpacked_dir = Path(unpacked_dir).resolve()
        self.original_file = Path(original_file)
        self.verbose = verbose

        # Set schemas directory
        self.schemas_dir = Path(__file__).parent.parent.parent / &quot;schemas&quot;

        # Get all XML and .rels files
        patterns = [&quot;*.xml&quot;, &quot;*.rels&quot;]
        self.xml_files = [
            f for pattern in patterns for f in self.unpacked_dir.rglob(pattern)
        ]

        if not self.xml_files:
            print(f&quot;Warning: No XML files found in {self.unpacked_dir}&quot;)

    def validate(self):
        &quot;&quot;&quot;Run all validation checks and return True if all pass.&quot;&quot;&quot;
        raise NotImplementedError(&quot;Subclasses must implement the validate method&quot;)

    def validate_xml(self):
        &quot;&quot;&quot;Validate that all XML files are well-formed.&quot;&quot;&quot;
        errors = []

        for xml_file in self.xml_files:
            try:
                # Try to parse the XML file
                lxml.etree.parse(str(xml_file))
            except lxml.etree.XMLSyntaxError as e:
                errors.append(
                    f&quot;  {xml_file.relative_to(self.unpacked_dir)}: &quot;
                    f&quot;Line {e.lineno}: {e.msg}&quot;
                )
            except Exception as e:
                errors.append(
                    f&quot;  {xml_file.relative_to(self.unpacked_dir)}: &quot;
                    f&quot;Unexpected error: {str(e)}&quot;
                )

        if errors:
            print(f&quot;FAILED - Found {len(errors)} XML violations:&quot;)
            for error in errors:
                print(error)
            return False
        else:
            if self.verbose:
                print(&quot;PASSED - All XML files are well-formed&quot;)
            return True

    def validate_namespaces(self):
        &quot;&quot;&quot;Validate that namespace prefixes in Ignorable attributes are declared.&quot;&quot;&quot;
        errors = []

        for xml_file in self.xml_files:
            try:
                root = lxml.etree.parse(str(xml_file)).getroot()
                declared = set(root.nsmap.keys()) - {None}  # Exclude default namespace

                for attr_val in [
                    v for k, v in root.attrib.items() if k.endswith(&quot;Ignorable&quot;)
                ]:
                    undeclared = set(attr_val.split()) - declared
                    errors.extend(
                        f&quot;  {xml_file.relative_to(self.unpacked_dir)}: &quot;
                        f&quot;Namespace &#x27;{ns}&#x27; in Ignorable but not declared&quot;
                        for ns in undeclared
                    )
            except lxml.etree.XMLSyntaxError:
                continue

        if errors:
            print(f&quot;FAILED - {len(errors)} namespace issues:&quot;)
            for error in errors:
                print(error)
            return False
        if self.verbose:
            print(&quot;PASSED - All namespace prefixes properly declared&quot;)
        return True

    def validate_unique_ids(self):
        &quot;&quot;&quot;Validate that specific IDs are unique according to OOXML requirements.&quot;&quot;&quot;
        errors = []
        global_ids = {}  # Track globally unique IDs across all files

        for xml_file in self.xml_files:
            try:
                root = lxml.etree.parse(str(xml_file)).getroot()
                file_ids = {}  # Track IDs that must be unique within this file

                # Remove all mc:AlternateContent elements from the tree
                mc_elements = root.xpath(
                    &quot;.//mc:AlternateContent&quot;, namespaces={&quot;mc&quot;: self.MC_NAMESPACE}
                )
                for elem in mc_elements:
                    elem.getparent().remove(elem)

                # Now check IDs in the cleaned tree
                for elem in root.iter():
                    # Get the element name without namespace
                    tag = (
                        elem.tag.split(&quot;}&quot;)[-1].lower()
                        if &quot;}&quot; in elem.tag
                        else elem.tag.lower()
                    )

                    # Check if this element type has ID uniqueness requirements
                    if tag in self.UNIQUE_ID_REQUIREMENTS:
                        attr_name, scope = self.UNIQUE_ID_REQUIREMENTS[tag]

                        # Look for the specified attribute
                        id_value = None
                        for attr, value in elem.attrib.items():
                            attr_local = (
                                attr.split(&quot;}&quot;)[-1].lower()
                                if &quot;}&quot; in attr
                                else attr.lower()
                            )
                            if attr_local == attr_name:
                                id_value = value
                                break

                        if id_value is not None:
                            if scope == &quot;global&quot;:
                                # Check global uniqueness
                                if id_value in global_ids:
                                    prev_file, prev_line, prev_tag = global_ids[
                                        id_value
                                    ]
                                    errors.append(
                                        f&quot;  {xml_file.relative_to(self.unpacked_dir)}: &quot;
                                        f&quot;Line {elem.sourceline}: Global ID &#x27;{id_value}&#x27; in &lt;{tag}&gt; &quot;
                                        f&quot;already used in {prev_file} at line {prev_line} in &lt;{prev_tag}&gt;&quot;
                                    )
                                else:
                                    global_ids[id_value] = (
                                        xml_file.relative_to(self.unpacked_dir),
                                        elem.sourceline,
                                        tag,
                                    )
                            elif scope == &quot;file&quot;:
                                # Check file-level uniqueness
                                key = (tag, attr_name)
                                if key not in file_ids:
                                    file_ids[key] = {}

                                if id_value in file_ids[key]:
                                    prev_line = file_ids[key][id_value]
                                    errors.append(
                                        f&quot;  {xml_file.relative_to(self.unpacked_dir)}: &quot;
                                        f&quot;Line {elem.sourceline}: Duplicate {attr_name}=&#x27;{id_value}&#x27; in &lt;{tag}&gt; &quot;
                                        f&quot;(first occurrence at line {prev_line})&quot;
                                    )
                                else:
                                    file_ids[key][id_value] = elem.sourceline

            except (lxml.etree.XMLSyntaxError, Exception) as e:
                errors.append(
                    f&quot;  {xml_file.relative_to(self.unpacked_dir)}: Error: {e}&quot;
                )

        if errors:
            print(f&quot;FAILED - Found {len(errors)} ID uniqueness violations:&quot;)
            for error in errors:
                print(error)
            return False
        else:
            if self.verbose:
                print(&quot;PASSED - All required IDs are unique&quot;)
            return True

    def validate_file_references(self):
        &quot;&quot;&quot;
        Validate that all .rels files properly reference files and that all files are referenced.
        &quot;&quot;&quot;
        errors = []

        # Find all .rels files
        rels_files = list(self.unpacked_dir.rglob(&quot;*.rels&quot;))

        if not rels_files:
            if self.verbose:
                print(&quot;PASSED - No .rels files found&quot;)
            return True

        # Get all files in the unpacked directory (excluding reference files)
        all_files = []
        for file_path in self.unpacked_dir.rglob(&quot;*&quot;):
            if (
                file_path.is_file()
                and file_path.name != &quot;[Content_Types].xml&quot;
                and not file_path.name.endswith(&quot;.rels&quot;)
            ):  # This file is not referenced by .rels
                all_files.append(file_path.resolve())

        # Track all files that are referenced by any .rels file
        all_referenced_files = set()

        if self.verbose:
            print(
                f&quot;Found {len(rels_files)} .rels files and {len(all_files)} target files&quot;
            )

        # Check each .rels file
        for rels_file in rels_files:
            try:
                # Parse relationships file
                rels_root = lxml.etree.parse(str(rels_file)).getroot()

                # Get the directory where this .rels file is located
                rels_dir = rels_file.parent

                # Find all relationships and their targets
                referenced_files = set()
                broken_refs = []

                for rel in rels_root.findall(
                    &quot;.//ns:Relationship&quot;,
                    namespaces={&quot;ns&quot;: self.PACKAGE_RELATIONSHIPS_NAMESPACE},
                ):
                    target = rel.get(&quot;Target&quot;)
                    if target and not target.startswith(
                        (&quot;http&quot;, &quot;mailto:&quot;)
                    ):  # Skip external URLs
                        # Resolve the target path relative to the .rels file location
                        if rels_file.name == &quot;.rels&quot;:
                            # Root .rels file - targets are relative to unpacked_dir
                            target_path = self.unpacked_dir / target
                        else:
                            # Other .rels files - targets are relative to their parent&#x27;s parent
                            # e.g., word/_rels/document.xml.rels -&gt; targets relative to word/
                            base_dir = rels_dir.parent
                            target_path = base_dir / target

                        # Normalize the path and check if it exists
                        try:
                            target_path = target_path.resolve()
                            if target_path.exists() and target_path.is_file():
                                referenced_files.add(target_path)
                                all_referenced_files.add(target_path)
                            else:
                                broken_refs.append((target, rel.sourceline))
                        except (OSError, ValueError):
                            broken_refs.append((target, rel.sourceline))

                # Report broken references
                if broken_refs:
                    rel_path = rels_file.relative_to(self.unpacked_dir)
                    for broken_ref, line_num in broken_refs:
                        errors.append(
                            f&quot;  {rel_path}: Line {line_num}: Broken reference to {broken_ref}&quot;
                        )

            except Exception as e:
                rel_path = rels_file.relative_to(self.unpacked_dir)
                errors.append(f&quot;  Error parsing {rel_path}: {e}&quot;)

        # Check for unreferenced files (files that exist but are not referenced anywhere)
        unreferenced_files = set(all_files) - all_referenced_files

        if unreferenced_files:
            for unref_file in sorted(unreferenced_files):
                unref_rel_path = unref_file.relative_to(self.unpacked_dir)
                errors.append(f&quot;  Unreferenced file: {unref_rel_path}&quot;)

        if errors:
            print(f&quot;FAILED - Found {len(errors)} relationship validation errors:&quot;)
            for error in errors:
                print(error)
            print(
                &quot;CRITICAL: These errors will cause the document to appear corrupt. &quot;
                + &quot;Broken references MUST be fixed, &quot;
                + &quot;and unreferenced files MUST be referenced or removed.&quot;
            )
            return False
        else:
            if self.verbose:
                print(
                    &quot;PASSED - All references are valid and all files are properly referenced&quot;
                )
            return True

    def validate_all_relationship_ids(self):
        &quot;&quot;&quot;
        Validate that all r:id attributes in XML files reference existing IDs
        in their corresponding .rels files, and optionally validate relationship types.
        &quot;&quot;&quot;
        import lxml.etree

        errors = []

        # Process each XML file that might contain r:id references
        for xml_file in self.xml_files:
            # Skip .rels files themselves
            if xml_file.suffix == &quot;.rels&quot;:
                continue

            # Determine the corresponding .rels file
            # For dir/file.xml, it&#x27;s dir/_rels/file.xml.rels
            rels_dir = xml_file.parent / &quot;_rels&quot;
            rels_file = rels_dir / f&quot;{xml_file.name}.rels&quot;

            # Skip if there&#x27;s no corresponding .rels file (that&#x27;s okay)
            if not rels_file.exists():
                continue

            try:
                # Parse the .rels file to get valid relationship IDs and their types
                rels_root = lxml.etree.parse(str(rels_file)).getroot()
                rid_to_type = {}

                for rel in rels_root.findall(
                    f&quot;.//{{{self.PACKAGE_RELATIONSHIPS_NAMESPACE}}}Relationship&quot;
                ):
                    rid = rel.get(&quot;Id&quot;)
                    rel_type = rel.get(&quot;Type&quot;, &quot;&quot;)
                    if rid:
                        # Check for duplicate rIds
                        if rid in rid_to_type:
                            rels_rel_path = rels_file.relative_to(self.unpacked_dir)
                            errors.append(
                                f&quot;  {rels_rel_path}: Line {rel.sourceline}: &quot;
                                f&quot;Duplicate relationship ID &#x27;{rid}&#x27; (IDs must be unique)&quot;
                            )
                        # Extract just the type name from the full URL
                        type_name = (
                            rel_type.split(&quot;/&quot;)[-1] if &quot;/&quot; in rel_type else rel_type
                        )
                        rid_to_type[rid] = type_name

                # Parse the XML file to find all r:id references
                xml_root = lxml.etree.parse(str(xml_file)).getroot()

                # Find all elements with r:id attributes
                for elem in xml_root.iter():
                    # Check for r:id attribute (relationship ID)
                    rid_attr = elem.get(f&quot;{{{self.OFFICE_RELATIONSHIPS_NAMESPACE}}}id&quot;)
                    if rid_attr:
                        xml_rel_path = xml_file.relative_to(self.unpacked_dir)
                        elem_name = (
                            elem.tag.split(&quot;}&quot;)[-1] if &quot;}&quot; in elem.tag else elem.tag
                        )

                        # Check if the ID exists
                        if rid_attr not in rid_to_type:
                            errors.append(
                                f&quot;  {xml_rel_path}: Line {elem.sourceline}: &quot;
                                f&quot;&lt;{elem_name}&gt; references non-existent relationship &#x27;{rid_attr}&#x27; &quot;
                                f&quot;(valid IDs: {&#x27;, &#x27;.join(sorted(rid_to_type.keys())[:5])}{&#x27;...&#x27; if len(rid_to_type) &gt; 5 else &#x27;&#x27;})&quot;
                            )
                        # Check if we have type expectations for this element
                        elif self.ELEMENT_RELATIONSHIP_TYPES:
                            expected_type = self._get_expected_relationship_type(
                                elem_name
                            )
                            if expected_type:
                                actual_type = rid_to_type[rid_attr]
                                # Check if the actual type matches or contains the expected type
                                if expected_type not in actual_type.lower():
                                    errors.append(
                                        f&quot;  {xml_rel_path}: Line {elem.sourceline}: &quot;
                                        f&quot;&lt;{elem_name}&gt; references &#x27;{rid_attr}&#x27; which points to &#x27;{actual_type}&#x27; &quot;
                                        f&quot;but should point to a &#x27;{expected_type}&#x27; relationship&quot;
                                    )

            except Exception as e:
                xml_rel_path = xml_file.relative_to(self.unpacked_dir)
                errors.append(f&quot;  Error processing {xml_rel_path}: {e}&quot;)

        if errors:
            print(f&quot;FAILED - Found {len(errors)} relationship ID reference errors:&quot;)
            for error in errors:
                print(error)
            print(&quot;\nThese ID mismatches will cause the document to appear corrupt!&quot;)
            return False
        else:
            if self.verbose:
                print(&quot;PASSED - All relationship ID references are valid&quot;)
            return True

    def _get_expected_relationship_type(self, element_name):
        &quot;&quot;&quot;
        Get the expected relationship type for an element.
        First checks the explicit mapping, then tries pattern detection.
        &quot;&quot;&quot;
        # Normalize element name to lowercase
        elem_lower = element_name.lower()

        # Check explicit mapping first
        if elem_lower in self.ELEMENT_RELATIONSHIP_TYPES:
            return self.ELEMENT_RELATIONSHIP_TYPES[elem_lower]

        # Try pattern detection for common patterns
        # Pattern 1: Elements ending in &quot;Id&quot; often expect a relationship of the prefix type
        if elem_lower.endswith(&quot;id&quot;) and len(elem_lower) &gt; 2:
            # e.g., &quot;sldId&quot; -&gt; &quot;sld&quot;, &quot;sldMasterId&quot; -&gt; &quot;sldMaster&quot;
            prefix = elem_lower[:-2]  # Remove &quot;id&quot;
            # Check if this might be a compound like &quot;sldMasterId&quot;
            if prefix.endswith(&quot;master&quot;):
                return prefix.lower()
            elif prefix.endswith(&quot;layout&quot;):
                return prefix.lower()
            else:
                # Simple case like &quot;sldId&quot; -&gt; &quot;slide&quot;
                # Common transformations
                if prefix == &quot;sld&quot;:
                    return &quot;slide&quot;
                return prefix.lower()

        # Pattern 2: Elements ending in &quot;Reference&quot; expect a relationship of the prefix type
        if elem_lower.endswith(&quot;reference&quot;) and len(elem_lower) &gt; 9:
            prefix = elem_lower[:-9]  # Remove &quot;reference&quot;
            return prefix.lower()

        return None

    def validate_content_types(self):
        &quot;&quot;&quot;Validate that all content files are properly declared in [Content_Types].xml.&quot;&quot;&quot;
        errors = []

        # Find [Content_Types].xml file
        content_types_file = self.unpacked_dir / &quot;[Content_Types].xml&quot;
        if not content_types_file.exists():
            print(&quot;FAILED - [Content_Types].xml file not found&quot;)
            return False

        try:
            # Parse and get all declared parts and extensions
            root = lxml.etree.parse(str(content_types_file)).getroot()
            declared_parts = set()
            declared_extensions = set()

            # Get Override declarations (specific files)
            for override in root.findall(
                f&quot;.//{{{self.CONTENT_TYPES_NAMESPACE}}}Override&quot;
            ):
                part_name = override.get(&quot;PartName&quot;)
                if part_name is not None:
                    declared_parts.add(part_name.lstrip(&quot;/&quot;))

            # Get Default declarations (by extension)
            for default in root.findall(
                f&quot;.//{{{self.CONTENT_TYPES_NAMESPACE}}}Default&quot;
            ):
                extension = default.get(&quot;Extension&quot;)
                if extension is not None:
                    declared_extensions.add(extension.lower())

            # Root elements that require content type declaration
            declarable_roots = {
                &quot;sld&quot;,
                &quot;sldLayout&quot;,
                &quot;sldMaster&quot;,
                &quot;presentation&quot;,  # PowerPoint
                &quot;document&quot;,  # Word
                &quot;workbook&quot;,
                &quot;worksheet&quot;,  # Excel
                &quot;theme&quot;,  # Common
            }

            # Common media file extensions that should be declared
            media_extensions = {
                &quot;png&quot;: &quot;image/png&quot;,
                &quot;jpg&quot;: &quot;image/jpeg&quot;,
                &quot;jpeg&quot;: &quot;image/jpeg&quot;,
                &quot;gif&quot;: &quot;image/gif&quot;,
                &quot;bmp&quot;: &quot;image/bmp&quot;,
                &quot;tiff&quot;: &quot;image/tiff&quot;,
                &quot;wmf&quot;: &quot;image/x-wmf&quot;,
                &quot;emf&quot;: &quot;image/x-emf&quot;,
            }

            # Get all files in the unpacked directory
            all_files = list(self.unpacked_dir.rglob(&quot;*&quot;))
            all_files = [f for f in all_files if f.is_file()]

            # Check all XML files for Override declarations
            for xml_file in self.xml_files:
                path_str = str(xml_file.relative_to(self.unpacked_dir)).replace(
                    &quot;\\&quot;, &quot;/&quot;
                )

                # Skip non-content files
                if any(
                    skip in path_str
                    for skip in [&quot;.rels&quot;, &quot;[Content_Types]&quot;, &quot;docProps/&quot;, &quot;_rels/&quot;]
                ):
                    continue

                try:
                    root_tag = lxml.etree.parse(str(xml_file)).getroot().tag
                    root_name = root_tag.split(&quot;}&quot;)[-1] if &quot;}&quot; in root_tag else root_tag

                    if root_name in declarable_roots and path_str not in declared_parts:
                        errors.append(
                            f&quot;  {path_str}: File with &lt;{root_name}&gt; root not declared in [Content_Types].xml&quot;
                        )

                except Exception:
                    continue  # Skip unparseable files

            # Check all non-XML files for Default extension declarations
            for file_path in all_files:
                # Skip XML files and metadata files (already checked above)
                if file_path.suffix.lower() in {&quot;.xml&quot;, &quot;.rels&quot;}:
                    continue
                if file_path.name == &quot;[Content_Types].xml&quot;:
                    continue
                if &quot;_rels&quot; in file_path.parts or &quot;docProps&quot; in file_path.parts:
                    continue

                extension = file_path.suffix.lstrip(&quot;.&quot;).lower()
                if extension and extension not in declared_extensions:
                    # Check if it&#x27;s a known media extension that should be declared
                    if extension in media_extensions:
                        relative_path = file_path.relative_to(self.unpacked_dir)
                        errors.append(
                            f&#x27;  {relative_path}: File with extension \&#x27;{extension}\&#x27; not declared in [Content_Types].xml - should add: &lt;Default Extension=&quot;{extension}&quot; ContentType=&quot;{media_extensions[extension]}&quot;/&gt;&#x27;
                        )

        except Exception as e:
            errors.append(f&quot;  Error parsing [Content_Types].xml: {e}&quot;)

        if errors:
            print(f&quot;FAILED - Found {len(errors)} content type declaration errors:&quot;)
            for error in errors:
                print(error)
            return False
        else:
            if self.verbose:
                print(
                    &quot;PASSED - All content files are properly declared in [Content_Types].xml&quot;
                )
            return True

    def validate_file_against_xsd(self, xml_file, verbose=False):
        &quot;&quot;&quot;Validate a single XML file against XSD schema, comparing with original.

        Args:
            xml_file: Path to XML file to validate
            verbose: Enable verbose output

        Returns:
            tuple: (is_valid, new_errors_set) where is_valid is True/False/None (skipped)
        &quot;&quot;&quot;
        # Resolve both paths to handle symlinks
        xml_file = Path(xml_file).resolve()
        unpacked_dir = self.unpacked_dir.resolve()

        # Validate current file
        is_valid, current_errors = self._validate_single_file_xsd(
            xml_file, unpacked_dir
        )

        if is_valid is None:
            return None, set()  # Skipped
        elif is_valid:
            return True, set()  # Valid, no errors

        # Get errors from original file for this specific file
        original_errors = self._get_original_file_errors(xml_file)

        # Compare with original (both are guaranteed to be sets here)
        assert current_errors is not None
        new_errors = current_errors - original_errors

        if new_errors:
            if verbose:
                relative_path = xml_file.relative_to(unpacked_dir)
                print(f&quot;FAILED - {relative_path}: {len(new_errors)} new error(s)&quot;)
                for error in list(new_errors)[:3]:
                    truncated = error[:250] + &quot;...&quot; if len(error) &gt; 250 else error
                    print(f&quot;  - {truncated}&quot;)
            return False, new_errors
        else:
            # All errors existed in original
            if verbose:
                print(
                    f&quot;PASSED - No new errors (original had {len(current_errors)} errors)&quot;
                )
            return True, set()

    def validate_against_xsd(self):
        &quot;&quot;&quot;Validate XML files against XSD schemas, showing only new errors compared to original.&quot;&quot;&quot;
        new_errors = []
        original_error_count = 0
        valid_count = 0
        skipped_count = 0

        for xml_file in self.xml_files:
            relative_path = str(xml_file.relative_to(self.unpacked_dir))
            is_valid, new_file_errors = self.validate_file_against_xsd(
                xml_file, verbose=False
            )

            if is_valid is None:
                skipped_count += 1
                continue
            elif is_valid and not new_file_errors:
                valid_count += 1
                continue
            elif is_valid:
                # Had errors but all existed in original
                original_error_count += 1
                valid_count += 1
                continue

            # Has new errors
            new_errors.append(f&quot;  {relative_path}: {len(new_file_errors)} new error(s)&quot;)
            for error in list(new_file_errors)[:3]:  # Show first 3 errors
                new_errors.append(
                    f&quot;    - {error[:250]}...&quot; if len(error) &gt; 250 else f&quot;    - {error}&quot;
                )

        # Print summary
        if self.verbose:
            print(f&quot;Validated {len(self.xml_files)} files:&quot;)
            print(f&quot;  - Valid: {valid_count}&quot;)
            print(f&quot;  - Skipped (no schema): {skipped_count}&quot;)
            if original_error_count:
                print(f&quot;  - With original errors (ignored): {original_error_count}&quot;)
            print(
                f&quot;  - With NEW errors: {len(new_errors) &gt; 0 and len([e for e in new_errors if not e.startswith(&#x27;    &#x27;)]) or 0}&quot;
            )

        if new_errors:
            print(&quot;\nFAILED - Found NEW validation errors:&quot;)
            for error in new_errors:
                print(error)
            return False
        else:
            if self.verbose:
                print(&quot;\nPASSED - No new XSD validation errors introduced&quot;)
            return True

    def _get_schema_path(self, xml_file):
        &quot;&quot;&quot;Determine the appropriate schema path for an XML file.&quot;&quot;&quot;
        # Check exact filename match
        if xml_file.name in self.SCHEMA_MAPPINGS:
            return self.schemas_dir / self.SCHEMA_MAPPINGS[xml_file.name]

        # Check .rels files
        if xml_file.suffix == &quot;.rels&quot;:
            return self.schemas_dir / self.SCHEMA_MAPPINGS[&quot;.rels&quot;]

        # Check chart files
        if &quot;charts/&quot; in str(xml_file) and xml_file.name.startswith(&quot;chart&quot;):
            return self.schemas_dir / self.SCHEMA_MAPPINGS[&quot;chart&quot;]

        # Check theme files
        if &quot;theme/&quot; in str(xml_file) and xml_file.name.startswith(&quot;theme&quot;):
            return self.schemas_dir / self.SCHEMA_MAPPINGS[&quot;theme&quot;]

        # Check if file is in a main content folder and use appropriate schema
        if xml_file.parent.name in self.MAIN_CONTENT_FOLDERS:
            return self.schemas_dir / self.SCHEMA_MAPPINGS[xml_file.parent.name]

        return None

    def _clean_ignorable_namespaces(self, xml_doc):
        &quot;&quot;&quot;Remove attributes and elements not in allowed namespaces.&quot;&quot;&quot;
        # Create a clean copy
        xml_string = lxml.etree.tostring(xml_doc, encoding=&quot;unicode&quot;)
        xml_copy = lxml.etree.fromstring(xml_string)

        # Remove attributes not in allowed namespaces
        for elem in xml_copy.iter():
            attrs_to_remove = []

            for attr in elem.attrib:
                # Check if attribute is from a namespace other than allowed ones
                if &quot;{&quot; in attr:
                    ns = attr.split(&quot;}&quot;)[0][1:]
                    if ns not in self.OOXML_NAMESPACES:
                        attrs_to_remove.append(attr)

            # Remove collected attributes
            for attr in attrs_to_remove:
                del elem.attrib[attr]

        # Remove elements not in allowed namespaces
        self._remove_ignorable_elements(xml_copy)

        return lxml.etree.ElementTree(xml_copy)

    def _remove_ignorable_elements(self, root):
        &quot;&quot;&quot;Recursively remove all elements not in allowed namespaces.&quot;&quot;&quot;
        elements_to_remove = []

        # Find elements to remove
        for elem in list(root):
            # Skip non-element nodes (comments, processing instructions, etc.)
            if not hasattr(elem, &quot;tag&quot;) or callable(elem.tag):
                continue

            tag_str = str(elem.tag)
            if tag_str.startswith(&quot;{&quot;):
                ns = tag_str.split(&quot;}&quot;)[0][1:]
                if ns not in self.OOXML_NAMESPACES:
                    elements_to_remove.append(elem)
                    continue

            # Recursively clean child elements
            self._remove_ignorable_elements(elem)

        # Remove collected elements
        for elem in elements_to_remove:
            root.remove(elem)

    def _preprocess_for_mc_ignorable(self, xml_doc):
        &quot;&quot;&quot;Preprocess XML to handle mc:Ignorable attribute properly.&quot;&quot;&quot;
        # Remove mc:Ignorable attributes before validation
        root = xml_doc.getroot()

        # Remove mc:Ignorable attribute from root
        if f&quot;{{{self.MC_NAMESPACE}}}Ignorable&quot; in root.attrib:
            del root.attrib[f&quot;{{{self.MC_NAMESPACE}}}Ignorable&quot;]

        return xml_doc

    def _validate_single_file_xsd(self, xml_file, base_path):
        &quot;&quot;&quot;Validate a single XML file against XSD schema. Returns (is_valid, errors_set).&quot;&quot;&quot;
        schema_path = self._get_schema_path(xml_file)
        if not schema_path:
            return None, None  # Skip file

        try:
            # Load schema
            with open(schema_path, &quot;rb&quot;) as xsd_file:
                parser = lxml.etree.XMLParser()
                xsd_doc = lxml.etree.parse(
                    xsd_file, parser=parser, base_url=str(schema_path)
                )
                schema = lxml.etree.XMLSchema(xsd_doc)

            # Load and preprocess XML
            with open(xml_file, &quot;r&quot;) as f:
                xml_doc = lxml.etree.parse(f)

            xml_doc, _ = self._remove_template_tags_from_text_nodes(xml_doc)
            xml_doc = self._preprocess_for_mc_ignorable(xml_doc)

            # Clean ignorable namespaces if needed
            relative_path = xml_file.relative_to(base_path)
            if (
                relative_path.parts
                and relative_path.parts[0] in self.MAIN_CONTENT_FOLDERS
            ):
                xml_doc = self._clean_ignorable_namespaces(xml_doc)

            # Validate
            if schema.validate(xml_doc):
                return True, set()
            else:
                errors = set()
                for error in schema.error_log:
                    # Store normalized error message (without line numbers for comparison)
                    errors.add(error.message)
                return False, errors

        except Exception as e:
            return False, {str(e)}

    def _get_original_file_errors(self, xml_file):
        &quot;&quot;&quot;Get XSD validation errors from a single file in the original document.

        Args:
            xml_file: Path to the XML file in unpacked_dir to check

        Returns:
            set: Set of error messages from the original file
        &quot;&quot;&quot;
        import tempfile
        import zipfile

        # Resolve both paths to handle symlinks (e.g., /var vs /private/var on macOS)
        xml_file = Path(xml_file).resolve()
        unpacked_dir = self.unpacked_dir.resolve()
        relative_path = xml_file.relative_to(unpacked_dir)

        with tempfile.TemporaryDirectory() as temp_dir:
            temp_path = Path(temp_dir)

            # Extract original file
            with zipfile.ZipFile(self.original_file, &quot;r&quot;) as zip_ref:
                zip_ref.extractall(temp_path)

            # Find corresponding file in original
            original_xml_file = temp_path / relative_path

            if not original_xml_file.exists():
                # File didn&#x27;t exist in original, so no original errors
                return set()

            # Validate the specific file in original
            is_valid, errors = self._validate_single_file_xsd(
                original_xml_file, temp_path
            )
            return errors if errors else set()

    def _remove_template_tags_from_text_nodes(self, xml_doc):
        &quot;&quot;&quot;Remove template tags from XML text nodes and collect warnings.

        Template tags follow the pattern {{ ... }} and are used as placeholders
        for content replacement. They should be removed from text content before
        XSD validation while preserving XML structure.

        Returns:
            tuple: (cleaned_xml_doc, warnings_list)
        &quot;&quot;&quot;
        warnings = []
        template_pattern = re.compile(r&quot;\{\{[^}]*\}\}&quot;)

        # Create a copy of the document to avoid modifying the original
        xml_string = lxml.etree.tostring(xml_doc, encoding=&quot;unicode&quot;)
        xml_copy = lxml.etree.fromstring(xml_string)

        def process_text_content(text, content_type):
            if not text:
                return text
            matches = list(template_pattern.finditer(text))
            if matches:
                for match in matches:
                    warnings.append(
                        f&quot;Found template tag in {content_type}: {match.group()}&quot;
                    )
                return template_pattern.sub(&quot;&quot;, text)
            return text

        # Process all text nodes in the document
        for elem in xml_copy.iter():
            # Skip processing if this is a w:t element
            if not hasattr(elem, &quot;tag&quot;) or callable(elem.tag):
                continue
            tag_str = str(elem.tag)
            if tag_str.endswith(&quot;}t&quot;) or tag_str == &quot;t&quot;:
                continue

            elem.text = process_text_content(elem.text, &quot;text content&quot;)
            elem.tail = process_text_content(elem.tail, &quot;tail content&quot;)

        return lxml.etree.ElementTree(xml_copy), warnings


if __name__ == &quot;__main__&quot;:
    raise RuntimeError(&quot;This module should not be run directly.&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/base/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/ooxml/scripts/validation/base.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="bigshoulders_ofl Imported skill bigshoulders_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/BigShoulders-OFL.txt Unknown LICENSE.txt sources/anthropic/bigshoulders_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">bigshoulders_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('bigshoulders_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill bigshoulders_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2019 The Big Shoulders Project Authors (https://github.com/xotypeco/big_shoulders)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/bigshoulders_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/BigShoulders-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="boldonse_ofl Imported skill boldonse_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/Boldonse-OFL.txt Unknown LICENSE.txt sources/anthropic/boldonse_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">boldonse_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('boldonse_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill boldonse_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2024 The Boldonse Project Authors (https://github.com/googlefonts/boldonse)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/boldonse_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/Boldonse-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="botanical_garden Imported skill botanical_garden from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/theme-factory/themes/botanical-garden.md Unknown LICENSE.txt sources/anthropic/botanical_garden/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">botanical_garden</div>
                <button class="copy-btn" onclick="copyToClipboard('botanical_garden')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill botanical_garden from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Botanical Garden

A fresh and organic theme featuring vibrant garden-inspired colors for lively presentations.

## Color Palette

- **Fern Green**: `#4a7c59` - Rich natural green
- **Marigold**: `#f9a620` - Bright floral accent
- **Terracotta**: `#b7472a` - Earthy warm tone
- **Cream**: `#f5f3ed` - Soft neutral backgrounds

## Typography

- **Headers**: DejaVu Serif Bold
- **Body Text**: DejaVu Sans

## Best Used For

Garden centers, food presentations, farm-to-table content, botanical brands, natural products.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/botanical_garden/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/themes/botanical-garden.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="bricolagegrotesque_ofl Imported skill bricolagegrotesque_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/BricolageGrotesque-OFL.txt Unknown LICENSE.txt sources/anthropic/bricolagegrotesque_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">bricolagegrotesque_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('bricolagegrotesque_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill bricolagegrotesque_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2022 The Bricolage Grotesque Project Authors (https://github.com/ateliertriay/bricolage)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/bricolagegrotesque_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/BricolageGrotesque-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="check_bounding_boxes Imported skill check_bounding_boxes from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pdf/scripts/check_bounding_boxes.py Unknown LICENSE.txt sources/anthropic/check_bounding_boxes/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">check_bounding_boxes</div>
                <button class="copy-btn" onclick="copyToClipboard('check_bounding_boxes')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill check_bounding_boxes from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">from dataclasses import dataclass
import json
import sys


# Script to check that the `fields.json` file that Claude creates when analyzing PDFs
# does not have overlapping bounding boxes. See forms.md.


@dataclass
class RectAndField:
    rect: list[float]
    rect_type: str
    field: dict


# Returns a list of messages that are printed to stdout for Claude to read.
def get_bounding_box_messages(fields_json_stream) -&gt; list[str]:
    messages = []
    fields = json.load(fields_json_stream)
    messages.append(f&quot;Read {len(fields[&#x27;form_fields&#x27;])} fields&quot;)

    def rects_intersect(r1, r2):
        disjoint_horizontal = r1[0] &gt;= r2[2] or r1[2] &lt;= r2[0]
        disjoint_vertical = r1[1] &gt;= r2[3] or r1[3] &lt;= r2[1]
        return not (disjoint_horizontal or disjoint_vertical)

    rects_and_fields = []
    for f in fields[&quot;form_fields&quot;]:
        rects_and_fields.append(RectAndField(f[&quot;label_bounding_box&quot;], &quot;label&quot;, f))
        rects_and_fields.append(RectAndField(f[&quot;entry_bounding_box&quot;], &quot;entry&quot;, f))

    has_error = False
    for i, ri in enumerate(rects_and_fields):
        # This is O(N^2); we can optimize if it becomes a problem.
        for j in range(i + 1, len(rects_and_fields)):
            rj = rects_and_fields[j]
            if ri.field[&quot;page_number&quot;] == rj.field[&quot;page_number&quot;] and rects_intersect(ri.rect, rj.rect):
                has_error = True
                if ri.field is rj.field:
                    messages.append(f&quot;FAILURE: intersection between label and entry bounding boxes for `{ri.field[&#x27;description&#x27;]}` ({ri.rect}, {rj.rect})&quot;)
                else:
                    messages.append(f&quot;FAILURE: intersection between {ri.rect_type} bounding box for `{ri.field[&#x27;description&#x27;]}` ({ri.rect}) and {rj.rect_type} bounding box for `{rj.field[&#x27;description&#x27;]}` ({rj.rect})&quot;)
                if len(messages) &gt;= 20:
                    messages.append(&quot;Aborting further checks; fix bounding boxes and try again&quot;)
                    return messages
        if ri.rect_type == &quot;entry&quot;:
            if &quot;entry_text&quot; in ri.field:
                font_size = ri.field[&quot;entry_text&quot;].get(&quot;font_size&quot;, 14)
                entry_height = ri.rect[3] - ri.rect[1]
                if entry_height &lt; font_size:
                    has_error = True
                    messages.append(f&quot;FAILURE: entry bounding box height ({entry_height}) for `{ri.field[&#x27;description&#x27;]}` is too short for the text content (font size: {font_size}). Increase the box height or decrease the font size.&quot;)
                    if len(messages) &gt;= 20:
                        messages.append(&quot;Aborting further checks; fix bounding boxes and try again&quot;)
                        return messages

    if not has_error:
        messages.append(&quot;SUCCESS: All bounding boxes are valid&quot;)
    return messages

if __name__ == &quot;__main__&quot;:
    if len(sys.argv) != 2:
        print(&quot;Usage: check_bounding_boxes.py [fields.json]&quot;)
        sys.exit(1)
    # Input file should be in the `fields.json` format described in forms.md.
    with open(sys.argv[1]) as f:
        messages = get_bounding_box_messages(f)
    for msg in messages:
        print(msg)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/check_bounding_boxes/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/scripts/check_bounding_boxes.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="check_fillable_fields Imported skill check_fillable_fields from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pdf/scripts/check_fillable_fields.py Unknown LICENSE.txt sources/anthropic/check_fillable_fields/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">check_fillable_fields</div>
                <button class="copy-btn" onclick="copyToClipboard('check_fillable_fields')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill check_fillable_fields from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">import sys
from pypdf import PdfReader


# Script for Claude to run to determine whether a PDF has fillable form fields. See forms.md.


reader = PdfReader(sys.argv[1])
if (reader.get_fields()):
    print(&quot;This PDF has fillable form fields&quot;)
else:
    print(&quot;This PDF does not have fillable form fields; you will need to visually determine where to enter data&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/check_fillable_fields/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/scripts/check_fillable_fields.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="company_newsletter Imported skill company_newsletter from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/internal-comms/examples/company-newsletter.md Unknown LICENSE.txt sources/anthropic/company_newsletter/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">company_newsletter</div>
                <button class="copy-btn" onclick="copyToClipboard('company_newsletter')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill company_newsletter from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">## Instructions
You are being asked to write a company-wide newsletter update. You are meant to summarize the past week/month of a company in the form of a newsletter that the entire company will read. It should be maybe ~20-25 bullet points long. It will be sent via Slack and email, so make it consumable for that.

Ideally it includes the following attributes:
- Lots of links: pulling documents from Google Drive that are very relevant, linking to prominent Slack messages in announce channels and from executives, perhgaps referencing emails that went company-wide, highlighting significant things that have happened in the company.
- Short and to-the-point: each bullet should probably be no longer than ~1-2 sentences
- Use the &quot;we&quot; tense, as you are part of the company. Many of the bullets should say &quot;we did this&quot; or &quot;we did that&quot;

## Tools to use
If you have access to the following tools, please try to use them. If not, you can also let the user know directly that their responses would be better if they gave them access.

- Slack: look for messages in channels with lots of people, with lots of reactions or lots of responses within the thread
- Email: look for things from executives that discuss company-wide announcements
- Calendar: if there were meetings with large attendee lists, particularly things like All-Hands meetings, big company announcements, etc. If there were documents attached to those meetings, those are great links to include.
- Documents: if there were new docs published in the last week or two that got a lot of attention, you can link them. These should be things like company-wide vision docs, plans for the upcoming quarter or half, things authored by critical executives, etc.
- External press: if you see references to articles or press we&#x27;ve received over the past week, that could be really cool too.

If you don&#x27;t have access to any of these things, you can ask the user for things they want to cover. In this case, you&#x27;ll mostly just be polishing up and fitting to this format more directly.

## Sections
The company is pretty big: 1000+ people. There are a variety of different teams and initiatives going on across the company. To make sure the update works well, try breaking it into sections of similar things. You might break into clusters like {product development, go to market, finance} or {recruiting, execution, vision}, or {external news, internal news} etc. Try to make sure the different areas of the company are highlighted well.

## Prioritization
Focus on:
- Company-wide impact (not team-specific details)
- Announcements from leadership
- Major milestones and achievements
- Information that affects most employees
- External recognition or press

Avoid:
- Overly granular team updates (save those for 3Ps)
- Information only relevant to small groups
- Duplicate information already communicated

## Example Formats

:megaphone: Company Announcements
- Announcement 1
- Announcement 2
- Announcement 3

:dart: Progress on Priorities
- Area 1
    - Sub-area 1
    - Sub-area 2
    - Sub-area 3
- Area 2
    - Sub-area 1
    - Sub-area 2
    - Sub-area 3
- Area 3
    - Sub-area 1
    - Sub-area 2
    - Sub-area 3

:pillar: Leadership Updates
- Post 1
- Post 2
- Post 3

:thread: Social Updates
- Update 1
- Update 2
- Update 3</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/company_newsletter/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/internal-comms/examples/company-newsletter.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/internal-comms/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="connections Imported skill connections from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/mcp-builder/scripts/connections.py Unknown LICENSE.txt sources/anthropic/connections/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">connections</div>
                <button class="copy-btn" onclick="copyToClipboard('connections')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill connections from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Lightweight connection handling for MCP servers.&quot;&quot;&quot;

from abc import ABC, abstractmethod
from contextlib import AsyncExitStack
from typing import Any

from mcp import ClientSession, StdioServerParameters
from mcp.client.sse import sse_client
from mcp.client.stdio import stdio_client
from mcp.client.streamable_http import streamablehttp_client


class MCPConnection(ABC):
    &quot;&quot;&quot;Base class for MCP server connections.&quot;&quot;&quot;

    def __init__(self):
        self.session = None
        self._stack = None

    @abstractmethod
    def _create_context(self):
        &quot;&quot;&quot;Create the connection context based on connection type.&quot;&quot;&quot;

    async def __aenter__(self):
        &quot;&quot;&quot;Initialize MCP server connection.&quot;&quot;&quot;
        self._stack = AsyncExitStack()
        await self._stack.__aenter__()

        try:
            ctx = self._create_context()
            result = await self._stack.enter_async_context(ctx)

            if len(result) == 2:
                read, write = result
            elif len(result) == 3:
                read, write, _ = result
            else:
                raise ValueError(f&quot;Unexpected context result: {result}&quot;)

            session_ctx = ClientSession(read, write)
            self.session = await self._stack.enter_async_context(session_ctx)
            await self.session.initialize()
            return self
        except BaseException:
            await self._stack.__aexit__(None, None, None)
            raise

    async def __aexit__(self, exc_type, exc_val, exc_tb):
        &quot;&quot;&quot;Clean up MCP server connection resources.&quot;&quot;&quot;
        if self._stack:
            await self._stack.__aexit__(exc_type, exc_val, exc_tb)
        self.session = None
        self._stack = None

    async def list_tools(self) -&gt; list[dict[str, Any]]:
        &quot;&quot;&quot;Retrieve available tools from the MCP server.&quot;&quot;&quot;
        response = await self.session.list_tools()
        return [
            {
                &quot;name&quot;: tool.name,
                &quot;description&quot;: tool.description,
                &quot;input_schema&quot;: tool.inputSchema,
            }
            for tool in response.tools
        ]

    async def call_tool(self, tool_name: str, arguments: dict[str, Any]) -&gt; Any:
        &quot;&quot;&quot;Call a tool on the MCP server with provided arguments.&quot;&quot;&quot;
        result = await self.session.call_tool(tool_name, arguments=arguments)
        return result.content


class MCPConnectionStdio(MCPConnection):
    &quot;&quot;&quot;MCP connection using standard input/output.&quot;&quot;&quot;

    def __init__(self, command: str, args: list[str] = None, env: dict[str, str] = None):
        super().__init__()
        self.command = command
        self.args = args or []
        self.env = env

    def _create_context(self):
        return stdio_client(
            StdioServerParameters(command=self.command, args=self.args, env=self.env)
        )


class MCPConnectionSSE(MCPConnection):
    &quot;&quot;&quot;MCP connection using Server-Sent Events.&quot;&quot;&quot;

    def __init__(self, url: str, headers: dict[str, str] = None):
        super().__init__()
        self.url = url
        self.headers = headers or {}

    def _create_context(self):
        return sse_client(url=self.url, headers=self.headers)


class MCPConnectionHTTP(MCPConnection):
    &quot;&quot;&quot;MCP connection using Streamable HTTP.&quot;&quot;&quot;

    def __init__(self, url: str, headers: dict[str, str] = None):
        super().__init__()
        self.url = url
        self.headers = headers or {}

    def _create_context(self):
        return streamablehttp_client(url=self.url, headers=self.headers)


def create_connection(
    transport: str,
    command: str = None,
    args: list[str] = None,
    env: dict[str, str] = None,
    url: str = None,
    headers: dict[str, str] = None,
) -&gt; MCPConnection:
    &quot;&quot;&quot;Factory function to create the appropriate MCP connection.

    Args:
        transport: Connection type (&quot;stdio&quot;, &quot;sse&quot;, or &quot;http&quot;)
        command: Command to run (stdio only)
        args: Command arguments (stdio only)
        env: Environment variables (stdio only)
        url: Server URL (sse and http only)
        headers: HTTP headers (sse and http only)

    Returns:
        MCPConnection instance
    &quot;&quot;&quot;
    transport = transport.lower()

    if transport == &quot;stdio&quot;:
        if not command:
            raise ValueError(&quot;Command is required for stdio transport&quot;)
        return MCPConnectionStdio(command=command, args=args, env=env)

    elif transport == &quot;sse&quot;:
        if not url:
            raise ValueError(&quot;URL is required for sse transport&quot;)
        return MCPConnectionSSE(url=url, headers=headers)

    elif transport in [&quot;http&quot;, &quot;streamable_http&quot;, &quot;streamable-http&quot;]:
        if not url:
            raise ValueError(&quot;URL is required for http transport&quot;)
        return MCPConnectionHTTP(url=url, headers=headers)

    else:
        raise ValueError(f&quot;Unsupported transport type: {transport}. Use &#x27;stdio&#x27;, &#x27;sse&#x27;, or &#x27;http&#x27;&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/connections/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/scripts/connections.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="convert_pdf_to_images Imported skill convert_pdf_to_images from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pdf/scripts/convert_pdf_to_images.py Unknown LICENSE.txt sources/anthropic/convert_pdf_to_images/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">convert_pdf_to_images</div>
                <button class="copy-btn" onclick="copyToClipboard('convert_pdf_to_images')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill convert_pdf_to_images from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">import os
import sys

from pdf2image import convert_from_path


# Converts each page of a PDF to a PNG image.


def convert(pdf_path, output_dir, max_dim=1000):
    images = convert_from_path(pdf_path, dpi=200)

    for i, image in enumerate(images):
        # Scale image if needed to keep width/height under `max_dim`
        width, height = image.size
        if width &gt; max_dim or height &gt; max_dim:
            scale_factor = min(max_dim / width, max_dim / height)
            new_width = int(width * scale_factor)
            new_height = int(height * scale_factor)
            image = image.resize((new_width, new_height))
        
        image_path = os.path.join(output_dir, f&quot;page_{i+1}.png&quot;)
        image.save(image_path)
        print(f&quot;Saved page {i+1} as {image_path} (size: {image.size})&quot;)

    print(f&quot;Converted {len(images)} pages to PNG images&quot;)


if __name__ == &quot;__main__&quot;:
    if len(sys.argv) != 3:
        print(&quot;Usage: convert_pdf_to_images.py [input pdf] [output directory]&quot;)
        sys.exit(1)
    pdf_path = sys.argv[1]
    output_directory = sys.argv[2]
    convert(pdf_path, output_directory)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/convert_pdf_to_images/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/scripts/convert_pdf_to_images.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="create_validation_image Imported skill create_validation_image from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pdf/scripts/create_validation_image.py Unknown LICENSE.txt sources/anthropic/create_validation_image/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">create_validation_image</div>
                <button class="copy-btn" onclick="copyToClipboard('create_validation_image')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill create_validation_image from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">import json
import sys

from PIL import Image, ImageDraw


# Creates &quot;validation&quot; images with rectangles for the bounding box information that
# Claude creates when determining where to add text annotations in PDFs. See forms.md.


def create_validation_image(page_number, fields_json_path, input_path, output_path):
    # Input file should be in the `fields.json` format described in forms.md.
    with open(fields_json_path, &#x27;r&#x27;) as f:
        data = json.load(f)

        img = Image.open(input_path)
        draw = ImageDraw.Draw(img)
        num_boxes = 0
        
        for field in data[&quot;form_fields&quot;]:
            if field[&quot;page_number&quot;] == page_number:
                entry_box = field[&#x27;entry_bounding_box&#x27;]
                label_box = field[&#x27;label_bounding_box&#x27;]
                # Draw red rectangle over entry bounding box and blue rectangle over the label.
                draw.rectangle(entry_box, outline=&#x27;red&#x27;, width=2)
                draw.rectangle(label_box, outline=&#x27;blue&#x27;, width=2)
                num_boxes += 2
        
        img.save(output_path)
        print(f&quot;Created validation image at {output_path} with {num_boxes} bounding boxes&quot;)


if __name__ == &quot;__main__&quot;:
    if len(sys.argv) != 5:
        print(&quot;Usage: create_validation_image.py [page number] [fields.json file] [input image path] [output image path]&quot;)
        sys.exit(1)
    page_number = int(sys.argv[1])
    fields_json_path = sys.argv[2]
    input_image_path = sys.argv[3]
    output_image_path = sys.argv[4]
    create_validation_image(page_number, fields_json_path, input_image_path, output_image_path)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/create_validation_image/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/scripts/create_validation_image.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="crimsonpro_ofl Imported skill crimsonpro_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/CrimsonPro-OFL.txt Unknown LICENSE.txt sources/anthropic/crimsonpro_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">crimsonpro_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('crimsonpro_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill crimsonpro_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2018 The Crimson Pro Project Authors (https://github.com/Fonthausen/CrimsonPro)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/crimsonpro_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/CrimsonPro-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="desert_rose Imported skill desert_rose from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/theme-factory/themes/desert-rose.md Unknown LICENSE.txt sources/anthropic/desert_rose/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">desert_rose</div>
                <button class="copy-btn" onclick="copyToClipboard('desert_rose')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill desert_rose from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Desert Rose

A soft and sophisticated theme with dusty, muted tones perfect for elegant presentations.

## Color Palette

- **Dusty Rose**: `#d4a5a5` - Soft primary color
- **Clay**: `#b87d6d` - Earthy accent
- **Sand**: `#e8d5c4` - Warm neutral backgrounds
- **Deep Burgundy**: `#5d2e46` - Rich dark contrast

## Typography

- **Headers**: FreeSans Bold
- **Body Text**: FreeSans

## Best Used For

Fashion presentations, beauty brands, wedding planning, interior design, boutique businesses.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/desert_rose/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/themes/desert-rose.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="dmmono_ofl Imported skill dmmono_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/DMMono-OFL.txt Unknown LICENSE.txt sources/anthropic/dmmono_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">dmmono_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('dmmono_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill dmmono_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2020 The DM Mono Project Authors (https://www.github.com/googlefonts/dm-mono)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/dmmono_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/DMMono-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="document Imported skill document from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/docx/scripts/document.py Unknown LICENSE.txt sources/anthropic/document/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">document</div>
                <button class="copy-btn" onclick="copyToClipboard('document')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill document from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Library for working with Word documents: comments, tracked changes, and editing.

Usage:
    from skills.docx.scripts.document import Document

    # Initialize
    doc = Document(&#x27;workspace/unpacked&#x27;)
    doc = Document(&#x27;workspace/unpacked&#x27;, author=&quot;John Doe&quot;, initials=&quot;JD&quot;)

    # Find nodes
    node = doc[&quot;word/document.xml&quot;].get_node(tag=&quot;w:del&quot;, attrs={&quot;w:id&quot;: &quot;1&quot;})
    node = doc[&quot;word/document.xml&quot;].get_node(tag=&quot;w:p&quot;, line_number=10)

    # Add comments
    doc.add_comment(start=node, end=node, text=&quot;Comment text&quot;)
    doc.reply_to_comment(parent_comment_id=0, text=&quot;Reply text&quot;)

    # Suggest tracked changes
    doc[&quot;word/document.xml&quot;].suggest_deletion(node)  # Delete content
    doc[&quot;word/document.xml&quot;].revert_insertion(ins_node)  # Reject insertion
    doc[&quot;word/document.xml&quot;].revert_deletion(del_node)  # Reject deletion

    # Save
    doc.save()
&quot;&quot;&quot;

import html
import random
import shutil
import tempfile
from datetime import datetime, timezone
from pathlib import Path

from defusedxml import minidom
from ooxml.scripts.pack import pack_document
from ooxml.scripts.validation.docx import DOCXSchemaValidator
from ooxml.scripts.validation.redlining import RedliningValidator

from .utilities import XMLEditor

# Path to template files
TEMPLATE_DIR = Path(__file__).parent / &quot;templates&quot;


class DocxXMLEditor(XMLEditor):
    &quot;&quot;&quot;XMLEditor that automatically applies RSID, author, and date to new elements.

    Automatically adds attributes to elements that support them when inserting new content:
    - w:rsidR, w:rsidRDefault, w:rsidP (for w:p and w:r elements)
    - w:author and w:date (for w:ins, w:del, w:comment elements)
    - w:id (for w:ins and w:del elements)

    Attributes:
        dom (defusedxml.minidom.Document): The DOM document for direct manipulation
    &quot;&quot;&quot;

    def __init__(
        self, xml_path, rsid: str, author: str = &quot;Claude&quot;, initials: str = &quot;C&quot;
    ):
        &quot;&quot;&quot;Initialize with required RSID and optional author.

        Args:
            xml_path: Path to XML file to edit
            rsid: RSID to automatically apply to new elements
            author: Author name for tracked changes and comments (default: &quot;Claude&quot;)
            initials: Author initials (default: &quot;C&quot;)
        &quot;&quot;&quot;
        super().__init__(xml_path)
        self.rsid = rsid
        self.author = author
        self.initials = initials

    def _get_next_change_id(self):
        &quot;&quot;&quot;Get the next available change ID by checking all tracked change elements.&quot;&quot;&quot;
        max_id = -1
        for tag in (&quot;w:ins&quot;, &quot;w:del&quot;):
            elements = self.dom.getElementsByTagName(tag)
            for elem in elements:
                change_id = elem.getAttribute(&quot;w:id&quot;)
                if change_id:
                    try:
                        max_id = max(max_id, int(change_id))
                    except ValueError:
                        pass
        return max_id + 1

    def _ensure_w16du_namespace(self):
        &quot;&quot;&quot;Ensure w16du namespace is declared on the root element.&quot;&quot;&quot;
        root = self.dom.documentElement
        if not root.hasAttribute(&quot;xmlns:w16du&quot;):  # type: ignore
            root.setAttribute(  # type: ignore
                &quot;xmlns:w16du&quot;,
                &quot;http://schemas.microsoft.com/office/word/2023/wordml/word16du&quot;,
            )

    def _ensure_w16cex_namespace(self):
        &quot;&quot;&quot;Ensure w16cex namespace is declared on the root element.&quot;&quot;&quot;
        root = self.dom.documentElement
        if not root.hasAttribute(&quot;xmlns:w16cex&quot;):  # type: ignore
            root.setAttribute(  # type: ignore
                &quot;xmlns:w16cex&quot;,
                &quot;http://schemas.microsoft.com/office/word/2018/wordml/cex&quot;,
            )

    def _ensure_w14_namespace(self):
        &quot;&quot;&quot;Ensure w14 namespace is declared on the root element.&quot;&quot;&quot;
        root = self.dom.documentElement
        if not root.hasAttribute(&quot;xmlns:w14&quot;):  # type: ignore
            root.setAttribute(  # type: ignore
                &quot;xmlns:w14&quot;,
                &quot;http://schemas.microsoft.com/office/word/2010/wordml&quot;,
            )

    def _inject_attributes_to_nodes(self, nodes):
        &quot;&quot;&quot;Inject RSID, author, and date attributes into DOM nodes where applicable.

        Adds attributes to elements that support them:
        - w:r: gets w:rsidR (or w:rsidDel if inside w:del)
        - w:p: gets w:rsidR, w:rsidRDefault, w:rsidP, w14:paraId, w14:textId
        - w:t: gets xml:space=&quot;preserve&quot; if text has leading/trailing whitespace
        - w:ins, w:del: get w:id, w:author, w:date, w16du:dateUtc
        - w:comment: gets w:author, w:date, w:initials
        - w16cex:commentExtensible: gets w16cex:dateUtc

        Args:
            nodes: List of DOM nodes to process
        &quot;&quot;&quot;
        from datetime import datetime, timezone

        timestamp = datetime.now(timezone.utc).strftime(&quot;%Y-%m-%dT%H:%M:%SZ&quot;)

        def is_inside_deletion(elem):
            &quot;&quot;&quot;Check if element is inside a w:del element.&quot;&quot;&quot;
            parent = elem.parentNode
            while parent:
                if parent.nodeType == parent.ELEMENT_NODE and parent.tagName == &quot;w:del&quot;:
                    return True
                parent = parent.parentNode
            return False

        def add_rsid_to_p(elem):
            if not elem.hasAttribute(&quot;w:rsidR&quot;):
                elem.setAttribute(&quot;w:rsidR&quot;, self.rsid)
            if not elem.hasAttribute(&quot;w:rsidRDefault&quot;):
                elem.setAttribute(&quot;w:rsidRDefault&quot;, self.rsid)
            if not elem.hasAttribute(&quot;w:rsidP&quot;):
                elem.setAttribute(&quot;w:rsidP&quot;, self.rsid)
            # Add w14:paraId and w14:textId if not present
            if not elem.hasAttribute(&quot;w14:paraId&quot;):
                self._ensure_w14_namespace()
                elem.setAttribute(&quot;w14:paraId&quot;, _generate_hex_id())
            if not elem.hasAttribute(&quot;w14:textId&quot;):
                self._ensure_w14_namespace()
                elem.setAttribute(&quot;w14:textId&quot;, _generate_hex_id())

        def add_rsid_to_r(elem):
            # Use w:rsidDel for &lt;w:r&gt; inside &lt;w:del&gt;, otherwise w:rsidR
            if is_inside_deletion(elem):
                if not elem.hasAttribute(&quot;w:rsidDel&quot;):
                    elem.setAttribute(&quot;w:rsidDel&quot;, self.rsid)
            else:
                if not elem.hasAttribute(&quot;w:rsidR&quot;):
                    elem.setAttribute(&quot;w:rsidR&quot;, self.rsid)

        def add_tracked_change_attrs(elem):
            # Auto-assign w:id if not present
            if not elem.hasAttribute(&quot;w:id&quot;):
                elem.setAttribute(&quot;w:id&quot;, str(self._get_next_change_id()))
            if not elem.hasAttribute(&quot;w:author&quot;):
                elem.setAttribute(&quot;w:author&quot;, self.author)
            if not elem.hasAttribute(&quot;w:date&quot;):
                elem.setAttribute(&quot;w:date&quot;, timestamp)
            # Add w16du:dateUtc for tracked changes (same as w:date since we generate UTC timestamps)
            if elem.tagName in (&quot;w:ins&quot;, &quot;w:del&quot;) and not elem.hasAttribute(
                &quot;w16du:dateUtc&quot;
            ):
                self._ensure_w16du_namespace()
                elem.setAttribute(&quot;w16du:dateUtc&quot;, timestamp)

        def add_comment_attrs(elem):
            if not elem.hasAttribute(&quot;w:author&quot;):
                elem.setAttribute(&quot;w:author&quot;, self.author)
            if not elem.hasAttribute(&quot;w:date&quot;):
                elem.setAttribute(&quot;w:date&quot;, timestamp)
            if not elem.hasAttribute(&quot;w:initials&quot;):
                elem.setAttribute(&quot;w:initials&quot;, self.initials)

        def add_comment_extensible_date(elem):
            # Add w16cex:dateUtc for comment extensible elements
            if not elem.hasAttribute(&quot;w16cex:dateUtc&quot;):
                self._ensure_w16cex_namespace()
                elem.setAttribute(&quot;w16cex:dateUtc&quot;, timestamp)

        def add_xml_space_to_t(elem):
            # Add xml:space=&quot;preserve&quot; to w:t if text has leading/trailing whitespace
            if (
                elem.firstChild
                and elem.firstChild.nodeType == elem.firstChild.TEXT_NODE
            ):
                text = elem.firstChild.data
                if text and (text[0].isspace() or text[-1].isspace()):
                    if not elem.hasAttribute(&quot;xml:space&quot;):
                        elem.setAttribute(&quot;xml:space&quot;, &quot;preserve&quot;)

        for node in nodes:
            if node.nodeType != node.ELEMENT_NODE:
                continue

            # Handle the node itself
            if node.tagName == &quot;w:p&quot;:
                add_rsid_to_p(node)
            elif node.tagName == &quot;w:r&quot;:
                add_rsid_to_r(node)
            elif node.tagName == &quot;w:t&quot;:
                add_xml_space_to_t(node)
            elif node.tagName in (&quot;w:ins&quot;, &quot;w:del&quot;):
                add_tracked_change_attrs(node)
            elif node.tagName == &quot;w:comment&quot;:
                add_comment_attrs(node)
            elif node.tagName == &quot;w16cex:commentExtensible&quot;:
                add_comment_extensible_date(node)

            # Process descendants (getElementsByTagName doesn&#x27;t return the element itself)
            for elem in node.getElementsByTagName(&quot;w:p&quot;):
                add_rsid_to_p(elem)
            for elem in node.getElementsByTagName(&quot;w:r&quot;):
                add_rsid_to_r(elem)
            for elem in node.getElementsByTagName(&quot;w:t&quot;):
                add_xml_space_to_t(elem)
            for tag in (&quot;w:ins&quot;, &quot;w:del&quot;):
                for elem in node.getElementsByTagName(tag):
                    add_tracked_change_attrs(elem)
            for elem in node.getElementsByTagName(&quot;w:comment&quot;):
                add_comment_attrs(elem)
            for elem in node.getElementsByTagName(&quot;w16cex:commentExtensible&quot;):
                add_comment_extensible_date(elem)

    def replace_node(self, elem, new_content):
        &quot;&quot;&quot;Replace node with automatic attribute injection.&quot;&quot;&quot;
        nodes = super().replace_node(elem, new_content)
        self._inject_attributes_to_nodes(nodes)
        return nodes

    def insert_after(self, elem, xml_content):
        &quot;&quot;&quot;Insert after with automatic attribute injection.&quot;&quot;&quot;
        nodes = super().insert_after(elem, xml_content)
        self._inject_attributes_to_nodes(nodes)
        return nodes

    def insert_before(self, elem, xml_content):
        &quot;&quot;&quot;Insert before with automatic attribute injection.&quot;&quot;&quot;
        nodes = super().insert_before(elem, xml_content)
        self._inject_attributes_to_nodes(nodes)
        return nodes

    def append_to(self, elem, xml_content):
        &quot;&quot;&quot;Append to with automatic attribute injection.&quot;&quot;&quot;
        nodes = super().append_to(elem, xml_content)
        self._inject_attributes_to_nodes(nodes)
        return nodes

    def revert_insertion(self, elem):
        &quot;&quot;&quot;Reject an insertion by wrapping its content in a deletion.

        Wraps all runs inside w:ins in w:del, converting w:t to w:delText.
        Can process a single w:ins element or a container element with multiple w:ins.

        Args:
            elem: Element to process (w:ins, w:p, w:body, etc.)

        Returns:
            list: List containing the processed element(s)

        Raises:
            ValueError: If the element contains no w:ins elements

        Example:
            # Reject a single insertion
            ins = doc[&quot;word/document.xml&quot;].get_node(tag=&quot;w:ins&quot;, attrs={&quot;w:id&quot;: &quot;5&quot;})
            doc[&quot;word/document.xml&quot;].revert_insertion(ins)

            # Reject all insertions in a paragraph
            para = doc[&quot;word/document.xml&quot;].get_node(tag=&quot;w:p&quot;, line_number=42)
            doc[&quot;word/document.xml&quot;].revert_insertion(para)
        &quot;&quot;&quot;
        # Collect insertions
        ins_elements = []
        if elem.tagName == &quot;w:ins&quot;:
            ins_elements.append(elem)
        else:
            ins_elements.extend(elem.getElementsByTagName(&quot;w:ins&quot;))

        # Validate that there are insertions to reject
        if not ins_elements:
            raise ValueError(
                f&quot;revert_insertion requires w:ins elements. &quot;
                f&quot;The provided element &lt;{elem.tagName}&gt; contains no insertions. &quot;
            )

        # Process all insertions - wrap all children in w:del
        for ins_elem in ins_elements:
            runs = list(ins_elem.getElementsByTagName(&quot;w:r&quot;))
            if not runs:
                continue

            # Create deletion wrapper
            del_wrapper = self.dom.createElement(&quot;w:del&quot;)

            # Process each run
            for run in runs:
                # Convert w:t  w:delText and w:rsidR  w:rsidDel
                if run.hasAttribute(&quot;w:rsidR&quot;):
                    run.setAttribute(&quot;w:rsidDel&quot;, run.getAttribute(&quot;w:rsidR&quot;))
                    run.removeAttribute(&quot;w:rsidR&quot;)
                elif not run.hasAttribute(&quot;w:rsidDel&quot;):
                    run.setAttribute(&quot;w:rsidDel&quot;, self.rsid)

                for t_elem in list(run.getElementsByTagName(&quot;w:t&quot;)):
                    del_text = self.dom.createElement(&quot;w:delText&quot;)
                    # Copy ALL child nodes (not just firstChild) to handle entities
                    while t_elem.firstChild:
                        del_text.appendChild(t_elem.firstChild)
                    for i in range(t_elem.attributes.length):
                        attr = t_elem.attributes.item(i)
                        del_text.setAttribute(attr.name, attr.value)
                    t_elem.parentNode.replaceChild(del_text, t_elem)

            # Move all children from ins to del wrapper
            while ins_elem.firstChild:
                del_wrapper.appendChild(ins_elem.firstChild)

            # Add del wrapper back to ins
            ins_elem.appendChild(del_wrapper)

            # Inject attributes to the deletion wrapper
            self._inject_attributes_to_nodes([del_wrapper])

        return [elem]

    def revert_deletion(self, elem):
        &quot;&quot;&quot;Reject a deletion by re-inserting the deleted content.

        Creates w:ins elements after each w:del, copying deleted content and
        converting w:delText back to w:t.
        Can process a single w:del element or a container element with multiple w:del.

        Args:
            elem: Element to process (w:del, w:p, w:body, etc.)

        Returns:
            list: If elem is w:del, returns [elem, new_ins]. Otherwise returns [elem].

        Raises:
            ValueError: If the element contains no w:del elements

        Example:
            # Reject a single deletion - returns [w:del, w:ins]
            del_elem = doc[&quot;word/document.xml&quot;].get_node(tag=&quot;w:del&quot;, attrs={&quot;w:id&quot;: &quot;3&quot;})
            nodes = doc[&quot;word/document.xml&quot;].revert_deletion(del_elem)

            # Reject all deletions in a paragraph - returns [para]
            para = doc[&quot;word/document.xml&quot;].get_node(tag=&quot;w:p&quot;, line_number=42)
            nodes = doc[&quot;word/document.xml&quot;].revert_deletion(para)
        &quot;&quot;&quot;
        # Collect deletions FIRST - before we modify the DOM
        del_elements = []
        is_single_del = elem.tagName == &quot;w:del&quot;

        if is_single_del:
            del_elements.append(elem)
        else:
            del_elements.extend(elem.getElementsByTagName(&quot;w:del&quot;))

        # Validate that there are deletions to reject
        if not del_elements:
            raise ValueError(
                f&quot;revert_deletion requires w:del elements. &quot;
                f&quot;The provided element &lt;{elem.tagName}&gt; contains no deletions. &quot;
            )

        # Track created insertion (only relevant if elem is a single w:del)
        created_insertion = None

        # Process all deletions - create insertions that copy the deleted content
        for del_elem in del_elements:
            # Clone the deleted runs and convert them to insertions
            runs = list(del_elem.getElementsByTagName(&quot;w:r&quot;))
            if not runs:
                continue

            # Create insertion wrapper
            ins_elem = self.dom.createElement(&quot;w:ins&quot;)

            for run in runs:
                # Clone the run
                new_run = run.cloneNode(True)

                # Convert w:delText  w:t
                for del_text in list(new_run.getElementsByTagName(&quot;w:delText&quot;)):
                    t_elem = self.dom.createElement(&quot;w:t&quot;)
                    # Copy ALL child nodes (not just firstChild) to handle entities
                    while del_text.firstChild:
                        t_elem.appendChild(del_text.firstChild)
                    for i in range(del_text.attributes.length):
                        attr = del_text.attributes.item(i)
                        t_elem.setAttribute(attr.name, attr.value)
                    del_text.parentNode.replaceChild(t_elem, del_text)

                # Update run attributes: w:rsidDel  w:rsidR
                if new_run.hasAttribute(&quot;w:rsidDel&quot;):
                    new_run.setAttribute(&quot;w:rsidR&quot;, new_run.getAttribute(&quot;w:rsidDel&quot;))
                    new_run.removeAttribute(&quot;w:rsidDel&quot;)
                elif not new_run.hasAttribute(&quot;w:rsidR&quot;):
                    new_run.setAttribute(&quot;w:rsidR&quot;, self.rsid)

                ins_elem.appendChild(new_run)

            # Insert the new insertion after the deletion
            nodes = self.insert_after(del_elem, ins_elem.toxml())

            # If processing a single w:del, track the created insertion
            if is_single_del and nodes:
                created_insertion = nodes[0]

        # Return based on input type
        if is_single_del and created_insertion:
            return [elem, created_insertion]
        else:
            return [elem]

    @staticmethod
    def suggest_paragraph(xml_content: str) -&gt; str:
        &quot;&quot;&quot;Transform paragraph XML to add tracked change wrapping for insertion.

        Wraps runs in &lt;w:ins&gt; and adds &lt;w:ins/&gt; to w:rPr in w:pPr for numbered lists.

        Args:
            xml_content: XML string containing a &lt;w:p&gt; element

        Returns:
            str: Transformed XML with tracked change wrapping
        &quot;&quot;&quot;
        wrapper = f&#x27;&lt;root xmlns:w=&quot;http://schemas.openxmlformats.org/wordprocessingml/2006/main&quot;&gt;{xml_content}&lt;/root&gt;&#x27;
        doc = minidom.parseString(wrapper)
        para = doc.getElementsByTagName(&quot;w:p&quot;)[0]

        # Ensure w:pPr exists
        pPr_list = para.getElementsByTagName(&quot;w:pPr&quot;)
        if not pPr_list:
            pPr = doc.createElement(&quot;w:pPr&quot;)
            para.insertBefore(
                pPr, para.firstChild
            ) if para.firstChild else para.appendChild(pPr)
        else:
            pPr = pPr_list[0]

        # Ensure w:rPr exists in w:pPr
        rPr_list = pPr.getElementsByTagName(&quot;w:rPr&quot;)
        if not rPr_list:
            rPr = doc.createElement(&quot;w:rPr&quot;)
            pPr.appendChild(rPr)
        else:
            rPr = rPr_list[0]

        # Add &lt;w:ins/&gt; to w:rPr
        ins_marker = doc.createElement(&quot;w:ins&quot;)
        rPr.insertBefore(
            ins_marker, rPr.firstChild
        ) if rPr.firstChild else rPr.appendChild(ins_marker)

        # Wrap all non-pPr children in &lt;w:ins&gt;
        ins_wrapper = doc.createElement(&quot;w:ins&quot;)
        for child in [c for c in para.childNodes if c.nodeName != &quot;w:pPr&quot;]:
            para.removeChild(child)
            ins_wrapper.appendChild(child)
        para.appendChild(ins_wrapper)

        return para.toxml()

    def suggest_deletion(self, elem):
        &quot;&quot;&quot;Mark a w:r or w:p element as deleted with tracked changes (in-place DOM manipulation).

        For w:r: wraps in &lt;w:del&gt;, converts &lt;w:t&gt; to &lt;w:delText&gt;, preserves w:rPr
        For w:p (regular): wraps content in &lt;w:del&gt;, converts &lt;w:t&gt; to &lt;w:delText&gt;
        For w:p (numbered list): adds &lt;w:del/&gt; to w:rPr in w:pPr, wraps content in &lt;w:del&gt;

        Args:
            elem: A w:r or w:p DOM element without existing tracked changes

        Returns:
            Element: The modified element

        Raises:
            ValueError: If element has existing tracked changes or invalid structure
        &quot;&quot;&quot;
        if elem.nodeName == &quot;w:r&quot;:
            # Check for existing w:delText
            if elem.getElementsByTagName(&quot;w:delText&quot;):
                raise ValueError(&quot;w:r element already contains w:delText&quot;)

            # Convert w:t  w:delText
            for t_elem in list(elem.getElementsByTagName(&quot;w:t&quot;)):
                del_text = self.dom.createElement(&quot;w:delText&quot;)
                # Copy ALL child nodes (not just firstChild) to handle entities
                while t_elem.firstChild:
                    del_text.appendChild(t_elem.firstChild)
                # Preserve attributes like xml:space
                for i in range(t_elem.attributes.length):
                    attr = t_elem.attributes.item(i)
                    del_text.setAttribute(attr.name, attr.value)
                t_elem.parentNode.replaceChild(del_text, t_elem)

            # Update run attributes: w:rsidR  w:rsidDel
            if elem.hasAttribute(&quot;w:rsidR&quot;):
                elem.setAttribute(&quot;w:rsidDel&quot;, elem.getAttribute(&quot;w:rsidR&quot;))
                elem.removeAttribute(&quot;w:rsidR&quot;)
            elif not elem.hasAttribute(&quot;w:rsidDel&quot;):
                elem.setAttribute(&quot;w:rsidDel&quot;, self.rsid)

            # Wrap in w:del
            del_wrapper = self.dom.createElement(&quot;w:del&quot;)
            parent = elem.parentNode
            parent.insertBefore(del_wrapper, elem)
            parent.removeChild(elem)
            del_wrapper.appendChild(elem)

            # Inject attributes to the deletion wrapper
            self._inject_attributes_to_nodes([del_wrapper])

            return del_wrapper

        elif elem.nodeName == &quot;w:p&quot;:
            # Check for existing tracked changes
            if elem.getElementsByTagName(&quot;w:ins&quot;) or elem.getElementsByTagName(&quot;w:del&quot;):
                raise ValueError(&quot;w:p element already contains tracked changes&quot;)

            # Check if it&#x27;s a numbered list item
            pPr_list = elem.getElementsByTagName(&quot;w:pPr&quot;)
            is_numbered = pPr_list and pPr_list[0].getElementsByTagName(&quot;w:numPr&quot;)

            if is_numbered:
                # Add &lt;w:del/&gt; to w:rPr in w:pPr
                pPr = pPr_list[0]
                rPr_list = pPr.getElementsByTagName(&quot;w:rPr&quot;)

                if not rPr_list:
                    rPr = self.dom.createElement(&quot;w:rPr&quot;)
                    pPr.appendChild(rPr)
                else:
                    rPr = rPr_list[0]

                # Add &lt;w:del/&gt; marker
                del_marker = self.dom.createElement(&quot;w:del&quot;)
                rPr.insertBefore(
                    del_marker, rPr.firstChild
                ) if rPr.firstChild else rPr.appendChild(del_marker)

            # Convert w:t  w:delText in all runs
            for t_elem in list(elem.getElementsByTagName(&quot;w:t&quot;)):
                del_text = self.dom.createElement(&quot;w:delText&quot;)
                # Copy ALL child nodes (not just firstChild) to handle entities
                while t_elem.firstChild:
                    del_text.appendChild(t_elem.firstChild)
                # Preserve attributes like xml:space
                for i in range(t_elem.attributes.length):
                    attr = t_elem.attributes.item(i)
                    del_text.setAttribute(attr.name, attr.value)
                t_elem.parentNode.replaceChild(del_text, t_elem)

            # Update run attributes: w:rsidR  w:rsidDel
            for run in elem.getElementsByTagName(&quot;w:r&quot;):
                if run.hasAttribute(&quot;w:rsidR&quot;):
                    run.setAttribute(&quot;w:rsidDel&quot;, run.getAttribute(&quot;w:rsidR&quot;))
                    run.removeAttribute(&quot;w:rsidR&quot;)
                elif not run.hasAttribute(&quot;w:rsidDel&quot;):
                    run.setAttribute(&quot;w:rsidDel&quot;, self.rsid)

            # Wrap all non-pPr children in &lt;w:del&gt;
            del_wrapper = self.dom.createElement(&quot;w:del&quot;)
            for child in [c for c in elem.childNodes if c.nodeName != &quot;w:pPr&quot;]:
                elem.removeChild(child)
                del_wrapper.appendChild(child)
            elem.appendChild(del_wrapper)

            # Inject attributes to the deletion wrapper
            self._inject_attributes_to_nodes([del_wrapper])

            return elem

        else:
            raise ValueError(f&quot;Element must be w:r or w:p, got {elem.nodeName}&quot;)


def _generate_hex_id() -&gt; str:
    &quot;&quot;&quot;Generate random 8-character hex ID for para/durable IDs.

    Values are constrained to be less than 0x7FFFFFFF per OOXML spec:
    - paraId must be &lt; 0x80000000
    - durableId must be &lt; 0x7FFFFFFF
    We use the stricter constraint (0x7FFFFFFF) for both.
    &quot;&quot;&quot;
    return f&quot;{random.randint(1, 0x7FFFFFFE):08X}&quot;


def _generate_rsid() -&gt; str:
    &quot;&quot;&quot;Generate random 8-character hex RSID.&quot;&quot;&quot;
    return &quot;&quot;.join(random.choices(&quot;0123456789ABCDEF&quot;, k=8))


class Document:
    &quot;&quot;&quot;Manages comments in unpacked Word documents.&quot;&quot;&quot;

    def __init__(
        self,
        unpacked_dir,
        rsid=None,
        track_revisions=False,
        author=&quot;Claude&quot;,
        initials=&quot;C&quot;,
    ):
        &quot;&quot;&quot;
        Initialize with path to unpacked Word document directory.
        Automatically sets up comment infrastructure (people.xml, RSIDs).

        Args:
            unpacked_dir: Path to unpacked DOCX directory (must contain word/ subdirectory)
            rsid: Optional RSID to use for all comment elements. If not provided, one will be generated.
            track_revisions: If True, enables track revisions in settings.xml (default: False)
            author: Default author name for comments (default: &quot;Claude&quot;)
            initials: Default author initials for comments (default: &quot;C&quot;)
        &quot;&quot;&quot;
        self.original_path = Path(unpacked_dir)

        if not self.original_path.exists() or not self.original_path.is_dir():
            raise ValueError(f&quot;Directory not found: {unpacked_dir}&quot;)

        # Create temporary directory with subdirectories for unpacked content and baseline
        self.temp_dir = tempfile.mkdtemp(prefix=&quot;docx_&quot;)
        self.unpacked_path = Path(self.temp_dir) / &quot;unpacked&quot;
        shutil.copytree(self.original_path, self.unpacked_path)

        # Pack original directory into temporary .docx for validation baseline (outside unpacked dir)
        self.original_docx = Path(self.temp_dir) / &quot;original.docx&quot;
        pack_document(self.original_path, self.original_docx, validate=False)

        self.word_path = self.unpacked_path / &quot;word&quot;

        # Generate RSID if not provided
        self.rsid = rsid if rsid else _generate_rsid()
        print(f&quot;Using RSID: {self.rsid}&quot;)

        # Set default author and initials
        self.author = author
        self.initials = initials

        # Cache for lazy-loaded editors
        self._editors = {}

        # Comment file paths
        self.comments_path = self.word_path / &quot;comments.xml&quot;
        self.comments_extended_path = self.word_path / &quot;commentsExtended.xml&quot;
        self.comments_ids_path = self.word_path / &quot;commentsIds.xml&quot;
        self.comments_extensible_path = self.word_path / &quot;commentsExtensible.xml&quot;

        # Load existing comments and determine next ID (before setup modifies files)
        self.existing_comments = self._load_existing_comments()
        self.next_comment_id = self._get_next_comment_id()

        # Convenient access to document.xml editor (semi-private)
        self._document = self[&quot;word/document.xml&quot;]

        # Setup tracked changes infrastructure
        self._setup_tracking(track_revisions=track_revisions)

        # Add author to people.xml
        self._add_author_to_people(author)

    def __getitem__(self, xml_path: str) -&gt; DocxXMLEditor:
        &quot;&quot;&quot;
        Get or create a DocxXMLEditor for the specified XML file.

        Enables lazy-loaded editors with bracket notation:
            node = doc[&quot;word/document.xml&quot;].get_node(tag=&quot;w:p&quot;, line_number=42)

        Args:
            xml_path: Relative path to XML file (e.g., &quot;word/document.xml&quot;, &quot;word/comments.xml&quot;)

        Returns:
            DocxXMLEditor instance for the specified file

        Raises:
            ValueError: If the file does not exist

        Example:
            # Get node from document.xml
            node = doc[&quot;word/document.xml&quot;].get_node(tag=&quot;w:del&quot;, attrs={&quot;w:id&quot;: &quot;1&quot;})

            # Get node from comments.xml
            comment = doc[&quot;word/comments.xml&quot;].get_node(tag=&quot;w:comment&quot;, attrs={&quot;w:id&quot;: &quot;0&quot;})
        &quot;&quot;&quot;
        if xml_path not in self._editors:
            file_path = self.unpacked_path / xml_path
            if not file_path.exists():
                raise ValueError(f&quot;XML file not found: {xml_path}&quot;)
            # Use DocxXMLEditor with RSID, author, and initials for all editors
            self._editors[xml_path] = DocxXMLEditor(
                file_path, rsid=self.rsid, author=self.author, initials=self.initials
            )
        return self._editors[xml_path]

    def add_comment(self, start, end, text: str) -&gt; int:
        &quot;&quot;&quot;
        Add a comment spanning from one element to another.

        Args:
            start: DOM element for the starting point
            end: DOM element for the ending point
            text: Comment content

        Returns:
            The comment ID that was created

        Example:
            start_node = cm.get_document_node(tag=&quot;w:del&quot;, id=&quot;1&quot;)
            end_node = cm.get_document_node(tag=&quot;w:ins&quot;, id=&quot;2&quot;)
            cm.add_comment(start=start_node, end=end_node, text=&quot;Explanation&quot;)
        &quot;&quot;&quot;
        comment_id = self.next_comment_id
        para_id = _generate_hex_id()
        durable_id = _generate_hex_id()
        timestamp = datetime.now(timezone.utc).strftime(&quot;%Y-%m-%dT%H:%M:%SZ&quot;)

        # Add comment ranges to document.xml immediately
        self._document.insert_before(start, self._comment_range_start_xml(comment_id))

        # If end node is a paragraph, append comment markup inside it
        # Otherwise insert after it (for run-level anchors)
        if end.tagName == &quot;w:p&quot;:
            self._document.append_to(end, self._comment_range_end_xml(comment_id))
        else:
            self._document.insert_after(end, self._comment_range_end_xml(comment_id))

        # Add to comments.xml immediately
        self._add_to_comments_xml(
            comment_id, para_id, text, self.author, self.initials, timestamp
        )

        # Add to commentsExtended.xml immediately
        self._add_to_comments_extended_xml(para_id, parent_para_id=None)

        # Add to commentsIds.xml immediately
        self._add_to_comments_ids_xml(para_id, durable_id)

        # Add to commentsExtensible.xml immediately
        self._add_to_comments_extensible_xml(durable_id)

        # Update existing_comments so replies work
        self.existing_comments[comment_id] = {&quot;para_id&quot;: para_id}

        self.next_comment_id += 1
        return comment_id

    def reply_to_comment(
        self,
        parent_comment_id: int,
        text: str,
    ) -&gt; int:
        &quot;&quot;&quot;
        Add a reply to an existing comment.

        Args:
            parent_comment_id: The w:id of the parent comment to reply to
            text: Reply text

        Returns:
            The comment ID that was created for the reply

        Example:
            cm.reply_to_comment(parent_comment_id=0, text=&quot;I agree with this change&quot;)
        &quot;&quot;&quot;
        if parent_comment_id not in self.existing_comments:
            raise ValueError(f&quot;Parent comment with id={parent_comment_id} not found&quot;)

        parent_info = self.existing_comments[parent_comment_id]
        comment_id = self.next_comment_id
        para_id = _generate_hex_id()
        durable_id = _generate_hex_id()
        timestamp = datetime.now(timezone.utc).strftime(&quot;%Y-%m-%dT%H:%M:%SZ&quot;)

        # Add comment ranges to document.xml immediately
        parent_start_elem = self._document.get_node(
            tag=&quot;w:commentRangeStart&quot;, attrs={&quot;w:id&quot;: str(parent_comment_id)}
        )
        parent_ref_elem = self._document.get_node(
            tag=&quot;w:commentReference&quot;, attrs={&quot;w:id&quot;: str(parent_comment_id)}
        )

        self._document.insert_after(
            parent_start_elem, self._comment_range_start_xml(comment_id)
        )
        parent_ref_run = parent_ref_elem.parentNode
        self._document.insert_after(
            parent_ref_run, f&#x27;&lt;w:commentRangeEnd w:id=&quot;{comment_id}&quot;/&gt;&#x27;
        )
        self._document.insert_after(
            parent_ref_run, self._comment_ref_run_xml(comment_id)
        )

        # Add to comments.xml immediately
        self._add_to_comments_xml(
            comment_id, para_id, text, self.author, self.initials, timestamp
        )

        # Add to commentsExtended.xml immediately (with parent)
        self._add_to_comments_extended_xml(
            para_id, parent_para_id=parent_info[&quot;para_id&quot;]
        )

        # Add to commentsIds.xml immediately
        self._add_to_comments_ids_xml(para_id, durable_id)

        # Add to commentsExtensible.xml immediately
        self._add_to_comments_extensible_xml(durable_id)

        # Update existing_comments so replies work
        self.existing_comments[comment_id] = {&quot;para_id&quot;: para_id}

        self.next_comment_id += 1
        return comment_id

    def __del__(self):
        &quot;&quot;&quot;Clean up temporary directory on deletion.&quot;&quot;&quot;
        if hasattr(self, &quot;temp_dir&quot;) and Path(self.temp_dir).exists():
            shutil.rmtree(self.temp_dir)

    def validate(self) -&gt; None:
        &quot;&quot;&quot;
        Validate the document against XSD schema and redlining rules.

        Raises:
            ValueError: If validation fails.
        &quot;&quot;&quot;
        # Create validators with current state
        schema_validator = DOCXSchemaValidator(
            self.unpacked_path, self.original_docx, verbose=False
        )
        redlining_validator = RedliningValidator(
            self.unpacked_path, self.original_docx, verbose=False
        )

        # Run validations
        if not schema_validator.validate():
            raise ValueError(&quot;Schema validation failed&quot;)
        if not redlining_validator.validate():
            raise ValueError(&quot;Redlining validation failed&quot;)

    def save(self, destination=None, validate=True) -&gt; None:
        &quot;&quot;&quot;
        Save all modified XML files to disk and copy to destination directory.

        This persists all changes made via add_comment() and reply_to_comment().

        Args:
            destination: Optional path to save to. If None, saves back to original directory.
            validate: If True, validates document before saving (default: True).
        &quot;&quot;&quot;
        # Only ensure comment relationships and content types if comment files exist
        if self.comments_path.exists():
            self._ensure_comment_relationships()
            self._ensure_comment_content_types()

        # Save all modified XML files in temp directory
        for editor in self._editors.values():
            editor.save()

        # Validate by default
        if validate:
            self.validate()

        # Copy contents from temp directory to destination (or original directory)
        target_path = Path(destination) if destination else self.original_path
        shutil.copytree(self.unpacked_path, target_path, dirs_exist_ok=True)

    # ==================== Private: Initialization ====================

    def _get_next_comment_id(self):
        &quot;&quot;&quot;Get the next available comment ID.&quot;&quot;&quot;
        if not self.comments_path.exists():
            return 0

        editor = self[&quot;word/comments.xml&quot;]
        max_id = -1
        for comment_elem in editor.dom.getElementsByTagName(&quot;w:comment&quot;):
            comment_id = comment_elem.getAttribute(&quot;w:id&quot;)
            if comment_id:
                try:
                    max_id = max(max_id, int(comment_id))
                except ValueError:
                    pass
        return max_id + 1

    def _load_existing_comments(self):
        &quot;&quot;&quot;Load existing comments from files to enable replies.&quot;&quot;&quot;
        if not self.comments_path.exists():
            return {}

        editor = self[&quot;word/comments.xml&quot;]
        existing = {}

        for comment_elem in editor.dom.getElementsByTagName(&quot;w:comment&quot;):
            comment_id = comment_elem.getAttribute(&quot;w:id&quot;)
            if not comment_id:
                continue

            # Find para_id from the w:p element within the comment
            para_id = None
            for p_elem in comment_elem.getElementsByTagName(&quot;w:p&quot;):
                para_id = p_elem.getAttribute(&quot;w14:paraId&quot;)
                if para_id:
                    break

            if not para_id:
                continue

            existing[int(comment_id)] = {&quot;para_id&quot;: para_id}

        return existing

    # ==================== Private: Setup Methods ====================

    def _setup_tracking(self, track_revisions=False):
        &quot;&quot;&quot;Set up comment infrastructure in unpacked directory.

        Args:
            track_revisions: If True, enables track revisions in settings.xml
        &quot;&quot;&quot;
        # Create or update word/people.xml
        people_file = self.word_path / &quot;people.xml&quot;
        self._update_people_xml(people_file)

        # Update XML files
        self._add_content_type_for_people(self.unpacked_path / &quot;[Content_Types].xml&quot;)
        self._add_relationship_for_people(
            self.word_path / &quot;_rels&quot; / &quot;document.xml.rels&quot;
        )

        # Always add RSID to settings.xml, optionally enable trackRevisions
        self._update_settings(
            self.word_path / &quot;settings.xml&quot;, track_revisions=track_revisions
        )

    def _update_people_xml(self, path):
        &quot;&quot;&quot;Create people.xml if it doesn&#x27;t exist.&quot;&quot;&quot;
        if not path.exists():
            # Copy from template
            shutil.copy(TEMPLATE_DIR / &quot;people.xml&quot;, path)

    def _add_content_type_for_people(self, path):
        &quot;&quot;&quot;Add people.xml content type to [Content_Types].xml if not already present.&quot;&quot;&quot;
        editor = self[&quot;[Content_Types].xml&quot;]

        if self._has_override(editor, &quot;/word/people.xml&quot;):
            return

        # Add Override element
        root = editor.dom.documentElement
        override_xml = &#x27;&lt;Override PartName=&quot;/word/people.xml&quot; ContentType=&quot;application/vnd.openxmlformats-officedocument.wordprocessingml.people+xml&quot;/&gt;&#x27;
        editor.append_to(root, override_xml)

    def _add_relationship_for_people(self, path):
        &quot;&quot;&quot;Add people.xml relationship to document.xml.rels if not already present.&quot;&quot;&quot;
        editor = self[&quot;word/_rels/document.xml.rels&quot;]

        if self._has_relationship(editor, &quot;people.xml&quot;):
            return

        root = editor.dom.documentElement
        root_tag = root.tagName  # type: ignore
        prefix = root_tag.split(&quot;:&quot;)[0] + &quot;:&quot; if &quot;:&quot; in root_tag else &quot;&quot;
        next_rid = editor.get_next_rid()

        # Create the relationship entry
        rel_xml = f&#x27;&lt;{prefix}Relationship Id=&quot;{next_rid}&quot; Type=&quot;http://schemas.microsoft.com/office/2011/relationships/people&quot; Target=&quot;people.xml&quot;/&gt;&#x27;
        editor.append_to(root, rel_xml)

    def _update_settings(self, path, track_revisions=False):
        &quot;&quot;&quot;Add RSID and optionally enable track revisions in settings.xml.

        Args:
            path: Path to settings.xml
            track_revisions: If True, adds trackRevisions element

        Places elements per OOXML schema order:
        - trackRevisions: early (before defaultTabStop)
        - rsids: late (after compat)
        &quot;&quot;&quot;
        editor = self[&quot;word/settings.xml&quot;]
        root = editor.get_node(tag=&quot;w:settings&quot;)
        prefix = root.tagName.split(&quot;:&quot;)[0] if &quot;:&quot; in root.tagName else &quot;w&quot;

        # Conditionally add trackRevisions if requested
        if track_revisions:
            track_revisions_exists = any(
                elem.tagName == f&quot;{prefix}:trackRevisions&quot;
                for elem in editor.dom.getElementsByTagName(f&quot;{prefix}:trackRevisions&quot;)
            )

            if not track_revisions_exists:
                track_rev_xml = f&quot;&lt;{prefix}:trackRevisions/&gt;&quot;
                # Try to insert before documentProtection, defaultTabStop, or at start
                inserted = False
                for tag in [f&quot;{prefix}:documentProtection&quot;, f&quot;{prefix}:defaultTabStop&quot;]:
                    elements = editor.dom.getElementsByTagName(tag)
                    if elements:
                        editor.insert_before(elements[0], track_rev_xml)
                        inserted = True
                        break
                if not inserted:
                    # Insert as first child of settings
                    if root.firstChild:
                        editor.insert_before(root.firstChild, track_rev_xml)
                    else:
                        editor.append_to(root, track_rev_xml)

        # Always check if rsids section exists
        rsids_elements = editor.dom.getElementsByTagName(f&quot;{prefix}:rsids&quot;)

        if not rsids_elements:
            # Add new rsids section
            rsids_xml = f&#x27;&#x27;&#x27;&lt;{prefix}:rsids&gt;
  &lt;{prefix}:rsidRoot {prefix}:val=&quot;{self.rsid}&quot;/&gt;
  &lt;{prefix}:rsid {prefix}:val=&quot;{self.rsid}&quot;/&gt;
&lt;/{prefix}:rsids&gt;&#x27;&#x27;&#x27;

            # Try to insert after compat, before clrSchemeMapping, or before closing tag
            inserted = False
            compat_elements = editor.dom.getElementsByTagName(f&quot;{prefix}:compat&quot;)
            if compat_elements:
                editor.insert_after(compat_elements[0], rsids_xml)
                inserted = True

            if not inserted:
                clr_elements = editor.dom.getElementsByTagName(
                    f&quot;{prefix}:clrSchemeMapping&quot;
                )
                if clr_elements:
                    editor.insert_before(clr_elements[0], rsids_xml)
                    inserted = True

            if not inserted:
                editor.append_to(root, rsids_xml)
        else:
            # Check if this rsid already exists
            rsids_elem = rsids_elements[0]
            rsid_exists = any(
                elem.getAttribute(f&quot;{prefix}:val&quot;) == self.rsid
                for elem in rsids_elem.getElementsByTagName(f&quot;{prefix}:rsid&quot;)
            )

            if not rsid_exists:
                rsid_xml = f&#x27;&lt;{prefix}:rsid {prefix}:val=&quot;{self.rsid}&quot;/&gt;&#x27;
                editor.append_to(rsids_elem, rsid_xml)

    # ==================== Private: XML File Creation ====================

    def _add_to_comments_xml(
        self, comment_id, para_id, text, author, initials, timestamp
    ):
        &quot;&quot;&quot;Add a single comment to comments.xml.&quot;&quot;&quot;
        if not self.comments_path.exists():
            shutil.copy(TEMPLATE_DIR / &quot;comments.xml&quot;, self.comments_path)

        editor = self[&quot;word/comments.xml&quot;]
        root = editor.get_node(tag=&quot;w:comments&quot;)

        escaped_text = (
            text.replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;).replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;)
        )
        # Note: w:rsidR, w:rsidRDefault, w:rsidP on w:p, w:rsidR on w:r,
        # and w:author, w:date, w:initials on w:comment are automatically added by DocxXMLEditor
        comment_xml = f&#x27;&#x27;&#x27;&lt;w:comment w:id=&quot;{comment_id}&quot;&gt;
  &lt;w:p w14:paraId=&quot;{para_id}&quot; w14:textId=&quot;77777777&quot;&gt;
    &lt;w:r&gt;&lt;w:rPr&gt;&lt;w:rStyle w:val=&quot;CommentReference&quot;/&gt;&lt;/w:rPr&gt;&lt;w:annotationRef/&gt;&lt;/w:r&gt;
    &lt;w:r&gt;&lt;w:rPr&gt;&lt;w:color w:val=&quot;000000&quot;/&gt;&lt;w:sz w:val=&quot;20&quot;/&gt;&lt;w:szCs w:val=&quot;20&quot;/&gt;&lt;/w:rPr&gt;&lt;w:t&gt;{escaped_text}&lt;/w:t&gt;&lt;/w:r&gt;
  &lt;/w:p&gt;
&lt;/w:comment&gt;&#x27;&#x27;&#x27;
        editor.append_to(root, comment_xml)

    def _add_to_comments_extended_xml(self, para_id, parent_para_id):
        &quot;&quot;&quot;Add a single comment to commentsExtended.xml.&quot;&quot;&quot;
        if not self.comments_extended_path.exists():
            shutil.copy(
                TEMPLATE_DIR / &quot;commentsExtended.xml&quot;, self.comments_extended_path
            )

        editor = self[&quot;word/commentsExtended.xml&quot;]
        root = editor.get_node(tag=&quot;w15:commentsEx&quot;)

        if parent_para_id:
            xml = f&#x27;&lt;w15:commentEx w15:paraId=&quot;{para_id}&quot; w15:paraIdParent=&quot;{parent_para_id}&quot; w15:done=&quot;0&quot;/&gt;&#x27;
        else:
            xml = f&#x27;&lt;w15:commentEx w15:paraId=&quot;{para_id}&quot; w15:done=&quot;0&quot;/&gt;&#x27;
        editor.append_to(root, xml)

    def _add_to_comments_ids_xml(self, para_id, durable_id):
        &quot;&quot;&quot;Add a single comment to commentsIds.xml.&quot;&quot;&quot;
        if not self.comments_ids_path.exists():
            shutil.copy(TEMPLATE_DIR / &quot;commentsIds.xml&quot;, self.comments_ids_path)

        editor = self[&quot;word/commentsIds.xml&quot;]
        root = editor.get_node(tag=&quot;w16cid:commentsIds&quot;)

        xml = f&#x27;&lt;w16cid:commentId w16cid:paraId=&quot;{para_id}&quot; w16cid:durableId=&quot;{durable_id}&quot;/&gt;&#x27;
        editor.append_to(root, xml)

    def _add_to_comments_extensible_xml(self, durable_id):
        &quot;&quot;&quot;Add a single comment to commentsExtensible.xml.&quot;&quot;&quot;
        if not self.comments_extensible_path.exists():
            shutil.copy(
                TEMPLATE_DIR / &quot;commentsExtensible.xml&quot;, self.comments_extensible_path
            )

        editor = self[&quot;word/commentsExtensible.xml&quot;]
        root = editor.get_node(tag=&quot;w16cex:commentsExtensible&quot;)

        xml = f&#x27;&lt;w16cex:commentExtensible w16cex:durableId=&quot;{durable_id}&quot;/&gt;&#x27;
        editor.append_to(root, xml)

    # ==================== Private: XML Fragments ====================

    def _comment_range_start_xml(self, comment_id):
        &quot;&quot;&quot;Generate XML for comment range start.&quot;&quot;&quot;
        return f&#x27;&lt;w:commentRangeStart w:id=&quot;{comment_id}&quot;/&gt;&#x27;

    def _comment_range_end_xml(self, comment_id):
        &quot;&quot;&quot;Generate XML for comment range end with reference run.

        Note: w:rsidR is automatically added by DocxXMLEditor.
        &quot;&quot;&quot;
        return f&#x27;&#x27;&#x27;&lt;w:commentRangeEnd w:id=&quot;{comment_id}&quot;/&gt;
&lt;w:r&gt;
  &lt;w:rPr&gt;&lt;w:rStyle w:val=&quot;CommentReference&quot;/&gt;&lt;/w:rPr&gt;
  &lt;w:commentReference w:id=&quot;{comment_id}&quot;/&gt;
&lt;/w:r&gt;&#x27;&#x27;&#x27;

    def _comment_ref_run_xml(self, comment_id):
        &quot;&quot;&quot;Generate XML for comment reference run.

        Note: w:rsidR is automatically added by DocxXMLEditor.
        &quot;&quot;&quot;
        return f&#x27;&#x27;&#x27;&lt;w:r&gt;
  &lt;w:rPr&gt;&lt;w:rStyle w:val=&quot;CommentReference&quot;/&gt;&lt;/w:rPr&gt;
  &lt;w:commentReference w:id=&quot;{comment_id}&quot;/&gt;
&lt;/w:r&gt;&#x27;&#x27;&#x27;

    # ==================== Private: Metadata Updates ====================

    def _has_relationship(self, editor, target):
        &quot;&quot;&quot;Check if a relationship with given target exists.&quot;&quot;&quot;
        for rel_elem in editor.dom.getElementsByTagName(&quot;Relationship&quot;):
            if rel_elem.getAttribute(&quot;Target&quot;) == target:
                return True
        return False

    def _has_override(self, editor, part_name):
        &quot;&quot;&quot;Check if an override with given part name exists.&quot;&quot;&quot;
        for override_elem in editor.dom.getElementsByTagName(&quot;Override&quot;):
            if override_elem.getAttribute(&quot;PartName&quot;) == part_name:
                return True
        return False

    def _has_author(self, editor, author):
        &quot;&quot;&quot;Check if an author already exists in people.xml.&quot;&quot;&quot;
        for person_elem in editor.dom.getElementsByTagName(&quot;w15:person&quot;):
            if person_elem.getAttribute(&quot;w15:author&quot;) == author:
                return True
        return False

    def _add_author_to_people(self, author):
        &quot;&quot;&quot;Add author to people.xml (called during initialization).&quot;&quot;&quot;
        people_path = self.word_path / &quot;people.xml&quot;

        # people.xml should already exist from _setup_tracking
        if not people_path.exists():
            raise ValueError(&quot;people.xml should exist after _setup_tracking&quot;)

        editor = self[&quot;word/people.xml&quot;]
        root = editor.get_node(tag=&quot;w15:people&quot;)

        # Check if author already exists
        if self._has_author(editor, author):
            return

        # Add author with proper XML escaping to prevent injection
        escaped_author = html.escape(author, quote=True)
        person_xml = f&#x27;&#x27;&#x27;&lt;w15:person w15:author=&quot;{escaped_author}&quot;&gt;
  &lt;w15:presenceInfo w15:providerId=&quot;None&quot; w15:userId=&quot;{escaped_author}&quot;/&gt;
&lt;/w15:person&gt;&#x27;&#x27;&#x27;
        editor.append_to(root, person_xml)

    def _ensure_comment_relationships(self):
        &quot;&quot;&quot;Ensure word/_rels/document.xml.rels has comment relationships.&quot;&quot;&quot;
        editor = self[&quot;word/_rels/document.xml.rels&quot;]

        if self._has_relationship(editor, &quot;comments.xml&quot;):
            return

        root = editor.dom.documentElement
        root_tag = root.tagName  # type: ignore
        prefix = root_tag.split(&quot;:&quot;)[0] + &quot;:&quot; if &quot;:&quot; in root_tag else &quot;&quot;
        next_rid_num = int(editor.get_next_rid()[3:])

        # Add relationship elements
        rels = [
            (
                next_rid_num,
                &quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments&quot;,
                &quot;comments.xml&quot;,
            ),
            (
                next_rid_num + 1,
                &quot;http://schemas.microsoft.com/office/2011/relationships/commentsExtended&quot;,
                &quot;commentsExtended.xml&quot;,
            ),
            (
                next_rid_num + 2,
                &quot;http://schemas.microsoft.com/office/2016/09/relationships/commentsIds&quot;,
                &quot;commentsIds.xml&quot;,
            ),
            (
                next_rid_num + 3,
                &quot;http://schemas.microsoft.com/office/2018/08/relationships/commentsExtensible&quot;,
                &quot;commentsExtensible.xml&quot;,
            ),
        ]

        for rel_id, rel_type, target in rels:
            rel_xml = f&#x27;&lt;{prefix}Relationship Id=&quot;rId{rel_id}&quot; Type=&quot;{rel_type}&quot; Target=&quot;{target}&quot;/&gt;&#x27;
            editor.append_to(root, rel_xml)

    def _ensure_comment_content_types(self):
        &quot;&quot;&quot;Ensure [Content_Types].xml has comment content types.&quot;&quot;&quot;
        editor = self[&quot;[Content_Types].xml&quot;]

        if self._has_override(editor, &quot;/word/comments.xml&quot;):
            return

        root = editor.dom.documentElement

        # Add Override elements
        overrides = [
            (
                &quot;/word/comments.xml&quot;,
                &quot;application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml&quot;,
            ),
            (
                &quot;/word/commentsExtended.xml&quot;,
                &quot;application/vnd.openxmlformats-officedocument.wordprocessingml.commentsExtended+xml&quot;,
            ),
            (
                &quot;/word/commentsIds.xml&quot;,
                &quot;application/vnd.openxmlformats-officedocument.wordprocessingml.commentsIds+xml&quot;,
            ),
            (
                &quot;/word/commentsExtensible.xml&quot;,
                &quot;application/vnd.openxmlformats-officedocument.wordprocessingml.commentsExtensible+xml&quot;,
            ),
        ]

        for part_name, content_type in overrides:
            override_xml = (
                f&#x27;&lt;Override PartName=&quot;{part_name}&quot; ContentType=&quot;{content_type}&quot;/&gt;&#x27;
            )
            editor.append_to(root, override_xml)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/document/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/docx/scripts/document.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/docx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="docx Imported skill docx from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/ooxml/scripts/validation/docx.py Unknown LICENSE.txt sources/anthropic/docx/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">docx</div>
                <button class="copy-btn" onclick="copyToClipboard('docx')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill docx from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;
Validator for Word document XML files against XSD schemas.
&quot;&quot;&quot;

import re
import tempfile
import zipfile

import lxml.etree

from .base import BaseSchemaValidator


class DOCXSchemaValidator(BaseSchemaValidator):
    &quot;&quot;&quot;Validator for Word document XML files against XSD schemas.&quot;&quot;&quot;

    # Word-specific namespace
    WORD_2006_NAMESPACE = &quot;http://schemas.openxmlformats.org/wordprocessingml/2006/main&quot;

    # Word-specific element to relationship type mappings
    # Start with empty mapping - add specific cases as we discover them
    ELEMENT_RELATIONSHIP_TYPES = {}

    def validate(self):
        &quot;&quot;&quot;Run all validation checks and return True if all pass.&quot;&quot;&quot;
        # Test 0: XML well-formedness
        if not self.validate_xml():
            return False

        # Test 1: Namespace declarations
        all_valid = True
        if not self.validate_namespaces():
            all_valid = False

        # Test 2: Unique IDs
        if not self.validate_unique_ids():
            all_valid = False

        # Test 3: Relationship and file reference validation
        if not self.validate_file_references():
            all_valid = False

        # Test 4: Content type declarations
        if not self.validate_content_types():
            all_valid = False

        # Test 5: XSD schema validation
        if not self.validate_against_xsd():
            all_valid = False

        # Test 6: Whitespace preservation
        if not self.validate_whitespace_preservation():
            all_valid = False

        # Test 7: Deletion validation
        if not self.validate_deletions():
            all_valid = False

        # Test 8: Insertion validation
        if not self.validate_insertions():
            all_valid = False

        # Test 9: Relationship ID reference validation
        if not self.validate_all_relationship_ids():
            all_valid = False

        # Count and compare paragraphs
        self.compare_paragraph_counts()

        return all_valid

    def validate_whitespace_preservation(self):
        &quot;&quot;&quot;
        Validate that w:t elements with whitespace have xml:space=&#x27;preserve&#x27;.
        &quot;&quot;&quot;
        errors = []

        for xml_file in self.xml_files:
            # Only check document.xml files
            if xml_file.name != &quot;document.xml&quot;:
                continue

            try:
                root = lxml.etree.parse(str(xml_file)).getroot()

                # Find all w:t elements
                for elem in root.iter(f&quot;{{{self.WORD_2006_NAMESPACE}}}t&quot;):
                    if elem.text:
                        text = elem.text
                        # Check if text starts or ends with whitespace
                        if re.match(r&quot;^\s.*&quot;, text) or re.match(r&quot;.*\s$&quot;, text):
                            # Check if xml:space=&quot;preserve&quot; attribute exists
                            xml_space_attr = f&quot;{{{self.XML_NAMESPACE}}}space&quot;
                            if (
                                xml_space_attr not in elem.attrib
                                or elem.attrib[xml_space_attr] != &quot;preserve&quot;
                            ):
                                # Show a preview of the text
                                text_preview = (
                                    repr(text)[:50] + &quot;...&quot;
                                    if len(repr(text)) &gt; 50
                                    else repr(text)
                                )
                                errors.append(
                                    f&quot;  {xml_file.relative_to(self.unpacked_dir)}: &quot;
                                    f&quot;Line {elem.sourceline}: w:t element with whitespace missing xml:space=&#x27;preserve&#x27;: {text_preview}&quot;
                                )

            except (lxml.etree.XMLSyntaxError, Exception) as e:
                errors.append(
                    f&quot;  {xml_file.relative_to(self.unpacked_dir)}: Error: {e}&quot;
                )

        if errors:
            print(f&quot;FAILED - Found {len(errors)} whitespace preservation violations:&quot;)
            for error in errors:
                print(error)
            return False
        else:
            if self.verbose:
                print(&quot;PASSED - All whitespace is properly preserved&quot;)
            return True

    def validate_deletions(self):
        &quot;&quot;&quot;
        Validate that w:t elements are not within w:del elements.
        For some reason, XSD validation does not catch this, so we do it manually.
        &quot;&quot;&quot;
        errors = []

        for xml_file in self.xml_files:
            # Only check document.xml files
            if xml_file.name != &quot;document.xml&quot;:
                continue

            try:
                root = lxml.etree.parse(str(xml_file)).getroot()

                # Find all w:t elements that are descendants of w:del elements
                namespaces = {&quot;w&quot;: self.WORD_2006_NAMESPACE}
                xpath_expression = &quot;.//w:del//w:t&quot;
                problematic_t_elements = root.xpath(
                    xpath_expression, namespaces=namespaces
                )
                for t_elem in problematic_t_elements:
                    if t_elem.text:
                        # Show a preview of the text
                        text_preview = (
                            repr(t_elem.text)[:50] + &quot;...&quot;
                            if len(repr(t_elem.text)) &gt; 50
                            else repr(t_elem.text)
                        )
                        errors.append(
                            f&quot;  {xml_file.relative_to(self.unpacked_dir)}: &quot;
                            f&quot;Line {t_elem.sourceline}: &lt;w:t&gt; found within &lt;w:del&gt;: {text_preview}&quot;
                        )

            except (lxml.etree.XMLSyntaxError, Exception) as e:
                errors.append(
                    f&quot;  {xml_file.relative_to(self.unpacked_dir)}: Error: {e}&quot;
                )

        if errors:
            print(f&quot;FAILED - Found {len(errors)} deletion validation violations:&quot;)
            for error in errors:
                print(error)
            return False
        else:
            if self.verbose:
                print(&quot;PASSED - No w:t elements found within w:del elements&quot;)
            return True

    def count_paragraphs_in_unpacked(self):
        &quot;&quot;&quot;Count the number of paragraphs in the unpacked document.&quot;&quot;&quot;
        count = 0

        for xml_file in self.xml_files:
            # Only check document.xml files
            if xml_file.name != &quot;document.xml&quot;:
                continue

            try:
                root = lxml.etree.parse(str(xml_file)).getroot()
                # Count all w:p elements
                paragraphs = root.findall(f&quot;.//{{{self.WORD_2006_NAMESPACE}}}p&quot;)
                count = len(paragraphs)
            except Exception as e:
                print(f&quot;Error counting paragraphs in unpacked document: {e}&quot;)

        return count

    def count_paragraphs_in_original(self):
        &quot;&quot;&quot;Count the number of paragraphs in the original docx file.&quot;&quot;&quot;
        count = 0

        try:
            # Create temporary directory to unpack original
            with tempfile.TemporaryDirectory() as temp_dir:
                # Unpack original docx
                with zipfile.ZipFile(self.original_file, &quot;r&quot;) as zip_ref:
                    zip_ref.extractall(temp_dir)

                # Parse document.xml
                doc_xml_path = temp_dir + &quot;/word/document.xml&quot;
                root = lxml.etree.parse(doc_xml_path).getroot()

                # Count all w:p elements
                paragraphs = root.findall(f&quot;.//{{{self.WORD_2006_NAMESPACE}}}p&quot;)
                count = len(paragraphs)

        except Exception as e:
            print(f&quot;Error counting paragraphs in original document: {e}&quot;)

        return count

    def validate_insertions(self):
        &quot;&quot;&quot;
        Validate that w:delText elements are not within w:ins elements.
        w:delText is only allowed in w:ins if nested within a w:del.
        &quot;&quot;&quot;
        errors = []

        for xml_file in self.xml_files:
            if xml_file.name != &quot;document.xml&quot;:
                continue

            try:
                root = lxml.etree.parse(str(xml_file)).getroot()
                namespaces = {&quot;w&quot;: self.WORD_2006_NAMESPACE}

                # Find w:delText in w:ins that are NOT within w:del
                invalid_elements = root.xpath(
                    &quot;.//w:ins//w:delText[not(ancestor::w:del)]&quot;,
                    namespaces=namespaces
                )

                for elem in invalid_elements:
                    text_preview = (
                        repr(elem.text or &quot;&quot;)[:50] + &quot;...&quot;
                        if len(repr(elem.text or &quot;&quot;)) &gt; 50
                        else repr(elem.text or &quot;&quot;)
                    )
                    errors.append(
                        f&quot;  {xml_file.relative_to(self.unpacked_dir)}: &quot;
                        f&quot;Line {elem.sourceline}: &lt;w:delText&gt; within &lt;w:ins&gt;: {text_preview}&quot;
                    )

            except (lxml.etree.XMLSyntaxError, Exception) as e:
                errors.append(
                    f&quot;  {xml_file.relative_to(self.unpacked_dir)}: Error: {e}&quot;
                )

        if errors:
            print(f&quot;FAILED - Found {len(errors)} insertion validation violations:&quot;)
            for error in errors:
                print(error)
            return False
        else:
            if self.verbose:
                print(&quot;PASSED - No w:delText elements within w:ins elements&quot;)
            return True

    def compare_paragraph_counts(self):
        &quot;&quot;&quot;Compare paragraph counts between original and new document.&quot;&quot;&quot;
        original_count = self.count_paragraphs_in_original()
        new_count = self.count_paragraphs_in_unpacked()

        diff = new_count - original_count
        diff_str = f&quot;+{diff}&quot; if diff &gt; 0 else str(diff)
        print(f&quot;\nParagraphs: {original_count}  {new_count} ({diff_str})&quot;)


if __name__ == &quot;__main__&quot;:
    raise RuntimeError(&quot;This module should not be run directly.&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/docx/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/ooxml/scripts/validation/docx.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="docx_js Imported skill docx_js from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/docx/docx-js.md Unknown LICENSE.txt sources/anthropic/docx_js/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">docx_js</div>
                <button class="copy-btn" onclick="copyToClipboard('docx_js')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill docx_js from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># DOCX Library Tutorial

Generate .docx files with JavaScript/TypeScript.

**Important: Read this entire document before starting.** Critical formatting rules and common pitfalls are covered throughout - skipping sections may result in corrupted files or rendering issues.

## Setup
Assumes docx is already installed globally
If not installed: `npm install -g docx`

```javascript
const { Document, Packer, Paragraph, TextRun, Table, TableRow, TableCell, ImageRun, Media, 
        Header, Footer, AlignmentType, PageOrientation, LevelFormat, ExternalHyperlink, 
        InternalHyperlink, TableOfContents, HeadingLevel, BorderStyle, WidthType, TabStopType, 
        TabStopPosition, UnderlineType, ShadingType, VerticalAlign, SymbolRun, PageNumber,
        FootnoteReferenceRun, Footnote, PageBreak } = require(&#x27;docx&#x27;);

// Create &amp; Save
const doc = new Document({ sections: [{ children: [/* content */] }] });
Packer.toBuffer(doc).then(buffer =&gt; fs.writeFileSync(&quot;doc.docx&quot;, buffer)); // Node.js
Packer.toBlob(doc).then(blob =&gt; { /* download logic */ }); // Browser
```

## Text &amp; Formatting
```javascript
// IMPORTANT: Never use \n for line breaks - always use separate Paragraph elements
//  WRONG: new TextRun(&quot;Line 1\nLine 2&quot;)
//  CORRECT: new Paragraph({ children: [new TextRun(&quot;Line 1&quot;)] }), new Paragraph({ children: [new TextRun(&quot;Line 2&quot;)] })

// Basic text with all formatting options
new Paragraph({
  alignment: AlignmentType.CENTER,
  spacing: { before: 200, after: 200 },
  indent: { left: 720, right: 720 },
  children: [
    new TextRun({ text: &quot;Bold&quot;, bold: true }),
    new TextRun({ text: &quot;Italic&quot;, italics: true }),
    new TextRun({ text: &quot;Underlined&quot;, underline: { type: UnderlineType.DOUBLE, color: &quot;FF0000&quot; } }),
    new TextRun({ text: &quot;Colored&quot;, color: &quot;FF0000&quot;, size: 28, font: &quot;Arial&quot; }), // Arial default
    new TextRun({ text: &quot;Highlighted&quot;, highlight: &quot;yellow&quot; }),
    new TextRun({ text: &quot;Strikethrough&quot;, strike: true }),
    new TextRun({ text: &quot;x2&quot;, superScript: true }),
    new TextRun({ text: &quot;H2O&quot;, subScript: true }),
    new TextRun({ text: &quot;SMALL CAPS&quot;, smallCaps: true }),
    new SymbolRun({ char: &quot;2022&quot;, font: &quot;Symbol&quot; }), // Bullet 
    new SymbolRun({ char: &quot;00A9&quot;, font: &quot;Arial&quot; })   // Copyright  - Arial for symbols
  ]
})
```

## Styles &amp; Professional Formatting

```javascript
const doc = new Document({
  styles: {
    default: { document: { run: { font: &quot;Arial&quot;, size: 24 } } }, // 12pt default
    paragraphStyles: [
      // Document title style - override built-in Title style
      { id: &quot;Title&quot;, name: &quot;Title&quot;, basedOn: &quot;Normal&quot;,
        run: { size: 56, bold: true, color: &quot;000000&quot;, font: &quot;Arial&quot; },
        paragraph: { spacing: { before: 240, after: 120 }, alignment: AlignmentType.CENTER } },
      // IMPORTANT: Override built-in heading styles by using their exact IDs
      { id: &quot;Heading1&quot;, name: &quot;Heading 1&quot;, basedOn: &quot;Normal&quot;, next: &quot;Normal&quot;, quickFormat: true,
        run: { size: 32, bold: true, color: &quot;000000&quot;, font: &quot;Arial&quot; }, // 16pt
        paragraph: { spacing: { before: 240, after: 240 }, outlineLevel: 0 } }, // Required for TOC
      { id: &quot;Heading2&quot;, name: &quot;Heading 2&quot;, basedOn: &quot;Normal&quot;, next: &quot;Normal&quot;, quickFormat: true,
        run: { size: 28, bold: true, color: &quot;000000&quot;, font: &quot;Arial&quot; }, // 14pt
        paragraph: { spacing: { before: 180, after: 180 }, outlineLevel: 1 } },
      // Custom styles use your own IDs
      { id: &quot;myStyle&quot;, name: &quot;My Style&quot;, basedOn: &quot;Normal&quot;,
        run: { size: 28, bold: true, color: &quot;000000&quot; },
        paragraph: { spacing: { after: 120 }, alignment: AlignmentType.CENTER } }
    ],
    characterStyles: [{ id: &quot;myCharStyle&quot;, name: &quot;My Char Style&quot;,
      run: { color: &quot;FF0000&quot;, bold: true, underline: { type: UnderlineType.SINGLE } } }]
  },
  sections: [{
    properties: { page: { margin: { top: 1440, right: 1440, bottom: 1440, left: 1440 } } },
    children: [
      new Paragraph({ heading: HeadingLevel.TITLE, children: [new TextRun(&quot;Document Title&quot;)] }), // Uses overridden Title style
      new Paragraph({ heading: HeadingLevel.HEADING_1, children: [new TextRun(&quot;Heading 1&quot;)] }), // Uses overridden Heading1 style
      new Paragraph({ style: &quot;myStyle&quot;, children: [new TextRun(&quot;Custom paragraph style&quot;)] }),
      new Paragraph({ children: [
        new TextRun(&quot;Normal with &quot;),
        new TextRun({ text: &quot;custom char style&quot;, style: &quot;myCharStyle&quot; })
      ]})
    ]
  }]
});
```

**Professional Font Combinations:**
- **Arial (Headers) + Arial (Body)** - Most universally supported, clean and professional
- **Times New Roman (Headers) + Arial (Body)** - Classic serif headers with modern sans-serif body
- **Georgia (Headers) + Verdana (Body)** - Optimized for screen reading, elegant contrast

**Key Styling Principles:**
- **Override built-in styles**: Use exact IDs like &quot;Heading1&quot;, &quot;Heading2&quot;, &quot;Heading3&quot; to override Word&#x27;s built-in heading styles
- **HeadingLevel constants**: `HeadingLevel.HEADING_1` uses &quot;Heading1&quot; style, `HeadingLevel.HEADING_2` uses &quot;Heading2&quot; style, etc.
- **Include outlineLevel**: Set `outlineLevel: 0` for H1, `outlineLevel: 1` for H2, etc. to ensure TOC works correctly
- **Use custom styles** instead of inline formatting for consistency
- **Set a default font** using `styles.default.document.run.font` - Arial is universally supported
- **Establish visual hierarchy** with different font sizes (titles &gt; headers &gt; body)
- **Add proper spacing** with `before` and `after` paragraph spacing
- **Use colors sparingly**: Default to black (000000) and shades of gray for titles and headings (heading 1, heading 2, etc.)
- **Set consistent margins** (1440 = 1 inch is standard)


## Lists (ALWAYS USE PROPER LISTS - NEVER USE UNICODE BULLETS)
```javascript
// Bullets - ALWAYS use the numbering config, NOT unicode symbols
// CRITICAL: Use LevelFormat.BULLET constant, NOT the string &quot;bullet&quot;
const doc = new Document({
  numbering: {
    config: [
      { reference: &quot;bullet-list&quot;,
        levels: [{ level: 0, format: LevelFormat.BULLET, text: &quot;&quot;, alignment: AlignmentType.LEFT,
          style: { paragraph: { indent: { left: 720, hanging: 360 } } } }] },
      { reference: &quot;first-numbered-list&quot;,
        levels: [{ level: 0, format: LevelFormat.DECIMAL, text: &quot;%1.&quot;, alignment: AlignmentType.LEFT,
          style: { paragraph: { indent: { left: 720, hanging: 360 } } } }] },
      { reference: &quot;second-numbered-list&quot;, // Different reference = restarts at 1
        levels: [{ level: 0, format: LevelFormat.DECIMAL, text: &quot;%1.&quot;, alignment: AlignmentType.LEFT,
          style: { paragraph: { indent: { left: 720, hanging: 360 } } } }] }
    ]
  },
  sections: [{
    children: [
      // Bullet list items
      new Paragraph({ numbering: { reference: &quot;bullet-list&quot;, level: 0 },
        children: [new TextRun(&quot;First bullet point&quot;)] }),
      new Paragraph({ numbering: { reference: &quot;bullet-list&quot;, level: 0 },
        children: [new TextRun(&quot;Second bullet point&quot;)] }),
      // Numbered list items
      new Paragraph({ numbering: { reference: &quot;first-numbered-list&quot;, level: 0 },
        children: [new TextRun(&quot;First numbered item&quot;)] }),
      new Paragraph({ numbering: { reference: &quot;first-numbered-list&quot;, level: 0 },
        children: [new TextRun(&quot;Second numbered item&quot;)] }),
      //  CRITICAL: Different reference = INDEPENDENT list that restarts at 1
      // Same reference = CONTINUES previous numbering
      new Paragraph({ numbering: { reference: &quot;second-numbered-list&quot;, level: 0 },
        children: [new TextRun(&quot;Starts at 1 again (because different reference)&quot;)] })
    ]
  }]
});

//  CRITICAL NUMBERING RULE: Each reference creates an INDEPENDENT numbered list
// - Same reference = continues numbering (1, 2, 3... then 4, 5, 6...)
// - Different reference = restarts at 1 (1, 2, 3... then 1, 2, 3...)
// Use unique reference names for each separate numbered section!

//  CRITICAL: NEVER use unicode bullets - they create fake lists that don&#x27;t work properly
// new TextRun(&quot; Item&quot;)           // WRONG
// new SymbolRun({ char: &quot;2022&quot; }) // WRONG
//  ALWAYS use numbering config with LevelFormat.BULLET for real Word lists
```

## Tables
```javascript
// Complete table with margins, borders, headers, and bullet points
const tableBorder = { style: BorderStyle.SINGLE, size: 1, color: &quot;CCCCCC&quot; };
const cellBorders = { top: tableBorder, bottom: tableBorder, left: tableBorder, right: tableBorder };

new Table({
  columnWidths: [4680, 4680], //  CRITICAL: Set column widths at table level - values in DXA (twentieths of a point)
  margins: { top: 100, bottom: 100, left: 180, right: 180 }, // Set once for all cells
  rows: [
    new TableRow({
      tableHeader: true,
      children: [
        new TableCell({
          borders: cellBorders,
          width: { size: 4680, type: WidthType.DXA }, // ALSO set width on each cell
          //  CRITICAL: Always use ShadingType.CLEAR to prevent black backgrounds in Word.
          shading: { fill: &quot;D5E8F0&quot;, type: ShadingType.CLEAR }, 
          verticalAlign: VerticalAlign.CENTER,
          children: [new Paragraph({ 
            alignment: AlignmentType.CENTER,
            children: [new TextRun({ text: &quot;Header&quot;, bold: true, size: 22 })]
          })]
        }),
        new TableCell({
          borders: cellBorders,
          width: { size: 4680, type: WidthType.DXA }, // ALSO set width on each cell
          shading: { fill: &quot;D5E8F0&quot;, type: ShadingType.CLEAR },
          children: [new Paragraph({ 
            alignment: AlignmentType.CENTER,
            children: [new TextRun({ text: &quot;Bullet Points&quot;, bold: true, size: 22 })]
          })]
        })
      ]
    }),
    new TableRow({
      children: [
        new TableCell({
          borders: cellBorders,
          width: { size: 4680, type: WidthType.DXA }, // ALSO set width on each cell
          children: [new Paragraph({ children: [new TextRun(&quot;Regular data&quot;)] })]
        }),
        new TableCell({
          borders: cellBorders,
          width: { size: 4680, type: WidthType.DXA }, // ALSO set width on each cell
          children: [
            new Paragraph({ 
              numbering: { reference: &quot;bullet-list&quot;, level: 0 },
              children: [new TextRun(&quot;First bullet point&quot;)] 
            }),
            new Paragraph({ 
              numbering: { reference: &quot;bullet-list&quot;, level: 0 },
              children: [new TextRun(&quot;Second bullet point&quot;)] 
            })
          ]
        })
      ]
    })
  ]
})
```

**IMPORTANT: Table Width &amp; Borders**
- Use BOTH `columnWidths: [width1, width2, ...]` array AND `width: { size: X, type: WidthType.DXA }` on each cell
- Values in DXA (twentieths of a point): 1440 = 1 inch, Letter usable width = 9360 DXA (with 1&quot; margins)
- Apply borders to individual `TableCell` elements, NOT the `Table` itself

**Precomputed Column Widths (Letter size with 1&quot; margins = 9360 DXA total):**
- **2 columns:** `columnWidths: [4680, 4680]` (equal width)
- **3 columns:** `columnWidths: [3120, 3120, 3120]` (equal width)

## Links &amp; Navigation
```javascript
// TOC (requires headings) - CRITICAL: Use HeadingLevel only, NOT custom styles
//  WRONG: new Paragraph({ heading: HeadingLevel.HEADING_1, style: &quot;customHeader&quot;, children: [new TextRun(&quot;Title&quot;)] })
//  CORRECT: new Paragraph({ heading: HeadingLevel.HEADING_1, children: [new TextRun(&quot;Title&quot;)] })
new TableOfContents(&quot;Table of Contents&quot;, { hyperlink: true, headingStyleRange: &quot;1-3&quot; }),

// External link
new Paragraph({
  children: [new ExternalHyperlink({
    children: [new TextRun({ text: &quot;Google&quot;, style: &quot;Hyperlink&quot; })],
    link: &quot;https://www.google.com&quot;
  })]
}),

// Internal link &amp; bookmark
new Paragraph({
  children: [new InternalHyperlink({
    children: [new TextRun({ text: &quot;Go to Section&quot;, style: &quot;Hyperlink&quot; })],
    anchor: &quot;section1&quot;
  })]
}),
new Paragraph({
  children: [new TextRun(&quot;Section Content&quot;)],
  bookmark: { id: &quot;section1&quot;, name: &quot;section1&quot; }
}),
```

## Images &amp; Media
```javascript
// Basic image with sizing &amp; positioning
// CRITICAL: Always specify &#x27;type&#x27; parameter - it&#x27;s REQUIRED for ImageRun
new Paragraph({
  alignment: AlignmentType.CENTER,
  children: [new ImageRun({
    type: &quot;png&quot;, // NEW REQUIREMENT: Must specify image type (png, jpg, jpeg, gif, bmp, svg)
    data: fs.readFileSync(&quot;image.png&quot;),
    transformation: { width: 200, height: 150, rotation: 0 }, // rotation in degrees
    altText: { title: &quot;Logo&quot;, description: &quot;Company logo&quot;, name: &quot;Name&quot; } // IMPORTANT: All three fields are required
  })]
})
```

## Page Breaks
```javascript
// Manual page break
new Paragraph({ children: [new PageBreak()] }),

// Page break before paragraph
new Paragraph({
  pageBreakBefore: true,
  children: [new TextRun(&quot;This starts on a new page&quot;)]
})

//  CRITICAL: NEVER use PageBreak standalone - it will create invalid XML that Word cannot open
//  WRONG: new PageBreak() 
//  CORRECT: new Paragraph({ children: [new PageBreak()] })
```

## Headers/Footers &amp; Page Setup
```javascript
const doc = new Document({
  sections: [{
    properties: {
      page: {
        margin: { top: 1440, right: 1440, bottom: 1440, left: 1440 }, // 1440 = 1 inch
        size: { orientation: PageOrientation.LANDSCAPE },
        pageNumbers: { start: 1, formatType: &quot;decimal&quot; } // &quot;upperRoman&quot;, &quot;lowerRoman&quot;, &quot;upperLetter&quot;, &quot;lowerLetter&quot;
      }
    },
    headers: {
      default: new Header({ children: [new Paragraph({ 
        alignment: AlignmentType.RIGHT,
        children: [new TextRun(&quot;Header Text&quot;)]
      })] })
    },
    footers: {
      default: new Footer({ children: [new Paragraph({ 
        alignment: AlignmentType.CENTER,
        children: [new TextRun(&quot;Page &quot;), new TextRun({ children: [PageNumber.CURRENT] }), new TextRun(&quot; of &quot;), new TextRun({ children: [PageNumber.TOTAL_PAGES] })]
      })] })
    },
    children: [/* content */]
  }]
});
```

## Tabs
```javascript
new Paragraph({
  tabStops: [
    { type: TabStopType.LEFT, position: TabStopPosition.MAX / 4 },
    { type: TabStopType.CENTER, position: TabStopPosition.MAX / 2 },
    { type: TabStopType.RIGHT, position: TabStopPosition.MAX * 3 / 4 }
  ],
  children: [new TextRun(&quot;Left\tCenter\tRight&quot;)]
})
```

## Constants &amp; Quick Reference
- **Underlines:** `SINGLE`, `DOUBLE`, `WAVY`, `DASH`
- **Borders:** `SINGLE`, `DOUBLE`, `DASHED`, `DOTTED`  
- **Numbering:** `DECIMAL` (1,2,3), `UPPER_ROMAN` (I,II,III), `LOWER_LETTER` (a,b,c)
- **Tabs:** `LEFT`, `CENTER`, `RIGHT`, `DECIMAL`
- **Symbols:** `&quot;2022&quot;` (), `&quot;00A9&quot;` (), `&quot;00AE&quot;` (), `&quot;2122&quot;` (), `&quot;00B0&quot;` (), `&quot;F070&quot;` (), `&quot;F0FC&quot;` ()

## Critical Issues &amp; Common Mistakes
- **CRITICAL: PageBreak must ALWAYS be inside a Paragraph** - standalone PageBreak creates invalid XML that Word cannot open
- **ALWAYS use ShadingType.CLEAR for table cell shading** - Never use ShadingType.SOLID (causes black background).
- Measurements in DXA (1440 = 1 inch) | Each table cell needs 1 Paragraph | TOC requires HeadingLevel styles only
- **ALWAYS use custom styles** with Arial font for professional appearance and proper visual hierarchy
- **ALWAYS set a default font** using `styles.default.document.run.font` - Arial recommended
- **ALWAYS use columnWidths array for tables** + individual cell widths for compatibility
- **NEVER use unicode symbols for bullets** - always use proper numbering configuration with `LevelFormat.BULLET` constant (NOT the string &quot;bullet&quot;)
- **NEVER use \n for line breaks anywhere** - always use separate Paragraph elements for each line
- **ALWAYS use TextRun objects within Paragraph children** - never use text property directly on Paragraph
- **CRITICAL for images**: ImageRun REQUIRES `type` parameter - always specify &quot;png&quot;, &quot;jpg&quot;, &quot;jpeg&quot;, &quot;gif&quot;, &quot;bmp&quot;, or &quot;svg&quot;
- **CRITICAL for bullets**: Must use `LevelFormat.BULLET` constant, not string &quot;bullet&quot;, and include `text: &quot;&quot;` for the bullet character
- **CRITICAL for numbering**: Each numbering reference creates an INDEPENDENT list. Same reference = continues numbering (1,2,3 then 4,5,6). Different reference = restarts at 1 (1,2,3 then 1,2,3). Use unique reference names for each separate numbered section!
- **CRITICAL for TOC**: When using TableOfContents, headings must use HeadingLevel ONLY - do NOT add custom styles to heading paragraphs or TOC will break
- **Tables**: Set `columnWidths` array + individual cell widths, apply borders to cells not table
- **Set table margins at TABLE level** for consistent cell padding (avoids repetition per cell)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/docx_js/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/docx/docx-js.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/docx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="easing Imported skill easing from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/slack-gif-creator/core/easing.py Unknown LICENSE.txt sources/anthropic/easing/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">easing</div>
                <button class="copy-btn" onclick="copyToClipboard('easing')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill easing from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Easing Functions - Timing functions for smooth animations.

Provides various easing functions for natural motion and timing.
All functions take a value t (0.0 to 1.0) and return eased value (0.0 to 1.0).
&quot;&quot;&quot;

import math


def linear(t: float) -&gt; float:
    &quot;&quot;&quot;Linear interpolation (no easing).&quot;&quot;&quot;
    return t


def ease_in_quad(t: float) -&gt; float:
    &quot;&quot;&quot;Quadratic ease-in (slow start, accelerating).&quot;&quot;&quot;
    return t * t


def ease_out_quad(t: float) -&gt; float:
    &quot;&quot;&quot;Quadratic ease-out (fast start, decelerating).&quot;&quot;&quot;
    return t * (2 - t)


def ease_in_out_quad(t: float) -&gt; float:
    &quot;&quot;&quot;Quadratic ease-in-out (slow start and end).&quot;&quot;&quot;
    if t &lt; 0.5:
        return 2 * t * t
    return -1 + (4 - 2 * t) * t


def ease_in_cubic(t: float) -&gt; float:
    &quot;&quot;&quot;Cubic ease-in (slow start).&quot;&quot;&quot;
    return t * t * t


def ease_out_cubic(t: float) -&gt; float:
    &quot;&quot;&quot;Cubic ease-out (fast start).&quot;&quot;&quot;
    return (t - 1) * (t - 1) * (t - 1) + 1


def ease_in_out_cubic(t: float) -&gt; float:
    &quot;&quot;&quot;Cubic ease-in-out.&quot;&quot;&quot;
    if t &lt; 0.5:
        return 4 * t * t * t
    return (t - 1) * (2 * t - 2) * (2 * t - 2) + 1


def ease_in_bounce(t: float) -&gt; float:
    &quot;&quot;&quot;Bounce ease-in (bouncy start).&quot;&quot;&quot;
    return 1 - ease_out_bounce(1 - t)


def ease_out_bounce(t: float) -&gt; float:
    &quot;&quot;&quot;Bounce ease-out (bouncy end).&quot;&quot;&quot;
    if t &lt; 1 / 2.75:
        return 7.5625 * t * t
    elif t &lt; 2 / 2.75:
        t -= 1.5 / 2.75
        return 7.5625 * t * t + 0.75
    elif t &lt; 2.5 / 2.75:
        t -= 2.25 / 2.75
        return 7.5625 * t * t + 0.9375
    else:
        t -= 2.625 / 2.75
        return 7.5625 * t * t + 0.984375


def ease_in_out_bounce(t: float) -&gt; float:
    &quot;&quot;&quot;Bounce ease-in-out.&quot;&quot;&quot;
    if t &lt; 0.5:
        return ease_in_bounce(t * 2) * 0.5
    return ease_out_bounce(t * 2 - 1) * 0.5 + 0.5


def ease_in_elastic(t: float) -&gt; float:
    &quot;&quot;&quot;Elastic ease-in (spring effect).&quot;&quot;&quot;
    if t == 0 or t == 1:
        return t
    return -math.pow(2, 10 * (t - 1)) * math.sin((t - 1.1) * 5 * math.pi)


def ease_out_elastic(t: float) -&gt; float:
    &quot;&quot;&quot;Elastic ease-out (spring effect).&quot;&quot;&quot;
    if t == 0 or t == 1:
        return t
    return math.pow(2, -10 * t) * math.sin((t - 0.1) * 5 * math.pi) + 1


def ease_in_out_elastic(t: float) -&gt; float:
    &quot;&quot;&quot;Elastic ease-in-out.&quot;&quot;&quot;
    if t == 0 or t == 1:
        return t
    t = t * 2 - 1
    if t &lt; 0:
        return -0.5 * math.pow(2, 10 * t) * math.sin((t - 0.1) * 5 * math.pi)
    return math.pow(2, -10 * t) * math.sin((t - 0.1) * 5 * math.pi) * 0.5 + 1


# Convenience mapping
EASING_FUNCTIONS = {
    &quot;linear&quot;: linear,
    &quot;ease_in&quot;: ease_in_quad,
    &quot;ease_out&quot;: ease_out_quad,
    &quot;ease_in_out&quot;: ease_in_out_quad,
    &quot;bounce_in&quot;: ease_in_bounce,
    &quot;bounce_out&quot;: ease_out_bounce,
    &quot;bounce&quot;: ease_in_out_bounce,
    &quot;elastic_in&quot;: ease_in_elastic,
    &quot;elastic_out&quot;: ease_out_elastic,
    &quot;elastic&quot;: ease_in_out_elastic,
}


def get_easing(name: str = &quot;linear&quot;):
    &quot;&quot;&quot;Get easing function by name.&quot;&quot;&quot;
    return EASING_FUNCTIONS.get(name, linear)


def interpolate(start: float, end: float, t: float, easing: str = &quot;linear&quot;) -&gt; float:
    &quot;&quot;&quot;
    Interpolate between two values with easing.

    Args:
        start: Start value
        end: End value
        t: Progress from 0.0 to 1.0
        easing: Name of easing function

    Returns:
        Interpolated value
    &quot;&quot;&quot;
    ease_func = get_easing(easing)
    eased_t = ease_func(t)
    return start + (end - start) * eased_t


def ease_back_in(t: float) -&gt; float:
    &quot;&quot;&quot;Back ease-in (slight overshoot backward before forward motion).&quot;&quot;&quot;
    c1 = 1.70158
    c3 = c1 + 1
    return c3 * t * t * t - c1 * t * t


def ease_back_out(t: float) -&gt; float:
    &quot;&quot;&quot;Back ease-out (overshoot forward then settle back).&quot;&quot;&quot;
    c1 = 1.70158
    c3 = c1 + 1
    return 1 + c3 * pow(t - 1, 3) + c1 * pow(t - 1, 2)


def ease_back_in_out(t: float) -&gt; float:
    &quot;&quot;&quot;Back ease-in-out (overshoot at both ends).&quot;&quot;&quot;
    c1 = 1.70158
    c2 = c1 * 1.525
    if t &lt; 0.5:
        return (pow(2 * t, 2) * ((c2 + 1) * 2 * t - c2)) / 2
    return (pow(2 * t - 2, 2) * ((c2 + 1) * (t * 2 - 2) + c2) + 2) / 2


def apply_squash_stretch(
    base_scale: tuple[float, float], intensity: float, direction: str = &quot;vertical&quot;
) -&gt; tuple[float, float]:
    &quot;&quot;&quot;
    Calculate squash and stretch scales for more dynamic animation.

    Args:
        base_scale: (width_scale, height_scale) base scales
        intensity: Squash/stretch intensity (0.0-1.0)
        direction: &#x27;vertical&#x27;, &#x27;horizontal&#x27;, or &#x27;both&#x27;

    Returns:
        (width_scale, height_scale) with squash/stretch applied
    &quot;&quot;&quot;
    width_scale, height_scale = base_scale

    if direction == &quot;vertical&quot;:
        # Compress vertically, expand horizontally (preserve volume)
        height_scale *= 1 - intensity * 0.5
        width_scale *= 1 + intensity * 0.5
    elif direction == &quot;horizontal&quot;:
        # Compress horizontally, expand vertically
        width_scale *= 1 - intensity * 0.5
        height_scale *= 1 + intensity * 0.5
    elif direction == &quot;both&quot;:
        # General squash (both dimensions)
        width_scale *= 1 - intensity * 0.3
        height_scale *= 1 - intensity * 0.3

    return (width_scale, height_scale)


def calculate_arc_motion(
    start: tuple[float, float], end: tuple[float, float], height: float, t: float
) -&gt; tuple[float, float]:
    &quot;&quot;&quot;
    Calculate position along a parabolic arc (natural motion path).

    Args:
        start: (x, y) starting position
        end: (x, y) ending position
        height: Arc height at midpoint (positive = upward)
        t: Progress (0.0-1.0)

    Returns:
        (x, y) position along arc
    &quot;&quot;&quot;
    x1, y1 = start
    x2, y2 = end

    # Linear interpolation for x
    x = x1 + (x2 - x1) * t

    # Parabolic interpolation for y
    # y = start + progress * (end - start) + arc_offset
    # Arc offset peaks at t=0.5
    arc_offset = 4 * height * t * (1 - t)
    y = y1 + (y2 - y1) * t - arc_offset

    return (x, y)


# Add new easing functions to the convenience mapping
EASING_FUNCTIONS.update(
    {
        &quot;back_in&quot;: ease_back_in,
        &quot;back_out&quot;: ease_back_out,
        &quot;back_in_out&quot;: ease_back_in_out,
        &quot;anticipate&quot;: ease_back_in,  # Alias
        &quot;overshoot&quot;: ease_back_out,  # Alias
    }
)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/easing/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/slack-gif-creator/core/easing.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/slack-gif-creator/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="ericaone_ofl Imported skill ericaone_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/EricaOne-OFL.txt Unknown LICENSE.txt sources/anthropic/ericaone_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">ericaone_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('ericaone_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill ericaone_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright (c) 2011 by LatinoType Limitada (luciano@latinotype.com), 
with Reserved Font Names &quot;Erica One&quot;

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/ericaone_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/EricaOne-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="evaluation Imported skill evaluation from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/mcp-builder/scripts/evaluation.py Unknown LICENSE.txt sources/anthropic/evaluation/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">evaluation</div>
                <button class="copy-btn" onclick="copyToClipboard('evaluation')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill evaluation from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;MCP Server Evaluation Harness

This script evaluates MCP servers by running test questions against them using Claude.
&quot;&quot;&quot;

import argparse
import asyncio
import json
import re
import sys
import time
import traceback
import xml.etree.ElementTree as ET
from pathlib import Path
from typing import Any

from anthropic import Anthropic

from connections import create_connection

EVALUATION_PROMPT = &quot;&quot;&quot;You are an AI assistant with access to tools.

When given a task, you MUST:
1. Use the available tools to complete the task
2. Provide summary of each step in your approach, wrapped in &lt;summary&gt; tags
3. Provide feedback on the tools provided, wrapped in &lt;feedback&gt; tags
4. Provide your final response, wrapped in &lt;response&gt; tags

Summary Requirements:
- In your &lt;summary&gt; tags, you must explain:
  - The steps you took to complete the task
  - Which tools you used, in what order, and why
  - The inputs you provided to each tool
  - The outputs you received from each tool
  - A summary for how you arrived at the response

Feedback Requirements:
- In your &lt;feedback&gt; tags, provide constructive feedback on the tools:
  - Comment on tool names: Are they clear and descriptive?
  - Comment on input parameters: Are they well-documented? Are required vs optional parameters clear?
  - Comment on descriptions: Do they accurately describe what the tool does?
  - Comment on any errors encountered during tool usage: Did the tool fail to execute? Did the tool return too many tokens?
  - Identify specific areas for improvement and explain WHY they would help
  - Be specific and actionable in your suggestions

Response Requirements:
- Your response should be concise and directly address what was asked
- Always wrap your final response in &lt;response&gt; tags
- If you cannot solve the task return &lt;response&gt;NOT_FOUND&lt;/response&gt;
- For numeric responses, provide just the number
- For IDs, provide just the ID
- For names or text, provide the exact text requested
- Your response should go last&quot;&quot;&quot;


def parse_evaluation_file(file_path: Path) -&gt; list[dict[str, Any]]:
    &quot;&quot;&quot;Parse XML evaluation file with qa_pair elements.&quot;&quot;&quot;
    try:
        tree = ET.parse(file_path)
        root = tree.getroot()
        evaluations = []

        for qa_pair in root.findall(&quot;.//qa_pair&quot;):
            question_elem = qa_pair.find(&quot;question&quot;)
            answer_elem = qa_pair.find(&quot;answer&quot;)

            if question_elem is not None and answer_elem is not None:
                evaluations.append({
                    &quot;question&quot;: (question_elem.text or &quot;&quot;).strip(),
                    &quot;answer&quot;: (answer_elem.text or &quot;&quot;).strip(),
                })

        return evaluations
    except Exception as e:
        print(f&quot;Error parsing evaluation file {file_path}: {e}&quot;)
        return []


def extract_xml_content(text: str, tag: str) -&gt; str | None:
    &quot;&quot;&quot;Extract content from XML tags.&quot;&quot;&quot;
    pattern = rf&quot;&lt;{tag}&gt;(.*?)&lt;/{tag}&gt;&quot;
    matches = re.findall(pattern, text, re.DOTALL)
    return matches[-1].strip() if matches else None


async def agent_loop(
    client: Anthropic,
    model: str,
    question: str,
    tools: list[dict[str, Any]],
    connection: Any,
) -&gt; tuple[str, dict[str, Any]]:
    &quot;&quot;&quot;Run the agent loop with MCP tools.&quot;&quot;&quot;
    messages = [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: question}]

    response = await asyncio.to_thread(
        client.messages.create,
        model=model,
        max_tokens=4096,
        system=EVALUATION_PROMPT,
        messages=messages,
        tools=tools,
    )

    messages.append({&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: response.content})

    tool_metrics = {}

    while response.stop_reason == &quot;tool_use&quot;:
        tool_use = next(block for block in response.content if block.type == &quot;tool_use&quot;)
        tool_name = tool_use.name
        tool_input = tool_use.input

        tool_start_ts = time.time()
        try:
            tool_result = await connection.call_tool(tool_name, tool_input)
            tool_response = json.dumps(tool_result) if isinstance(tool_result, (dict, list)) else str(tool_result)
        except Exception as e:
            tool_response = f&quot;Error executing tool {tool_name}: {str(e)}\n&quot;
            tool_response += traceback.format_exc()
        tool_duration = time.time() - tool_start_ts

        if tool_name not in tool_metrics:
            tool_metrics[tool_name] = {&quot;count&quot;: 0, &quot;durations&quot;: []}
        tool_metrics[tool_name][&quot;count&quot;] += 1
        tool_metrics[tool_name][&quot;durations&quot;].append(tool_duration)

        messages.append({
            &quot;role&quot;: &quot;user&quot;,
            &quot;content&quot;: [{
                &quot;type&quot;: &quot;tool_result&quot;,
                &quot;tool_use_id&quot;: tool_use.id,
                &quot;content&quot;: tool_response,
            }]
        })

        response = await asyncio.to_thread(
            client.messages.create,
            model=model,
            max_tokens=4096,
            system=EVALUATION_PROMPT,
            messages=messages,
            tools=tools,
        )
        messages.append({&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: response.content})

    response_text = next(
        (block.text for block in response.content if hasattr(block, &quot;text&quot;)),
        None,
    )
    return response_text, tool_metrics


async def evaluate_single_task(
    client: Anthropic,
    model: str,
    qa_pair: dict[str, Any],
    tools: list[dict[str, Any]],
    connection: Any,
    task_index: int,
) -&gt; dict[str, Any]:
    &quot;&quot;&quot;Evaluate a single QA pair with the given tools.&quot;&quot;&quot;
    start_time = time.time()

    print(f&quot;Task {task_index + 1}: Running task with question: {qa_pair[&#x27;question&#x27;]}&quot;)
    response, tool_metrics = await agent_loop(client, model, qa_pair[&quot;question&quot;], tools, connection)

    response_value = extract_xml_content(response, &quot;response&quot;)
    summary = extract_xml_content(response, &quot;summary&quot;)
    feedback = extract_xml_content(response, &quot;feedback&quot;)

    duration_seconds = time.time() - start_time

    return {
        &quot;question&quot;: qa_pair[&quot;question&quot;],
        &quot;expected&quot;: qa_pair[&quot;answer&quot;],
        &quot;actual&quot;: response_value,
        &quot;score&quot;: int(response_value == qa_pair[&quot;answer&quot;]) if response_value else 0,
        &quot;total_duration&quot;: duration_seconds,
        &quot;tool_calls&quot;: tool_metrics,
        &quot;num_tool_calls&quot;: sum(len(metrics[&quot;durations&quot;]) for metrics in tool_metrics.values()),
        &quot;summary&quot;: summary,
        &quot;feedback&quot;: feedback,
    }


REPORT_HEADER = &quot;&quot;&quot;
# Evaluation Report

## Summary

- **Accuracy**: {correct}/{total} ({accuracy:.1f}%)
- **Average Task Duration**: {average_duration_s:.2f}s
- **Average Tool Calls per Task**: {average_tool_calls:.2f}
- **Total Tool Calls**: {total_tool_calls}

---
&quot;&quot;&quot;

TASK_TEMPLATE = &quot;&quot;&quot;
### Task {task_num}

**Question**: {question}
**Ground Truth Answer**: `{expected_answer}`
**Actual Answer**: `{actual_answer}`
**Correct**: {correct_indicator}
**Duration**: {total_duration:.2f}s
**Tool Calls**: {tool_calls}

**Summary**
{summary}

**Feedback**
{feedback}

---
&quot;&quot;&quot;


async def run_evaluation(
    eval_path: Path,
    connection: Any,
    model: str = &quot;claude-3-7-sonnet-20250219&quot;,
) -&gt; str:
    &quot;&quot;&quot;Run evaluation with MCP server tools.&quot;&quot;&quot;
    print(&quot; Starting Evaluation&quot;)

    client = Anthropic()

    tools = await connection.list_tools()
    print(f&quot; Loaded {len(tools)} tools from MCP server&quot;)

    qa_pairs = parse_evaluation_file(eval_path)
    print(f&quot; Loaded {len(qa_pairs)} evaluation tasks&quot;)

    results = []
    for i, qa_pair in enumerate(qa_pairs):
        print(f&quot;Processing task {i + 1}/{len(qa_pairs)}&quot;)
        result = await evaluate_single_task(client, model, qa_pair, tools, connection, i)
        results.append(result)

    correct = sum(r[&quot;score&quot;] for r in results)
    accuracy = (correct / len(results)) * 100 if results else 0
    average_duration_s = sum(r[&quot;total_duration&quot;] for r in results) / len(results) if results else 0
    average_tool_calls = sum(r[&quot;num_tool_calls&quot;] for r in results) / len(results) if results else 0
    total_tool_calls = sum(r[&quot;num_tool_calls&quot;] for r in results)

    report = REPORT_HEADER.format(
        correct=correct,
        total=len(results),
        accuracy=accuracy,
        average_duration_s=average_duration_s,
        average_tool_calls=average_tool_calls,
        total_tool_calls=total_tool_calls,
    )

    report += &quot;&quot;.join([
        TASK_TEMPLATE.format(
            task_num=i + 1,
            question=qa_pair[&quot;question&quot;],
            expected_answer=qa_pair[&quot;answer&quot;],
            actual_answer=result[&quot;actual&quot;] or &quot;N/A&quot;,
            correct_indicator=&quot;&quot; if result[&quot;score&quot;] else &quot;&quot;,
            total_duration=result[&quot;total_duration&quot;],
            tool_calls=json.dumps(result[&quot;tool_calls&quot;], indent=2),
            summary=result[&quot;summary&quot;] or &quot;N/A&quot;,
            feedback=result[&quot;feedback&quot;] or &quot;N/A&quot;,
        )
        for i, (qa_pair, result) in enumerate(zip(qa_pairs, results))
    ])

    return report


def parse_headers(header_list: list[str]) -&gt; dict[str, str]:
    &quot;&quot;&quot;Parse header strings in format &#x27;Key: Value&#x27; into a dictionary.&quot;&quot;&quot;
    headers = {}
    if not header_list:
        return headers

    for header in header_list:
        if &quot;:&quot; in header:
            key, value = header.split(&quot;:&quot;, 1)
            headers[key.strip()] = value.strip()
        else:
            print(f&quot;Warning: Ignoring malformed header: {header}&quot;)
    return headers


def parse_env_vars(env_list: list[str]) -&gt; dict[str, str]:
    &quot;&quot;&quot;Parse environment variable strings in format &#x27;KEY=VALUE&#x27; into a dictionary.&quot;&quot;&quot;
    env = {}
    if not env_list:
        return env

    for env_var in env_list:
        if &quot;=&quot; in env_var:
            key, value = env_var.split(&quot;=&quot;, 1)
            env[key.strip()] = value.strip()
        else:
            print(f&quot;Warning: Ignoring malformed environment variable: {env_var}&quot;)
    return env


async def main():
    parser = argparse.ArgumentParser(
        description=&quot;Evaluate MCP servers using test questions&quot;,
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog=&quot;&quot;&quot;
Examples:
  # Evaluate a local stdio MCP server
  python evaluation.py -t stdio -c python -a my_server.py eval.xml

  # Evaluate an SSE MCP server
  python evaluation.py -t sse -u https://example.com/mcp -H &quot;Authorization: Bearer token&quot; eval.xml

  # Evaluate an HTTP MCP server with custom model
  python evaluation.py -t http -u https://example.com/mcp -m claude-3-5-sonnet-20241022 eval.xml
        &quot;&quot;&quot;,
    )

    parser.add_argument(&quot;eval_file&quot;, type=Path, help=&quot;Path to evaluation XML file&quot;)
    parser.add_argument(&quot;-t&quot;, &quot;--transport&quot;, choices=[&quot;stdio&quot;, &quot;sse&quot;, &quot;http&quot;], default=&quot;stdio&quot;, help=&quot;Transport type (default: stdio)&quot;)
    parser.add_argument(&quot;-m&quot;, &quot;--model&quot;, default=&quot;claude-3-7-sonnet-20250219&quot;, help=&quot;Claude model to use (default: claude-3-7-sonnet-20250219)&quot;)

    stdio_group = parser.add_argument_group(&quot;stdio options&quot;)
    stdio_group.add_argument(&quot;-c&quot;, &quot;--command&quot;, help=&quot;Command to run MCP server (stdio only)&quot;)
    stdio_group.add_argument(&quot;-a&quot;, &quot;--args&quot;, nargs=&quot;+&quot;, help=&quot;Arguments for the command (stdio only)&quot;)
    stdio_group.add_argument(&quot;-e&quot;, &quot;--env&quot;, nargs=&quot;+&quot;, help=&quot;Environment variables in KEY=VALUE format (stdio only)&quot;)

    remote_group = parser.add_argument_group(&quot;sse/http options&quot;)
    remote_group.add_argument(&quot;-u&quot;, &quot;--url&quot;, help=&quot;MCP server URL (sse/http only)&quot;)
    remote_group.add_argument(&quot;-H&quot;, &quot;--header&quot;, nargs=&quot;+&quot;, dest=&quot;headers&quot;, help=&quot;HTTP headers in &#x27;Key: Value&#x27; format (sse/http only)&quot;)

    parser.add_argument(&quot;-o&quot;, &quot;--output&quot;, type=Path, help=&quot;Output file for evaluation report (default: stdout)&quot;)

    args = parser.parse_args()

    if not args.eval_file.exists():
        print(f&quot;Error: Evaluation file not found: {args.eval_file}&quot;)
        sys.exit(1)

    headers = parse_headers(args.headers) if args.headers else None
    env_vars = parse_env_vars(args.env) if args.env else None

    try:
        connection = create_connection(
            transport=args.transport,
            command=args.command,
            args=args.args,
            env=env_vars,
            url=args.url,
            headers=headers,
        )
    except ValueError as e:
        print(f&quot;Error: {e}&quot;)
        sys.exit(1)

    print(f&quot; Connecting to MCP server via {args.transport}...&quot;)

    async with connection:
        print(&quot; Connected successfully&quot;)
        report = await run_evaluation(args.eval_file, connection, args.model)

        if args.output:
            args.output.write_text(report)
            print(f&quot;\n Report saved to {args.output}&quot;)
        else:
            print(&quot;\n&quot; + report)


if __name__ == &quot;__main__&quot;:
    asyncio.run(main())</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/evaluation/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/scripts/evaluation.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="extract_form_field_info Imported skill extract_form_field_info from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pdf/scripts/extract_form_field_info.py Unknown LICENSE.txt sources/anthropic/extract_form_field_info/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">extract_form_field_info</div>
                <button class="copy-btn" onclick="copyToClipboard('extract_form_field_info')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill extract_form_field_info from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">import json
import sys

from pypdf import PdfReader


# Extracts data for the fillable form fields in a PDF and outputs JSON that
# Claude uses to fill the fields. See forms.md.


# This matches the format used by PdfReader `get_fields` and `update_page_form_field_values` methods.
def get_full_annotation_field_id(annotation):
    components = []
    while annotation:
        field_name = annotation.get(&#x27;/T&#x27;)
        if field_name:
            components.append(field_name)
        annotation = annotation.get(&#x27;/Parent&#x27;)
    return &quot;.&quot;.join(reversed(components)) if components else None


def make_field_dict(field, field_id):
    field_dict = {&quot;field_id&quot;: field_id}
    ft = field.get(&#x27;/FT&#x27;)
    if ft == &quot;/Tx&quot;:
        field_dict[&quot;type&quot;] = &quot;text&quot;
    elif ft == &quot;/Btn&quot;:
        field_dict[&quot;type&quot;] = &quot;checkbox&quot;  # radio groups handled separately
        states = field.get(&quot;/_States_&quot;, [])
        if len(states) == 2:
            # &quot;/Off&quot; seems to always be the unchecked value, as suggested by
            # https://opensource.adobe.com/dc-acrobat-sdk-docs/standards/pdfstandards/pdf/PDF32000_2008.pdf#page=448
            # It can be either first or second in the &quot;/_States_&quot; list.
            if &quot;/Off&quot; in states:
                field_dict[&quot;checked_value&quot;] = states[0] if states[0] != &quot;/Off&quot; else states[1]
                field_dict[&quot;unchecked_value&quot;] = &quot;/Off&quot;
            else:
                print(f&quot;Unexpected state values for checkbox `${field_id}`. Its checked and unchecked values may not be correct; if you&#x27;re trying to check it, visually verify the results.&quot;)
                field_dict[&quot;checked_value&quot;] = states[0]
                field_dict[&quot;unchecked_value&quot;] = states[1]
    elif ft == &quot;/Ch&quot;:
        field_dict[&quot;type&quot;] = &quot;choice&quot;
        states = field.get(&quot;/_States_&quot;, [])
        field_dict[&quot;choice_options&quot;] = [{
            &quot;value&quot;: state[0],
            &quot;text&quot;: state[1],
        } for state in states]
    else:
        field_dict[&quot;type&quot;] = f&quot;unknown ({ft})&quot;
    return field_dict


# Returns a list of fillable PDF fields:
# [
#   {
#     &quot;field_id&quot;: &quot;name&quot;,
#     &quot;page&quot;: 1,
#     &quot;type&quot;: (&quot;text&quot;, &quot;checkbox&quot;, &quot;radio_group&quot;, or &quot;choice&quot;)
#     // Per-type additional fields described in forms.md
#   },
# ]
def get_field_info(reader: PdfReader):
    fields = reader.get_fields()

    field_info_by_id = {}
    possible_radio_names = set()

    for field_id, field in fields.items():
        # Skip if this is a container field with children, except that it might be
        # a parent group for radio button options.
        if field.get(&quot;/Kids&quot;):
            if field.get(&quot;/FT&quot;) == &quot;/Btn&quot;:
                possible_radio_names.add(field_id)
            continue
        field_info_by_id[field_id] = make_field_dict(field, field_id)

    # Bounding rects are stored in annotations in page objects.

    # Radio button options have a separate annotation for each choice;
    # all choices have the same field name.
    # See https://westhealth.github.io/exploring-fillable-forms-with-pdfrw.html
    radio_fields_by_id = {}

    for page_index, page in enumerate(reader.pages):
        annotations = page.get(&#x27;/Annots&#x27;, [])
        for ann in annotations:
            field_id = get_full_annotation_field_id(ann)
            if field_id in field_info_by_id:
                field_info_by_id[field_id][&quot;page&quot;] = page_index + 1
                field_info_by_id[field_id][&quot;rect&quot;] = ann.get(&#x27;/Rect&#x27;)
            elif field_id in possible_radio_names:
                try:
                    # ann[&#x27;/AP&#x27;][&#x27;/N&#x27;] should have two items. One of them is &#x27;/Off&#x27;,
                    # the other is the active value.
                    on_values = [v for v in ann[&quot;/AP&quot;][&quot;/N&quot;] if v != &quot;/Off&quot;]
                except KeyError:
                    continue
                if len(on_values) == 1:
                    rect = ann.get(&quot;/Rect&quot;)
                    if field_id not in radio_fields_by_id:
                        radio_fields_by_id[field_id] = {
                            &quot;field_id&quot;: field_id,
                            &quot;type&quot;: &quot;radio_group&quot;,
                            &quot;page&quot;: page_index + 1,
                            &quot;radio_options&quot;: [],
                        }
                    # Note: at least on macOS 15.7, Preview.app doesn&#x27;t show selected
                    # radio buttons correctly. (It does if you remove the leading slash
                    # from the value, but that causes them not to appear correctly in
                    # Chrome/Firefox/Acrobat/etc).
                    radio_fields_by_id[field_id][&quot;radio_options&quot;].append({
                        &quot;value&quot;: on_values[0],
                        &quot;rect&quot;: rect,
                    })

    # Some PDFs have form field definitions without corresponding annotations,
    # so we can&#x27;t tell where they are. Ignore these fields for now.
    fields_with_location = []
    for field_info in field_info_by_id.values():
        if &quot;page&quot; in field_info:
            fields_with_location.append(field_info)
        else:
            print(f&quot;Unable to determine location for field id: {field_info.get(&#x27;field_id&#x27;)}, ignoring&quot;)

    # Sort by page number, then Y position (flipped in PDF coordinate system), then X.
    def sort_key(f):
        if &quot;radio_options&quot; in f:
            rect = f[&quot;radio_options&quot;][0][&quot;rect&quot;] or [0, 0, 0, 0]
        else:
            rect = f.get(&quot;rect&quot;) or [0, 0, 0, 0]
        adjusted_position = [-rect[1], rect[0]]
        return [f.get(&quot;page&quot;), adjusted_position]
    
    sorted_fields = fields_with_location + list(radio_fields_by_id.values())
    sorted_fields.sort(key=sort_key)

    return sorted_fields


def write_field_info(pdf_path: str, json_output_path: str):
    reader = PdfReader(pdf_path)
    field_info = get_field_info(reader)
    with open(json_output_path, &quot;w&quot;) as f:
        json.dump(field_info, f, indent=2)
    print(f&quot;Wrote {len(field_info)} fields to {json_output_path}&quot;)


if __name__ == &quot;__main__&quot;:
    if len(sys.argv) != 3:
        print(&quot;Usage: extract_form_field_info.py [input pdf] [output json]&quot;)
        sys.exit(1)
    write_field_info(sys.argv[1], sys.argv[2])</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/extract_form_field_info/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/scripts/extract_form_field_info.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="faq_answers Imported skill faq_answers from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/internal-comms/examples/faq-answers.md Unknown LICENSE.txt sources/anthropic/faq_answers/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">faq_answers</div>
                <button class="copy-btn" onclick="copyToClipboard('faq_answers')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill faq_answers from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">## Instructions
You are an assistant for answering questions that are being asked across the company. Every week, there are lots of questions that get asked across the company, and your goal is to try to summarize what those questions are. We want our company to be well-informed and on the same page, so your job is to produce a set of frequently asked questions that our employees are asking and attempt to answer them. Your singular job is to do two things:

- Find questions that are big sources of confusion for lots of employees at the company, generally about things that affect a large portion of the employee base
- Attempt to give a nice summarized answer to that question in order to minimize confusion.

Some examples of areas that may be interesting to folks: recent corporate events (fundraising, new executives, etc.), upcoming launches, hiring progress, changes to vision or focus, etc.


## Tools Available
You should use the company&#x27;s available tools, where communication and work happens. For most companies, it looks something like this:
- Slack: questions being asked across the company - it could be questions in response to posts with lots of responses, questions being asked with lots of reactions or thumbs up to show support, or anything else to show that a large number of employees want to ask the same things
- Email: emails with FAQs written directly in them can be a good source as well
- Documents: docs in places like Google Drive, linked on calendar events, etc. can also be a good source of FAQs, either directly added or inferred based on the contents of the doc

## Formatting
The formatting should be pretty basic:

- *Question*: [insert question - 1 sentence]
- *Answer*: [insert answer - 1-2 sentence]

## Guidance
Make sure you&#x27;re being holistic in your questions. Don&#x27;t focus too much on just the user in question or the team they are a part of, but try to capture the entire company. Try to be as holistic as you can in reading all the tools available, producing responses that are relevant to all at the company.

## Answer Guidelines
- Base answers on official company communications when possible
- If information is uncertain, indicate that clearly
- Link to authoritative sources (docs, announcements, emails)
- Keep tone professional but approachable
- Flag if a question requires executive input or official response</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/faq_answers/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/internal-comms/examples/faq-answers.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/internal-comms/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="fill_fillable_fields Imported skill fill_fillable_fields from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pdf/scripts/fill_fillable_fields.py Unknown LICENSE.txt sources/anthropic/fill_fillable_fields/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">fill_fillable_fields</div>
                <button class="copy-btn" onclick="copyToClipboard('fill_fillable_fields')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill fill_fillable_fields from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">import json
import sys

from pypdf import PdfReader, PdfWriter

from extract_form_field_info import get_field_info


# Fills fillable form fields in a PDF. See forms.md.


def fill_pdf_fields(input_pdf_path: str, fields_json_path: str, output_pdf_path: str):
    with open(fields_json_path) as f:
        fields = json.load(f)
    # Group by page number.
    fields_by_page = {}
    for field in fields:
        if &quot;value&quot; in field:
            field_id = field[&quot;field_id&quot;]
            page = field[&quot;page&quot;]
            if page not in fields_by_page:
                fields_by_page[page] = {}
            fields_by_page[page][field_id] = field[&quot;value&quot;]
    
    reader = PdfReader(input_pdf_path)

    has_error = False
    field_info = get_field_info(reader)
    fields_by_ids = {f[&quot;field_id&quot;]: f for f in field_info}
    for field in fields:
        existing_field = fields_by_ids.get(field[&quot;field_id&quot;])
        if not existing_field:
            has_error = True
            print(f&quot;ERROR: `{field[&#x27;field_id&#x27;]}` is not a valid field ID&quot;)
        elif field[&quot;page&quot;] != existing_field[&quot;page&quot;]:
            has_error = True
            print(f&quot;ERROR: Incorrect page number for `{field[&#x27;field_id&#x27;]}` (got {field[&#x27;page&#x27;]}, expected {existing_field[&#x27;page&#x27;]})&quot;)
        else:
            if &quot;value&quot; in field:
                err = validation_error_for_field_value(existing_field, field[&quot;value&quot;])
                if err:
                    print(err)
                    has_error = True
    if has_error:
        sys.exit(1)

    writer = PdfWriter(clone_from=reader)
    for page, field_values in fields_by_page.items():
        writer.update_page_form_field_values(writer.pages[page - 1], field_values, auto_regenerate=False)

    # This seems to be necessary for many PDF viewers to format the form values correctly.
    # It may cause the viewer to show a &quot;save changes&quot; dialog even if the user doesn&#x27;t make any changes.
    writer.set_need_appearances_writer(True)
    
    with open(output_pdf_path, &quot;wb&quot;) as f:
        writer.write(f)


def validation_error_for_field_value(field_info, field_value):
    field_type = field_info[&quot;type&quot;]
    field_id = field_info[&quot;field_id&quot;]
    if field_type == &quot;checkbox&quot;:
        checked_val = field_info[&quot;checked_value&quot;]
        unchecked_val = field_info[&quot;unchecked_value&quot;]
        if field_value != checked_val and field_value != unchecked_val:
            return f&#x27;ERROR: Invalid value &quot;{field_value}&quot; for checkbox field &quot;{field_id}&quot;. The checked value is &quot;{checked_val}&quot; and the unchecked value is &quot;{unchecked_val}&quot;&#x27;
    elif field_type == &quot;radio_group&quot;:
        option_values = [opt[&quot;value&quot;] for opt in field_info[&quot;radio_options&quot;]]
        if field_value not in option_values:
            return f&#x27;ERROR: Invalid value &quot;{field_value}&quot; for radio group field &quot;{field_id}&quot;. Valid values are: {option_values}&#x27; 
    elif field_type == &quot;choice&quot;:
        choice_values = [opt[&quot;value&quot;] for opt in field_info[&quot;choice_options&quot;]]
        if field_value not in choice_values:
            return f&#x27;ERROR: Invalid value &quot;{field_value}&quot; for choice field &quot;{field_id}&quot;. Valid values are: {choice_values}&#x27;
    return None


# pypdf (at least version 5.7.0) has a bug when setting the value for a selection list field.
# In _writer.py around line 966:
#
# if field.get(FA.FT, &quot;/Tx&quot;) == &quot;/Ch&quot; and field_flags &amp; FA.FfBits.Combo == 0:
#     txt = &quot;\n&quot;.join(annotation.get_inherited(FA.Opt, []))
#
# The problem is that for selection lists, `get_inherited` returns a list of two-element lists like
# [[&quot;value1&quot;, &quot;Text 1&quot;], [&quot;value2&quot;, &quot;Text 2&quot;], ...]
# This causes `join` to throw a TypeError because it expects an iterable of strings.
# The horrible workaround is to patch `get_inherited` to return a list of the value strings.
# We call the original method and adjust the return value only if the argument to `get_inherited`
# is `FA.Opt` and if the return value is a list of two-element lists.
def monkeypatch_pydpf_method():
    from pypdf.generic import DictionaryObject
    from pypdf.constants import FieldDictionaryAttributes

    original_get_inherited = DictionaryObject.get_inherited

    def patched_get_inherited(self, key: str, default = None):
        result = original_get_inherited(self, key, default)
        if key == FieldDictionaryAttributes.Opt:
            if isinstance(result, list) and all(isinstance(v, list) and len(v) == 2 for v in result):
                result = [r[0] for r in result]
        return result

    DictionaryObject.get_inherited = patched_get_inherited


if __name__ == &quot;__main__&quot;:
    if len(sys.argv) != 4:
        print(&quot;Usage: fill_fillable_fields.py [input pdf] [field_values.json] [output pdf]&quot;)
        sys.exit(1)
    monkeypatch_pydpf_method()
    input_pdf = sys.argv[1]
    fields_json = sys.argv[2]
    output_pdf = sys.argv[3]
    fill_pdf_fields(input_pdf, fields_json, output_pdf)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/fill_fillable_fields/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/scripts/fill_fillable_fields.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="fill_pdf_form_with_annotations Imported skill fill_pdf_form_with_annotations from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pdf/scripts/fill_pdf_form_with_annotations.py Unknown LICENSE.txt sources/anthropic/fill_pdf_form_with_annotations/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">fill_pdf_form_with_annotations</div>
                <button class="copy-btn" onclick="copyToClipboard('fill_pdf_form_with_annotations')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill fill_pdf_form_with_annotations from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">import json
import sys

from pypdf import PdfReader, PdfWriter
from pypdf.annotations import FreeText


# Fills a PDF by adding text annotations defined in `fields.json`. See forms.md.


def transform_coordinates(bbox, image_width, image_height, pdf_width, pdf_height):
    &quot;&quot;&quot;Transform bounding box from image coordinates to PDF coordinates&quot;&quot;&quot;
    # Image coordinates: origin at top-left, y increases downward
    # PDF coordinates: origin at bottom-left, y increases upward
    x_scale = pdf_width / image_width
    y_scale = pdf_height / image_height
    
    left = bbox[0] * x_scale
    right = bbox[2] * x_scale
    
    # Flip Y coordinates for PDF
    top = pdf_height - (bbox[1] * y_scale)
    bottom = pdf_height - (bbox[3] * y_scale)
    
    return left, bottom, right, top


def fill_pdf_form(input_pdf_path, fields_json_path, output_pdf_path):
    &quot;&quot;&quot;Fill the PDF form with data from fields.json&quot;&quot;&quot;
    
    # `fields.json` format described in forms.md.
    with open(fields_json_path, &quot;r&quot;) as f:
        fields_data = json.load(f)
    
    # Open the PDF
    reader = PdfReader(input_pdf_path)
    writer = PdfWriter()
    
    # Copy all pages to writer
    writer.append(reader)
    
    # Get PDF dimensions for each page
    pdf_dimensions = {}
    for i, page in enumerate(reader.pages):
        mediabox = page.mediabox
        pdf_dimensions[i + 1] = [mediabox.width, mediabox.height]
    
    # Process each form field
    annotations = []
    for field in fields_data[&quot;form_fields&quot;]:
        page_num = field[&quot;page_number&quot;]
        
        # Get page dimensions and transform coordinates.
        page_info = next(p for p in fields_data[&quot;pages&quot;] if p[&quot;page_number&quot;] == page_num)
        image_width = page_info[&quot;image_width&quot;]
        image_height = page_info[&quot;image_height&quot;]
        pdf_width, pdf_height = pdf_dimensions[page_num]
        
        transformed_entry_box = transform_coordinates(
            field[&quot;entry_bounding_box&quot;],
            image_width, image_height,
            pdf_width, pdf_height
        )
        
        # Skip empty fields
        if &quot;entry_text&quot; not in field or &quot;text&quot; not in field[&quot;entry_text&quot;]:
            continue
        entry_text = field[&quot;entry_text&quot;]
        text = entry_text[&quot;text&quot;]
        if not text:
            continue
        
        font_name = entry_text.get(&quot;font&quot;, &quot;Arial&quot;)
        font_size = str(entry_text.get(&quot;font_size&quot;, 14)) + &quot;pt&quot;
        font_color = entry_text.get(&quot;font_color&quot;, &quot;000000&quot;)

        # Font size/color seems to not work reliably across viewers:
        # https://github.com/py-pdf/pypdf/issues/2084
        annotation = FreeText(
            text=text,
            rect=transformed_entry_box,
            font=font_name,
            font_size=font_size,
            font_color=font_color,
            border_color=None,
            background_color=None,
        )
        annotations.append(annotation)
        # page_number is 0-based for pypdf
        writer.add_annotation(page_number=page_num - 1, annotation=annotation)
        
    # Save the filled PDF
    with open(output_pdf_path, &quot;wb&quot;) as output:
        writer.write(output)
    
    print(f&quot;Successfully filled PDF form and saved to {output_pdf_path}&quot;)
    print(f&quot;Added {len(annotations)} text annotations&quot;)


if __name__ == &quot;__main__&quot;:
    if len(sys.argv) != 4:
        print(&quot;Usage: fill_pdf_form_with_annotations.py [input pdf] [fields.json] [output pdf]&quot;)
        sys.exit(1)
    input_pdf = sys.argv[1]
    fields_json = sys.argv[2]
    output_pdf = sys.argv[3]
    
    fill_pdf_form(input_pdf, fields_json, output_pdf)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/fill_pdf_form_with_annotations/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/scripts/fill_pdf_form_with_annotations.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="forest_canopy Imported skill forest_canopy from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/theme-factory/themes/forest-canopy.md Unknown LICENSE.txt sources/anthropic/forest_canopy/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">forest_canopy</div>
                <button class="copy-btn" onclick="copyToClipboard('forest_canopy')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill forest_canopy from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Forest Canopy

A natural and grounded theme featuring earth tones inspired by dense forest environments.

## Color Palette

- **Forest Green**: `#2d4a2b` - Primary dark green
- **Sage**: `#7d8471` - Muted green accent
- **Olive**: `#a4ac86` - Light accent color
- **Ivory**: `#faf9f6` - Backgrounds and text

## Typography

- **Headers**: FreeSerif Bold
- **Body Text**: FreeSans

## Best Used For

Environmental presentations, sustainability reports, outdoor brands, wellness content, organic products.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/forest_canopy/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/themes/forest-canopy.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="forms Imported skill forms from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pdf/forms.md Unknown LICENSE.txt sources/anthropic/forms/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">forms</div>
                <button class="copy-btn" onclick="copyToClipboard('forms')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill forms from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">**CRITICAL: You MUST complete these steps in order. Do not skip ahead to writing code.**

If you need to fill out a PDF form, first check to see if the PDF has fillable form fields. Run this script from this file&#x27;s directory:
 `python scripts/check_fillable_fields &lt;file.pdf&gt;`, and depending on the result go to either the &quot;Fillable fields&quot; or &quot;Non-fillable fields&quot; and follow those instructions.

# Fillable fields
If the PDF has fillable form fields:
- Run this script from this file&#x27;s directory: `python scripts/extract_form_field_info.py &lt;input.pdf&gt; &lt;field_info.json&gt;`. It will create a JSON file with a list of fields in this format:
```
[
  {
    &quot;field_id&quot;: (unique ID for the field),
    &quot;page&quot;: (page number, 1-based),
    &quot;rect&quot;: ([left, bottom, right, top] bounding box in PDF coordinates, y=0 is the bottom of the page),
    &quot;type&quot;: (&quot;text&quot;, &quot;checkbox&quot;, &quot;radio_group&quot;, or &quot;choice&quot;),
  },
  // Checkboxes have &quot;checked_value&quot; and &quot;unchecked_value&quot; properties:
  {
    &quot;field_id&quot;: (unique ID for the field),
    &quot;page&quot;: (page number, 1-based),
    &quot;type&quot;: &quot;checkbox&quot;,
    &quot;checked_value&quot;: (Set the field to this value to check the checkbox),
    &quot;unchecked_value&quot;: (Set the field to this value to uncheck the checkbox),
  },
  // Radio groups have a &quot;radio_options&quot; list with the possible choices.
  {
    &quot;field_id&quot;: (unique ID for the field),
    &quot;page&quot;: (page number, 1-based),
    &quot;type&quot;: &quot;radio_group&quot;,
    &quot;radio_options&quot;: [
      {
        &quot;value&quot;: (set the field to this value to select this radio option),
        &quot;rect&quot;: (bounding box for the radio button for this option)
      },
      // Other radio options
    ]
  },
  // Multiple choice fields have a &quot;choice_options&quot; list with the possible choices:
  {
    &quot;field_id&quot;: (unique ID for the field),
    &quot;page&quot;: (page number, 1-based),
    &quot;type&quot;: &quot;choice&quot;,
    &quot;choice_options&quot;: [
      {
        &quot;value&quot;: (set the field to this value to select this option),
        &quot;text&quot;: (display text of the option)
      },
      // Other choice options
    ],
  }
]
```
- Convert the PDF to PNGs (one image for each page) with this script (run from this file&#x27;s directory):
`python scripts/convert_pdf_to_images.py &lt;file.pdf&gt; &lt;output_directory&gt;`
Then analyze the images to determine the purpose of each form field (make sure to convert the bounding box PDF coordinates to image coordinates).
- Create a `field_values.json` file in this format with the values to be entered for each field:
```
[
  {
    &quot;field_id&quot;: &quot;last_name&quot;, // Must match the field_id from `extract_form_field_info.py`
    &quot;description&quot;: &quot;The user&#x27;s last name&quot;,
    &quot;page&quot;: 1, // Must match the &quot;page&quot; value in field_info.json
    &quot;value&quot;: &quot;Simpson&quot;
  },
  {
    &quot;field_id&quot;: &quot;Checkbox12&quot;,
    &quot;description&quot;: &quot;Checkbox to be checked if the user is 18 or over&quot;,
    &quot;page&quot;: 1,
    &quot;value&quot;: &quot;/On&quot; // If this is a checkbox, use its &quot;checked_value&quot; value to check it. If it&#x27;s a radio button group, use one of the &quot;value&quot; values in &quot;radio_options&quot;.
  },
  // more fields
]
```
- Run the `fill_fillable_fields.py` script from this file&#x27;s directory to create a filled-in PDF:
`python scripts/fill_fillable_fields.py &lt;input pdf&gt; &lt;field_values.json&gt; &lt;output pdf&gt;`
This script will verify that the field IDs and values you provide are valid; if it prints error messages, correct the appropriate fields and try again.

# Non-fillable fields
If the PDF doesn&#x27;t have fillable form fields, you&#x27;ll need to visually determine where the data should be added and create text annotations. Follow the below steps *exactly*. You MUST perform all of these steps to ensure that the the form is accurately completed. Details for each step are below.
- Convert the PDF to PNG images and determine field bounding boxes.
- Create a JSON file with field information and validation images showing the bounding boxes.
- Validate the the bounding boxes.
- Use the bounding boxes to fill in the form.

## Step 1: Visual Analysis (REQUIRED)
- Convert the PDF to PNG images. Run this script from this file&#x27;s directory:
`python scripts/convert_pdf_to_images.py &lt;file.pdf&gt; &lt;output_directory&gt;`
The script will create a PNG image for each page in the PDF.
- Carefully examine each PNG image and identify all form fields and areas where the user should enter data. For each form field where the user should enter text, determine bounding boxes for both the form field label, and the area where the user should enter text. The label and entry bounding boxes MUST NOT INTERSECT; the text entry box should only include the area where data should be entered. Usually this area will be immediately to the side, above, or below its label. Entry bounding boxes must be tall and wide enough to contain their text.

These are some examples of form structures that you might see:

*Label inside box*
```

 Name:                  

```
The input area should be to the right of the &quot;Name&quot; label and extend to the edge of the box.

*Label before line*
```
Email: _______________________
```
The input area should be above the line and include its entire width.

*Label under line*
```
_________________________
Name
```
The input area should be above the line and include the entire width of the line. This is common for signature and date fields.

*Label above line*
```
Please enter any special requests:
________________________________________________
```
The input area should extend from the bottom of the label to the line, and should include the entire width of the line.

*Checkboxes*
```
Are you a US citizen? Yes   No 
```
For checkboxes:
- Look for small square boxes () - these are the actual checkboxes to target. They may be to the left or right of their labels.
- Distinguish between label text (&quot;Yes&quot;, &quot;No&quot;) and the clickable checkbox squares.
- The entry bounding box should cover ONLY the small square, not the text label.

### Step 2: Create fields.json and validation images (REQUIRED)
- Create a file named `fields.json` with information for the form fields and bounding boxes in this format:
```
{
  &quot;pages&quot;: [
    {
      &quot;page_number&quot;: 1,
      &quot;image_width&quot;: (first page image width in pixels),
      &quot;image_height&quot;: (first page image height in pixels),
    },
    {
      &quot;page_number&quot;: 2,
      &quot;image_width&quot;: (second page image width in pixels),
      &quot;image_height&quot;: (second page image height in pixels),
    }
    // additional pages
  ],
  &quot;form_fields&quot;: [
    // Example for a text field.
    {
      &quot;page_number&quot;: 1,
      &quot;description&quot;: &quot;The user&#x27;s last name should be entered here&quot;,
      // Bounding boxes are [left, top, right, bottom]. The bounding boxes for the label and text entry should not overlap.
      &quot;field_label&quot;: &quot;Last name&quot;,
      &quot;label_bounding_box&quot;: [30, 125, 95, 142],
      &quot;entry_bounding_box&quot;: [100, 125, 280, 142],
      &quot;entry_text&quot;: {
        &quot;text&quot;: &quot;Johnson&quot;, // This text will be added as an annotation at the entry_bounding_box location
        &quot;font_size&quot;: 14, // optional, defaults to 14
        &quot;font_color&quot;: &quot;000000&quot;, // optional, RRGGBB format, defaults to 000000 (black)
      }
    },
    // Example for a checkbox. TARGET THE SQUARE for the entry bounding box, NOT THE TEXT
    {
      &quot;page_number&quot;: 2,
      &quot;description&quot;: &quot;Checkbox that should be checked if the user is over 18&quot;,
      &quot;entry_bounding_box&quot;: [140, 525, 155, 540],  // Small box over checkbox square
      &quot;field_label&quot;: &quot;Yes&quot;,
      &quot;label_bounding_box&quot;: [100, 525, 132, 540],  // Box containing &quot;Yes&quot; text
      // Use &quot;X&quot; to check a checkbox.
      &quot;entry_text&quot;: {
        &quot;text&quot;: &quot;X&quot;,
      }
    }
    // additional form field entries
  ]
}
```

Create validation images by running this script from this file&#x27;s directory for each page:
`python scripts/create_validation_image.py &lt;page_number&gt; &lt;path_to_fields.json&gt; &lt;input_image_path&gt; &lt;output_image_path&gt;

The validation images will have red rectangles where text should be entered, and blue rectangles covering label text.

### Step 3: Validate Bounding Boxes (REQUIRED)
#### Automated intersection check
- Verify that none of bounding boxes intersect and that the entry bounding boxes are tall enough by checking the fields.json file with the `check_bounding_boxes.py` script (run from this file&#x27;s directory):
`python scripts/check_bounding_boxes.py &lt;JSON file&gt;`

If there are errors, reanalyze the relevant fields, adjust the bounding boxes, and iterate until there are no remaining errors. Remember: label (blue) bounding boxes should contain text labels, entry (red) boxes should not.

#### Manual image inspection
**CRITICAL: Do not proceed without visually inspecting validation images**
- Red rectangles must ONLY cover input areas
- Red rectangles MUST NOT contain any text
- Blue rectangles should contain label text
- For checkboxes:
  - Red rectangle MUST be centered on the checkbox square
  - Blue rectangle should cover the text label for the checkbox

- If any rectangles look wrong, fix fields.json, regenerate the validation images, and verify again. Repeat this process until the bounding boxes are fully accurate.


### Step 4: Add annotations to the PDF
Run this script from this file&#x27;s directory to create a filled-out PDF using the information in fields.json:
`python scripts/fill_pdf_form_with_annotations.py &lt;input_pdf_path&gt; &lt;path_to_fields.json&gt; &lt;output_pdf_path&gt;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/forms/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/forms.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="frame_composer Imported skill frame_composer from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/slack-gif-creator/core/frame_composer.py Unknown LICENSE.txt sources/anthropic/frame_composer/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">frame_composer</div>
                <button class="copy-btn" onclick="copyToClipboard('frame_composer')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill frame_composer from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Frame Composer - Utilities for composing visual elements into frames.

Provides functions for drawing shapes, text, emojis, and compositing elements
together to create animation frames.
&quot;&quot;&quot;

from typing import Optional

import numpy as np
from PIL import Image, ImageDraw, ImageFont


def create_blank_frame(
    width: int, height: int, color: tuple[int, int, int] = (255, 255, 255)
) -&gt; Image.Image:
    &quot;&quot;&quot;
    Create a blank frame with solid color background.

    Args:
        width: Frame width
        height: Frame height
        color: RGB color tuple (default: white)

    Returns:
        PIL Image
    &quot;&quot;&quot;
    return Image.new(&quot;RGB&quot;, (width, height), color)


def draw_circle(
    frame: Image.Image,
    center: tuple[int, int],
    radius: int,
    fill_color: Optional[tuple[int, int, int]] = None,
    outline_color: Optional[tuple[int, int, int]] = None,
    outline_width: int = 1,
) -&gt; Image.Image:
    &quot;&quot;&quot;
    Draw a circle on a frame.

    Args:
        frame: PIL Image to draw on
        center: (x, y) center position
        radius: Circle radius
        fill_color: RGB fill color (None for no fill)
        outline_color: RGB outline color (None for no outline)
        outline_width: Outline width in pixels

    Returns:
        Modified frame
    &quot;&quot;&quot;
    draw = ImageDraw.Draw(frame)
    x, y = center
    bbox = [x - radius, y - radius, x + radius, y + radius]
    draw.ellipse(bbox, fill=fill_color, outline=outline_color, width=outline_width)
    return frame


def draw_text(
    frame: Image.Image,
    text: str,
    position: tuple[int, int],
    color: tuple[int, int, int] = (0, 0, 0),
    centered: bool = False,
) -&gt; Image.Image:
    &quot;&quot;&quot;
    Draw text on a frame.

    Args:
        frame: PIL Image to draw on
        text: Text to draw
        position: (x, y) position (top-left unless centered=True)
        color: RGB text color
        centered: If True, center text at position

    Returns:
        Modified frame
    &quot;&quot;&quot;
    draw = ImageDraw.Draw(frame)

    # Uses Pillow&#x27;s default font.
    # If the font should be changed for the emoji, add additional logic here.
    font = ImageFont.load_default()

    if centered:
        bbox = draw.textbbox((0, 0), text, font=font)
        text_width = bbox[2] - bbox[0]
        text_height = bbox[3] - bbox[1]
        x = position[0] - text_width // 2
        y = position[1] - text_height // 2
        position = (x, y)

    draw.text(position, text, fill=color, font=font)
    return frame


def create_gradient_background(
    width: int,
    height: int,
    top_color: tuple[int, int, int],
    bottom_color: tuple[int, int, int],
) -&gt; Image.Image:
    &quot;&quot;&quot;
    Create a vertical gradient background.

    Args:
        width: Frame width
        height: Frame height
        top_color: RGB color at top
        bottom_color: RGB color at bottom

    Returns:
        PIL Image with gradient
    &quot;&quot;&quot;
    frame = Image.new(&quot;RGB&quot;, (width, height))
    draw = ImageDraw.Draw(frame)

    # Calculate color step for each row
    r1, g1, b1 = top_color
    r2, g2, b2 = bottom_color

    for y in range(height):
        # Interpolate color
        ratio = y / height
        r = int(r1 * (1 - ratio) + r2 * ratio)
        g = int(g1 * (1 - ratio) + g2 * ratio)
        b = int(b1 * (1 - ratio) + b2 * ratio)

        # Draw horizontal line
        draw.line([(0, y), (width, y)], fill=(r, g, b))

    return frame


def draw_star(
    frame: Image.Image,
    center: tuple[int, int],
    size: int,
    fill_color: tuple[int, int, int],
    outline_color: Optional[tuple[int, int, int]] = None,
    outline_width: int = 1,
) -&gt; Image.Image:
    &quot;&quot;&quot;
    Draw a 5-pointed star.

    Args:
        frame: PIL Image to draw on
        center: (x, y) center position
        size: Star size (outer radius)
        fill_color: RGB fill color
        outline_color: RGB outline color (None for no outline)
        outline_width: Outline width

    Returns:
        Modified frame
    &quot;&quot;&quot;
    import math

    draw = ImageDraw.Draw(frame)
    x, y = center

    # Calculate star points
    points = []
    for i in range(10):
        angle = (i * 36 - 90) * math.pi / 180  # 36 degrees per point, start at top
        radius = size if i % 2 == 0 else size * 0.4  # Alternate between outer and inner
        px = x + radius * math.cos(angle)
        py = y + radius * math.sin(angle)
        points.append((px, py))

    # Draw star
    draw.polygon(points, fill=fill_color, outline=outline_color, width=outline_width)

    return frame</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/frame_composer/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/slack-gif-creator/core/frame_composer.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/slack-gif-creator/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="geistmono_ofl Imported skill geistmono_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/GeistMono-OFL.txt Unknown LICENSE.txt sources/anthropic/geistmono_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">geistmono_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('geistmono_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill geistmono_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2024 The Geist Project Authors (https://github.com/vercel/geist-font.git)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/geistmono_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/GeistMono-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="general_comms Imported skill general_comms from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/internal-comms/examples/general-comms.md Unknown LICENSE.txt sources/anthropic/general_comms/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">general_comms</div>
                <button class="copy-btn" onclick="copyToClipboard('general_comms')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill general_comms from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">## Instructions
  You are being asked to write internal company communication that doesn&#x27;t fit into the standard formats (3P
  updates, newsletters, or FAQs).

  Before proceeding:
  1. Ask the user about their target audience
  2. Understand the communication&#x27;s purpose
  3. Clarify the desired tone (formal, casual, urgent, informational)
  4. Confirm any specific formatting requirements

  Use these general principles:
  - Be clear and concise
  - Use active voice
  - Put the most important information first
  - Include relevant links and references
  - Match the company&#x27;s communication style</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/general_comms/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/internal-comms/examples/general-comms.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/internal-comms/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="generator_template Imported skill generator_template from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/algorithmic-art/templates/generator_template.js Unknown LICENSE.txt sources/anthropic/generator_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">generator_template</div>
                <button class="copy-btn" onclick="copyToClipboard('generator_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill generator_template from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">/**
 * 
 *                  P5.JS GENERATIVE ART - BEST PRACTICES
 * 
 *
 * This file shows STRUCTURE and PRINCIPLES for p5.js generative art.
 * It does NOT prescribe what art you should create.
 *
 * Your algorithmic philosophy should guide what you build.
 * These are just best practices for how to structure your code.
 *
 * 
 */

// ============================================================================
// 1. PARAMETER ORGANIZATION
// ============================================================================
// Keep all tunable parameters in one object
// This makes it easy to:
// - Connect to UI controls
// - Reset to defaults
// - Serialize/save configurations

let params = {
    // Define parameters that match YOUR algorithm
    // Examples (customize for your art):
    // - Counts: how many elements (particles, circles, branches, etc.)
    // - Scales: size, speed, spacing
    // - Probabilities: likelihood of events
    // - Angles: rotation, direction
    // - Colors: palette arrays

    seed: 12345,
    // define colorPalette as an array -- choose whatever colors you&#x27;d like [&#x27;#d97757&#x27;, &#x27;#6a9bcc&#x27;, &#x27;#788c5d&#x27;, &#x27;#b0aea5&#x27;]
    // Add YOUR parameters here based on your algorithm
};

// ============================================================================
// 2. SEEDED RANDOMNESS (Critical for reproducibility)
// ============================================================================
// ALWAYS use seeded random for Art Blocks-style reproducible output

function initializeSeed(seed) {
    randomSeed(seed);
    noiseSeed(seed);
    // Now all random() and noise() calls will be deterministic
}

// ============================================================================
// 3. P5.JS LIFECYCLE
// ============================================================================

function setup() {
    createCanvas(800, 800);

    // Initialize seed first
    initializeSeed(params.seed);

    // Set up your generative system
    // This is where you initialize:
    // - Arrays of objects
    // - Grid structures
    // - Initial positions
    // - Starting states

    // For static art: call noLoop() at the end of setup
    // For animated art: let draw() keep running
}

function draw() {
    // Option 1: Static generation (runs once, then stops)
    // - Generate everything in setup()
    // - Call noLoop() in setup()
    // - draw() doesn&#x27;t do much or can be empty

    // Option 2: Animated generation (continuous)
    // - Update your system each frame
    // - Common patterns: particle movement, growth, evolution
    // - Can optionally call noLoop() after N frames

    // Option 3: User-triggered regeneration
    // - Use noLoop() by default
    // - Call redraw() when parameters change
}

// ============================================================================
// 4. CLASS STRUCTURE (When you need objects)
// ============================================================================
// Use classes when your algorithm involves multiple entities
// Examples: particles, agents, cells, nodes, etc.

class Entity {
    constructor() {
        // Initialize entity properties
        // Use random() here - it will be seeded
    }

    update() {
        // Update entity state
        // This might involve:
        // - Physics calculations
        // - Behavioral rules
        // - Interactions with neighbors
    }

    display() {
        // Render the entity
        // Keep rendering logic separate from update logic
    }
}

// ============================================================================
// 5. PERFORMANCE CONSIDERATIONS
// ============================================================================

// For large numbers of elements:
// - Pre-calculate what you can
// - Use simple collision detection (spatial hashing if needed)
// - Limit expensive operations (sqrt, trig) when possible
// - Consider using p5 vectors efficiently

// For smooth animation:
// - Aim for 60fps
// - Profile if things are slow
// - Consider reducing particle counts or simplifying calculations

// ============================================================================
// 6. UTILITY FUNCTIONS
// ============================================================================

// Color utilities
function hexToRgb(hex) {
    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
    } : null;
}

function colorFromPalette(index) {
    return params.colorPalette[index % params.colorPalette.length];
}

// Mapping and easing
function mapRange(value, inMin, inMax, outMin, outMax) {
    return outMin + (outMax - outMin) * ((value - inMin) / (inMax - inMin));
}

function easeInOutCubic(t) {
    return t &lt; 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
}

// Constrain to bounds
function wrapAround(value, max) {
    if (value &lt; 0) return max;
    if (value &gt; max) return 0;
    return value;
}

// ============================================================================
// 7. PARAMETER UPDATES (Connect to UI)
// ============================================================================

function updateParameter(paramName, value) {
    params[paramName] = value;
    // Decide if you need to regenerate or just update
    // Some params can update in real-time, others need full regeneration
}

function regenerate() {
    // Reinitialize your generative system
    // Useful when parameters change significantly
    initializeSeed(params.seed);
    // Then regenerate your system
}

// ============================================================================
// 8. COMMON P5.JS PATTERNS
// ============================================================================

// Drawing with transparency for trails/fading
function fadeBackground(opacity) {
    fill(250, 249, 245, opacity); // Anthropic light with alpha
    noStroke();
    rect(0, 0, width, height);
}

// Using noise for organic variation
function getNoiseValue(x, y, scale = 0.01) {
    return noise(x * scale, y * scale);
}

// Creating vectors from angles
function vectorFromAngle(angle, magnitude = 1) {
    return createVector(cos(angle), sin(angle)).mult(magnitude);
}

// ============================================================================
// 9. EXPORT FUNCTIONS
// ============================================================================

function exportImage() {
    saveCanvas(&#x27;generative-art-&#x27; + params.seed, &#x27;png&#x27;);
}

// ============================================================================
// REMEMBER
// ============================================================================
//
// These are TOOLS and PRINCIPLES, not a recipe.
// Your algorithmic philosophy should guide WHAT you create.
// This structure helps you create it WELL.
//
// Focus on:
// - Clean, readable code
// - Parameterized for exploration
// - Seeded for reproducibility
// - Performant execution
//
// The art itself is entirely up to you!
//
// ============================================================================</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/generator_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/algorithmic-art/templates/generator_template.js" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/algorithmic-art/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="gif_builder Imported skill gif_builder from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/slack-gif-creator/core/gif_builder.py Unknown LICENSE.txt sources/anthropic/gif_builder/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">gif_builder</div>
                <button class="copy-btn" onclick="copyToClipboard('gif_builder')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill gif_builder from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
GIF Builder - Core module for assembling frames into GIFs optimized for Slack.

This module provides the main interface for creating GIFs from programmatically
generated frames, with automatic optimization for Slack&#x27;s requirements.
&quot;&quot;&quot;

from pathlib import Path
from typing import Optional

import imageio.v3 as imageio
import numpy as np
from PIL import Image


class GIFBuilder:
    &quot;&quot;&quot;Builder for creating optimized GIFs from frames.&quot;&quot;&quot;

    def __init__(self, width: int = 480, height: int = 480, fps: int = 15):
        &quot;&quot;&quot;
        Initialize GIF builder.

        Args:
            width: Frame width in pixels
            height: Frame height in pixels
            fps: Frames per second
        &quot;&quot;&quot;
        self.width = width
        self.height = height
        self.fps = fps
        self.frames: list[np.ndarray] = []

    def add_frame(self, frame: np.ndarray | Image.Image):
        &quot;&quot;&quot;
        Add a frame to the GIF.

        Args:
            frame: Frame as numpy array or PIL Image (will be converted to RGB)
        &quot;&quot;&quot;
        if isinstance(frame, Image.Image):
            frame = np.array(frame.convert(&quot;RGB&quot;))

        # Ensure frame is correct size
        if frame.shape[:2] != (self.height, self.width):
            pil_frame = Image.fromarray(frame)
            pil_frame = pil_frame.resize(
                (self.width, self.height), Image.Resampling.LANCZOS
            )
            frame = np.array(pil_frame)

        self.frames.append(frame)

    def add_frames(self, frames: list[np.ndarray | Image.Image]):
        &quot;&quot;&quot;Add multiple frames at once.&quot;&quot;&quot;
        for frame in frames:
            self.add_frame(frame)

    def optimize_colors(
        self, num_colors: int = 128, use_global_palette: bool = True
    ) -&gt; list[np.ndarray]:
        &quot;&quot;&quot;
        Reduce colors in all frames using quantization.

        Args:
            num_colors: Target number of colors (8-256)
            use_global_palette: Use a single palette for all frames (better compression)

        Returns:
            List of color-optimized frames
        &quot;&quot;&quot;
        optimized = []

        if use_global_palette and len(self.frames) &gt; 1:
            # Create a global palette from all frames
            # Sample frames to build palette
            sample_size = min(5, len(self.frames))
            sample_indices = [
                int(i * len(self.frames) / sample_size) for i in range(sample_size)
            ]
            sample_frames = [self.frames[i] for i in sample_indices]

            # Combine sample frames into a single image for palette generation
            # Flatten each frame to get all pixels, then stack them
            all_pixels = np.vstack(
                [f.reshape(-1, 3) for f in sample_frames]
            )  # (total_pixels, 3)

            # Create a properly-shaped RGB image from the pixel data
            # We&#x27;ll make a roughly square image from all the pixels
            total_pixels = len(all_pixels)
            width = min(512, int(np.sqrt(total_pixels)))  # Reasonable width, max 512
            height = (total_pixels + width - 1) // width  # Ceiling division

            # Pad if necessary to fill the rectangle
            pixels_needed = width * height
            if pixels_needed &gt; total_pixels:
                padding = np.zeros((pixels_needed - total_pixels, 3), dtype=np.uint8)
                all_pixels = np.vstack([all_pixels, padding])

            # Reshape to proper RGB image format (H, W, 3)
            img_array = (
                all_pixels[:pixels_needed].reshape(height, width, 3).astype(np.uint8)
            )
            combined_img = Image.fromarray(img_array, mode=&quot;RGB&quot;)

            # Generate global palette
            global_palette = combined_img.quantize(colors=num_colors, method=2)

            # Apply global palette to all frames
            for frame in self.frames:
                pil_frame = Image.fromarray(frame)
                quantized = pil_frame.quantize(palette=global_palette, dither=1)
                optimized.append(np.array(quantized.convert(&quot;RGB&quot;)))
        else:
            # Use per-frame quantization
            for frame in self.frames:
                pil_frame = Image.fromarray(frame)
                quantized = pil_frame.quantize(colors=num_colors, method=2, dither=1)
                optimized.append(np.array(quantized.convert(&quot;RGB&quot;)))

        return optimized

    def deduplicate_frames(self, threshold: float = 0.9995) -&gt; int:
        &quot;&quot;&quot;
        Remove duplicate or near-duplicate consecutive frames.

        Args:
            threshold: Similarity threshold (0.0-1.0). Higher = more strict (0.9995 = nearly identical).
                      Use 0.9995+ to preserve subtle animations, 0.98 for aggressive removal.

        Returns:
            Number of frames removed
        &quot;&quot;&quot;
        if len(self.frames) &lt; 2:
            return 0

        deduplicated = [self.frames[0]]
        removed_count = 0

        for i in range(1, len(self.frames)):
            # Compare with previous frame
            prev_frame = np.array(deduplicated[-1], dtype=np.float32)
            curr_frame = np.array(self.frames[i], dtype=np.float32)

            # Calculate similarity (normalized)
            diff = np.abs(prev_frame - curr_frame)
            similarity = 1.0 - (np.mean(diff) / 255.0)

            # Keep frame if sufficiently different
            # High threshold (0.9995+) means only remove nearly identical frames
            if similarity &lt; threshold:
                deduplicated.append(self.frames[i])
            else:
                removed_count += 1

        self.frames = deduplicated
        return removed_count

    def save(
        self,
        output_path: str | Path,
        num_colors: int = 128,
        optimize_for_emoji: bool = False,
        remove_duplicates: bool = False,
    ) -&gt; dict:
        &quot;&quot;&quot;
        Save frames as optimized GIF for Slack.

        Args:
            output_path: Where to save the GIF
            num_colors: Number of colors to use (fewer = smaller file)
            optimize_for_emoji: If True, optimize for emoji size (128x128, fewer colors)
            remove_duplicates: If True, remove duplicate consecutive frames (opt-in)

        Returns:
            Dictionary with file info (path, size, dimensions, frame_count)
        &quot;&quot;&quot;
        if not self.frames:
            raise ValueError(&quot;No frames to save. Add frames with add_frame() first.&quot;)

        output_path = Path(output_path)

        # Remove duplicate frames to reduce file size
        if remove_duplicates:
            removed = self.deduplicate_frames(threshold=0.9995)
            if removed &gt; 0:
                print(
                    f&quot;  Removed {removed} nearly identical frames (preserved subtle animations)&quot;
                )

        # Optimize for emoji if requested
        if optimize_for_emoji:
            if self.width &gt; 128 or self.height &gt; 128:
                print(
                    f&quot;  Resizing from {self.width}x{self.height} to 128x128 for emoji&quot;
                )
                self.width = 128
                self.height = 128
                # Resize all frames
                resized_frames = []
                for frame in self.frames:
                    pil_frame = Image.fromarray(frame)
                    pil_frame = pil_frame.resize((128, 128), Image.Resampling.LANCZOS)
                    resized_frames.append(np.array(pil_frame))
                self.frames = resized_frames
            num_colors = min(num_colors, 48)  # More aggressive color limit for emoji

            # More aggressive FPS reduction for emoji
            if len(self.frames) &gt; 12:
                print(
                    f&quot;  Reducing frames from {len(self.frames)} to ~12 for emoji size&quot;
                )
                # Keep every nth frame to get close to 12 frames
                keep_every = max(1, len(self.frames) // 12)
                self.frames = [
                    self.frames[i] for i in range(0, len(self.frames), keep_every)
                ]

        # Optimize colors with global palette
        optimized_frames = self.optimize_colors(num_colors, use_global_palette=True)

        # Calculate frame duration in milliseconds
        frame_duration = 1000 / self.fps

        # Save GIF
        imageio.imwrite(
            output_path,
            optimized_frames,
            duration=frame_duration,
            loop=0,  # Infinite loop
        )

        # Get file info
        file_size_kb = output_path.stat().st_size / 1024
        file_size_mb = file_size_kb / 1024

        info = {
            &quot;path&quot;: str(output_path),
            &quot;size_kb&quot;: file_size_kb,
            &quot;size_mb&quot;: file_size_mb,
            &quot;dimensions&quot;: f&quot;{self.width}x{self.height}&quot;,
            &quot;frame_count&quot;: len(optimized_frames),
            &quot;fps&quot;: self.fps,
            &quot;duration_seconds&quot;: len(optimized_frames) / self.fps,
            &quot;colors&quot;: num_colors,
        }

        # Print info
        print(f&quot;\n GIF created successfully!&quot;)
        print(f&quot;  Path: {output_path}&quot;)
        print(f&quot;  Size: {file_size_kb:.1f} KB ({file_size_mb:.2f} MB)&quot;)
        print(f&quot;  Dimensions: {self.width}x{self.height}&quot;)
        print(f&quot;  Frames: {len(optimized_frames)} @ {self.fps} fps&quot;)
        print(f&quot;  Duration: {info[&#x27;duration_seconds&#x27;]:.1f}s&quot;)
        print(f&quot;  Colors: {num_colors}&quot;)

        # Size info
        if optimize_for_emoji:
            print(f&quot;  Optimized for emoji (128x128, reduced colors)&quot;)
        if file_size_mb &gt; 1.0:
            print(f&quot;\n  Note: Large file size ({file_size_kb:.1f} KB)&quot;)
            print(&quot;  Consider: fewer frames, smaller dimensions, or fewer colors&quot;)

        return info

    def clear(self):
        &quot;&quot;&quot;Clear all frames (useful for creating multiple GIFs).&quot;&quot;&quot;
        self.frames = []</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/gif_builder/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/slack-gif-creator/core/gif_builder.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/slack-gif-creator/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="gloock_ofl Imported skill gloock_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/Gloock-OFL.txt Unknown LICENSE.txt sources/anthropic/gloock_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">gloock_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('gloock_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill gloock_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2022 The Gloock Project Authors (https://github.com/duartp/gloock)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/gloock_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/Gloock-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="golden_hour Imported skill golden_hour from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/theme-factory/themes/golden-hour.md Unknown LICENSE.txt sources/anthropic/golden_hour/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">golden_hour</div>
                <button class="copy-btn" onclick="copyToClipboard('golden_hour')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill golden_hour from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Golden Hour

A rich and warm autumnal palette that creates an inviting and sophisticated atmosphere.

## Color Palette

- **Mustard Yellow**: `#f4a900` - Bold primary accent
- **Terracotta**: `#c1666b` - Warm secondary color
- **Warm Beige**: `#d4b896` - Neutral backgrounds
- **Chocolate Brown**: `#4a403a` - Dark text and anchors

## Typography

- **Headers**: FreeSans Bold
- **Body Text**: FreeSans

## Best Used For

Restaurant presentations, hospitality brands, fall campaigns, cozy lifestyle content, artisan products.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/golden_hour/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/themes/golden-hour.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="html2pptx Imported skill html2pptx from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/scripts/html2pptx.js Unknown LICENSE.txt sources/anthropic/html2pptx/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">html2pptx</div>
                <button class="copy-btn" onclick="copyToClipboard('html2pptx')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill html2pptx from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">/**
 * html2pptx - Convert HTML slide to pptxgenjs slide with positioned elements
 *
 * USAGE:
 *   const pptx = new pptxgen();
 *   pptx.layout = &#x27;LAYOUT_16x9&#x27;;  // Must match HTML body dimensions
 *
 *   const { slide, placeholders } = await html2pptx(&#x27;slide.html&#x27;, pptx);
 *   slide.addChart(pptx.charts.LINE, data, placeholders[0]);
 *
 *   await pptx.writeFile(&#x27;output.pptx&#x27;);
 *
 * FEATURES:
 *   - Converts HTML to PowerPoint with accurate positioning
 *   - Supports text, images, shapes, and bullet lists
 *   - Extracts placeholder elements (class=&quot;placeholder&quot;) with positions
 *   - Handles CSS gradients, borders, and margins
 *
 * VALIDATION:
 *   - Uses body width/height from HTML for viewport sizing
 *   - Throws error if HTML dimensions don&#x27;t match presentation layout
 *   - Throws error if content overflows body (with overflow details)
 *
 * RETURNS:
 *   { slide, placeholders } where placeholders is an array of { id, x, y, w, h }
 */

const { chromium } = require(&#x27;playwright&#x27;);
const path = require(&#x27;path&#x27;);
const sharp = require(&#x27;sharp&#x27;);

const PT_PER_PX = 0.75;
const PX_PER_IN = 96;
const EMU_PER_IN = 914400;

// Helper: Get body dimensions and check for overflow
async function getBodyDimensions(page) {
  const bodyDimensions = await page.evaluate(() =&gt; {
    const body = document.body;
    const style = window.getComputedStyle(body);

    return {
      width: parseFloat(style.width),
      height: parseFloat(style.height),
      scrollWidth: body.scrollWidth,
      scrollHeight: body.scrollHeight
    };
  });

  const errors = [];
  const widthOverflowPx = Math.max(0, bodyDimensions.scrollWidth - bodyDimensions.width - 1);
  const heightOverflowPx = Math.max(0, bodyDimensions.scrollHeight - bodyDimensions.height - 1);

  const widthOverflowPt = widthOverflowPx * PT_PER_PX;
  const heightOverflowPt = heightOverflowPx * PT_PER_PX;

  if (widthOverflowPt &gt; 0 || heightOverflowPt &gt; 0) {
    const directions = [];
    if (widthOverflowPt &gt; 0) directions.push(`${widthOverflowPt.toFixed(1)}pt horizontally`);
    if (heightOverflowPt &gt; 0) directions.push(`${heightOverflowPt.toFixed(1)}pt vertically`);
    const reminder = heightOverflowPt &gt; 0 ? &#x27; (Remember: leave 0.5&quot; margin at bottom of slide)&#x27; : &#x27;&#x27;;
    errors.push(`HTML content overflows body by ${directions.join(&#x27; and &#x27;)}${reminder}`);
  }

  return { ...bodyDimensions, errors };
}

// Helper: Validate dimensions match presentation layout
function validateDimensions(bodyDimensions, pres) {
  const errors = [];
  const widthInches = bodyDimensions.width / PX_PER_IN;
  const heightInches = bodyDimensions.height / PX_PER_IN;

  if (pres.presLayout) {
    const layoutWidth = pres.presLayout.width / EMU_PER_IN;
    const layoutHeight = pres.presLayout.height / EMU_PER_IN;

    if (Math.abs(layoutWidth - widthInches) &gt; 0.1 || Math.abs(layoutHeight - heightInches) &gt; 0.1) {
      errors.push(
        `HTML dimensions (${widthInches.toFixed(1)}&quot;  ${heightInches.toFixed(1)}&quot;) ` +
        `don&#x27;t match presentation layout (${layoutWidth.toFixed(1)}&quot;  ${layoutHeight.toFixed(1)}&quot;)`
      );
    }
  }
  return errors;
}

function validateTextBoxPosition(slideData, bodyDimensions) {
  const errors = [];
  const slideHeightInches = bodyDimensions.height / PX_PER_IN;
  const minBottomMargin = 0.5; // 0.5 inches from bottom

  for (const el of slideData.elements) {
    // Check text elements (p, h1-h6, list)
    if ([&#x27;p&#x27;, &#x27;h1&#x27;, &#x27;h2&#x27;, &#x27;h3&#x27;, &#x27;h4&#x27;, &#x27;h5&#x27;, &#x27;h6&#x27;, &#x27;list&#x27;].includes(el.type)) {
      const fontSize = el.style?.fontSize || 0;
      const bottomEdge = el.position.y + el.position.h;
      const distanceFromBottom = slideHeightInches - bottomEdge;

      if (fontSize &gt; 12 &amp;&amp; distanceFromBottom &lt; minBottomMargin) {
        const getText = () =&gt; {
          if (typeof el.text === &#x27;string&#x27;) return el.text;
          if (Array.isArray(el.text)) return el.text.find(t =&gt; t.text)?.text || &#x27;&#x27;;
          if (Array.isArray(el.items)) return el.items.find(item =&gt; item.text)?.text || &#x27;&#x27;;
          return &#x27;&#x27;;
        };
        const textPrefix = getText().substring(0, 50) + (getText().length &gt; 50 ? &#x27;...&#x27; : &#x27;&#x27;);

        errors.push(
          `Text box &quot;${textPrefix}&quot; ends too close to bottom edge ` +
          `(${distanceFromBottom.toFixed(2)}&quot; from bottom, minimum ${minBottomMargin}&quot; required)`
        );
      }
    }
  }

  return errors;
}

// Helper: Add background to slide
async function addBackground(slideData, targetSlide, tmpDir) {
  if (slideData.background.type === &#x27;image&#x27; &amp;&amp; slideData.background.path) {
    let imagePath = slideData.background.path.startsWith(&#x27;file://&#x27;)
      ? slideData.background.path.replace(&#x27;file://&#x27;, &#x27;&#x27;)
      : slideData.background.path;
    targetSlide.background = { path: imagePath };
  } else if (slideData.background.type === &#x27;color&#x27; &amp;&amp; slideData.background.value) {
    targetSlide.background = { color: slideData.background.value };
  }
}

// Helper: Add elements to slide
function addElements(slideData, targetSlide, pres) {
  for (const el of slideData.elements) {
    if (el.type === &#x27;image&#x27;) {
      let imagePath = el.src.startsWith(&#x27;file://&#x27;) ? el.src.replace(&#x27;file://&#x27;, &#x27;&#x27;) : el.src;
      targetSlide.addImage({
        path: imagePath,
        x: el.position.x,
        y: el.position.y,
        w: el.position.w,
        h: el.position.h
      });
    } else if (el.type === &#x27;line&#x27;) {
      targetSlide.addShape(pres.ShapeType.line, {
        x: el.x1,
        y: el.y1,
        w: el.x2 - el.x1,
        h: el.y2 - el.y1,
        line: { color: el.color, width: el.width }
      });
    } else if (el.type === &#x27;shape&#x27;) {
      const shapeOptions = {
        x: el.position.x,
        y: el.position.y,
        w: el.position.w,
        h: el.position.h,
        shape: el.shape.rectRadius &gt; 0 ? pres.ShapeType.roundRect : pres.ShapeType.rect
      };

      if (el.shape.fill) {
        shapeOptions.fill = { color: el.shape.fill };
        if (el.shape.transparency != null) shapeOptions.fill.transparency = el.shape.transparency;
      }
      if (el.shape.line) shapeOptions.line = el.shape.line;
      if (el.shape.rectRadius &gt; 0) shapeOptions.rectRadius = el.shape.rectRadius;
      if (el.shape.shadow) shapeOptions.shadow = el.shape.shadow;

      targetSlide.addText(el.text || &#x27;&#x27;, shapeOptions);
    } else if (el.type === &#x27;list&#x27;) {
      const listOptions = {
        x: el.position.x,
        y: el.position.y,
        w: el.position.w,
        h: el.position.h,
        fontSize: el.style.fontSize,
        fontFace: el.style.fontFace,
        color: el.style.color,
        align: el.style.align,
        valign: &#x27;top&#x27;,
        lineSpacing: el.style.lineSpacing,
        paraSpaceBefore: el.style.paraSpaceBefore,
        paraSpaceAfter: el.style.paraSpaceAfter,
        margin: el.style.margin
      };
      if (el.style.margin) listOptions.margin = el.style.margin;
      targetSlide.addText(el.items, listOptions);
    } else {
      // Check if text is single-line (height suggests one line)
      const lineHeight = el.style.lineSpacing || el.style.fontSize * 1.2;
      const isSingleLine = el.position.h &lt;= lineHeight * 1.5;

      let adjustedX = el.position.x;
      let adjustedW = el.position.w;

      // Make single-line text 2% wider to account for underestimate
      if (isSingleLine) {
        const widthIncrease = el.position.w * 0.02;
        const align = el.style.align;

        if (align === &#x27;center&#x27;) {
          // Center: expand both sides
          adjustedX = el.position.x - (widthIncrease / 2);
          adjustedW = el.position.w + widthIncrease;
        } else if (align === &#x27;right&#x27;) {
          // Right: expand to the left
          adjustedX = el.position.x - widthIncrease;
          adjustedW = el.position.w + widthIncrease;
        } else {
          // Left (default): expand to the right
          adjustedW = el.position.w + widthIncrease;
        }
      }

      const textOptions = {
        x: adjustedX,
        y: el.position.y,
        w: adjustedW,
        h: el.position.h,
        fontSize: el.style.fontSize,
        fontFace: el.style.fontFace,
        color: el.style.color,
        bold: el.style.bold,
        italic: el.style.italic,
        underline: el.style.underline,
        valign: &#x27;top&#x27;,
        lineSpacing: el.style.lineSpacing,
        paraSpaceBefore: el.style.paraSpaceBefore,
        paraSpaceAfter: el.style.paraSpaceAfter,
        inset: 0  // Remove default PowerPoint internal padding
      };

      if (el.style.align) textOptions.align = el.style.align;
      if (el.style.margin) textOptions.margin = el.style.margin;
      if (el.style.rotate !== undefined) textOptions.rotate = el.style.rotate;
      if (el.style.transparency !== null &amp;&amp; el.style.transparency !== undefined) textOptions.transparency = el.style.transparency;

      targetSlide.addText(el.text, textOptions);
    }
  }
}

// Helper: Extract slide data from HTML page
async function extractSlideData(page) {
  return await page.evaluate(() =&gt; {
    const PT_PER_PX = 0.75;
    const PX_PER_IN = 96;

    // Fonts that are single-weight and should not have bold applied
    // (applying bold causes PowerPoint to use faux bold which makes text wider)
    const SINGLE_WEIGHT_FONTS = [&#x27;impact&#x27;];

    // Helper: Check if a font should skip bold formatting
    const shouldSkipBold = (fontFamily) =&gt; {
      if (!fontFamily) return false;
      const normalizedFont = fontFamily.toLowerCase().replace(/[&#x27;&quot;]/g, &#x27;&#x27;).split(&#x27;,&#x27;)[0].trim();
      return SINGLE_WEIGHT_FONTS.includes(normalizedFont);
    };

    // Unit conversion helpers
    const pxToInch = (px) =&gt; px / PX_PER_IN;
    const pxToPoints = (pxStr) =&gt; parseFloat(pxStr) * PT_PER_PX;
    const rgbToHex = (rgbStr) =&gt; {
      // Handle transparent backgrounds by defaulting to white
      if (rgbStr === &#x27;rgba(0, 0, 0, 0)&#x27; || rgbStr === &#x27;transparent&#x27;) return &#x27;FFFFFF&#x27;;

      const match = rgbStr.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);
      if (!match) return &#x27;FFFFFF&#x27;;
      return match.slice(1).map(n =&gt; parseInt(n).toString(16).padStart(2, &#x27;0&#x27;)).join(&#x27;&#x27;);
    };

    const extractAlpha = (rgbStr) =&gt; {
      const match = rgbStr.match(/rgba\((\d+),\s*(\d+),\s*(\d+),\s*([\d.]+)\)/);
      if (!match || !match[4]) return null;
      const alpha = parseFloat(match[4]);
      return Math.round((1 - alpha) * 100);
    };

    const applyTextTransform = (text, textTransform) =&gt; {
      if (textTransform === &#x27;uppercase&#x27;) return text.toUpperCase();
      if (textTransform === &#x27;lowercase&#x27;) return text.toLowerCase();
      if (textTransform === &#x27;capitalize&#x27;) {
        return text.replace(/\b\w/g, c =&gt; c.toUpperCase());
      }
      return text;
    };

    // Extract rotation angle from CSS transform and writing-mode
    const getRotation = (transform, writingMode) =&gt; {
      let angle = 0;

      // Handle writing-mode first
      // PowerPoint: 90 = text rotated 90 clockwise (reads top to bottom, letters upright)
      // PowerPoint: 270 = text rotated 270 clockwise (reads bottom to top, letters upright)
      if (writingMode === &#x27;vertical-rl&#x27;) {
        // vertical-rl alone = text reads top to bottom = 90 in PowerPoint
        angle = 90;
      } else if (writingMode === &#x27;vertical-lr&#x27;) {
        // vertical-lr alone = text reads bottom to top = 270 in PowerPoint
        angle = 270;
      }

      // Then add any transform rotation
      if (transform &amp;&amp; transform !== &#x27;none&#x27;) {
        // Try to match rotate() function
        const rotateMatch = transform.match(/rotate\((-?\d+(?:\.\d+)?)deg\)/);
        if (rotateMatch) {
          angle += parseFloat(rotateMatch[1]);
        } else {
          // Browser may compute as matrix - extract rotation from matrix
          const matrixMatch = transform.match(/matrix\(([^)]+)\)/);
          if (matrixMatch) {
            const values = matrixMatch[1].split(&#x27;,&#x27;).map(parseFloat);
            // matrix(a, b, c, d, e, f) where rotation = atan2(b, a)
            const matrixAngle = Math.atan2(values[1], values[0]) * (180 / Math.PI);
            angle += Math.round(matrixAngle);
          }
        }
      }

      // Normalize to 0-359 range
      angle = angle % 360;
      if (angle &lt; 0) angle += 360;

      return angle === 0 ? null : angle;
    };

    // Get position/dimensions accounting for rotation
    const getPositionAndSize = (el, rect, rotation) =&gt; {
      if (rotation === null) {
        return { x: rect.left, y: rect.top, w: rect.width, h: rect.height };
      }

      // For 90 or 270 rotations, swap width and height
      // because PowerPoint applies rotation to the original (unrotated) box
      const isVertical = rotation === 90 || rotation === 270;

      if (isVertical) {
        // The browser shows us the rotated dimensions (tall box for vertical text)
        // But PowerPoint needs the pre-rotation dimensions (wide box that will be rotated)
        // So we swap: browser&#x27;s height becomes PPT&#x27;s width, browser&#x27;s width becomes PPT&#x27;s height
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;

        return {
          x: centerX - rect.height / 2,
          y: centerY - rect.width / 2,
          w: rect.height,
          h: rect.width
        };
      }

      // For other rotations, use element&#x27;s offset dimensions
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;
      return {
        x: centerX - el.offsetWidth / 2,
        y: centerY - el.offsetHeight / 2,
        w: el.offsetWidth,
        h: el.offsetHeight
      };
    };

    // Parse CSS box-shadow into PptxGenJS shadow properties
    const parseBoxShadow = (boxShadow) =&gt; {
      if (!boxShadow || boxShadow === &#x27;none&#x27;) return null;

      // Browser computed style format: &quot;rgba(0, 0, 0, 0.3) 2px 2px 8px 0px [inset]&quot;
      // CSS format: &quot;[inset] 2px 2px 8px 0px rgba(0, 0, 0, 0.3)&quot;

      const insetMatch = boxShadow.match(/inset/);

      // IMPORTANT: PptxGenJS/PowerPoint doesn&#x27;t properly support inset shadows
      // Only process outer shadows to avoid file corruption
      if (insetMatch) return null;

      // Extract color first (rgba or rgb at start)
      const colorMatch = boxShadow.match(/rgba?\([^)]+\)/);

      // Extract numeric values (handles both px and pt units)
      const parts = boxShadow.match(/([-\d.]+)(px|pt)/g);

      if (!parts || parts.length &lt; 2) return null;

      const offsetX = parseFloat(parts[0]);
      const offsetY = parseFloat(parts[1]);
      const blur = parts.length &gt; 2 ? parseFloat(parts[2]) : 0;

      // Calculate angle from offsets (in degrees, 0 = right, 90 = down)
      let angle = 0;
      if (offsetX !== 0 || offsetY !== 0) {
        angle = Math.atan2(offsetY, offsetX) * (180 / Math.PI);
        if (angle &lt; 0) angle += 360;
      }

      // Calculate offset distance (hypotenuse)
      const offset = Math.sqrt(offsetX * offsetX + offsetY * offsetY) * PT_PER_PX;

      // Extract opacity from rgba
      let opacity = 0.5;
      if (colorMatch) {
        const opacityMatch = colorMatch[0].match(/[\d.]+\)$/);
        if (opacityMatch) {
          opacity = parseFloat(opacityMatch[0].replace(&#x27;)&#x27;, &#x27;&#x27;));
        }
      }

      return {
        type: &#x27;outer&#x27;,
        angle: Math.round(angle),
        blur: blur * 0.75, // Convert to points
        color: colorMatch ? rgbToHex(colorMatch[0]) : &#x27;000000&#x27;,
        offset: offset,
        opacity
      };
    };

    // Parse inline formatting tags (&lt;b&gt;, &lt;i&gt;, &lt;u&gt;, &lt;strong&gt;, &lt;em&gt;, &lt;span&gt;) into text runs
    const parseInlineFormatting = (element, baseOptions = {}, runs = [], baseTextTransform = (x) =&gt; x) =&gt; {
      let prevNodeIsText = false;

      element.childNodes.forEach((node) =&gt; {
        let textTransform = baseTextTransform;

        const isText = node.nodeType === Node.TEXT_NODE || node.tagName === &#x27;BR&#x27;;
        if (isText) {
          const text = node.tagName === &#x27;BR&#x27; ? &#x27;\n&#x27; : textTransform(node.textContent.replace(/\s+/g, &#x27; &#x27;));
          const prevRun = runs[runs.length - 1];
          if (prevNodeIsText &amp;&amp; prevRun) {
            prevRun.text += text;
          } else {
            runs.push({ text, options: { ...baseOptions } });
          }

        } else if (node.nodeType === Node.ELEMENT_NODE &amp;&amp; node.textContent.trim()) {
          const options = { ...baseOptions };
          const computed = window.getComputedStyle(node);

          // Handle inline elements with computed styles
          if (node.tagName === &#x27;SPAN&#x27; || node.tagName === &#x27;B&#x27; || node.tagName === &#x27;STRONG&#x27; || node.tagName === &#x27;I&#x27; || node.tagName === &#x27;EM&#x27; || node.tagName === &#x27;U&#x27;) {
            const isBold = computed.fontWeight === &#x27;bold&#x27; || parseInt(computed.fontWeight) &gt;= 600;
            if (isBold &amp;&amp; !shouldSkipBold(computed.fontFamily)) options.bold = true;
            if (computed.fontStyle === &#x27;italic&#x27;) options.italic = true;
            if (computed.textDecoration &amp;&amp; computed.textDecoration.includes(&#x27;underline&#x27;)) options.underline = true;
            if (computed.color &amp;&amp; computed.color !== &#x27;rgb(0, 0, 0)&#x27;) {
              options.color = rgbToHex(computed.color);
              const transparency = extractAlpha(computed.color);
              if (transparency !== null) options.transparency = transparency;
            }
            if (computed.fontSize) options.fontSize = pxToPoints(computed.fontSize);

            // Apply text-transform on the span element itself
            if (computed.textTransform &amp;&amp; computed.textTransform !== &#x27;none&#x27;) {
              const transformStr = computed.textTransform;
              textTransform = (text) =&gt; applyTextTransform(text, transformStr);
            }

            // Validate: Check for margins on inline elements
            if (computed.marginLeft &amp;&amp; parseFloat(computed.marginLeft) &gt; 0) {
              errors.push(`Inline element &lt;${node.tagName.toLowerCase()}&gt; has margin-left which is not supported in PowerPoint. Remove margin from inline elements.`);
            }
            if (computed.marginRight &amp;&amp; parseFloat(computed.marginRight) &gt; 0) {
              errors.push(`Inline element &lt;${node.tagName.toLowerCase()}&gt; has margin-right which is not supported in PowerPoint. Remove margin from inline elements.`);
            }
            if (computed.marginTop &amp;&amp; parseFloat(computed.marginTop) &gt; 0) {
              errors.push(`Inline element &lt;${node.tagName.toLowerCase()}&gt; has margin-top which is not supported in PowerPoint. Remove margin from inline elements.`);
            }
            if (computed.marginBottom &amp;&amp; parseFloat(computed.marginBottom) &gt; 0) {
              errors.push(`Inline element &lt;${node.tagName.toLowerCase()}&gt; has margin-bottom which is not supported in PowerPoint. Remove margin from inline elements.`);
            }

            // Recursively process the child node. This will flatten nested spans into multiple runs.
            parseInlineFormatting(node, options, runs, textTransform);
          }
        }

        prevNodeIsText = isText;
      });

      // Trim leading space from first run and trailing space from last run
      if (runs.length &gt; 0) {
        runs[0].text = runs[0].text.replace(/^\s+/, &#x27;&#x27;);
        runs[runs.length - 1].text = runs[runs.length - 1].text.replace(/\s+$/, &#x27;&#x27;);
      }

      return runs.filter(r =&gt; r.text.length &gt; 0);
    };

    // Extract background from body (image or color)
    const body = document.body;
    const bodyStyle = window.getComputedStyle(body);
    const bgImage = bodyStyle.backgroundImage;
    const bgColor = bodyStyle.backgroundColor;

    // Collect validation errors
    const errors = [];

    // Validate: Check for CSS gradients
    if (bgImage &amp;&amp; (bgImage.includes(&#x27;linear-gradient&#x27;) || bgImage.includes(&#x27;radial-gradient&#x27;))) {
      errors.push(
        &#x27;CSS gradients are not supported. Use Sharp to rasterize gradients as PNG images first, &#x27; +
        &#x27;then reference with background-image: url(\&#x27;gradient.png\&#x27;)&#x27;
      );
    }

    let background;
    if (bgImage &amp;&amp; bgImage !== &#x27;none&#x27;) {
      // Extract URL from url(&quot;...&quot;) or url(...)
      const urlMatch = bgImage.match(/url\([&quot;&#x27;]?([^&quot;&#x27;)]+)[&quot;&#x27;]?\)/);
      if (urlMatch) {
        background = {
          type: &#x27;image&#x27;,
          path: urlMatch[1]
        };
      } else {
        background = {
          type: &#x27;color&#x27;,
          value: rgbToHex(bgColor)
        };
      }
    } else {
      background = {
        type: &#x27;color&#x27;,
        value: rgbToHex(bgColor)
      };
    }

    // Process all elements
    const elements = [];
    const placeholders = [];
    const textTags = [&#x27;P&#x27;, &#x27;H1&#x27;, &#x27;H2&#x27;, &#x27;H3&#x27;, &#x27;H4&#x27;, &#x27;H5&#x27;, &#x27;H6&#x27;, &#x27;UL&#x27;, &#x27;OL&#x27;, &#x27;LI&#x27;];
    const processed = new Set();

    document.querySelectorAll(&#x27;*&#x27;).forEach((el) =&gt; {
      if (processed.has(el)) return;

      // Validate text elements don&#x27;t have backgrounds, borders, or shadows
      if (textTags.includes(el.tagName)) {
        const computed = window.getComputedStyle(el);
        const hasBg = computed.backgroundColor &amp;&amp; computed.backgroundColor !== &#x27;rgba(0, 0, 0, 0)&#x27;;
        const hasBorder = (computed.borderWidth &amp;&amp; parseFloat(computed.borderWidth) &gt; 0) ||
                          (computed.borderTopWidth &amp;&amp; parseFloat(computed.borderTopWidth) &gt; 0) ||
                          (computed.borderRightWidth &amp;&amp; parseFloat(computed.borderRightWidth) &gt; 0) ||
                          (computed.borderBottomWidth &amp;&amp; parseFloat(computed.borderBottomWidth) &gt; 0) ||
                          (computed.borderLeftWidth &amp;&amp; parseFloat(computed.borderLeftWidth) &gt; 0);
        const hasShadow = computed.boxShadow &amp;&amp; computed.boxShadow !== &#x27;none&#x27;;

        if (hasBg || hasBorder || hasShadow) {
          errors.push(
            `Text element &lt;${el.tagName.toLowerCase()}&gt; has ${hasBg ? &#x27;background&#x27; : hasBorder ? &#x27;border&#x27; : &#x27;shadow&#x27;}. ` +
            &#x27;Backgrounds, borders, and shadows are only supported on &lt;div&gt; elements, not text elements.&#x27;
          );
          return;
        }
      }

      // Extract placeholder elements (for charts, etc.)
      if (el.className &amp;&amp; el.className.includes(&#x27;placeholder&#x27;)) {
        const rect = el.getBoundingClientRect();
        if (rect.width === 0 || rect.height === 0) {
          errors.push(
            `Placeholder &quot;${el.id || &#x27;unnamed&#x27;}&quot; has ${rect.width === 0 ? &#x27;width: 0&#x27; : &#x27;height: 0&#x27;}. Check the layout CSS.`
          );
        } else {
          placeholders.push({
            id: el.id || `placeholder-${placeholders.length}`,
            x: pxToInch(rect.left),
            y: pxToInch(rect.top),
            w: pxToInch(rect.width),
            h: pxToInch(rect.height)
          });
        }
        processed.add(el);
        return;
      }

      // Extract images
      if (el.tagName === &#x27;IMG&#x27;) {
        const rect = el.getBoundingClientRect();
        if (rect.width &gt; 0 &amp;&amp; rect.height &gt; 0) {
          elements.push({
            type: &#x27;image&#x27;,
            src: el.src,
            position: {
              x: pxToInch(rect.left),
              y: pxToInch(rect.top),
              w: pxToInch(rect.width),
              h: pxToInch(rect.height)
            }
          });
          processed.add(el);
          return;
        }
      }

      // Extract DIVs with backgrounds/borders as shapes
      const isContainer = el.tagName === &#x27;DIV&#x27; &amp;&amp; !textTags.includes(el.tagName);
      if (isContainer) {
        const computed = window.getComputedStyle(el);
        const hasBg = computed.backgroundColor &amp;&amp; computed.backgroundColor !== &#x27;rgba(0, 0, 0, 0)&#x27;;

        // Validate: Check for unwrapped text content in DIV
        for (const node of el.childNodes) {
          if (node.nodeType === Node.TEXT_NODE) {
            const text = node.textContent.trim();
            if (text) {
              errors.push(
                `DIV element contains unwrapped text &quot;${text.substring(0, 50)}${text.length &gt; 50 ? &#x27;...&#x27; : &#x27;&#x27;}&quot;. ` +
                &#x27;All text must be wrapped in &lt;p&gt;, &lt;h1&gt;-&lt;h6&gt;, &lt;ul&gt;, or &lt;ol&gt; tags to appear in PowerPoint.&#x27;
              );
            }
          }
        }

        // Check for background images on shapes
        const bgImage = computed.backgroundImage;
        if (bgImage &amp;&amp; bgImage !== &#x27;none&#x27;) {
          errors.push(
            &#x27;Background images on DIV elements are not supported. &#x27; +
            &#x27;Use solid colors or borders for shapes, or use slide.addImage() in PptxGenJS to layer images.&#x27;
          );
          return;
        }

        // Check for borders - both uniform and partial
        const borderTop = computed.borderTopWidth;
        const borderRight = computed.borderRightWidth;
        const borderBottom = computed.borderBottomWidth;
        const borderLeft = computed.borderLeftWidth;
        const borders = [borderTop, borderRight, borderBottom, borderLeft].map(b =&gt; parseFloat(b) || 0);
        const hasBorder = borders.some(b =&gt; b &gt; 0);
        const hasUniformBorder = hasBorder &amp;&amp; borders.every(b =&gt; b === borders[0]);
        const borderLines = [];

        if (hasBorder &amp;&amp; !hasUniformBorder) {
          const rect = el.getBoundingClientRect();
          const x = pxToInch(rect.left);
          const y = pxToInch(rect.top);
          const w = pxToInch(rect.width);
          const h = pxToInch(rect.height);

          // Collect lines to add after shape (inset by half the line width to center on edge)
          if (parseFloat(borderTop) &gt; 0) {
            const widthPt = pxToPoints(borderTop);
            const inset = (widthPt / 72) / 2; // Convert points to inches, then half
            borderLines.push({
              type: &#x27;line&#x27;,
              x1: x, y1: y + inset, x2: x + w, y2: y + inset,
              width: widthPt,
              color: rgbToHex(computed.borderTopColor)
            });
          }
          if (parseFloat(borderRight) &gt; 0) {
            const widthPt = pxToPoints(borderRight);
            const inset = (widthPt / 72) / 2;
            borderLines.push({
              type: &#x27;line&#x27;,
              x1: x + w - inset, y1: y, x2: x + w - inset, y2: y + h,
              width: widthPt,
              color: rgbToHex(computed.borderRightColor)
            });
          }
          if (parseFloat(borderBottom) &gt; 0) {
            const widthPt = pxToPoints(borderBottom);
            const inset = (widthPt / 72) / 2;
            borderLines.push({
              type: &#x27;line&#x27;,
              x1: x, y1: y + h - inset, x2: x + w, y2: y + h - inset,
              width: widthPt,
              color: rgbToHex(computed.borderBottomColor)
            });
          }
          if (parseFloat(borderLeft) &gt; 0) {
            const widthPt = pxToPoints(borderLeft);
            const inset = (widthPt / 72) / 2;
            borderLines.push({
              type: &#x27;line&#x27;,
              x1: x + inset, y1: y, x2: x + inset, y2: y + h,
              width: widthPt,
              color: rgbToHex(computed.borderLeftColor)
            });
          }
        }

        if (hasBg || hasBorder) {
          const rect = el.getBoundingClientRect();
          if (rect.width &gt; 0 &amp;&amp; rect.height &gt; 0) {
            const shadow = parseBoxShadow(computed.boxShadow);

            // Only add shape if there&#x27;s background or uniform border
            if (hasBg || hasUniformBorder) {
              elements.push({
                type: &#x27;shape&#x27;,
                text: &#x27;&#x27;,  // Shape only - child text elements render on top
                position: {
                  x: pxToInch(rect.left),
                  y: pxToInch(rect.top),
                  w: pxToInch(rect.width),
                  h: pxToInch(rect.height)
                },
                shape: {
                  fill: hasBg ? rgbToHex(computed.backgroundColor) : null,
                  transparency: hasBg ? extractAlpha(computed.backgroundColor) : null,
                  line: hasUniformBorder ? {
                    color: rgbToHex(computed.borderColor),
                    width: pxToPoints(computed.borderWidth)
                  } : null,
                  // Convert border-radius to rectRadius (in inches)
                  // % values: 50%+ = circle (1), &lt;50% = percentage of min dimension
                  // pt values: divide by 72 (72pt = 1 inch)
                  // px values: divide by 96 (96px = 1 inch)
                  rectRadius: (() =&gt; {
                    const radius = computed.borderRadius;
                    const radiusValue = parseFloat(radius);
                    if (radiusValue === 0) return 0;

                    if (radius.includes(&#x27;%&#x27;)) {
                      if (radiusValue &gt;= 50) return 1;
                      // Calculate percentage of smaller dimension
                      const minDim = Math.min(rect.width, rect.height);
                      return (radiusValue / 100) * pxToInch(minDim);
                    }

                    if (radius.includes(&#x27;pt&#x27;)) return radiusValue / 72;
                    return radiusValue / PX_PER_IN;
                  })(),
                  shadow: shadow
                }
              });
            }

            // Add partial border lines
            elements.push(...borderLines);

            processed.add(el);
            return;
          }
        }
      }

      // Extract bullet lists as single text block
      if (el.tagName === &#x27;UL&#x27; || el.tagName === &#x27;OL&#x27;) {
        const rect = el.getBoundingClientRect();
        if (rect.width === 0 || rect.height === 0) return;

        const liElements = Array.from(el.querySelectorAll(&#x27;li&#x27;));
        const items = [];
        const ulComputed = window.getComputedStyle(el);
        const ulPaddingLeftPt = pxToPoints(ulComputed.paddingLeft);

        // Split: margin-left for bullet position, indent for text position
        // margin-left + indent = ul padding-left
        const marginLeft = ulPaddingLeftPt * 0.5;
        const textIndent = ulPaddingLeftPt * 0.5;

        liElements.forEach((li, idx) =&gt; {
          const isLast = idx === liElements.length - 1;
          const runs = parseInlineFormatting(li, { breakLine: false });
          // Clean manual bullets from first run
          if (runs.length &gt; 0) {
            runs[0].text = runs[0].text.replace(/^[\-\*]\s*/, &#x27;&#x27;);
            runs[0].options.bullet = { indent: textIndent };
          }
          // Set breakLine on last run
          if (runs.length &gt; 0 &amp;&amp; !isLast) {
            runs[runs.length - 1].options.breakLine = true;
          }
          items.push(...runs);
        });

        const computed = window.getComputedStyle(liElements[0] || el);

        elements.push({
          type: &#x27;list&#x27;,
          items: items,
          position: {
            x: pxToInch(rect.left),
            y: pxToInch(rect.top),
            w: pxToInch(rect.width),
            h: pxToInch(rect.height)
          },
          style: {
            fontSize: pxToPoints(computed.fontSize),
            fontFace: computed.fontFamily.split(&#x27;,&#x27;)[0].replace(/[&#x27;&quot;]/g, &#x27;&#x27;).trim(),
            color: rgbToHex(computed.color),
            transparency: extractAlpha(computed.color),
            align: computed.textAlign === &#x27;start&#x27; ? &#x27;left&#x27; : computed.textAlign,
            lineSpacing: computed.lineHeight &amp;&amp; computed.lineHeight !== &#x27;normal&#x27; ? pxToPoints(computed.lineHeight) : null,
            paraSpaceBefore: 0,
            paraSpaceAfter: pxToPoints(computed.marginBottom),
            // PptxGenJS margin array is [left, right, bottom, top]
            margin: [marginLeft, 0, 0, 0]
          }
        });

        liElements.forEach(li =&gt; processed.add(li));
        processed.add(el);
        return;
      }

      // Extract text elements (P, H1, H2, etc.)
      if (!textTags.includes(el.tagName)) return;

      const rect = el.getBoundingClientRect();
      const text = el.textContent.trim();
      if (rect.width === 0 || rect.height === 0 || !text) return;

      // Validate: Check for manual bullet symbols in text elements (not in lists)
      if (el.tagName !== &#x27;LI&#x27; &amp;&amp; /^[\-\*]\s/.test(text.trimStart())) {
        errors.push(
          `Text element &lt;${el.tagName.toLowerCase()}&gt; starts with bullet symbol &quot;${text.substring(0, 20)}...&quot;. ` +
          &#x27;Use &lt;ul&gt; or &lt;ol&gt; lists instead of manual bullet symbols.&#x27;
        );
        return;
      }

      const computed = window.getComputedStyle(el);
      const rotation = getRotation(computed.transform, computed.writingMode);
      const { x, y, w, h } = getPositionAndSize(el, rect, rotation);

      const baseStyle = {
        fontSize: pxToPoints(computed.fontSize),
        fontFace: computed.fontFamily.split(&#x27;,&#x27;)[0].replace(/[&#x27;&quot;]/g, &#x27;&#x27;).trim(),
        color: rgbToHex(computed.color),
        align: computed.textAlign === &#x27;start&#x27; ? &#x27;left&#x27; : computed.textAlign,
        lineSpacing: pxToPoints(computed.lineHeight),
        paraSpaceBefore: pxToPoints(computed.marginTop),
        paraSpaceAfter: pxToPoints(computed.marginBottom),
        // PptxGenJS margin array is [left, right, bottom, top] (not [top, right, bottom, left] as documented)
        margin: [
          pxToPoints(computed.paddingLeft),
          pxToPoints(computed.paddingRight),
          pxToPoints(computed.paddingBottom),
          pxToPoints(computed.paddingTop)
        ]
      };

      const transparency = extractAlpha(computed.color);
      if (transparency !== null) baseStyle.transparency = transparency;

      if (rotation !== null) baseStyle.rotate = rotation;

      const hasFormatting = el.querySelector(&#x27;b, i, u, strong, em, span, br&#x27;);

      if (hasFormatting) {
        // Text with inline formatting
        const transformStr = computed.textTransform;
        const runs = parseInlineFormatting(el, {}, [], (str) =&gt; applyTextTransform(str, transformStr));

        // Adjust lineSpacing based on largest fontSize in runs
        const adjustedStyle = { ...baseStyle };
        if (adjustedStyle.lineSpacing) {
          const maxFontSize = Math.max(
            adjustedStyle.fontSize,
            ...runs.map(r =&gt; r.options?.fontSize || 0)
          );
          if (maxFontSize &gt; adjustedStyle.fontSize) {
            const lineHeightMultiplier = adjustedStyle.lineSpacing / adjustedStyle.fontSize;
            adjustedStyle.lineSpacing = maxFontSize * lineHeightMultiplier;
          }
        }

        elements.push({
          type: el.tagName.toLowerCase(),
          text: runs,
          position: { x: pxToInch(x), y: pxToInch(y), w: pxToInch(w), h: pxToInch(h) },
          style: adjustedStyle
        });
      } else {
        // Plain text - inherit CSS formatting
        const textTransform = computed.textTransform;
        const transformedText = applyTextTransform(text, textTransform);

        const isBold = computed.fontWeight === &#x27;bold&#x27; || parseInt(computed.fontWeight) &gt;= 600;

        elements.push({
          type: el.tagName.toLowerCase(),
          text: transformedText,
          position: { x: pxToInch(x), y: pxToInch(y), w: pxToInch(w), h: pxToInch(h) },
          style: {
            ...baseStyle,
            bold: isBold &amp;&amp; !shouldSkipBold(computed.fontFamily),
            italic: computed.fontStyle === &#x27;italic&#x27;,
            underline: computed.textDecoration.includes(&#x27;underline&#x27;)
          }
        });
      }

      processed.add(el);
    });

    return { background, elements, placeholders, errors };
  });
}

async function html2pptx(htmlFile, pres, options = {}) {
  const {
    tmpDir = process.env.TMPDIR || &#x27;/tmp&#x27;,
    slide = null
  } = options;

  try {
    // Use Chrome on macOS, default Chromium on Unix
    const launchOptions = { env: { TMPDIR: tmpDir } };
    if (process.platform === &#x27;darwin&#x27;) {
      launchOptions.channel = &#x27;chrome&#x27;;
    }

    const browser = await chromium.launch(launchOptions);

    let bodyDimensions;
    let slideData;

    const filePath = path.isAbsolute(htmlFile) ? htmlFile : path.join(process.cwd(), htmlFile);
    const validationErrors = [];

    try {
      const page = await browser.newPage();
      page.on(&#x27;console&#x27;, (msg) =&gt; {
        // Log the message text to your test runner&#x27;s console
        console.log(`Browser console: ${msg.text()}`);
      });

      await page.goto(`file://${filePath}`);

      bodyDimensions = await getBodyDimensions(page);

      await page.setViewportSize({
        width: Math.round(bodyDimensions.width),
        height: Math.round(bodyDimensions.height)
      });

      slideData = await extractSlideData(page);
    } finally {
      await browser.close();
    }

    // Collect all validation errors
    if (bodyDimensions.errors &amp;&amp; bodyDimensions.errors.length &gt; 0) {
      validationErrors.push(...bodyDimensions.errors);
    }

    const dimensionErrors = validateDimensions(bodyDimensions, pres);
    if (dimensionErrors.length &gt; 0) {
      validationErrors.push(...dimensionErrors);
    }

    const textBoxPositionErrors = validateTextBoxPosition(slideData, bodyDimensions);
    if (textBoxPositionErrors.length &gt; 0) {
      validationErrors.push(...textBoxPositionErrors);
    }

    if (slideData.errors &amp;&amp; slideData.errors.length &gt; 0) {
      validationErrors.push(...slideData.errors);
    }

    // Throw all errors at once if any exist
    if (validationErrors.length &gt; 0) {
      const errorMessage = validationErrors.length === 1
        ? validationErrors[0]
        : `Multiple validation errors found:\n${validationErrors.map((e, i) =&gt; `  ${i + 1}. ${e}`).join(&#x27;\n&#x27;)}`;
      throw new Error(errorMessage);
    }

    const targetSlide = slide || pres.addSlide();

    await addBackground(slideData, targetSlide, tmpDir);
    addElements(slideData, targetSlide, pres);

    return { slide: targetSlide, placeholders: slideData.placeholders };
  } catch (error) {
    if (!error.message.startsWith(htmlFile)) {
      throw new Error(`${htmlFile}: ${error.message}`);
    }
    throw error;
  }
}

module.exports = html2pptx;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/html2pptx/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/scripts/html2pptx.js" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="ibmplexmono_ofl Imported skill ibmplexmono_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/IBMPlexMono-OFL.txt Unknown LICENSE.txt sources/anthropic/ibmplexmono_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">ibmplexmono_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('ibmplexmono_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill ibmplexmono_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright  2017 IBM Corp. with Reserved Font Name &quot;Plex&quot;

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/ibmplexmono_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/IBMPlexMono-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="init_skill Imported skill init_skill from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/skill-creator/scripts/init_skill.py Unknown LICENSE.txt sources/anthropic/init_skill/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">init_skill</div>
                <button class="copy-btn" onclick="copyToClipboard('init_skill')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill init_skill from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Skill Initializer - Creates a new skill from template

Usage:
    init_skill.py &lt;skill-name&gt; --path &lt;path&gt;

Examples:
    init_skill.py my-new-skill --path skills/public
    init_skill.py my-api-helper --path skills/private
    init_skill.py custom-skill --path /custom/location
&quot;&quot;&quot;

import sys
from pathlib import Path


SKILL_TEMPLATE = &quot;&quot;&quot;---
name: {skill_name}
description: [TODO: Complete and informative explanation of what the skill does and when to use it. Include WHEN to use this skill - specific scenarios, file types, or tasks that trigger it.]
---

# {skill_title}

## Overview

[TODO: 1-2 sentences explaining what this skill enables]

## Structuring This Skill

[TODO: Choose the structure that best fits this skill&#x27;s purpose. Common patterns:

**1. Workflow-Based** (best for sequential processes)
- Works well when there are clear step-by-step procedures
- Example: DOCX skill with &quot;Workflow Decision Tree&quot;  &quot;Reading&quot;  &quot;Creating&quot;  &quot;Editing&quot;
- Structure: ## Overview  ## Workflow Decision Tree  ## Step 1  ## Step 2...

**2. Task-Based** (best for tool collections)
- Works well when the skill offers different operations/capabilities
- Example: PDF skill with &quot;Quick Start&quot;  &quot;Merge PDFs&quot;  &quot;Split PDFs&quot;  &quot;Extract Text&quot;
- Structure: ## Overview  ## Quick Start  ## Task Category 1  ## Task Category 2...

**3. Reference/Guidelines** (best for standards or specifications)
- Works well for brand guidelines, coding standards, or requirements
- Example: Brand styling with &quot;Brand Guidelines&quot;  &quot;Colors&quot;  &quot;Typography&quot;  &quot;Features&quot;
- Structure: ## Overview  ## Guidelines  ## Specifications  ## Usage...

**4. Capabilities-Based** (best for integrated systems)
- Works well when the skill provides multiple interrelated features
- Example: Product Management with &quot;Core Capabilities&quot;  numbered capability list
- Structure: ## Overview  ## Core Capabilities  ### 1. Feature  ### 2. Feature...

Patterns can be mixed and matched as needed. Most skills combine patterns (e.g., start with task-based, add workflow for complex operations).

Delete this entire &quot;Structuring This Skill&quot; section when done - it&#x27;s just guidance.]

## [TODO: Replace with the first main section based on chosen structure]

[TODO: Add content here. See examples in existing skills:
- Code samples for technical skills
- Decision trees for complex workflows
- Concrete examples with realistic user requests
- References to scripts/templates/references as needed]

## Resources

This skill includes example resource directories that demonstrate how to organize different types of bundled resources:

### scripts/
Executable code (Python/Bash/etc.) that can be run directly to perform specific operations.

**Examples from other skills:**
- PDF skill: `fill_fillable_fields.py`, `extract_form_field_info.py` - utilities for PDF manipulation
- DOCX skill: `document.py`, `utilities.py` - Python modules for document processing

**Appropriate for:** Python scripts, shell scripts, or any executable code that performs automation, data processing, or specific operations.

**Note:** Scripts may be executed without loading into context, but can still be read by Claude for patching or environment adjustments.

### references/
Documentation and reference material intended to be loaded into context to inform Claude&#x27;s process and thinking.

**Examples from other skills:**
- Product management: `communication.md`, `context_building.md` - detailed workflow guides
- BigQuery: API reference documentation and query examples
- Finance: Schema documentation, company policies

**Appropriate for:** In-depth documentation, API references, database schemas, comprehensive guides, or any detailed information that Claude should reference while working.

### assets/
Files not intended to be loaded into context, but rather used within the output Claude produces.

**Examples from other skills:**
- Brand styling: PowerPoint template files (.pptx), logo files
- Frontend builder: HTML/React boilerplate project directories
- Typography: Font files (.ttf, .woff2)

**Appropriate for:** Templates, boilerplate code, document templates, images, icons, fonts, or any files meant to be copied or used in the final output.

---

**Any unneeded directories can be deleted.** Not every skill requires all three types of resources.
&quot;&quot;&quot;

EXAMPLE_SCRIPT = &#x27;&#x27;&#x27;#!/usr/bin/env python3
&quot;&quot;&quot;
Example helper script for {skill_name}

This is a placeholder script that can be executed directly.
Replace with actual implementation or delete if not needed.

Example real scripts from other skills:
- pdf/scripts/fill_fillable_fields.py - Fills PDF form fields
- pdf/scripts/convert_pdf_to_images.py - Converts PDF pages to images
&quot;&quot;&quot;

def main():
    print(&quot;This is an example script for {skill_name}&quot;)
    # TODO: Add actual script logic here
    # This could be data processing, file conversion, API calls, etc.

if __name__ == &quot;__main__&quot;:
    main()
&#x27;&#x27;&#x27;

EXAMPLE_REFERENCE = &quot;&quot;&quot;# Reference Documentation for {skill_title}

This is a placeholder for detailed reference documentation.
Replace with actual reference content or delete if not needed.

Example real reference docs from other skills:
- product-management/references/communication.md - Comprehensive guide for status updates
- product-management/references/context_building.md - Deep-dive on gathering context
- bigquery/references/ - API references and query examples

## When Reference Docs Are Useful

Reference docs are ideal for:
- Comprehensive API documentation
- Detailed workflow guides
- Complex multi-step processes
- Information too lengthy for main SKILL.md
- Content that&#x27;s only needed for specific use cases

## Structure Suggestions

### API Reference Example
- Overview
- Authentication
- Endpoints with examples
- Error codes
- Rate limits

### Workflow Guide Example
- Prerequisites
- Step-by-step instructions
- Common patterns
- Troubleshooting
- Best practices
&quot;&quot;&quot;

EXAMPLE_ASSET = &quot;&quot;&quot;# Example Asset File

This placeholder represents where asset files would be stored.
Replace with actual asset files (templates, images, fonts, etc.) or delete if not needed.

Asset files are NOT intended to be loaded into context, but rather used within
the output Claude produces.

Example asset files from other skills:
- Brand guidelines: logo.png, slides_template.pptx
- Frontend builder: hello-world/ directory with HTML/React boilerplate
- Typography: custom-font.ttf, font-family.woff2
- Data: sample_data.csv, test_dataset.json

## Common Asset Types

- Templates: .pptx, .docx, boilerplate directories
- Images: .png, .jpg, .svg, .gif
- Fonts: .ttf, .otf, .woff, .woff2
- Boilerplate code: Project directories, starter files
- Icons: .ico, .svg
- Data files: .csv, .json, .xml, .yaml

Note: This is a text placeholder. Actual assets can be any file type.
&quot;&quot;&quot;


def title_case_skill_name(skill_name):
    &quot;&quot;&quot;Convert hyphenated skill name to Title Case for display.&quot;&quot;&quot;
    return &#x27; &#x27;.join(word.capitalize() for word in skill_name.split(&#x27;-&#x27;))


def init_skill(skill_name, path):
    &quot;&quot;&quot;
    Initialize a new skill directory with template SKILL.md.

    Args:
        skill_name: Name of the skill
        path: Path where the skill directory should be created

    Returns:
        Path to created skill directory, or None if error
    &quot;&quot;&quot;
    # Determine skill directory path
    skill_dir = Path(path).resolve() / skill_name

    # Check if directory already exists
    if skill_dir.exists():
        print(f&quot; Error: Skill directory already exists: {skill_dir}&quot;)
        return None

    # Create skill directory
    try:
        skill_dir.mkdir(parents=True, exist_ok=False)
        print(f&quot; Created skill directory: {skill_dir}&quot;)
    except Exception as e:
        print(f&quot; Error creating directory: {e}&quot;)
        return None

    # Create SKILL.md from template
    skill_title = title_case_skill_name(skill_name)
    skill_content = SKILL_TEMPLATE.format(
        skill_name=skill_name,
        skill_title=skill_title
    )

    skill_md_path = skill_dir / &#x27;SKILL.md&#x27;
    try:
        skill_md_path.write_text(skill_content)
        print(&quot; Created SKILL.md&quot;)
    except Exception as e:
        print(f&quot; Error creating SKILL.md: {e}&quot;)
        return None

    # Create resource directories with example files
    try:
        # Create scripts/ directory with example script
        scripts_dir = skill_dir / &#x27;scripts&#x27;
        scripts_dir.mkdir(exist_ok=True)
        example_script = scripts_dir / &#x27;example.py&#x27;
        example_script.write_text(EXAMPLE_SCRIPT.format(skill_name=skill_name))
        example_script.chmod(0o755)
        print(&quot; Created scripts/example.py&quot;)

        # Create references/ directory with example reference doc
        references_dir = skill_dir / &#x27;references&#x27;
        references_dir.mkdir(exist_ok=True)
        example_reference = references_dir / &#x27;api_reference.md&#x27;
        example_reference.write_text(EXAMPLE_REFERENCE.format(skill_title=skill_title))
        print(&quot; Created references/api_reference.md&quot;)

        # Create assets/ directory with example asset placeholder
        assets_dir = skill_dir / &#x27;assets&#x27;
        assets_dir.mkdir(exist_ok=True)
        example_asset = assets_dir / &#x27;example_asset.txt&#x27;
        example_asset.write_text(EXAMPLE_ASSET)
        print(&quot; Created assets/example_asset.txt&quot;)
    except Exception as e:
        print(f&quot; Error creating resource directories: {e}&quot;)
        return None

    # Print next steps
    print(f&quot;\n Skill &#x27;{skill_name}&#x27; initialized successfully at {skill_dir}&quot;)
    print(&quot;\nNext steps:&quot;)
    print(&quot;1. Edit SKILL.md to complete the TODO items and update the description&quot;)
    print(&quot;2. Customize or delete the example files in scripts/, references/, and assets/&quot;)
    print(&quot;3. Run the validator when ready to check the skill structure&quot;)

    return skill_dir


def main():
    if len(sys.argv) &lt; 4 or sys.argv[2] != &#x27;--path&#x27;:
        print(&quot;Usage: init_skill.py &lt;skill-name&gt; --path &lt;path&gt;&quot;)
        print(&quot;\nSkill name requirements:&quot;)
        print(&quot;  - Hyphen-case identifier (e.g., &#x27;data-analyzer&#x27;)&quot;)
        print(&quot;  - Lowercase letters, digits, and hyphens only&quot;)
        print(&quot;  - Max 40 characters&quot;)
        print(&quot;  - Must match directory name exactly&quot;)
        print(&quot;\nExamples:&quot;)
        print(&quot;  init_skill.py my-new-skill --path skills/public&quot;)
        print(&quot;  init_skill.py my-api-helper --path skills/private&quot;)
        print(&quot;  init_skill.py custom-skill --path /custom/location&quot;)
        sys.exit(1)

    skill_name = sys.argv[1]
    path = sys.argv[3]

    print(f&quot; Initializing skill: {skill_name}&quot;)
    print(f&quot;   Location: {path}&quot;)
    print()

    result = init_skill(skill_name, path)

    if result:
        sys.exit(0)
    else:
        sys.exit(1)


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/init_skill/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/skill-creator/scripts/init_skill.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/skill-creator/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="instrumentsans_ofl Imported skill instrumentsans_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/InstrumentSans-OFL.txt Unknown LICENSE.txt sources/anthropic/instrumentsans_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">instrumentsans_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('instrumentsans_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill instrumentsans_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2022 The Instrument Sans Project Authors (https://github.com/Instrument/instrument-sans)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/instrumentsans_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/InstrumentSans-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="inventory Imported skill inventory from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/scripts/inventory.py Unknown LICENSE.txt sources/anthropic/inventory/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">inventory</div>
                <button class="copy-btn" onclick="copyToClipboard('inventory')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill inventory from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Extract structured text content from PowerPoint presentations.

This module provides functionality to:
- Extract all text content from PowerPoint shapes
- Preserve paragraph formatting (alignment, bullets, fonts, spacing)
- Handle nested GroupShapes recursively with correct absolute positions
- Sort shapes by visual position on slides
- Filter out slide numbers and non-content placeholders
- Export to JSON with clean, structured data

Classes:
    ParagraphData: Represents a text paragraph with formatting
    ShapeData: Represents a shape with position and text content

Main Functions:
    extract_text_inventory: Extract all text from a presentation
    save_inventory: Save extracted data to JSON

Usage:
    python inventory.py input.pptx output.json
&quot;&quot;&quot;

import argparse
import json
import platform
import sys
from dataclasses import dataclass
from pathlib import Path
from typing import Any, Dict, List, Optional, Tuple, Union

from PIL import Image, ImageDraw, ImageFont
from pptx import Presentation
from pptx.enum.text import PP_ALIGN
from pptx.shapes.base import BaseShape

# Type aliases for cleaner signatures
JsonValue = Union[str, int, float, bool, None]
ParagraphDict = Dict[str, JsonValue]
ShapeDict = Dict[
    str, Union[str, float, bool, List[ParagraphDict], List[str], Dict[str, Any], None]
]
InventoryData = Dict[
    str, Dict[str, &quot;ShapeData&quot;]
]  # Dict of slide_id -&gt; {shape_id -&gt; ShapeData}
InventoryDict = Dict[str, Dict[str, ShapeDict]]  # JSON-serializable inventory


def main():
    &quot;&quot;&quot;Main entry point for command-line usage.&quot;&quot;&quot;
    parser = argparse.ArgumentParser(
        description=&quot;Extract text inventory from PowerPoint with proper GroupShape support.&quot;,
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog=&quot;&quot;&quot;
Examples:
  python inventory.py presentation.pptx inventory.json
    Extracts text inventory with correct absolute positions for grouped shapes

  python inventory.py presentation.pptx inventory.json --issues-only
    Extracts only text shapes that have overflow or overlap issues

The output JSON includes:
  - All text content organized by slide and shape
  - Correct absolute positions for shapes in groups
  - Visual position and size in inches
  - Paragraph properties and formatting
  - Issue detection: text overflow and shape overlaps
        &quot;&quot;&quot;,
    )

    parser.add_argument(&quot;input&quot;, help=&quot;Input PowerPoint file (.pptx)&quot;)
    parser.add_argument(&quot;output&quot;, help=&quot;Output JSON file for inventory&quot;)
    parser.add_argument(
        &quot;--issues-only&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Include only text shapes that have overflow or overlap issues&quot;,
    )

    args = parser.parse_args()

    input_path = Path(args.input)
    if not input_path.exists():
        print(f&quot;Error: Input file not found: {args.input}&quot;)
        sys.exit(1)

    if not input_path.suffix.lower() == &quot;.pptx&quot;:
        print(&quot;Error: Input must be a PowerPoint file (.pptx)&quot;)
        sys.exit(1)

    try:
        print(f&quot;Extracting text inventory from: {args.input}&quot;)
        if args.issues_only:
            print(
                &quot;Filtering to include only text shapes with issues (overflow/overlap)&quot;
            )
        inventory = extract_text_inventory(input_path, issues_only=args.issues_only)

        output_path = Path(args.output)
        output_path.parent.mkdir(parents=True, exist_ok=True)
        save_inventory(inventory, output_path)

        print(f&quot;Output saved to: {args.output}&quot;)

        # Report statistics
        total_slides = len(inventory)
        total_shapes = sum(len(shapes) for shapes in inventory.values())
        if args.issues_only:
            if total_shapes &gt; 0:
                print(
                    f&quot;Found {total_shapes} text elements with issues in {total_slides} slides&quot;
                )
            else:
                print(&quot;No issues discovered&quot;)
        else:
            print(
                f&quot;Found text in {total_slides} slides with {total_shapes} text elements&quot;
            )

    except Exception as e:
        print(f&quot;Error processing presentation: {e}&quot;)
        import traceback

        traceback.print_exc()
        sys.exit(1)


@dataclass
class ShapeWithPosition:
    &quot;&quot;&quot;A shape with its absolute position on the slide.&quot;&quot;&quot;

    shape: BaseShape
    absolute_left: int  # in EMUs
    absolute_top: int  # in EMUs


class ParagraphData:
    &quot;&quot;&quot;Data structure for paragraph properties extracted from a PowerPoint paragraph.&quot;&quot;&quot;

    def __init__(self, paragraph: Any):
        &quot;&quot;&quot;Initialize from a PowerPoint paragraph object.

        Args:
            paragraph: The PowerPoint paragraph object
        &quot;&quot;&quot;
        self.text: str = paragraph.text.strip()
        self.bullet: bool = False
        self.level: Optional[int] = None
        self.alignment: Optional[str] = None
        self.space_before: Optional[float] = None
        self.space_after: Optional[float] = None
        self.font_name: Optional[str] = None
        self.font_size: Optional[float] = None
        self.bold: Optional[bool] = None
        self.italic: Optional[bool] = None
        self.underline: Optional[bool] = None
        self.color: Optional[str] = None
        self.theme_color: Optional[str] = None
        self.line_spacing: Optional[float] = None

        # Check for bullet formatting
        if (
            hasattr(paragraph, &quot;_p&quot;)
            and paragraph._p is not None
            and paragraph._p.pPr is not None
        ):
            pPr = paragraph._p.pPr
            ns = &quot;{http://schemas.openxmlformats.org/drawingml/2006/main}&quot;
            if (
                pPr.find(f&quot;{ns}buChar&quot;) is not None
                or pPr.find(f&quot;{ns}buAutoNum&quot;) is not None
            ):
                self.bullet = True
                if hasattr(paragraph, &quot;level&quot;):
                    self.level = paragraph.level

        # Add alignment if not LEFT (default)
        if hasattr(paragraph, &quot;alignment&quot;) and paragraph.alignment is not None:
            alignment_map = {
                PP_ALIGN.CENTER: &quot;CENTER&quot;,
                PP_ALIGN.RIGHT: &quot;RIGHT&quot;,
                PP_ALIGN.JUSTIFY: &quot;JUSTIFY&quot;,
            }
            if paragraph.alignment in alignment_map:
                self.alignment = alignment_map[paragraph.alignment]

        # Add spacing properties if set
        if hasattr(paragraph, &quot;space_before&quot;) and paragraph.space_before:
            self.space_before = paragraph.space_before.pt
        if hasattr(paragraph, &quot;space_after&quot;) and paragraph.space_after:
            self.space_after = paragraph.space_after.pt

        # Extract font properties from first run
        if paragraph.runs:
            first_run = paragraph.runs[0]
            if hasattr(first_run, &quot;font&quot;):
                font = first_run.font
                if font.name:
                    self.font_name = font.name
                if font.size:
                    self.font_size = font.size.pt
                if font.bold is not None:
                    self.bold = font.bold
                if font.italic is not None:
                    self.italic = font.italic
                if font.underline is not None:
                    self.underline = font.underline

                # Handle color - both RGB and theme colors
                try:
                    # Try RGB color first
                    if font.color.rgb:
                        self.color = str(font.color.rgb)
                except (AttributeError, TypeError):
                    # Fall back to theme color
                    try:
                        if font.color.theme_color:
                            self.theme_color = font.color.theme_color.name
                    except (AttributeError, TypeError):
                        pass

        # Add line spacing if set
        if hasattr(paragraph, &quot;line_spacing&quot;) and paragraph.line_spacing is not None:
            if hasattr(paragraph.line_spacing, &quot;pt&quot;):
                self.line_spacing = round(paragraph.line_spacing.pt, 2)
            else:
                # Multiplier - convert to points
                font_size = self.font_size if self.font_size else 12.0
                self.line_spacing = round(paragraph.line_spacing * font_size, 2)

    def to_dict(self) -&gt; ParagraphDict:
        &quot;&quot;&quot;Convert to dictionary for JSON serialization, excluding None values.&quot;&quot;&quot;
        result: ParagraphDict = {&quot;text&quot;: self.text}

        # Add optional fields only if they have values
        if self.bullet:
            result[&quot;bullet&quot;] = self.bullet
        if self.level is not None:
            result[&quot;level&quot;] = self.level
        if self.alignment:
            result[&quot;alignment&quot;] = self.alignment
        if self.space_before is not None:
            result[&quot;space_before&quot;] = self.space_before
        if self.space_after is not None:
            result[&quot;space_after&quot;] = self.space_after
        if self.font_name:
            result[&quot;font_name&quot;] = self.font_name
        if self.font_size is not None:
            result[&quot;font_size&quot;] = self.font_size
        if self.bold is not None:
            result[&quot;bold&quot;] = self.bold
        if self.italic is not None:
            result[&quot;italic&quot;] = self.italic
        if self.underline is not None:
            result[&quot;underline&quot;] = self.underline
        if self.color:
            result[&quot;color&quot;] = self.color
        if self.theme_color:
            result[&quot;theme_color&quot;] = self.theme_color
        if self.line_spacing is not None:
            result[&quot;line_spacing&quot;] = self.line_spacing

        return result


class ShapeData:
    &quot;&quot;&quot;Data structure for shape properties extracted from a PowerPoint shape.&quot;&quot;&quot;

    @staticmethod
    def emu_to_inches(emu: int) -&gt; float:
        &quot;&quot;&quot;Convert EMUs (English Metric Units) to inches.&quot;&quot;&quot;
        return emu / 914400.0

    @staticmethod
    def inches_to_pixels(inches: float, dpi: int = 96) -&gt; int:
        &quot;&quot;&quot;Convert inches to pixels at given DPI.&quot;&quot;&quot;
        return int(inches * dpi)

    @staticmethod
    def get_font_path(font_name: str) -&gt; Optional[str]:
        &quot;&quot;&quot;Get the font file path for a given font name.

        Args:
            font_name: Name of the font (e.g., &#x27;Arial&#x27;, &#x27;Calibri&#x27;)

        Returns:
            Path to the font file, or None if not found
        &quot;&quot;&quot;
        system = platform.system()

        # Common font file variations to try
        font_variations = [
            font_name,
            font_name.lower(),
            font_name.replace(&quot; &quot;, &quot;&quot;),
            font_name.replace(&quot; &quot;, &quot;-&quot;),
        ]

        # Define font directories and extensions by platform
        if system == &quot;Darwin&quot;:  # macOS
            font_dirs = [
                &quot;/System/Library/Fonts/&quot;,
                &quot;/Library/Fonts/&quot;,
                &quot;~/Library/Fonts/&quot;,
            ]
            extensions = [&quot;.ttf&quot;, &quot;.otf&quot;, &quot;.ttc&quot;, &quot;.dfont&quot;]
        else:  # Linux
            font_dirs = [
                &quot;/usr/share/fonts/truetype/&quot;,
                &quot;/usr/local/share/fonts/&quot;,
                &quot;~/.fonts/&quot;,
            ]
            extensions = [&quot;.ttf&quot;, &quot;.otf&quot;]

        # Try to find the font file
        from pathlib import Path

        for font_dir in font_dirs:
            font_dir_path = Path(font_dir).expanduser()
            if not font_dir_path.exists():
                continue

            # First try exact matches
            for variant in font_variations:
                for ext in extensions:
                    font_path = font_dir_path / f&quot;{variant}{ext}&quot;
                    if font_path.exists():
                        return str(font_path)

            # Then try fuzzy matching - find files containing the font name
            try:
                for file_path in font_dir_path.iterdir():
                    if file_path.is_file():
                        file_name_lower = file_path.name.lower()
                        font_name_lower = font_name.lower().replace(&quot; &quot;, &quot;&quot;)
                        if font_name_lower in file_name_lower and any(
                            file_name_lower.endswith(ext) for ext in extensions
                        ):
                            return str(file_path)
            except (OSError, PermissionError):
                continue

        return None

    @staticmethod
    def get_slide_dimensions(slide: Any) -&gt; tuple[Optional[int], Optional[int]]:
        &quot;&quot;&quot;Get slide dimensions from slide object.

        Args:
            slide: Slide object

        Returns:
            Tuple of (width_emu, height_emu) or (None, None) if not found
        &quot;&quot;&quot;
        try:
            prs = slide.part.package.presentation_part.presentation
            return prs.slide_width, prs.slide_height
        except (AttributeError, TypeError):
            return None, None

    @staticmethod
    def get_default_font_size(shape: BaseShape, slide_layout: Any) -&gt; Optional[float]:
        &quot;&quot;&quot;Extract default font size from slide layout for a placeholder shape.

        Args:
            shape: Placeholder shape
            slide_layout: Slide layout containing the placeholder definition

        Returns:
            Default font size in points, or None if not found
        &quot;&quot;&quot;
        try:
            if not hasattr(shape, &quot;placeholder_format&quot;):
                return None

            shape_type = shape.placeholder_format.type  # type: ignore
            for layout_placeholder in slide_layout.placeholders:
                if layout_placeholder.placeholder_format.type == shape_type:
                    # Find first defRPr element with sz (size) attribute
                    for elem in layout_placeholder.element.iter():
                        if &quot;defRPr&quot; in elem.tag and (sz := elem.get(&quot;sz&quot;)):
                            return float(sz) / 100.0  # Convert EMUs to points
                    break
        except Exception:
            pass
        return None

    def __init__(
        self,
        shape: BaseShape,
        absolute_left: Optional[int] = None,
        absolute_top: Optional[int] = None,
        slide: Optional[Any] = None,
    ):
        &quot;&quot;&quot;Initialize from a PowerPoint shape object.

        Args:
            shape: The PowerPoint shape object (should be pre-validated)
            absolute_left: Absolute left position in EMUs (for shapes in groups)
            absolute_top: Absolute top position in EMUs (for shapes in groups)
            slide: Optional slide object to get dimensions and layout information
        &quot;&quot;&quot;
        self.shape = shape  # Store reference to original shape
        self.shape_id: str = &quot;&quot;  # Will be set after sorting

        # Get slide dimensions from slide object
        self.slide_width_emu, self.slide_height_emu = (
            self.get_slide_dimensions(slide) if slide else (None, None)
        )

        # Get placeholder type if applicable
        self.placeholder_type: Optional[str] = None
        self.default_font_size: Optional[float] = None
        if hasattr(shape, &quot;is_placeholder&quot;) and shape.is_placeholder:  # type: ignore
            if shape.placeholder_format and shape.placeholder_format.type:  # type: ignore
                self.placeholder_type = (
                    str(shape.placeholder_format.type).split(&quot;.&quot;)[-1].split(&quot; &quot;)[0]  # type: ignore
                )

                # Get default font size from layout
                if slide and hasattr(slide, &quot;slide_layout&quot;):
                    self.default_font_size = self.get_default_font_size(
                        shape, slide.slide_layout
                    )

        # Get position information
        # Use absolute positions if provided (for shapes in groups), otherwise use shape&#x27;s position
        left_emu = (
            absolute_left
            if absolute_left is not None
            else (shape.left if hasattr(shape, &quot;left&quot;) else 0)
        )
        top_emu = (
            absolute_top
            if absolute_top is not None
            else (shape.top if hasattr(shape, &quot;top&quot;) else 0)
        )

        self.left: float = round(self.emu_to_inches(left_emu), 2)  # type: ignore
        self.top: float = round(self.emu_to_inches(top_emu), 2)  # type: ignore
        self.width: float = round(
            self.emu_to_inches(shape.width if hasattr(shape, &quot;width&quot;) else 0),
            2,  # type: ignore
        )
        self.height: float = round(
            self.emu_to_inches(shape.height if hasattr(shape, &quot;height&quot;) else 0),
            2,  # type: ignore
        )

        # Store EMU positions for overflow calculations
        self.left_emu = left_emu
        self.top_emu = top_emu
        self.width_emu = shape.width if hasattr(shape, &quot;width&quot;) else 0
        self.height_emu = shape.height if hasattr(shape, &quot;height&quot;) else 0

        # Calculate overflow status
        self.frame_overflow_bottom: Optional[float] = None
        self.slide_overflow_right: Optional[float] = None
        self.slide_overflow_bottom: Optional[float] = None
        self.overlapping_shapes: Dict[
            str, float
        ] = {}  # Dict of shape_id -&gt; overlap area in sq inches
        self.warnings: List[str] = []
        self._estimate_frame_overflow()
        self._calculate_slide_overflow()
        self._detect_bullet_issues()

    @property
    def paragraphs(self) -&gt; List[ParagraphData]:
        &quot;&quot;&quot;Calculate paragraphs from the shape&#x27;s text frame.&quot;&quot;&quot;
        if not self.shape or not hasattr(self.shape, &quot;text_frame&quot;):
            return []

        paragraphs = []
        for paragraph in self.shape.text_frame.paragraphs:  # type: ignore
            if paragraph.text.strip():
                paragraphs.append(ParagraphData(paragraph))
        return paragraphs

    def _get_default_font_size(self) -&gt; int:
        &quot;&quot;&quot;Get default font size from theme text styles or use conservative default.&quot;&quot;&quot;
        try:
            if not (
                hasattr(self.shape, &quot;part&quot;) and hasattr(self.shape.part, &quot;slide_layout&quot;)
            ):
                return 14

            slide_master = self.shape.part.slide_layout.slide_master  # type: ignore
            if not hasattr(slide_master, &quot;element&quot;):
                return 14

            # Determine theme style based on placeholder type
            style_name = &quot;bodyStyle&quot;  # Default
            if self.placeholder_type and &quot;TITLE&quot; in self.placeholder_type:
                style_name = &quot;titleStyle&quot;

            # Find font size in theme styles
            for child in slide_master.element.iter():
                tag = child.tag.split(&quot;}&quot;)[-1] if &quot;}&quot; in child.tag else child.tag
                if tag == style_name:
                    for elem in child.iter():
                        if &quot;sz&quot; in elem.attrib:
                            return int(elem.attrib[&quot;sz&quot;]) // 100
        except Exception:
            pass

        return 14  # Conservative default for body text

    def _get_usable_dimensions(self, text_frame) -&gt; Tuple[int, int]:
        &quot;&quot;&quot;Get usable width and height in pixels after accounting for margins.&quot;&quot;&quot;
        # Default PowerPoint margins in inches
        margins = {&quot;top&quot;: 0.05, &quot;bottom&quot;: 0.05, &quot;left&quot;: 0.1, &quot;right&quot;: 0.1}

        # Override with actual margins if set
        if hasattr(text_frame, &quot;margin_top&quot;) and text_frame.margin_top:
            margins[&quot;top&quot;] = self.emu_to_inches(text_frame.margin_top)
        if hasattr(text_frame, &quot;margin_bottom&quot;) and text_frame.margin_bottom:
            margins[&quot;bottom&quot;] = self.emu_to_inches(text_frame.margin_bottom)
        if hasattr(text_frame, &quot;margin_left&quot;) and text_frame.margin_left:
            margins[&quot;left&quot;] = self.emu_to_inches(text_frame.margin_left)
        if hasattr(text_frame, &quot;margin_right&quot;) and text_frame.margin_right:
            margins[&quot;right&quot;] = self.emu_to_inches(text_frame.margin_right)

        # Calculate usable area
        usable_width = self.width - margins[&quot;left&quot;] - margins[&quot;right&quot;]
        usable_height = self.height - margins[&quot;top&quot;] - margins[&quot;bottom&quot;]

        # Convert to pixels
        return (
            self.inches_to_pixels(usable_width),
            self.inches_to_pixels(usable_height),
        )

    def _wrap_text_line(self, line: str, max_width_px: int, draw, font) -&gt; List[str]:
        &quot;&quot;&quot;Wrap a single line of text to fit within max_width_px.&quot;&quot;&quot;
        if not line:
            return [&quot;&quot;]

        # Use textlength for efficient width calculation
        if draw.textlength(line, font=font) &lt;= max_width_px:
            return [line]

        # Need to wrap - split into words
        wrapped = []
        words = line.split(&quot; &quot;)
        current_line = &quot;&quot;

        for word in words:
            test_line = current_line + (&quot; &quot; if current_line else &quot;&quot;) + word
            if draw.textlength(test_line, font=font) &lt;= max_width_px:
                current_line = test_line
            else:
                if current_line:
                    wrapped.append(current_line)
                current_line = word

        if current_line:
            wrapped.append(current_line)

        return wrapped

    def _estimate_frame_overflow(self) -&gt; None:
        &quot;&quot;&quot;Estimate if text overflows the shape bounds using PIL text measurement.&quot;&quot;&quot;
        if not self.shape or not hasattr(self.shape, &quot;text_frame&quot;):
            return

        text_frame = self.shape.text_frame  # type: ignore
        if not text_frame or not text_frame.paragraphs:
            return

        # Get usable dimensions after accounting for margins
        usable_width_px, usable_height_px = self._get_usable_dimensions(text_frame)
        if usable_width_px &lt;= 0 or usable_height_px &lt;= 0:
            return

        # Set up PIL for text measurement
        dummy_img = Image.new(&quot;RGB&quot;, (1, 1))
        draw = ImageDraw.Draw(dummy_img)

        # Get default font size from placeholder or use conservative estimate
        default_font_size = self._get_default_font_size()

        # Calculate total height of all paragraphs
        total_height_px = 0

        for para_idx, paragraph in enumerate(text_frame.paragraphs):
            if not paragraph.text.strip():
                continue

            para_data = ParagraphData(paragraph)

            # Load font for this paragraph
            font_name = para_data.font_name or &quot;Arial&quot;
            font_size = int(para_data.font_size or default_font_size)

            font = None
            font_path = self.get_font_path(font_name)
            if font_path:
                try:
                    font = ImageFont.truetype(font_path, size=font_size)
                except Exception:
                    font = ImageFont.load_default()
            else:
                font = ImageFont.load_default()

            # Wrap all lines in this paragraph
            all_wrapped_lines = []
            for line in paragraph.text.split(&quot;\n&quot;):
                wrapped = self._wrap_text_line(line, usable_width_px, draw, font)
                all_wrapped_lines.extend(wrapped)

            if all_wrapped_lines:
                # Calculate line height
                if para_data.line_spacing:
                    # Custom line spacing explicitly set
                    line_height_px = para_data.line_spacing * 96 / 72
                else:
                    # PowerPoint default single spacing (1.0x font size)
                    line_height_px = font_size * 96 / 72

                # Add space_before (except first paragraph)
                if para_idx &gt; 0 and para_data.space_before:
                    total_height_px += para_data.space_before * 96 / 72

                # Add paragraph text height
                total_height_px += len(all_wrapped_lines) * line_height_px

                # Add space_after
                if para_data.space_after:
                    total_height_px += para_data.space_after * 96 / 72

        # Check for overflow (ignore negligible overflows &lt;= 0.05&quot;)
        if total_height_px &gt; usable_height_px:
            overflow_px = total_height_px - usable_height_px
            overflow_inches = round(overflow_px / 96.0, 2)
            if overflow_inches &gt; 0.05:  # Only report significant overflows
                self.frame_overflow_bottom = overflow_inches

    def _calculate_slide_overflow(self) -&gt; None:
        &quot;&quot;&quot;Calculate if shape overflows the slide boundaries.&quot;&quot;&quot;
        if self.slide_width_emu is None or self.slide_height_emu is None:
            return

        # Check right overflow (ignore negligible overflows &lt;= 0.01&quot;)
        right_edge_emu = self.left_emu + self.width_emu
        if right_edge_emu &gt; self.slide_width_emu:
            overflow_emu = right_edge_emu - self.slide_width_emu
            overflow_inches = round(self.emu_to_inches(overflow_emu), 2)
            if overflow_inches &gt; 0.01:  # Only report significant overflows
                self.slide_overflow_right = overflow_inches

        # Check bottom overflow (ignore negligible overflows &lt;= 0.01&quot;)
        bottom_edge_emu = self.top_emu + self.height_emu
        if bottom_edge_emu &gt; self.slide_height_emu:
            overflow_emu = bottom_edge_emu - self.slide_height_emu
            overflow_inches = round(self.emu_to_inches(overflow_emu), 2)
            if overflow_inches &gt; 0.01:  # Only report significant overflows
                self.slide_overflow_bottom = overflow_inches

    def _detect_bullet_issues(self) -&gt; None:
        &quot;&quot;&quot;Detect bullet point formatting issues in paragraphs.&quot;&quot;&quot;
        if not self.shape or not hasattr(self.shape, &quot;text_frame&quot;):
            return

        text_frame = self.shape.text_frame  # type: ignore
        if not text_frame or not text_frame.paragraphs:
            return

        # Common bullet symbols that indicate manual bullets
        bullet_symbols = [&quot;&quot;, &quot;&quot;, &quot;&quot;]

        for paragraph in text_frame.paragraphs:
            text = paragraph.text.strip()
            # Check for manual bullet symbols
            if text and any(text.startswith(symbol + &quot; &quot;) for symbol in bullet_symbols):
                self.warnings.append(
                    &quot;manual_bullet_symbol: use proper bullet formatting&quot;
                )
                break

    @property
    def has_any_issues(self) -&gt; bool:
        &quot;&quot;&quot;Check if shape has any issues (overflow, overlap, or warnings).&quot;&quot;&quot;
        return (
            self.frame_overflow_bottom is not None
            or self.slide_overflow_right is not None
            or self.slide_overflow_bottom is not None
            or len(self.overlapping_shapes) &gt; 0
            or len(self.warnings) &gt; 0
        )

    def to_dict(self) -&gt; ShapeDict:
        &quot;&quot;&quot;Convert to dictionary for JSON serialization.&quot;&quot;&quot;
        result: ShapeDict = {
            &quot;left&quot;: self.left,
            &quot;top&quot;: self.top,
            &quot;width&quot;: self.width,
            &quot;height&quot;: self.height,
        }

        # Add optional fields if present
        if self.placeholder_type:
            result[&quot;placeholder_type&quot;] = self.placeholder_type

        if self.default_font_size:
            result[&quot;default_font_size&quot;] = self.default_font_size

        # Add overflow information only if there is overflow
        overflow_data = {}

        # Add frame overflow if present
        if self.frame_overflow_bottom is not None:
            overflow_data[&quot;frame&quot;] = {&quot;overflow_bottom&quot;: self.frame_overflow_bottom}

        # Add slide overflow if present
        slide_overflow = {}
        if self.slide_overflow_right is not None:
            slide_overflow[&quot;overflow_right&quot;] = self.slide_overflow_right
        if self.slide_overflow_bottom is not None:
            slide_overflow[&quot;overflow_bottom&quot;] = self.slide_overflow_bottom
        if slide_overflow:
            overflow_data[&quot;slide&quot;] = slide_overflow

        # Only add overflow field if there is overflow
        if overflow_data:
            result[&quot;overflow&quot;] = overflow_data

        # Add overlap field if there are overlapping shapes
        if self.overlapping_shapes:
            result[&quot;overlap&quot;] = {&quot;overlapping_shapes&quot;: self.overlapping_shapes}

        # Add warnings field if there are warnings
        if self.warnings:
            result[&quot;warnings&quot;] = self.warnings

        # Add paragraphs after placeholder_type
        result[&quot;paragraphs&quot;] = [para.to_dict() for para in self.paragraphs]

        return result


def is_valid_shape(shape: BaseShape) -&gt; bool:
    &quot;&quot;&quot;Check if a shape contains meaningful text content.&quot;&quot;&quot;
    # Must have a text frame with content
    if not hasattr(shape, &quot;text_frame&quot;) or not shape.text_frame:  # type: ignore
        return False

    text = shape.text_frame.text.strip()  # type: ignore
    if not text:
        return False

    # Skip slide numbers and numeric footers
    if hasattr(shape, &quot;is_placeholder&quot;) and shape.is_placeholder:  # type: ignore
        if shape.placeholder_format and shape.placeholder_format.type:  # type: ignore
            placeholder_type = (
                str(shape.placeholder_format.type).split(&quot;.&quot;)[-1].split(&quot; &quot;)[0]  # type: ignore
            )
            if placeholder_type == &quot;SLIDE_NUMBER&quot;:
                return False
            if placeholder_type == &quot;FOOTER&quot; and text.isdigit():
                return False

    return True


def collect_shapes_with_absolute_positions(
    shape: BaseShape, parent_left: int = 0, parent_top: int = 0
) -&gt; List[ShapeWithPosition]:
    &quot;&quot;&quot;Recursively collect all shapes with valid text, calculating absolute positions.

    For shapes within groups, their positions are relative to the group.
    This function calculates the absolute position on the slide by accumulating
    parent group offsets.

    Args:
        shape: The shape to process
        parent_left: Accumulated left offset from parent groups (in EMUs)
        parent_top: Accumulated top offset from parent groups (in EMUs)

    Returns:
        List of ShapeWithPosition objects with absolute positions
    &quot;&quot;&quot;
    if hasattr(shape, &quot;shapes&quot;):  # GroupShape
        result = []
        # Get this group&#x27;s position
        group_left = shape.left if hasattr(shape, &quot;left&quot;) else 0
        group_top = shape.top if hasattr(shape, &quot;top&quot;) else 0

        # Calculate absolute position for this group
        abs_group_left = parent_left + group_left
        abs_group_top = parent_top + group_top

        # Process children with accumulated offsets
        for child in shape.shapes:  # type: ignore
            result.extend(
                collect_shapes_with_absolute_positions(
                    child, abs_group_left, abs_group_top
                )
            )
        return result

    # Regular shape - check if it has valid text
    if is_valid_shape(shape):
        # Calculate absolute position
        shape_left = shape.left if hasattr(shape, &quot;left&quot;) else 0
        shape_top = shape.top if hasattr(shape, &quot;top&quot;) else 0

        return [
            ShapeWithPosition(
                shape=shape,
                absolute_left=parent_left + shape_left,
                absolute_top=parent_top + shape_top,
            )
        ]

    return []


def sort_shapes_by_position(shapes: List[ShapeData]) -&gt; List[ShapeData]:
    &quot;&quot;&quot;Sort shapes by visual position (top-to-bottom, left-to-right).

    Shapes within 0.5 inches vertically are considered on the same row.
    &quot;&quot;&quot;
    if not shapes:
        return shapes

    # Sort by top position first
    shapes = sorted(shapes, key=lambda s: (s.top, s.left))

    # Group shapes by row (within 0.5 inches vertically)
    result = []
    row = [shapes[0]]
    row_top = shapes[0].top

    for shape in shapes[1:]:
        if abs(shape.top - row_top) &lt;= 0.5:
            row.append(shape)
        else:
            # Sort current row by left position and add to result
            result.extend(sorted(row, key=lambda s: s.left))
            row = [shape]
            row_top = shape.top

    # Don&#x27;t forget the last row
    result.extend(sorted(row, key=lambda s: s.left))
    return result


def calculate_overlap(
    rect1: Tuple[float, float, float, float],
    rect2: Tuple[float, float, float, float],
    tolerance: float = 0.05,
) -&gt; Tuple[bool, float]:
    &quot;&quot;&quot;Calculate if and how much two rectangles overlap.

    Args:
        rect1: (left, top, width, height) of first rectangle in inches
        rect2: (left, top, width, height) of second rectangle in inches
        tolerance: Minimum overlap in inches to consider as overlapping (default: 0.05&quot;)

    Returns:
        Tuple of (overlaps, overlap_area) where:
        - overlaps: True if rectangles overlap by more than tolerance
        - overlap_area: Area of overlap in square inches
    &quot;&quot;&quot;
    left1, top1, w1, h1 = rect1
    left2, top2, w2, h2 = rect2

    # Calculate overlap dimensions
    overlap_width = min(left1 + w1, left2 + w2) - max(left1, left2)
    overlap_height = min(top1 + h1, top2 + h2) - max(top1, top2)

    # Check if there&#x27;s meaningful overlap (more than tolerance)
    if overlap_width &gt; tolerance and overlap_height &gt; tolerance:
        # Calculate overlap area in square inches
        overlap_area = overlap_width * overlap_height
        return True, round(overlap_area, 2)

    return False, 0


def detect_overlaps(shapes: List[ShapeData]) -&gt; None:
    &quot;&quot;&quot;Detect overlapping shapes and update their overlapping_shapes dictionaries.

    This function requires each ShapeData to have its shape_id already set.
    It modifies the shapes in-place, adding shape IDs with overlap areas in square inches.

    Args:
        shapes: List of ShapeData objects with shape_id attributes set
    &quot;&quot;&quot;
    n = len(shapes)

    # Compare each pair of shapes
    for i in range(n):
        for j in range(i + 1, n):
            shape1 = shapes[i]
            shape2 = shapes[j]

            # Ensure shape IDs are set
            assert shape1.shape_id, f&quot;Shape at index {i} has no shape_id&quot;
            assert shape2.shape_id, f&quot;Shape at index {j} has no shape_id&quot;

            rect1 = (shape1.left, shape1.top, shape1.width, shape1.height)
            rect2 = (shape2.left, shape2.top, shape2.width, shape2.height)

            overlaps, overlap_area = calculate_overlap(rect1, rect2)

            if overlaps:
                # Add shape IDs with overlap area in square inches
                shape1.overlapping_shapes[shape2.shape_id] = overlap_area
                shape2.overlapping_shapes[shape1.shape_id] = overlap_area


def extract_text_inventory(
    pptx_path: Path, prs: Optional[Any] = None, issues_only: bool = False
) -&gt; InventoryData:
    &quot;&quot;&quot;Extract text content from all slides in a PowerPoint presentation.

    Args:
        pptx_path: Path to the PowerPoint file
        prs: Optional Presentation object to use. If not provided, will load from pptx_path.
        issues_only: If True, only include shapes that have overflow or overlap issues

    Returns a nested dictionary: {slide-N: {shape-N: ShapeData}}
    Shapes are sorted by visual position (top-to-bottom, left-to-right).
    The ShapeData objects contain the full shape information and can be
    converted to dictionaries for JSON serialization using to_dict().
    &quot;&quot;&quot;
    if prs is None:
        prs = Presentation(str(pptx_path))
    inventory: InventoryData = {}

    for slide_idx, slide in enumerate(prs.slides):
        # Collect all valid shapes from this slide with absolute positions
        shapes_with_positions = []
        for shape in slide.shapes:  # type: ignore
            shapes_with_positions.extend(collect_shapes_with_absolute_positions(shape))

        if not shapes_with_positions:
            continue

        # Convert to ShapeData with absolute positions and slide reference
        shape_data_list = [
            ShapeData(
                swp.shape,
                swp.absolute_left,
                swp.absolute_top,
                slide,
            )
            for swp in shapes_with_positions
        ]

        # Sort by visual position and assign stable IDs in one step
        sorted_shapes = sort_shapes_by_position(shape_data_list)
        for idx, shape_data in enumerate(sorted_shapes):
            shape_data.shape_id = f&quot;shape-{idx}&quot;

        # Detect overlaps using the stable shape IDs
        if len(sorted_shapes) &gt; 1:
            detect_overlaps(sorted_shapes)

        # Filter for issues only if requested (after overlap detection)
        if issues_only:
            sorted_shapes = [sd for sd in sorted_shapes if sd.has_any_issues]

        if not sorted_shapes:
            continue

        # Create slide inventory using the stable shape IDs
        inventory[f&quot;slide-{slide_idx}&quot;] = {
            shape_data.shape_id: shape_data for shape_data in sorted_shapes
        }

    return inventory


def get_inventory_as_dict(pptx_path: Path, issues_only: bool = False) -&gt; InventoryDict:
    &quot;&quot;&quot;Extract text inventory and return as JSON-serializable dictionaries.

    This is a convenience wrapper around extract_text_inventory that returns
    dictionaries instead of ShapeData objects, useful for testing and direct
    JSON serialization.

    Args:
        pptx_path: Path to the PowerPoint file
        issues_only: If True, only include shapes that have overflow or overlap issues

    Returns:
        Nested dictionary with all data serialized for JSON
    &quot;&quot;&quot;
    inventory = extract_text_inventory(pptx_path, issues_only=issues_only)

    # Convert ShapeData objects to dictionaries
    dict_inventory: InventoryDict = {}
    for slide_key, shapes in inventory.items():
        dict_inventory[slide_key] = {
            shape_key: shape_data.to_dict() for shape_key, shape_data in shapes.items()
        }

    return dict_inventory


def save_inventory(inventory: InventoryData, output_path: Path) -&gt; None:
    &quot;&quot;&quot;Save inventory to JSON file with proper formatting.

    Converts ShapeData objects to dictionaries for JSON serialization.
    &quot;&quot;&quot;
    # Convert ShapeData objects to dictionaries
    json_inventory: InventoryDict = {}
    for slide_key, shapes in inventory.items():
        json_inventory[slide_key] = {
            shape_key: shape_data.to_dict() for shape_key, shape_data in shapes.items()
        }

    with open(output_path, &quot;w&quot;, encoding=&quot;utf-8&quot;) as f:
        json.dump(json_inventory, f, indent=2, ensure_ascii=False)


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/inventory/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/scripts/inventory.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="italiana_ofl Imported skill italiana_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/Italiana-OFL.txt Unknown LICENSE.txt sources/anthropic/italiana_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">italiana_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('italiana_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill italiana_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright (c) 2011, Santiago Orozco (hi@typemade.mx), with Reserved Font Name &quot;Italiana&quot;.

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/italiana_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/Italiana-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="jetbrainsmono_ofl Imported skill jetbrainsmono_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/JetBrainsMono-OFL.txt Unknown LICENSE.txt sources/anthropic/jetbrainsmono_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">jetbrainsmono_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('jetbrainsmono_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill jetbrainsmono_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2020 The JetBrains Mono Project Authors (https://github.com/JetBrains/JetBrainsMono)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/jetbrainsmono_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/JetBrainsMono-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="jura_ofl Imported skill jura_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/Jura-OFL.txt Unknown LICENSE.txt sources/anthropic/jura_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">jura_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('jura_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill jura_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2019 The Jura Project Authors (https://github.com/ossobuffo/jura)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/jura_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/Jura-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="librebaskerville_ofl Imported skill librebaskerville_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/LibreBaskerville-OFL.txt Unknown LICENSE.txt sources/anthropic/librebaskerville_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">librebaskerville_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('librebaskerville_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill librebaskerville_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2012 The Libre Baskerville Project Authors (https://github.com/impallari/Libre-Baskerville) with Reserved Font Name Libre Baskerville.

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/librebaskerville_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/LibreBaskerville-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="license Imported skill license from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/mcp-builder/LICENSE.txt Unknown LICENSE.txt sources/anthropic/license/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">license</div>
                <button class="copy-btn" onclick="copyToClipboard('license')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill license from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      &quot;License&quot; shall mean the terms and conditions for use, reproduction,
      and distribution as defined by Sections 1 through 9 of this document.

      &quot;Licensor&quot; shall mean the copyright owner or entity authorized by
      the copyright owner that is granting the License.

      &quot;Legal Entity&quot; shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under common
      control with that entity. For the purposes of this definition,
      &quot;control&quot; means (i) the power, direct or indirect, to cause the
      direction or management of such entity, whether by contract or
      otherwise, or (ii) ownership of fifty percent (50%) or more of the
      outstanding shares, or (iii) beneficial ownership of such entity.

      &quot;You&quot; (or &quot;Your&quot;) shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      &quot;Source&quot; form shall mean the preferred form for making modifications,
      including but not limited to software source code, documentation
      source, and configuration files.

      &quot;Object&quot; form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      &quot;Work&quot; shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      &quot;Derivative Works&quot; shall mean any work, whether in Source or Object
      form, that is based on (or derived from) the Work and for which the
      editorial revisions, annotations, elaborations, or other modifications
      represent, as a whole, an original work of authorship. For the purposes
      of this License, Derivative Works shall not include works that remain
      separable from, or merely link (or bind by name) to the interfaces of,
      the Work and Derivative Works thereof.

      &quot;Contribution&quot; shall mean any work of authorship, including
      the original version of the Work and any modifications or additions
      to that Work or Derivative Works thereof, that is intentionally
      submitted to Licensor for inclusion in the Work by the copyright owner
      or by an individual or Legal Entity authorized to submit on behalf of
      the copyright owner. For the purposes of this definition, &quot;submitted&quot;
      means any form of electronic, verbal, or written communication sent
      to the Licensor or its representatives, including but not limited to
      communication on electronic mailing lists, source code control systems,
      and issue tracking systems that are managed by, or on behalf of, the
      Licensor for the purpose of discussing and improving the Work, but
      excluding communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as &quot;Not a Contribution.&quot;

      &quot;Contributor&quot; shall mean Licensor and any individual or Legal Entity
      on behalf of whom a Contribution has been received by Licensor and
      subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      copyright license to reproduce, prepare Derivative Works of,
      publicly display, publicly perform, sublicense, and distribute the
      Work and such Derivative Works in Source or Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have made,
      use, offer to sell, sell, import, and otherwise transfer the Work,
      where such license applies only to those patent claims licensable
      by such Contributor that are necessarily infringed by their
      Contribution(s) alone or by combination of their Contribution(s)
      with the Work to which such Contribution(s) was submitted. If You
      institute patent litigation against any entity (including a
      cross-claim or counterclaim in a lawsuit) alleging that the Work
      or a Contribution incorporated within the Work constitutes direct
      or contributory patent infringement, then any patent licenses
      granted to You under this License for that Work shall terminate
      as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a &quot;NOTICE&quot; text file as part of its
          distribution, then any Derivative Works that You distribute must
          include a readable copy of the attribution notices contained
          within such NOTICE file, excluding those notices that do not
          pertain to any part of the Derivative Works, in at least one
          of the following places: within a NOTICE text file distributed
          as part of the Derivative Works; within the Source form or
          documentation, if provided along with the Derivative Works; or,
          within a display generated by the Derivative Works, if and
          wherever such third-party notices normally appear. The contents
          of the NOTICE file are for informational purposes only and
          do not modify the License. You may add Your own attribution
          notices within Derivative Works that You distribute, alongside
          or as an addendum to the NOTICE text from the Work, provided
          that such additional attribution notices cannot be construed
          as modifying the License.

      You may add Your own copyright statement to Your modifications and
      may provide additional or different license terms and conditions
      for use, reproduction, or distribution of Your modifications, or
      for any such Derivative Works as a whole, provided Your use,
      reproduction, and distribution of the Work otherwise complies with
      the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state otherwise,
      any Contribution intentionally submitted for inclusion in the Work
      by You to the Licensor shall be under the terms and conditions of
      this License, without any additional terms or conditions.
      Notwithstanding the above, nothing herein shall supersede or modify
      the terms of any separate license agreement you may have executed
      with Licensor regarding such Contributions.

   6. Trademarks. This License does not grant permission to use the trade
      names, trademarks, service marks, or product names of the Licensor,
      except as required for reasonable and customary use in describing the
      origin of the Work and reproducing the content of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an &quot;AS IS&quot; BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or conditions
      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
      PARTICULAR PURPOSE. You are solely responsible for determining the
      appropriateness of using or redistributing the Work and assume any
      risks associated with Your exercise of permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
      liable to You for damages, including any direct, indirect, special,
      incidental, or consequential damages of any character arising as a
      result of this License or out of the use or inability to use the
      Work (including but not limited to damages for loss of goodwill,
      work stoppage, computer failure or malfunction, or any and all
      other commercial damages or losses), even if such Contributor
      has been advised of the possibility of such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by reason
      of your accepting any such warranty or additional liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets &quot;[]&quot;
      replaced with your own identifying information. (Don&#x27;t include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same &quot;printed page&quot; as the copyright notice for easier
      identification within third-party archives.

   Copyright [yyyy] [name of copyright owner]

   Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/license/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/LICENSE.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="lora_ofl Imported skill lora_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/Lora-OFL.txt Unknown LICENSE.txt sources/anthropic/lora_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">lora_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('lora_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill lora_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2011 The Lora Project Authors (https://github.com/cyrealtype/Lora-Cyrillic), with Reserved Font Name &quot;Lora&quot;.

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/lora_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/Lora-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="marketplace Imported skill marketplace from anthropic anthropic /a0/tmp/skills_research/anthropic/.claude-plugin/marketplace.json Unknown LICENSE.txt sources/anthropic/marketplace/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">marketplace</div>
                <button class="copy-btn" onclick="copyToClipboard('marketplace')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill marketplace from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;name&quot;: &quot;anthropic-agent-skills&quot;,
  &quot;owner&quot;: {
    &quot;name&quot;: &quot;Keith Lazuka&quot;,
    &quot;email&quot;: &quot;klazuka@anthropic.com&quot;
  },
  &quot;metadata&quot;: {
    &quot;description&quot;: &quot;Anthropic example skills&quot;,
    &quot;version&quot;: &quot;1.0.0&quot;
  },
  &quot;plugins&quot;: [
    {
      &quot;name&quot;: &quot;document-skills&quot;,
      &quot;description&quot;: &quot;Collection of document processing suite including Excel, Word, PowerPoint, and PDF capabilities&quot;,
      &quot;source&quot;: &quot;./&quot;,
      &quot;strict&quot;: false,
      &quot;skills&quot;: [
        &quot;./skills/xlsx&quot;,
        &quot;./skills/docx&quot;,
        &quot;./skills/pptx&quot;,
        &quot;./skills/pdf&quot;
      ]
    },
    {
      &quot;name&quot;: &quot;example-skills&quot;,
      &quot;description&quot;: &quot;Collection of example skills demonstrating various capabilities including skill creation, MCP building, visual design, algorithmic art, internal communications, web testing, artifact building, Slack GIFs, and theme styling&quot;,
      &quot;source&quot;: &quot;./&quot;,
      &quot;strict&quot;: false,
      &quot;skills&quot;: [
        &quot;./skills/algorithmic-art&quot;,
        &quot;./skills/brand-guidelines&quot;,
        &quot;./skills/canvas-design&quot;,
        &quot;./skills/doc-coauthoring&quot;,
        &quot;./skills/frontend-design&quot;,
        &quot;./skills/internal-comms&quot;,
        &quot;./skills/mcp-builder&quot;,
        &quot;./skills/skill-creator&quot;,
        &quot;./skills/slack-gif-creator&quot;,
        &quot;./skills/theme-factory&quot;,
        &quot;./skills/web-artifacts-builder&quot;,
        &quot;./skills/webapp-testing&quot;
      ]
    }
  ]
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/marketplace/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/anthropics/skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <span class="badge muted">License: LICENSE.txt</span>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="mcp_best_practices Imported skill mcp_best_practices from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/mcp-builder/reference/mcp_best_practices.md Unknown LICENSE.txt sources/anthropic/mcp_best_practices/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">mcp_best_practices</div>
                <button class="copy-btn" onclick="copyToClipboard('mcp_best_practices')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill mcp_best_practices from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># MCP Server Best Practices

## Quick Reference

### Server Naming
- **Python**: `{service}_mcp` (e.g., `slack_mcp`)
- **Node/TypeScript**: `{service}-mcp-server` (e.g., `slack-mcp-server`)

### Tool Naming
- Use snake_case with service prefix
- Format: `{service}_{action}_{resource}`
- Example: `slack_send_message`, `github_create_issue`

### Response Formats
- Support both JSON and Markdown formats
- JSON for programmatic processing
- Markdown for human readability

### Pagination
- Always respect `limit` parameter
- Return `has_more`, `next_offset`, `total_count`
- Default to 20-50 items

### Transport
- **Streamable HTTP**: For remote servers, multi-client scenarios
- **stdio**: For local integrations, command-line tools
- Avoid SSE (deprecated in favor of streamable HTTP)

---

## Server Naming Conventions

Follow these standardized naming patterns:

**Python**: Use format `{service}_mcp` (lowercase with underscores)
- Examples: `slack_mcp`, `github_mcp`, `jira_mcp`

**Node/TypeScript**: Use format `{service}-mcp-server` (lowercase with hyphens)
- Examples: `slack-mcp-server`, `github-mcp-server`, `jira-mcp-server`

The name should be general, descriptive of the service being integrated, easy to infer from the task description, and without version numbers.

---

## Tool Naming and Design

### Tool Naming

1. **Use snake_case**: `search_users`, `create_project`, `get_channel_info`
2. **Include service prefix**: Anticipate that your MCP server may be used alongside other MCP servers
   - Use `slack_send_message` instead of just `send_message`
   - Use `github_create_issue` instead of just `create_issue`
3. **Be action-oriented**: Start with verbs (get, list, search, create, etc.)
4. **Be specific**: Avoid generic names that could conflict with other servers

### Tool Design

- Tool descriptions must narrowly and unambiguously describe functionality
- Descriptions must precisely match actual functionality
- Provide tool annotations (readOnlyHint, destructiveHint, idempotentHint, openWorldHint)
- Keep tool operations focused and atomic

---

## Response Formats

All tools that return data should support multiple formats:

### JSON Format (`response_format=&quot;json&quot;`)
- Machine-readable structured data
- Include all available fields and metadata
- Consistent field names and types
- Use for programmatic processing

### Markdown Format (`response_format=&quot;markdown&quot;`, typically default)
- Human-readable formatted text
- Use headers, lists, and formatting for clarity
- Convert timestamps to human-readable format
- Show display names with IDs in parentheses
- Omit verbose metadata

---

## Pagination

For tools that list resources:

- **Always respect the `limit` parameter**
- **Implement pagination**: Use `offset` or cursor-based pagination
- **Return pagination metadata**: Include `has_more`, `next_offset`/`next_cursor`, `total_count`
- **Never load all results into memory**: Especially important for large datasets
- **Default to reasonable limits**: 20-50 items is typical

Example pagination response:
```json
{
  &quot;total&quot;: 150,
  &quot;count&quot;: 20,
  &quot;offset&quot;: 0,
  &quot;items&quot;: [...],
  &quot;has_more&quot;: true,
  &quot;next_offset&quot;: 20
}
```

---

## Transport Options

### Streamable HTTP

**Best for**: Remote servers, web services, multi-client scenarios

**Characteristics**:
- Bidirectional communication over HTTP
- Supports multiple simultaneous clients
- Can be deployed as a web service
- Enables server-to-client notifications

**Use when**:
- Serving multiple clients simultaneously
- Deploying as a cloud service
- Integration with web applications

### stdio

**Best for**: Local integrations, command-line tools

**Characteristics**:
- Standard input/output stream communication
- Simple setup, no network configuration needed
- Runs as a subprocess of the client

**Use when**:
- Building tools for local development environments
- Integrating with desktop applications
- Single-user, single-session scenarios

**Note**: stdio servers should NOT log to stdout (use stderr for logging)

### Transport Selection

| Criterion | stdio | Streamable HTTP |
|-----------|-------|-----------------|
| **Deployment** | Local | Remote |
| **Clients** | Single | Multiple |
| **Complexity** | Low | Medium |
| **Real-time** | No | Yes |

---

## Security Best Practices

### Authentication and Authorization

**OAuth 2.1**:
- Use secure OAuth 2.1 with certificates from recognized authorities
- Validate access tokens before processing requests
- Only accept tokens specifically intended for your server

**API Keys**:
- Store API keys in environment variables, never in code
- Validate keys on server startup
- Provide clear error messages when authentication fails

### Input Validation

- Sanitize file paths to prevent directory traversal
- Validate URLs and external identifiers
- Check parameter sizes and ranges
- Prevent command injection in system calls
- Use schema validation (Pydantic/Zod) for all inputs

### Error Handling

- Don&#x27;t expose internal errors to clients
- Log security-relevant errors server-side
- Provide helpful but not revealing error messages
- Clean up resources after errors

### DNS Rebinding Protection

For streamable HTTP servers running locally:
- Enable DNS rebinding protection
- Validate the `Origin` header on all incoming connections
- Bind to `127.0.0.1` rather than `0.0.0.0`

---

## Tool Annotations

Provide annotations to help clients understand tool behavior:

| Annotation | Type | Default | Description |
|-----------|------|---------|-------------|
| `readOnlyHint` | boolean | false | Tool does not modify its environment |
| `destructiveHint` | boolean | true | Tool may perform destructive updates |
| `idempotentHint` | boolean | false | Repeated calls with same args have no additional effect |
| `openWorldHint` | boolean | true | Tool interacts with external entities |

**Important**: Annotations are hints, not security guarantees. Clients should not make security-critical decisions based solely on annotations.

---

## Error Handling

- Use standard JSON-RPC error codes
- Report tool errors within result objects (not protocol-level errors)
- Provide helpful, specific error messages with suggested next steps
- Don&#x27;t expose internal implementation details
- Clean up resources properly on errors

Example error handling:
```typescript
try {
  const result = performOperation();
  return { content: [{ type: &quot;text&quot;, text: result }] };
} catch (error) {
  return {
    isError: true,
    content: [{
      type: &quot;text&quot;,
      text: `Error: ${error.message}. Try using filter=&#x27;active_only&#x27; to reduce results.`
    }]
  };
}
```

---

## Testing Requirements

Comprehensive testing should cover:

- **Functional testing**: Verify correct execution with valid/invalid inputs
- **Integration testing**: Test interaction with external systems
- **Security testing**: Validate auth, input sanitization, rate limiting
- **Performance testing**: Check behavior under load, timeouts
- **Error handling**: Ensure proper error reporting and cleanup

---

## Documentation Requirements

- Provide clear documentation of all tools and capabilities
- Include working examples (at least 3 per major feature)
- Document security considerations
- Specify required permissions and access levels
- Document rate limits and performance characteristics</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/mcp_best_practices/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/reference/mcp_best_practices.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="midnight_galaxy Imported skill midnight_galaxy from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/theme-factory/themes/midnight-galaxy.md Unknown LICENSE.txt sources/anthropic/midnight_galaxy/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">midnight_galaxy</div>
                <button class="copy-btn" onclick="copyToClipboard('midnight_galaxy')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill midnight_galaxy from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Midnight Galaxy

A dramatic and cosmic theme with deep purples and mystical tones for impactful presentations.

## Color Palette

- **Deep Purple**: `#2b1e3e` - Rich dark base
- **Cosmic Blue**: `#4a4e8f` - Mystical mid-tone
- **Lavender**: `#a490c2` - Soft accent color
- **Silver**: `#e6e6fa` - Light highlights and text

## Typography

- **Headers**: FreeSans Bold
- **Body Text**: FreeSans

## Best Used For

Entertainment industry, gaming presentations, nightlife venues, luxury brands, creative agencies.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/midnight_galaxy/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/themes/midnight-galaxy.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="modern_minimalist Imported skill modern_minimalist from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/theme-factory/themes/modern-minimalist.md Unknown LICENSE.txt sources/anthropic/modern_minimalist/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">modern_minimalist</div>
                <button class="copy-btn" onclick="copyToClipboard('modern_minimalist')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill modern_minimalist from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Modern Minimalist

A clean and contemporary theme with a sophisticated grayscale palette for maximum versatility.

## Color Palette

- **Charcoal**: `#36454f` - Primary dark color
- **Slate Gray**: `#708090` - Medium gray for accents
- **Light Gray**: `#d3d3d3` - Backgrounds and dividers
- **White**: `#ffffff` - Text and clean backgrounds

## Typography

- **Headers**: DejaVu Sans Bold
- **Body Text**: DejaVu Sans

## Best Used For

Tech presentations, architecture portfolios, design showcases, modern business proposals, data visualization.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/modern_minimalist/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/themes/modern-minimalist.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="nationalpark_ofl Imported skill nationalpark_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/NationalPark-OFL.txt Unknown LICENSE.txt sources/anthropic/nationalpark_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">nationalpark_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('nationalpark_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill nationalpark_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2025 The National Park Project Authors (https://github.com/benhoepner/National-Park)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/nationalpark_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/NationalPark-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="node_mcp_server Imported skill node_mcp_server from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/mcp-builder/reference/node_mcp_server.md Unknown LICENSE.txt sources/anthropic/node_mcp_server/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">node_mcp_server</div>
                <button class="copy-btn" onclick="copyToClipboard('node_mcp_server')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill node_mcp_server from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Node/TypeScript MCP Server Implementation Guide

## Overview

This document provides Node/TypeScript-specific best practices and examples for implementing MCP servers using the MCP TypeScript SDK. It covers project structure, server setup, tool registration patterns, input validation with Zod, error handling, and complete working examples.

---

## Quick Reference

### Key Imports
```typescript
import { McpServer } from &quot;@modelcontextprotocol/sdk/server/mcp.js&quot;;
import { StreamableHTTPServerTransport } from &quot;@modelcontextprotocol/sdk/server/streamableHttp.js&quot;;
import { StdioServerTransport } from &quot;@modelcontextprotocol/sdk/server/stdio.js&quot;;
import express from &quot;express&quot;;
import { z } from &quot;zod&quot;;
```

### Server Initialization
```typescript
const server = new McpServer({
  name: &quot;service-mcp-server&quot;,
  version: &quot;1.0.0&quot;
});
```

### Tool Registration Pattern
```typescript
server.registerTool(
  &quot;tool_name&quot;,
  {
    title: &quot;Tool Display Name&quot;,
    description: &quot;What the tool does&quot;,
    inputSchema: { param: z.string() },
    outputSchema: { result: z.string() }
  },
  async ({ param }) =&gt; {
    const output = { result: `Processed: ${param}` };
    return {
      content: [{ type: &quot;text&quot;, text: JSON.stringify(output) }],
      structuredContent: output // Modern pattern for structured data
    };
  }
);
```

---

## MCP TypeScript SDK

The official MCP TypeScript SDK provides:
- `McpServer` class for server initialization
- `registerTool` method for tool registration
- Zod schema integration for runtime input validation
- Type-safe tool handler implementations

**IMPORTANT - Use Modern APIs Only:**
- **DO use**: `server.registerTool()`, `server.registerResource()`, `server.registerPrompt()`
- **DO NOT use**: Old deprecated APIs such as `server.tool()`, `server.setRequestHandler(ListToolsRequestSchema, ...)`, or manual handler registration
- The `register*` methods provide better type safety, automatic schema handling, and are the recommended approach

See the MCP SDK documentation in the references for complete details.

## Server Naming Convention

Node/TypeScript MCP servers must follow this naming pattern:
- **Format**: `{service}-mcp-server` (lowercase with hyphens)
- **Examples**: `github-mcp-server`, `jira-mcp-server`, `stripe-mcp-server`

The name should be:
- General (not tied to specific features)
- Descriptive of the service/API being integrated
- Easy to infer from the task description
- Without version numbers or dates

## Project Structure

Create the following structure for Node/TypeScript MCP servers:

```
{service}-mcp-server/
 package.json
 tsconfig.json
 README.md
 src/
    index.ts          # Main entry point with McpServer initialization
    types.ts          # TypeScript type definitions and interfaces
    tools/            # Tool implementations (one file per domain)
    services/         # API clients and shared utilities
    schemas/          # Zod validation schemas
    constants.ts      # Shared constants (API_URL, CHARACTER_LIMIT, etc.)
 dist/                 # Built JavaScript files (entry point: dist/index.js)
```

## Tool Implementation

### Tool Naming

Use snake_case for tool names (e.g., &quot;search_users&quot;, &quot;create_project&quot;, &quot;get_channel_info&quot;) with clear, action-oriented names.

**Avoid Naming Conflicts**: Include the service context to prevent overlaps:
- Use &quot;slack_send_message&quot; instead of just &quot;send_message&quot;
- Use &quot;github_create_issue&quot; instead of just &quot;create_issue&quot;
- Use &quot;asana_list_tasks&quot; instead of just &quot;list_tasks&quot;

### Tool Structure

Tools are registered using the `registerTool` method with the following requirements:
- Use Zod schemas for runtime input validation and type safety
- The `description` field must be explicitly provided - JSDoc comments are NOT automatically extracted
- Explicitly provide `title`, `description`, `inputSchema`, and `annotations`
- The `inputSchema` must be a Zod schema object (not a JSON schema)
- Type all parameters and return values explicitly

```typescript
import { McpServer } from &quot;@modelcontextprotocol/sdk/server/mcp.js&quot;;
import { z } from &quot;zod&quot;;

const server = new McpServer({
  name: &quot;example-mcp&quot;,
  version: &quot;1.0.0&quot;
});

// Zod schema for input validation
const UserSearchInputSchema = z.object({
  query: z.string()
    .min(2, &quot;Query must be at least 2 characters&quot;)
    .max(200, &quot;Query must not exceed 200 characters&quot;)
    .describe(&quot;Search string to match against names/emails&quot;),
  limit: z.number()
    .int()
    .min(1)
    .max(100)
    .default(20)
    .describe(&quot;Maximum results to return&quot;),
  offset: z.number()
    .int()
    .min(0)
    .default(0)
    .describe(&quot;Number of results to skip for pagination&quot;),
  response_format: z.nativeEnum(ResponseFormat)
    .default(ResponseFormat.MARKDOWN)
    .describe(&quot;Output format: &#x27;markdown&#x27; for human-readable or &#x27;json&#x27; for machine-readable&quot;)
}).strict();

// Type definition from Zod schema
type UserSearchInput = z.infer&lt;typeof UserSearchInputSchema&gt;;

server.registerTool(
  &quot;example_search_users&quot;,
  {
    title: &quot;Search Example Users&quot;,
    description: `Search for users in the Example system by name, email, or team.

This tool searches across all user profiles in the Example platform, supporting partial matches and various search filters. It does NOT create or modify users, only searches existing ones.

Args:
  - query (string): Search string to match against names/emails
  - limit (number): Maximum results to return, between 1-100 (default: 20)
  - offset (number): Number of results to skip for pagination (default: 0)
  - response_format (&#x27;markdown&#x27; | &#x27;json&#x27;): Output format (default: &#x27;markdown&#x27;)

Returns:
  For JSON format: Structured data with schema:
  {
    &quot;total&quot;: number,           // Total number of matches found
    &quot;count&quot;: number,           // Number of results in this response
    &quot;offset&quot;: number,          // Current pagination offset
    &quot;users&quot;: [
      {
        &quot;id&quot;: string,          // User ID (e.g., &quot;U123456789&quot;)
        &quot;name&quot;: string,        // Full name (e.g., &quot;John Doe&quot;)
        &quot;email&quot;: string,       // Email address
        &quot;team&quot;: string,        // Team name (optional)
        &quot;active&quot;: boolean      // Whether user is active
      }
    ],
    &quot;has_more&quot;: boolean,       // Whether more results are available
    &quot;next_offset&quot;: number      // Offset for next page (if has_more is true)
  }

Examples:
  - Use when: &quot;Find all marketing team members&quot; -&gt; params with query=&quot;team:marketing&quot;
  - Use when: &quot;Search for John&#x27;s account&quot; -&gt; params with query=&quot;john&quot;
  - Don&#x27;t use when: You need to create a user (use example_create_user instead)

Error Handling:
  - Returns &quot;Error: Rate limit exceeded&quot; if too many requests (429 status)
  - Returns &quot;No users found matching &#x27;&lt;query&gt;&#x27;&quot; if search returns empty`,
    inputSchema: UserSearchInputSchema,
    annotations: {
      readOnlyHint: true,
      destructiveHint: false,
      idempotentHint: true,
      openWorldHint: true
    }
  },
  async (params: UserSearchInput) =&gt; {
    try {
      // Input validation is handled by Zod schema
      // Make API request using validated parameters
      const data = await makeApiRequest&lt;any&gt;(
        &quot;users/search&quot;,
        &quot;GET&quot;,
        undefined,
        {
          q: params.query,
          limit: params.limit,
          offset: params.offset
        }
      );

      const users = data.users || [];
      const total = data.total || 0;

      if (!users.length) {
        return {
          content: [{
            type: &quot;text&quot;,
            text: `No users found matching &#x27;${params.query}&#x27;`
          }]
        };
      }

      // Prepare structured output
      const output = {
        total,
        count: users.length,
        offset: params.offset,
        users: users.map((user: any) =&gt; ({
          id: user.id,
          name: user.name,
          email: user.email,
          ...(user.team ? { team: user.team } : {}),
          active: user.active ?? true
        })),
        has_more: total &gt; params.offset + users.length,
        ...(total &gt; params.offset + users.length ? {
          next_offset: params.offset + users.length
        } : {})
      };

      // Format text representation based on requested format
      let textContent: string;
      if (params.response_format === ResponseFormat.MARKDOWN) {
        const lines = [`# User Search Results: &#x27;${params.query}&#x27;`, &quot;&quot;,
          `Found ${total} users (showing ${users.length})`, &quot;&quot;];
        for (const user of users) {
          lines.push(`## ${user.name} (${user.id})`);
          lines.push(`- **Email**: ${user.email}`);
          if (user.team) lines.push(`- **Team**: ${user.team}`);
          lines.push(&quot;&quot;);
        }
        textContent = lines.join(&quot;\n&quot;);
      } else {
        textContent = JSON.stringify(output, null, 2);
      }

      return {
        content: [{ type: &quot;text&quot;, text: textContent }],
        structuredContent: output // Modern pattern for structured data
      };
    } catch (error) {
      return {
        content: [{
          type: &quot;text&quot;,
          text: handleApiError(error)
        }]
      };
    }
  }
);
```

## Zod Schemas for Input Validation

Zod provides runtime type validation:

```typescript
import { z } from &quot;zod&quot;;

// Basic schema with validation
const CreateUserSchema = z.object({
  name: z.string()
    .min(1, &quot;Name is required&quot;)
    .max(100, &quot;Name must not exceed 100 characters&quot;),
  email: z.string()
    .email(&quot;Invalid email format&quot;),
  age: z.number()
    .int(&quot;Age must be a whole number&quot;)
    .min(0, &quot;Age cannot be negative&quot;)
    .max(150, &quot;Age cannot be greater than 150&quot;)
}).strict();  // Use .strict() to forbid extra fields

// Enums
enum ResponseFormat {
  MARKDOWN = &quot;markdown&quot;,
  JSON = &quot;json&quot;
}

const SearchSchema = z.object({
  response_format: z.nativeEnum(ResponseFormat)
    .default(ResponseFormat.MARKDOWN)
    .describe(&quot;Output format&quot;)
});

// Optional fields with defaults
const PaginationSchema = z.object({
  limit: z.number()
    .int()
    .min(1)
    .max(100)
    .default(20)
    .describe(&quot;Maximum results to return&quot;),
  offset: z.number()
    .int()
    .min(0)
    .default(0)
    .describe(&quot;Number of results to skip&quot;)
});
```

## Response Format Options

Support multiple output formats for flexibility:

```typescript
enum ResponseFormat {
  MARKDOWN = &quot;markdown&quot;,
  JSON = &quot;json&quot;
}

const inputSchema = z.object({
  query: z.string(),
  response_format: z.nativeEnum(ResponseFormat)
    .default(ResponseFormat.MARKDOWN)
    .describe(&quot;Output format: &#x27;markdown&#x27; for human-readable or &#x27;json&#x27; for machine-readable&quot;)
});
```

**Markdown format**:
- Use headers, lists, and formatting for clarity
- Convert timestamps to human-readable format
- Show display names with IDs in parentheses
- Omit verbose metadata
- Group related information logically

**JSON format**:
- Return complete, structured data suitable for programmatic processing
- Include all available fields and metadata
- Use consistent field names and types

## Pagination Implementation

For tools that list resources:

```typescript
const ListSchema = z.object({
  limit: z.number().int().min(1).max(100).default(20),
  offset: z.number().int().min(0).default(0)
});

async function listItems(params: z.infer&lt;typeof ListSchema&gt;) {
  const data = await apiRequest(params.limit, params.offset);

  const response = {
    total: data.total,
    count: data.items.length,
    offset: params.offset,
    items: data.items,
    has_more: data.total &gt; params.offset + data.items.length,
    next_offset: data.total &gt; params.offset + data.items.length
      ? params.offset + data.items.length
      : undefined
  };

  return JSON.stringify(response, null, 2);
}
```

## Character Limits and Truncation

Add a CHARACTER_LIMIT constant to prevent overwhelming responses:

```typescript
// At module level in constants.ts
export const CHARACTER_LIMIT = 25000;  // Maximum response size in characters

async function searchTool(params: SearchInput) {
  let result = generateResponse(data);

  // Check character limit and truncate if needed
  if (result.length &gt; CHARACTER_LIMIT) {
    const truncatedData = data.slice(0, Math.max(1, data.length / 2));
    response.data = truncatedData;
    response.truncated = true;
    response.truncation_message =
      `Response truncated from ${data.length} to ${truncatedData.length} items. ` +
      `Use &#x27;offset&#x27; parameter or add filters to see more results.`;
    result = JSON.stringify(response, null, 2);
  }

  return result;
}
```

## Error Handling

Provide clear, actionable error messages:

```typescript
import axios, { AxiosError } from &quot;axios&quot;;

function handleApiError(error: unknown): string {
  if (error instanceof AxiosError) {
    if (error.response) {
      switch (error.response.status) {
        case 404:
          return &quot;Error: Resource not found. Please check the ID is correct.&quot;;
        case 403:
          return &quot;Error: Permission denied. You don&#x27;t have access to this resource.&quot;;
        case 429:
          return &quot;Error: Rate limit exceeded. Please wait before making more requests.&quot;;
        default:
          return `Error: API request failed with status ${error.response.status}`;
      }
    } else if (error.code === &quot;ECONNABORTED&quot;) {
      return &quot;Error: Request timed out. Please try again.&quot;;
    }
  }
  return `Error: Unexpected error occurred: ${error instanceof Error ? error.message : String(error)}`;
}
```

## Shared Utilities

Extract common functionality into reusable functions:

```typescript
// Shared API request function
async function makeApiRequest&lt;T&gt;(
  endpoint: string,
  method: &quot;GET&quot; | &quot;POST&quot; | &quot;PUT&quot; | &quot;DELETE&quot; = &quot;GET&quot;,
  data?: any,
  params?: any
): Promise&lt;T&gt; {
  try {
    const response = await axios({
      method,
      url: `${API_BASE_URL}/${endpoint}`,
      data,
      params,
      timeout: 30000,
      headers: {
        &quot;Content-Type&quot;: &quot;application/json&quot;,
        &quot;Accept&quot;: &quot;application/json&quot;
      }
    });
    return response.data;
  } catch (error) {
    throw error;
  }
}
```

## Async/Await Best Practices

Always use async/await for network requests and I/O operations:

```typescript
// Good: Async network request
async function fetchData(resourceId: string): Promise&lt;ResourceData&gt; {
  const response = await axios.get(`${API_URL}/resource/${resourceId}`);
  return response.data;
}

// Bad: Promise chains
function fetchData(resourceId: string): Promise&lt;ResourceData&gt; {
  return axios.get(`${API_URL}/resource/${resourceId}`)
    .then(response =&gt; response.data);  // Harder to read and maintain
}
```

## TypeScript Best Practices

1. **Use Strict TypeScript**: Enable strict mode in tsconfig.json
2. **Define Interfaces**: Create clear interface definitions for all data structures
3. **Avoid `any`**: Use proper types or `unknown` instead of `any`
4. **Zod for Runtime Validation**: Use Zod schemas to validate external data
5. **Type Guards**: Create type guard functions for complex type checking
6. **Error Handling**: Always use try-catch with proper error type checking
7. **Null Safety**: Use optional chaining (`?.`) and nullish coalescing (`??`)

```typescript
// Good: Type-safe with Zod and interfaces
interface UserResponse {
  id: string;
  name: string;
  email: string;
  team?: string;
  active: boolean;
}

const UserSchema = z.object({
  id: z.string(),
  name: z.string(),
  email: z.string().email(),
  team: z.string().optional(),
  active: z.boolean()
});

type User = z.infer&lt;typeof UserSchema&gt;;

async function getUser(id: string): Promise&lt;User&gt; {
  const data = await apiCall(`/users/${id}`);
  return UserSchema.parse(data);  // Runtime validation
}

// Bad: Using any
async function getUser(id: string): Promise&lt;any&gt; {
  return await apiCall(`/users/${id}`);  // No type safety
}
```

## Package Configuration

### package.json

```json
{
  &quot;name&quot;: &quot;{service}-mcp-server&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;description&quot;: &quot;MCP server for {Service} API integration&quot;,
  &quot;type&quot;: &quot;module&quot;,
  &quot;main&quot;: &quot;dist/index.js&quot;,
  &quot;scripts&quot;: {
    &quot;start&quot;: &quot;node dist/index.js&quot;,
    &quot;dev&quot;: &quot;tsx watch src/index.ts&quot;,
    &quot;build&quot;: &quot;tsc&quot;,
    &quot;clean&quot;: &quot;rm -rf dist&quot;
  },
  &quot;engines&quot;: {
    &quot;node&quot;: &quot;&gt;=18&quot;
  },
  &quot;dependencies&quot;: {
    &quot;@modelcontextprotocol/sdk&quot;: &quot;^1.6.1&quot;,
    &quot;axios&quot;: &quot;^1.7.9&quot;,
    &quot;zod&quot;: &quot;^3.23.8&quot;
  },
  &quot;devDependencies&quot;: {
    &quot;@types/node&quot;: &quot;^22.10.0&quot;,
    &quot;tsx&quot;: &quot;^4.19.2&quot;,
    &quot;typescript&quot;: &quot;^5.7.2&quot;
  }
}
```

### tsconfig.json

```json
{
  &quot;compilerOptions&quot;: {
    &quot;target&quot;: &quot;ES2022&quot;,
    &quot;module&quot;: &quot;Node16&quot;,
    &quot;moduleResolution&quot;: &quot;Node16&quot;,
    &quot;lib&quot;: [&quot;ES2022&quot;],
    &quot;outDir&quot;: &quot;./dist&quot;,
    &quot;rootDir&quot;: &quot;./src&quot;,
    &quot;strict&quot;: true,
    &quot;esModuleInterop&quot;: true,
    &quot;skipLibCheck&quot;: true,
    &quot;forceConsistentCasingInFileNames&quot;: true,
    &quot;declaration&quot;: true,
    &quot;declarationMap&quot;: true,
    &quot;sourceMap&quot;: true,
    &quot;allowSyntheticDefaultImports&quot;: true
  },
  &quot;include&quot;: [&quot;src/**/*&quot;],
  &quot;exclude&quot;: [&quot;node_modules&quot;, &quot;dist&quot;]
}
```

## Complete Example

```typescript
#!/usr/bin/env node
/**
 * MCP Server for Example Service.
 *
 * This server provides tools to interact with Example API, including user search,
 * project management, and data export capabilities.
 */

import { McpServer } from &quot;@modelcontextprotocol/sdk/server/mcp.js&quot;;
import { StdioServerTransport } from &quot;@modelcontextprotocol/sdk/server/stdio.js&quot;;
import { z } from &quot;zod&quot;;
import axios, { AxiosError } from &quot;axios&quot;;

// Constants
const API_BASE_URL = &quot;https://api.example.com/v1&quot;;
const CHARACTER_LIMIT = 25000;

// Enums
enum ResponseFormat {
  MARKDOWN = &quot;markdown&quot;,
  JSON = &quot;json&quot;
}

// Zod schemas
const UserSearchInputSchema = z.object({
  query: z.string()
    .min(2, &quot;Query must be at least 2 characters&quot;)
    .max(200, &quot;Query must not exceed 200 characters&quot;)
    .describe(&quot;Search string to match against names/emails&quot;),
  limit: z.number()
    .int()
    .min(1)
    .max(100)
    .default(20)
    .describe(&quot;Maximum results to return&quot;),
  offset: z.number()
    .int()
    .min(0)
    .default(0)
    .describe(&quot;Number of results to skip for pagination&quot;),
  response_format: z.nativeEnum(ResponseFormat)
    .default(ResponseFormat.MARKDOWN)
    .describe(&quot;Output format: &#x27;markdown&#x27; for human-readable or &#x27;json&#x27; for machine-readable&quot;)
}).strict();

type UserSearchInput = z.infer&lt;typeof UserSearchInputSchema&gt;;

// Shared utility functions
async function makeApiRequest&lt;T&gt;(
  endpoint: string,
  method: &quot;GET&quot; | &quot;POST&quot; | &quot;PUT&quot; | &quot;DELETE&quot; = &quot;GET&quot;,
  data?: any,
  params?: any
): Promise&lt;T&gt; {
  try {
    const response = await axios({
      method,
      url: `${API_BASE_URL}/${endpoint}`,
      data,
      params,
      timeout: 30000,
      headers: {
        &quot;Content-Type&quot;: &quot;application/json&quot;,
        &quot;Accept&quot;: &quot;application/json&quot;
      }
    });
    return response.data;
  } catch (error) {
    throw error;
  }
}

function handleApiError(error: unknown): string {
  if (error instanceof AxiosError) {
    if (error.response) {
      switch (error.response.status) {
        case 404:
          return &quot;Error: Resource not found. Please check the ID is correct.&quot;;
        case 403:
          return &quot;Error: Permission denied. You don&#x27;t have access to this resource.&quot;;
        case 429:
          return &quot;Error: Rate limit exceeded. Please wait before making more requests.&quot;;
        default:
          return `Error: API request failed with status ${error.response.status}`;
      }
    } else if (error.code === &quot;ECONNABORTED&quot;) {
      return &quot;Error: Request timed out. Please try again.&quot;;
    }
  }
  return `Error: Unexpected error occurred: ${error instanceof Error ? error.message : String(error)}`;
}

// Create MCP server instance
const server = new McpServer({
  name: &quot;example-mcp&quot;,
  version: &quot;1.0.0&quot;
});

// Register tools
server.registerTool(
  &quot;example_search_users&quot;,
  {
    title: &quot;Search Example Users&quot;,
    description: `[Full description as shown above]`,
    inputSchema: UserSearchInputSchema,
    annotations: {
      readOnlyHint: true,
      destructiveHint: false,
      idempotentHint: true,
      openWorldHint: true
    }
  },
  async (params: UserSearchInput) =&gt; {
    // Implementation as shown above
  }
);

// Main function
// For stdio (local):
async function runStdio() {
  if (!process.env.EXAMPLE_API_KEY) {
    console.error(&quot;ERROR: EXAMPLE_API_KEY environment variable is required&quot;);
    process.exit(1);
  }

  const transport = new StdioServerTransport();
  await server.connect(transport);
  console.error(&quot;MCP server running via stdio&quot;);
}

// For streamable HTTP (remote):
async function runHTTP() {
  if (!process.env.EXAMPLE_API_KEY) {
    console.error(&quot;ERROR: EXAMPLE_API_KEY environment variable is required&quot;);
    process.exit(1);
  }

  const app = express();
  app.use(express.json());

  app.post(&#x27;/mcp&#x27;, async (req, res) =&gt; {
    const transport = new StreamableHTTPServerTransport({
      sessionIdGenerator: undefined,
      enableJsonResponse: true
    });
    res.on(&#x27;close&#x27;, () =&gt; transport.close());
    await server.connect(transport);
    await transport.handleRequest(req, res, req.body);
  });

  const port = parseInt(process.env.PORT || &#x27;3000&#x27;);
  app.listen(port, () =&gt; {
    console.error(`MCP server running on http://localhost:${port}/mcp`);
  });
}

// Choose transport based on environment
const transport = process.env.TRANSPORT || &#x27;stdio&#x27;;
if (transport === &#x27;http&#x27;) {
  runHTTP().catch(error =&gt; {
    console.error(&quot;Server error:&quot;, error);
    process.exit(1);
  });
} else {
  runStdio().catch(error =&gt; {
    console.error(&quot;Server error:&quot;, error);
    process.exit(1);
  });
}
```

---

## Advanced MCP Features

### Resource Registration

Expose data as resources for efficient, URI-based access:

```typescript
import { ResourceTemplate } from &quot;@modelcontextprotocol/sdk/types.js&quot;;

// Register a resource with URI template
server.registerResource(
  {
    uri: &quot;file://documents/{name}&quot;,
    name: &quot;Document Resource&quot;,
    description: &quot;Access documents by name&quot;,
    mimeType: &quot;text/plain&quot;
  },
  async (uri: string) =&gt; {
    // Extract parameter from URI
    const match = uri.match(/^file:\/\/documents\/(.+)$/);
    if (!match) {
      throw new Error(&quot;Invalid URI format&quot;);
    }

    const documentName = match[1];
    const content = await loadDocument(documentName);

    return {
      contents: [{
        uri,
        mimeType: &quot;text/plain&quot;,
        text: content
      }]
    };
  }
);

// List available resources dynamically
server.registerResourceList(async () =&gt; {
  const documents = await getAvailableDocuments();
  return {
    resources: documents.map(doc =&gt; ({
      uri: `file://documents/${doc.name}`,
      name: doc.name,
      mimeType: &quot;text/plain&quot;,
      description: doc.description
    }))
  };
});
```

**When to use Resources vs Tools:**
- **Resources**: For data access with simple URI-based parameters
- **Tools**: For complex operations requiring validation and business logic
- **Resources**: When data is relatively static or template-based
- **Tools**: When operations have side effects or complex workflows

### Transport Options

The TypeScript SDK supports two main transport mechanisms:

#### Streamable HTTP (Recommended for Remote Servers)

```typescript
import { StreamableHTTPServerTransport } from &quot;@modelcontextprotocol/sdk/server/streamableHttp.js&quot;;
import express from &quot;express&quot;;

const app = express();
app.use(express.json());

app.post(&#x27;/mcp&#x27;, async (req, res) =&gt; {
  // Create new transport for each request (stateless, prevents request ID collisions)
  const transport = new StreamableHTTPServerTransport({
    sessionIdGenerator: undefined,
    enableJsonResponse: true
  });

  res.on(&#x27;close&#x27;, () =&gt; transport.close());

  await server.connect(transport);
  await transport.handleRequest(req, res, req.body);
});

app.listen(3000);
```

#### stdio (For Local Integrations)

```typescript
import { StdioServerTransport } from &quot;@modelcontextprotocol/sdk/server/stdio.js&quot;;

const transport = new StdioServerTransport();
await server.connect(transport);
```

**Transport selection:**
- **Streamable HTTP**: Web services, remote access, multiple clients
- **stdio**: Command-line tools, local development, subprocess integration

### Notification Support

Notify clients when server state changes:

```typescript
// Notify when tools list changes
server.notification({
  method: &quot;notifications/tools/list_changed&quot;
});

// Notify when resources change
server.notification({
  method: &quot;notifications/resources/list_changed&quot;
});
```

Use notifications sparingly - only when server capabilities genuinely change.

---

## Code Best Practices

### Code Composability and Reusability

Your implementation MUST prioritize composability and code reuse:

1. **Extract Common Functionality**:
   - Create reusable helper functions for operations used across multiple tools
   - Build shared API clients for HTTP requests instead of duplicating code
   - Centralize error handling logic in utility functions
   - Extract business logic into dedicated functions that can be composed
   - Extract shared markdown or JSON field selection &amp; formatting functionality

2. **Avoid Duplication**:
   - NEVER copy-paste similar code between tools
   - If you find yourself writing similar logic twice, extract it into a function
   - Common operations like pagination, filtering, field selection, and formatting should be shared
   - Authentication/authorization logic should be centralized

## Building and Running

Always build your TypeScript code before running:

```bash
# Build the project
npm run build

# Run the server
npm start

# Development with auto-reload
npm run dev
```

Always ensure `npm run build` completes successfully before considering the implementation complete.

## Quality Checklist

Before finalizing your Node/TypeScript MCP server implementation, ensure:

### Strategic Design
- [ ] Tools enable complete workflows, not just API endpoint wrappers
- [ ] Tool names reflect natural task subdivisions
- [ ] Response formats optimize for agent context efficiency
- [ ] Human-readable identifiers used where appropriate
- [ ] Error messages guide agents toward correct usage

### Implementation Quality
- [ ] FOCUSED IMPLEMENTATION: Most important and valuable tools implemented
- [ ] All tools registered using `registerTool` with complete configuration
- [ ] All tools include `title`, `description`, `inputSchema`, and `annotations`
- [ ] Annotations correctly set (readOnlyHint, destructiveHint, idempotentHint, openWorldHint)
- [ ] All tools use Zod schemas for runtime input validation with `.strict()` enforcement
- [ ] All Zod schemas have proper constraints and descriptive error messages
- [ ] All tools have comprehensive descriptions with explicit input/output types
- [ ] Descriptions include return value examples and complete schema documentation
- [ ] Error messages are clear, actionable, and educational

### TypeScript Quality
- [ ] TypeScript interfaces are defined for all data structures
- [ ] Strict TypeScript is enabled in tsconfig.json
- [ ] No use of `any` type - use `unknown` or proper types instead
- [ ] All async functions have explicit Promise&lt;T&gt; return types
- [ ] Error handling uses proper type guards (e.g., `axios.isAxiosError`, `z.ZodError`)

### Advanced Features (where applicable)
- [ ] Resources registered for appropriate data endpoints
- [ ] Appropriate transport configured (stdio or streamable HTTP)
- [ ] Notifications implemented for dynamic server capabilities
- [ ] Type-safe with SDK interfaces

### Project Configuration
- [ ] Package.json includes all necessary dependencies
- [ ] Build script produces working JavaScript in dist/ directory
- [ ] Main entry point is properly configured as dist/index.js
- [ ] Server name follows format: `{service}-mcp-server`
- [ ] tsconfig.json properly configured with strict mode

### Code Quality
- [ ] Pagination is properly implemented where applicable
- [ ] Large responses check CHARACTER_LIMIT constant and truncate with clear messages
- [ ] Filtering options are provided for potentially large result sets
- [ ] All network operations handle timeouts and connection errors gracefully
- [ ] Common functionality is extracted into reusable functions
- [ ] Return types are consistent across similar operations

### Testing and Build
- [ ] `npm run build` completes successfully without errors
- [ ] dist/index.js created and executable
- [ ] Server runs: `node dist/index.js --help`
- [ ] All imports resolve correctly
- [ ] Sample tool calls work as expected</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/node_mcp_server/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/reference/node_mcp_server.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="nothingyoucoulddo_ofl Imported skill nothingyoucoulddo_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/NothingYouCouldDo-OFL.txt Unknown LICENSE.txt sources/anthropic/nothingyoucoulddo_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">nothingyoucoulddo_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('nothingyoucoulddo_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill nothingyoucoulddo_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright (c) 2010, Kimberly Geswein (kimberlygeswein.com)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/nothingyoucoulddo_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/NothingYouCouldDo-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="ocean_depths Imported skill ocean_depths from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/theme-factory/themes/ocean-depths.md Unknown LICENSE.txt sources/anthropic/ocean_depths/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">ocean_depths</div>
                <button class="copy-btn" onclick="copyToClipboard('ocean_depths')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill ocean_depths from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Ocean Depths

A professional and calming maritime theme that evokes the serenity of deep ocean waters.

## Color Palette

- **Deep Navy**: `#1a2332` - Primary background color
- **Teal**: `#2d8b8b` - Accent color for highlights and emphasis
- **Seafoam**: `#a8dadc` - Secondary accent for lighter elements
- **Cream**: `#f1faee` - Text and light backgrounds

## Typography

- **Headers**: DejaVu Sans Bold
- **Body Text**: DejaVu Sans

## Best Used For

Corporate presentations, financial reports, professional consulting decks, trust-building content.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/ocean_depths/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/themes/ocean-depths.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="ooxml Imported skill ooxml from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/ooxml.md Unknown LICENSE.txt sources/anthropic/ooxml/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">ooxml</div>
                <button class="copy-btn" onclick="copyToClipboard('ooxml')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill ooxml from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Office Open XML Technical Reference for PowerPoint

**Important: Read this entire document before starting.** Critical XML schema rules and formatting requirements are covered throughout. Incorrect implementation can create invalid PPTX files that PowerPoint cannot open.

## Technical Guidelines

### Schema Compliance
- **Element ordering in `&lt;p:txBody&gt;`**: `&lt;a:bodyPr&gt;`, `&lt;a:lstStyle&gt;`, `&lt;a:p&gt;`
- **Whitespace**: Add `xml:space=&#x27;preserve&#x27;` to `&lt;a:t&gt;` elements with leading/trailing spaces
- **Unicode**: Escape characters in ASCII content: `&quot;` becomes `&amp;#8220;`
- **Images**: Add to `ppt/media/`, reference in slide XML, set dimensions to fit slide bounds
- **Relationships**: Update `ppt/slides/_rels/slideN.xml.rels` for each slide&#x27;s resources
- **Dirty attribute**: Add `dirty=&quot;0&quot;` to `&lt;a:rPr&gt;` and `&lt;a:endParaRPr&gt;` elements to indicate clean state

## Presentation Structure

### Basic Slide Structure
```xml
&lt;!-- ppt/slides/slide1.xml --&gt;
&lt;p:sld&gt;
  &lt;p:cSld&gt;
    &lt;p:spTree&gt;
      &lt;p:nvGrpSpPr&gt;...&lt;/p:nvGrpSpPr&gt;
      &lt;p:grpSpPr&gt;...&lt;/p:grpSpPr&gt;
      &lt;!-- Shapes go here --&gt;
    &lt;/p:spTree&gt;
  &lt;/p:cSld&gt;
&lt;/p:sld&gt;
```

### Text Box / Shape with Text
```xml
&lt;p:sp&gt;
  &lt;p:nvSpPr&gt;
    &lt;p:cNvPr id=&quot;2&quot; name=&quot;Title&quot;/&gt;
    &lt;p:cNvSpPr&gt;
      &lt;a:spLocks noGrp=&quot;1&quot;/&gt;
    &lt;/p:cNvSpPr&gt;
    &lt;p:nvPr&gt;
      &lt;p:ph type=&quot;ctrTitle&quot;/&gt;
    &lt;/p:nvPr&gt;
  &lt;/p:nvSpPr&gt;
  &lt;p:spPr&gt;
    &lt;a:xfrm&gt;
      &lt;a:off x=&quot;838200&quot; y=&quot;365125&quot;/&gt;
      &lt;a:ext cx=&quot;7772400&quot; cy=&quot;1470025&quot;/&gt;
    &lt;/a:xfrm&gt;
  &lt;/p:spPr&gt;
  &lt;p:txBody&gt;
    &lt;a:bodyPr/&gt;
    &lt;a:lstStyle/&gt;
    &lt;a:p&gt;
      &lt;a:r&gt;
        &lt;a:t&gt;Slide Title&lt;/a:t&gt;
      &lt;/a:r&gt;
    &lt;/a:p&gt;
  &lt;/p:txBody&gt;
&lt;/p:sp&gt;
```

### Text Formatting
```xml
&lt;!-- Bold --&gt;
&lt;a:r&gt;
  &lt;a:rPr b=&quot;1&quot;/&gt;
  &lt;a:t&gt;Bold Text&lt;/a:t&gt;
&lt;/a:r&gt;

&lt;!-- Italic --&gt;
&lt;a:r&gt;
  &lt;a:rPr i=&quot;1&quot;/&gt;
  &lt;a:t&gt;Italic Text&lt;/a:t&gt;
&lt;/a:r&gt;

&lt;!-- Underline --&gt;
&lt;a:r&gt;
  &lt;a:rPr u=&quot;sng&quot;/&gt;
  &lt;a:t&gt;Underlined&lt;/a:t&gt;
&lt;/a:r&gt;

&lt;!-- Highlight --&gt;
&lt;a:r&gt;
  &lt;a:rPr&gt;
    &lt;a:highlight&gt;
      &lt;a:srgbClr val=&quot;FFFF00&quot;/&gt;
    &lt;/a:highlight&gt;
  &lt;/a:rPr&gt;
  &lt;a:t&gt;Highlighted Text&lt;/a:t&gt;
&lt;/a:r&gt;

&lt;!-- Font and Size --&gt;
&lt;a:r&gt;
  &lt;a:rPr sz=&quot;2400&quot; typeface=&quot;Arial&quot;&gt;
    &lt;a:solidFill&gt;
      &lt;a:srgbClr val=&quot;FF0000&quot;/&gt;
    &lt;/a:solidFill&gt;
  &lt;/a:rPr&gt;
  &lt;a:t&gt;Colored Arial 24pt&lt;/a:t&gt;
&lt;/a:r&gt;

&lt;!-- Complete formatting example --&gt;
&lt;a:r&gt;
  &lt;a:rPr lang=&quot;en-US&quot; sz=&quot;1400&quot; b=&quot;1&quot; dirty=&quot;0&quot;&gt;
    &lt;a:solidFill&gt;
      &lt;a:srgbClr val=&quot;FAFAFA&quot;/&gt;
    &lt;/a:solidFill&gt;
  &lt;/a:rPr&gt;
  &lt;a:t&gt;Formatted text&lt;/a:t&gt;
&lt;/a:r&gt;
```

### Lists
```xml
&lt;!-- Bullet list --&gt;
&lt;a:p&gt;
  &lt;a:pPr lvl=&quot;0&quot;&gt;
    &lt;a:buChar char=&quot;&quot;/&gt;
  &lt;/a:pPr&gt;
  &lt;a:r&gt;
    &lt;a:t&gt;First bullet point&lt;/a:t&gt;
  &lt;/a:r&gt;
&lt;/a:p&gt;

&lt;!-- Numbered list --&gt;
&lt;a:p&gt;
  &lt;a:pPr lvl=&quot;0&quot;&gt;
    &lt;a:buAutoNum type=&quot;arabicPeriod&quot;/&gt;
  &lt;/a:pPr&gt;
  &lt;a:r&gt;
    &lt;a:t&gt;First numbered item&lt;/a:t&gt;
  &lt;/a:r&gt;
&lt;/a:p&gt;

&lt;!-- Second level indent --&gt;
&lt;a:p&gt;
  &lt;a:pPr lvl=&quot;1&quot;&gt;
    &lt;a:buChar char=&quot;&quot;/&gt;
  &lt;/a:pPr&gt;
  &lt;a:r&gt;
    &lt;a:t&gt;Indented bullet&lt;/a:t&gt;
  &lt;/a:r&gt;
&lt;/a:p&gt;
```

### Shapes
```xml
&lt;!-- Rectangle --&gt;
&lt;p:sp&gt;
  &lt;p:nvSpPr&gt;
    &lt;p:cNvPr id=&quot;3&quot; name=&quot;Rectangle&quot;/&gt;
    &lt;p:cNvSpPr/&gt;
    &lt;p:nvPr/&gt;
  &lt;/p:nvSpPr&gt;
  &lt;p:spPr&gt;
    &lt;a:xfrm&gt;
      &lt;a:off x=&quot;1000000&quot; y=&quot;1000000&quot;/&gt;
      &lt;a:ext cx=&quot;3000000&quot; cy=&quot;2000000&quot;/&gt;
    &lt;/a:xfrm&gt;
    &lt;a:prstGeom prst=&quot;rect&quot;&gt;
      &lt;a:avLst/&gt;
    &lt;/a:prstGeom&gt;
    &lt;a:solidFill&gt;
      &lt;a:srgbClr val=&quot;FF0000&quot;/&gt;
    &lt;/a:solidFill&gt;
    &lt;a:ln w=&quot;25400&quot;&gt;
      &lt;a:solidFill&gt;
        &lt;a:srgbClr val=&quot;000000&quot;/&gt;
      &lt;/a:solidFill&gt;
    &lt;/a:ln&gt;
  &lt;/p:spPr&gt;
&lt;/p:sp&gt;

&lt;!-- Rounded Rectangle --&gt;
&lt;p:sp&gt;
  &lt;p:spPr&gt;
    &lt;a:prstGeom prst=&quot;roundRect&quot;&gt;
      &lt;a:avLst/&gt;
    &lt;/a:prstGeom&gt;
  &lt;/p:spPr&gt;
&lt;/p:sp&gt;

&lt;!-- Circle/Ellipse --&gt;
&lt;p:sp&gt;
  &lt;p:spPr&gt;
    &lt;a:prstGeom prst=&quot;ellipse&quot;&gt;
      &lt;a:avLst/&gt;
    &lt;/a:prstGeom&gt;
  &lt;/p:spPr&gt;
&lt;/p:sp&gt;
```

### Images
```xml
&lt;p:pic&gt;
  &lt;p:nvPicPr&gt;
    &lt;p:cNvPr id=&quot;4&quot; name=&quot;Picture&quot;&gt;
      &lt;a:hlinkClick r:id=&quot;&quot; action=&quot;ppaction://media&quot;/&gt;
    &lt;/p:cNvPr&gt;
    &lt;p:cNvPicPr&gt;
      &lt;a:picLocks noChangeAspect=&quot;1&quot;/&gt;
    &lt;/p:cNvPicPr&gt;
    &lt;p:nvPr/&gt;
  &lt;/p:nvPicPr&gt;
  &lt;p:blipFill&gt;
    &lt;a:blip r:embed=&quot;rId2&quot;/&gt;
    &lt;a:stretch&gt;
      &lt;a:fillRect/&gt;
    &lt;/a:stretch&gt;
  &lt;/p:blipFill&gt;
  &lt;p:spPr&gt;
    &lt;a:xfrm&gt;
      &lt;a:off x=&quot;1000000&quot; y=&quot;1000000&quot;/&gt;
      &lt;a:ext cx=&quot;3000000&quot; cy=&quot;2000000&quot;/&gt;
    &lt;/a:xfrm&gt;
    &lt;a:prstGeom prst=&quot;rect&quot;&gt;
      &lt;a:avLst/&gt;
    &lt;/a:prstGeom&gt;
  &lt;/p:spPr&gt;
&lt;/p:pic&gt;
```

### Tables
```xml
&lt;p:graphicFrame&gt;
  &lt;p:nvGraphicFramePr&gt;
    &lt;p:cNvPr id=&quot;5&quot; name=&quot;Table&quot;/&gt;
    &lt;p:cNvGraphicFramePr&gt;
      &lt;a:graphicFrameLocks noGrp=&quot;1&quot;/&gt;
    &lt;/p:cNvGraphicFramePr&gt;
    &lt;p:nvPr/&gt;
  &lt;/p:nvGraphicFramePr&gt;
  &lt;p:xfrm&gt;
    &lt;a:off x=&quot;1000000&quot; y=&quot;1000000&quot;/&gt;
    &lt;a:ext cx=&quot;6000000&quot; cy=&quot;2000000&quot;/&gt;
  &lt;/p:xfrm&gt;
  &lt;a:graphic&gt;
    &lt;a:graphicData uri=&quot;http://schemas.openxmlformats.org/drawingml/2006/table&quot;&gt;
      &lt;a:tbl&gt;
        &lt;a:tblGrid&gt;
          &lt;a:gridCol w=&quot;3000000&quot;/&gt;
          &lt;a:gridCol w=&quot;3000000&quot;/&gt;
        &lt;/a:tblGrid&gt;
        &lt;a:tr h=&quot;500000&quot;&gt;
          &lt;a:tc&gt;
            &lt;a:txBody&gt;
              &lt;a:bodyPr/&gt;
              &lt;a:lstStyle/&gt;
              &lt;a:p&gt;
                &lt;a:r&gt;
                  &lt;a:t&gt;Cell 1&lt;/a:t&gt;
                &lt;/a:r&gt;
              &lt;/a:p&gt;
            &lt;/a:txBody&gt;
          &lt;/a:tc&gt;
          &lt;a:tc&gt;
            &lt;a:txBody&gt;
              &lt;a:bodyPr/&gt;
              &lt;a:lstStyle/&gt;
              &lt;a:p&gt;
                &lt;a:r&gt;
                  &lt;a:t&gt;Cell 2&lt;/a:t&gt;
                &lt;/a:r&gt;
              &lt;/a:p&gt;
            &lt;/a:txBody&gt;
          &lt;/a:tc&gt;
        &lt;/a:tr&gt;
      &lt;/a:tbl&gt;
    &lt;/a:graphicData&gt;
  &lt;/a:graphic&gt;
&lt;/p:graphicFrame&gt;
```

### Slide Layouts

```xml
&lt;!-- Title Slide Layout --&gt;
&lt;p:sp&gt;
  &lt;p:nvSpPr&gt;
    &lt;p:nvPr&gt;
      &lt;p:ph type=&quot;ctrTitle&quot;/&gt;
    &lt;/p:nvPr&gt;
  &lt;/p:nvSpPr&gt;
  &lt;!-- Title content --&gt;
&lt;/p:sp&gt;

&lt;p:sp&gt;
  &lt;p:nvSpPr&gt;
    &lt;p:nvPr&gt;
      &lt;p:ph type=&quot;subTitle&quot; idx=&quot;1&quot;/&gt;
    &lt;/p:nvPr&gt;
  &lt;/p:nvSpPr&gt;
  &lt;!-- Subtitle content --&gt;
&lt;/p:sp&gt;

&lt;!-- Content Slide Layout --&gt;
&lt;p:sp&gt;
  &lt;p:nvSpPr&gt;
    &lt;p:nvPr&gt;
      &lt;p:ph type=&quot;title&quot;/&gt;
    &lt;/p:nvPr&gt;
  &lt;/p:nvSpPr&gt;
  &lt;!-- Slide title --&gt;
&lt;/p:sp&gt;

&lt;p:sp&gt;
  &lt;p:nvSpPr&gt;
    &lt;p:nvPr&gt;
      &lt;p:ph type=&quot;body&quot; idx=&quot;1&quot;/&gt;
    &lt;/p:nvPr&gt;
  &lt;/p:nvSpPr&gt;
  &lt;!-- Content body --&gt;
&lt;/p:sp&gt;
```

## File Updates

When adding content, update these files:

**`ppt/_rels/presentation.xml.rels`:**
```xml
&lt;Relationship Id=&quot;rId1&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide&quot; Target=&quot;slides/slide1.xml&quot;/&gt;
&lt;Relationship Id=&quot;rId2&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster&quot; Target=&quot;slideMasters/slideMaster1.xml&quot;/&gt;
```

**`ppt/slides/_rels/slide1.xml.rels`:**
```xml
&lt;Relationship Id=&quot;rId1&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout&quot; Target=&quot;../slideLayouts/slideLayout1.xml&quot;/&gt;
&lt;Relationship Id=&quot;rId2&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/image&quot; Target=&quot;../media/image1.png&quot;/&gt;
```

**`[Content_Types].xml`:**
```xml
&lt;Default Extension=&quot;png&quot; ContentType=&quot;image/png&quot;/&gt;
&lt;Default Extension=&quot;jpg&quot; ContentType=&quot;image/jpeg&quot;/&gt;
&lt;Override PartName=&quot;/ppt/slides/slide1.xml&quot; ContentType=&quot;application/vnd.openxmlformats-officedocument.presentationml.slide+xml&quot;/&gt;
```

**`ppt/presentation.xml`:**
```xml
&lt;p:sldIdLst&gt;
  &lt;p:sldId id=&quot;256&quot; r:id=&quot;rId1&quot;/&gt;
  &lt;p:sldId id=&quot;257&quot; r:id=&quot;rId2&quot;/&gt;
&lt;/p:sldIdLst&gt;
```

**`docProps/app.xml`:** Update slide count and statistics
```xml
&lt;Slides&gt;2&lt;/Slides&gt;
&lt;Paragraphs&gt;10&lt;/Paragraphs&gt;
&lt;Words&gt;50&lt;/Words&gt;
```

## Slide Operations

### Adding a New Slide
When adding a slide to the end of the presentation:

1. **Create the slide file** (`ppt/slides/slideN.xml`)
2. **Update `[Content_Types].xml`**: Add Override for the new slide
3. **Update `ppt/_rels/presentation.xml.rels`**: Add relationship for the new slide
4. **Update `ppt/presentation.xml`**: Add slide ID to `&lt;p:sldIdLst&gt;`
5. **Create slide relationships** (`ppt/slides/_rels/slideN.xml.rels`) if needed
6. **Update `docProps/app.xml`**: Increment slide count and update statistics (if present)

### Duplicating a Slide
1. Copy the source slide XML file with a new name
2. Update all IDs in the new slide to be unique
3. Follow the &quot;Adding a New Slide&quot; steps above
4. **CRITICAL**: Remove or update any notes slide references in `_rels` files
5. Remove references to unused media files

### Reordering Slides
1. **Update `ppt/presentation.xml`**: Reorder `&lt;p:sldId&gt;` elements in `&lt;p:sldIdLst&gt;`
2. The order of `&lt;p:sldId&gt;` elements determines slide order
3. Keep slide IDs and relationship IDs unchanged

Example:
```xml
&lt;!-- Original order --&gt;
&lt;p:sldIdLst&gt;
  &lt;p:sldId id=&quot;256&quot; r:id=&quot;rId2&quot;/&gt;
  &lt;p:sldId id=&quot;257&quot; r:id=&quot;rId3&quot;/&gt;
  &lt;p:sldId id=&quot;258&quot; r:id=&quot;rId4&quot;/&gt;
&lt;/p:sldIdLst&gt;

&lt;!-- After moving slide 3 to position 2 --&gt;
&lt;p:sldIdLst&gt;
  &lt;p:sldId id=&quot;256&quot; r:id=&quot;rId2&quot;/&gt;
  &lt;p:sldId id=&quot;258&quot; r:id=&quot;rId4&quot;/&gt;
  &lt;p:sldId id=&quot;257&quot; r:id=&quot;rId3&quot;/&gt;
&lt;/p:sldIdLst&gt;
```

### Deleting a Slide
1. **Remove from `ppt/presentation.xml`**: Delete the `&lt;p:sldId&gt;` entry
2. **Remove from `ppt/_rels/presentation.xml.rels`**: Delete the relationship
3. **Remove from `[Content_Types].xml`**: Delete the Override entry
4. **Delete files**: Remove `ppt/slides/slideN.xml` and `ppt/slides/_rels/slideN.xml.rels`
5. **Update `docProps/app.xml`**: Decrement slide count and update statistics
6. **Clean up unused media**: Remove orphaned images from `ppt/media/`

Note: Don&#x27;t renumber remaining slides - keep their original IDs and filenames.


## Common Errors to Avoid

- **Encodings**: Escape unicode characters in ASCII content: `&quot;` becomes `&amp;#8220;`
- **Images**: Add to `ppt/media/` and update relationship files
- **Lists**: Omit bullets from list headers
- **IDs**: Use valid hexadecimal values for UUIDs
- **Themes**: Check all themes in `theme` directory for colors

## Validation Checklist for Template-Based Presentations

### Before Packing, Always:
- **Clean unused resources**: Remove unreferenced media, fonts, and notes directories
- **Fix Content_Types.xml**: Declare ALL slides, layouts, and themes present in the package
- **Fix relationship IDs**: 
   - Remove font embed references if not using embedded fonts
- **Remove broken references**: Check all `_rels` files for references to deleted resources

### Common Template Duplication Pitfalls:
- Multiple slides referencing the same notes slide after duplication
- Image/media references from template slides that no longer exist
- Font embedding references when fonts aren&#x27;t included
- Missing slideLayout declarations for layouts 12-25
- docProps directory may not unpack - this is optional</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/ooxml/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/ooxml.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="outfit_ofl Imported skill outfit_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/Outfit-OFL.txt Unknown LICENSE.txt sources/anthropic/outfit_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">outfit_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('outfit_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill outfit_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2021 The Outfit Project Authors (https://github.com/Outfitio/Outfit-Fonts)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/outfit_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/Outfit-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="output_patterns Imported skill output_patterns from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/skill-creator/references/output-patterns.md Unknown LICENSE.txt sources/anthropic/output_patterns/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">output_patterns</div>
                <button class="copy-btn" onclick="copyToClipboard('output_patterns')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill output_patterns from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Output Patterns

Use these patterns when skills need to produce consistent, high-quality output.

## Template Pattern

Provide templates for output format. Match the level of strictness to your needs.

**For strict requirements (like API responses or data formats):**

```markdown
## Report structure

ALWAYS use this exact template structure:

# [Analysis Title]

## Executive summary
[One-paragraph overview of key findings]

## Key findings
- Finding 1 with supporting data
- Finding 2 with supporting data
- Finding 3 with supporting data

## Recommendations
1. Specific actionable recommendation
2. Specific actionable recommendation
```

**For flexible guidance (when adaptation is useful):**

```markdown
## Report structure

Here is a sensible default format, but use your best judgment:

# [Analysis Title]

## Executive summary
[Overview]

## Key findings
[Adapt sections based on what you discover]

## Recommendations
[Tailor to the specific context]

Adjust sections as needed for the specific analysis type.
```

## Examples Pattern

For skills where output quality depends on seeing examples, provide input/output pairs:

```markdown
## Commit message format

Generate commit messages following these examples:

**Example 1:**
Input: Added user authentication with JWT tokens
Output:
```
feat(auth): implement JWT-based authentication

Add login endpoint and token validation middleware
```

**Example 2:**
Input: Fixed bug where dates displayed incorrectly in reports
Output:
```
fix(reports): correct date formatting in timezone conversion

Use UTC timestamps consistently across report generation
```

Follow this style: type(scope): brief description, then detailed explanation.
```

Examples help Claude understand the desired style and level of detail more clearly than descriptions alone.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/output_patterns/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/skill-creator/references/output-patterns.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/skill-creator/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="pack Imported skill pack from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/ooxml/scripts/pack.py Unknown LICENSE.txt sources/anthropic/pack/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">pack</div>
                <button class="copy-btn" onclick="copyToClipboard('pack')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill pack from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Tool to pack a directory into a .docx, .pptx, or .xlsx file with XML formatting undone.

Example usage:
    python pack.py &lt;input_directory&gt; &lt;office_file&gt; [--force]
&quot;&quot;&quot;

import argparse
import shutil
import subprocess
import sys
import tempfile
import defusedxml.minidom
import zipfile
from pathlib import Path


def main():
    parser = argparse.ArgumentParser(description=&quot;Pack a directory into an Office file&quot;)
    parser.add_argument(&quot;input_directory&quot;, help=&quot;Unpacked Office document directory&quot;)
    parser.add_argument(&quot;output_file&quot;, help=&quot;Output Office file (.docx/.pptx/.xlsx)&quot;)
    parser.add_argument(&quot;--force&quot;, action=&quot;store_true&quot;, help=&quot;Skip validation&quot;)
    args = parser.parse_args()

    try:
        success = pack_document(
            args.input_directory, args.output_file, validate=not args.force
        )

        # Show warning if validation was skipped
        if args.force:
            print(&quot;Warning: Skipped validation, file may be corrupt&quot;, file=sys.stderr)
        # Exit with error if validation failed
        elif not success:
            print(&quot;Contents would produce a corrupt file.&quot;, file=sys.stderr)
            print(&quot;Please validate XML before repacking.&quot;, file=sys.stderr)
            print(&quot;Use --force to skip validation and pack anyway.&quot;, file=sys.stderr)
            sys.exit(1)

    except ValueError as e:
        sys.exit(f&quot;Error: {e}&quot;)


def pack_document(input_dir, output_file, validate=False):
    &quot;&quot;&quot;Pack a directory into an Office file (.docx/.pptx/.xlsx).

    Args:
        input_dir: Path to unpacked Office document directory
        output_file: Path to output Office file
        validate: If True, validates with soffice (default: False)

    Returns:
        bool: True if successful, False if validation failed
    &quot;&quot;&quot;
    input_dir = Path(input_dir)
    output_file = Path(output_file)

    if not input_dir.is_dir():
        raise ValueError(f&quot;{input_dir} is not a directory&quot;)
    if output_file.suffix.lower() not in {&quot;.docx&quot;, &quot;.pptx&quot;, &quot;.xlsx&quot;}:
        raise ValueError(f&quot;{output_file} must be a .docx, .pptx, or .xlsx file&quot;)

    # Work in temporary directory to avoid modifying original
    with tempfile.TemporaryDirectory() as temp_dir:
        temp_content_dir = Path(temp_dir) / &quot;content&quot;
        shutil.copytree(input_dir, temp_content_dir)

        # Process XML files to remove pretty-printing whitespace
        for pattern in [&quot;*.xml&quot;, &quot;*.rels&quot;]:
            for xml_file in temp_content_dir.rglob(pattern):
                condense_xml(xml_file)

        # Create final Office file as zip archive
        output_file.parent.mkdir(parents=True, exist_ok=True)
        with zipfile.ZipFile(output_file, &quot;w&quot;, zipfile.ZIP_DEFLATED) as zf:
            for f in temp_content_dir.rglob(&quot;*&quot;):
                if f.is_file():
                    zf.write(f, f.relative_to(temp_content_dir))

        # Validate if requested
        if validate:
            if not validate_document(output_file):
                output_file.unlink()  # Delete the corrupt file
                return False

    return True


def validate_document(doc_path):
    &quot;&quot;&quot;Validate document by converting to HTML with soffice.&quot;&quot;&quot;
    # Determine the correct filter based on file extension
    match doc_path.suffix.lower():
        case &quot;.docx&quot;:
            filter_name = &quot;html:HTML&quot;
        case &quot;.pptx&quot;:
            filter_name = &quot;html:impress_html_Export&quot;
        case &quot;.xlsx&quot;:
            filter_name = &quot;html:HTML (StarCalc)&quot;

    with tempfile.TemporaryDirectory() as temp_dir:
        try:
            result = subprocess.run(
                [
                    &quot;soffice&quot;,
                    &quot;--headless&quot;,
                    &quot;--convert-to&quot;,
                    filter_name,
                    &quot;--outdir&quot;,
                    temp_dir,
                    str(doc_path),
                ],
                capture_output=True,
                timeout=10,
                text=True,
            )
            if not (Path(temp_dir) / f&quot;{doc_path.stem}.html&quot;).exists():
                error_msg = result.stderr.strip() or &quot;Document validation failed&quot;
                print(f&quot;Validation error: {error_msg}&quot;, file=sys.stderr)
                return False
            return True
        except FileNotFoundError:
            print(&quot;Warning: soffice not found. Skipping validation.&quot;, file=sys.stderr)
            return True
        except subprocess.TimeoutExpired:
            print(&quot;Validation error: Timeout during conversion&quot;, file=sys.stderr)
            return False
        except Exception as e:
            print(f&quot;Validation error: {e}&quot;, file=sys.stderr)
            return False


def condense_xml(xml_file):
    &quot;&quot;&quot;Strip unnecessary whitespace and remove comments.&quot;&quot;&quot;
    with open(xml_file, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:
        dom = defusedxml.minidom.parse(f)

    # Process each element to remove whitespace and comments
    for element in dom.getElementsByTagName(&quot;*&quot;):
        # Skip w:t elements and their processing
        if element.tagName.endswith(&quot;:t&quot;):
            continue

        # Remove whitespace-only text nodes and comment nodes
        for child in list(element.childNodes):
            if (
                child.nodeType == child.TEXT_NODE
                and child.nodeValue
                and child.nodeValue.strip() == &quot;&quot;
            ) or child.nodeType == child.COMMENT_NODE:
                element.removeChild(child)

    # Write back the condensed XML
    with open(xml_file, &quot;wb&quot;) as f:
        f.write(dom.toxml(encoding=&quot;UTF-8&quot;))


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/pack/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/ooxml/scripts/pack.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="package_skill Imported skill package_skill from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/skill-creator/scripts/package_skill.py Unknown LICENSE.txt sources/anthropic/package_skill/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">package_skill</div>
                <button class="copy-btn" onclick="copyToClipboard('package_skill')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill package_skill from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Skill Packager - Creates a distributable .skill file of a skill folder

Usage:
    python utils/package_skill.py &lt;path/to/skill-folder&gt; [output-directory]

Example:
    python utils/package_skill.py skills/public/my-skill
    python utils/package_skill.py skills/public/my-skill ./dist
&quot;&quot;&quot;

import sys
import zipfile
from pathlib import Path
from quick_validate import validate_skill


def package_skill(skill_path, output_dir=None):
    &quot;&quot;&quot;
    Package a skill folder into a .skill file.

    Args:
        skill_path: Path to the skill folder
        output_dir: Optional output directory for the .skill file (defaults to current directory)

    Returns:
        Path to the created .skill file, or None if error
    &quot;&quot;&quot;
    skill_path = Path(skill_path).resolve()

    # Validate skill folder exists
    if not skill_path.exists():
        print(f&quot; Error: Skill folder not found: {skill_path}&quot;)
        return None

    if not skill_path.is_dir():
        print(f&quot; Error: Path is not a directory: {skill_path}&quot;)
        return None

    # Validate SKILL.md exists
    skill_md = skill_path / &quot;SKILL.md&quot;
    if not skill_md.exists():
        print(f&quot; Error: SKILL.md not found in {skill_path}&quot;)
        return None

    # Run validation before packaging
    print(&quot; Validating skill...&quot;)
    valid, message = validate_skill(skill_path)
    if not valid:
        print(f&quot; Validation failed: {message}&quot;)
        print(&quot;   Please fix the validation errors before packaging.&quot;)
        return None
    print(f&quot; {message}\n&quot;)

    # Determine output location
    skill_name = skill_path.name
    if output_dir:
        output_path = Path(output_dir).resolve()
        output_path.mkdir(parents=True, exist_ok=True)
    else:
        output_path = Path.cwd()

    skill_filename = output_path / f&quot;{skill_name}.skill&quot;

    # Create the .skill file (zip format)
    try:
        with zipfile.ZipFile(skill_filename, &#x27;w&#x27;, zipfile.ZIP_DEFLATED) as zipf:
            # Walk through the skill directory
            for file_path in skill_path.rglob(&#x27;*&#x27;):
                if file_path.is_file():
                    # Calculate the relative path within the zip
                    arcname = file_path.relative_to(skill_path.parent)
                    zipf.write(file_path, arcname)
                    print(f&quot;  Added: {arcname}&quot;)

        print(f&quot;\n Successfully packaged skill to: {skill_filename}&quot;)
        return skill_filename

    except Exception as e:
        print(f&quot; Error creating .skill file: {e}&quot;)
        return None


def main():
    if len(sys.argv) &lt; 2:
        print(&quot;Usage: python utils/package_skill.py &lt;path/to/skill-folder&gt; [output-directory]&quot;)
        print(&quot;\nExample:&quot;)
        print(&quot;  python utils/package_skill.py skills/public/my-skill&quot;)
        print(&quot;  python utils/package_skill.py skills/public/my-skill ./dist&quot;)
        sys.exit(1)

    skill_path = sys.argv[1]
    output_dir = sys.argv[2] if len(sys.argv) &gt; 2 else None

    print(f&quot; Packaging skill: {skill_path}&quot;)
    if output_dir:
        print(f&quot;   Output directory: {output_dir}&quot;)
    print()

    result = package_skill(skill_path, output_dir)

    if result:
        sys.exit(0)
    else:
        sys.exit(1)


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/package_skill/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/skill-creator/scripts/package_skill.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/skill-creator/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="pixelifysans_ofl Imported skill pixelifysans_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/PixelifySans-OFL.txt Unknown LICENSE.txt sources/anthropic/pixelifysans_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">pixelifysans_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('pixelifysans_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill pixelifysans_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2021 The Pixelify Sans Project Authors (https://github.com/eifetx/Pixelify-Sans)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/pixelifysans_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/PixelifySans-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="poiretone_ofl Imported skill poiretone_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/PoiretOne-OFL.txt Unknown LICENSE.txt sources/anthropic/poiretone_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">poiretone_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('poiretone_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill poiretone_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright (c) 2011, Denis Masharov (denis.masharov@gmail.com)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/poiretone_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/PoiretOne-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="pptx Imported skill pptx from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/ooxml/scripts/validation/pptx.py Unknown LICENSE.txt sources/anthropic/pptx/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">pptx</div>
                <button class="copy-btn" onclick="copyToClipboard('pptx')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill pptx from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;
Validator for PowerPoint presentation XML files against XSD schemas.
&quot;&quot;&quot;

import re

from .base import BaseSchemaValidator


class PPTXSchemaValidator(BaseSchemaValidator):
    &quot;&quot;&quot;Validator for PowerPoint presentation XML files against XSD schemas.&quot;&quot;&quot;

    # PowerPoint presentation namespace
    PRESENTATIONML_NAMESPACE = (
        &quot;http://schemas.openxmlformats.org/presentationml/2006/main&quot;
    )

    # PowerPoint-specific element to relationship type mappings
    ELEMENT_RELATIONSHIP_TYPES = {
        &quot;sldid&quot;: &quot;slide&quot;,
        &quot;sldmasterid&quot;: &quot;slidemaster&quot;,
        &quot;notesmasterid&quot;: &quot;notesmaster&quot;,
        &quot;sldlayoutid&quot;: &quot;slidelayout&quot;,
        &quot;themeid&quot;: &quot;theme&quot;,
        &quot;tablestyleid&quot;: &quot;tablestyles&quot;,
    }

    def validate(self):
        &quot;&quot;&quot;Run all validation checks and return True if all pass.&quot;&quot;&quot;
        # Test 0: XML well-formedness
        if not self.validate_xml():
            return False

        # Test 1: Namespace declarations
        all_valid = True
        if not self.validate_namespaces():
            all_valid = False

        # Test 2: Unique IDs
        if not self.validate_unique_ids():
            all_valid = False

        # Test 3: UUID ID validation
        if not self.validate_uuid_ids():
            all_valid = False

        # Test 4: Relationship and file reference validation
        if not self.validate_file_references():
            all_valid = False

        # Test 5: Slide layout ID validation
        if not self.validate_slide_layout_ids():
            all_valid = False

        # Test 6: Content type declarations
        if not self.validate_content_types():
            all_valid = False

        # Test 7: XSD schema validation
        if not self.validate_against_xsd():
            all_valid = False

        # Test 8: Notes slide reference validation
        if not self.validate_notes_slide_references():
            all_valid = False

        # Test 9: Relationship ID reference validation
        if not self.validate_all_relationship_ids():
            all_valid = False

        # Test 10: Duplicate slide layout references validation
        if not self.validate_no_duplicate_slide_layouts():
            all_valid = False

        return all_valid

    def validate_uuid_ids(self):
        &quot;&quot;&quot;Validate that ID attributes that look like UUIDs contain only hex values.&quot;&quot;&quot;
        import lxml.etree

        errors = []
        # UUID pattern: 8-4-4-4-12 hex digits with optional braces/hyphens
        uuid_pattern = re.compile(
            r&quot;^[\{\(]?[0-9A-Fa-f]{8}-?[0-9A-Fa-f]{4}-?[0-9A-Fa-f]{4}-?[0-9A-Fa-f]{4}-?[0-9A-Fa-f]{12}[\}\)]?$&quot;
        )

        for xml_file in self.xml_files:
            try:
                root = lxml.etree.parse(str(xml_file)).getroot()

                # Check all elements for ID attributes
                for elem in root.iter():
                    for attr, value in elem.attrib.items():
                        # Check if this is an ID attribute
                        attr_name = attr.split(&quot;}&quot;)[-1].lower()
                        if attr_name == &quot;id&quot; or attr_name.endswith(&quot;id&quot;):
                            # Check if value looks like a UUID (has the right length and pattern structure)
                            if self._looks_like_uuid(value):
                                # Validate that it contains only hex characters in the right positions
                                if not uuid_pattern.match(value):
                                    errors.append(
                                        f&quot;  {xml_file.relative_to(self.unpacked_dir)}: &quot;
                                        f&quot;Line {elem.sourceline}: ID &#x27;{value}&#x27; appears to be a UUID but contains invalid hex characters&quot;
                                    )

            except (lxml.etree.XMLSyntaxError, Exception) as e:
                errors.append(
                    f&quot;  {xml_file.relative_to(self.unpacked_dir)}: Error: {e}&quot;
                )

        if errors:
            print(f&quot;FAILED - Found {len(errors)} UUID ID validation errors:&quot;)
            for error in errors:
                print(error)
            return False
        else:
            if self.verbose:
                print(&quot;PASSED - All UUID-like IDs contain valid hex values&quot;)
            return True

    def _looks_like_uuid(self, value):
        &quot;&quot;&quot;Check if a value has the general structure of a UUID.&quot;&quot;&quot;
        # Remove common UUID delimiters
        clean_value = value.strip(&quot;{}()&quot;).replace(&quot;-&quot;, &quot;&quot;)
        # Check if it&#x27;s 32 hex-like characters (could include invalid hex chars)
        return len(clean_value) == 32 and all(c.isalnum() for c in clean_value)

    def validate_slide_layout_ids(self):
        &quot;&quot;&quot;Validate that sldLayoutId elements in slide masters reference valid slide layouts.&quot;&quot;&quot;
        import lxml.etree

        errors = []

        # Find all slide master files
        slide_masters = list(self.unpacked_dir.glob(&quot;ppt/slideMasters/*.xml&quot;))

        if not slide_masters:
            if self.verbose:
                print(&quot;PASSED - No slide masters found&quot;)
            return True

        for slide_master in slide_masters:
            try:
                # Parse the slide master file
                root = lxml.etree.parse(str(slide_master)).getroot()

                # Find the corresponding _rels file for this slide master
                rels_file = slide_master.parent / &quot;_rels&quot; / f&quot;{slide_master.name}.rels&quot;

                if not rels_file.exists():
                    errors.append(
                        f&quot;  {slide_master.relative_to(self.unpacked_dir)}: &quot;
                        f&quot;Missing relationships file: {rels_file.relative_to(self.unpacked_dir)}&quot;
                    )
                    continue

                # Parse the relationships file
                rels_root = lxml.etree.parse(str(rels_file)).getroot()

                # Build a set of valid relationship IDs that point to slide layouts
                valid_layout_rids = set()
                for rel in rels_root.findall(
                    f&quot;.//{{{self.PACKAGE_RELATIONSHIPS_NAMESPACE}}}Relationship&quot;
                ):
                    rel_type = rel.get(&quot;Type&quot;, &quot;&quot;)
                    if &quot;slideLayout&quot; in rel_type:
                        valid_layout_rids.add(rel.get(&quot;Id&quot;))

                # Find all sldLayoutId elements in the slide master
                for sld_layout_id in root.findall(
                    f&quot;.//{{{self.PRESENTATIONML_NAMESPACE}}}sldLayoutId&quot;
                ):
                    r_id = sld_layout_id.get(
                        f&quot;{{{self.OFFICE_RELATIONSHIPS_NAMESPACE}}}id&quot;
                    )
                    layout_id = sld_layout_id.get(&quot;id&quot;)

                    if r_id and r_id not in valid_layout_rids:
                        errors.append(
                            f&quot;  {slide_master.relative_to(self.unpacked_dir)}: &quot;
                            f&quot;Line {sld_layout_id.sourceline}: sldLayoutId with id=&#x27;{layout_id}&#x27; &quot;
                            f&quot;references r:id=&#x27;{r_id}&#x27; which is not found in slide layout relationships&quot;
                        )

            except (lxml.etree.XMLSyntaxError, Exception) as e:
                errors.append(
                    f&quot;  {slide_master.relative_to(self.unpacked_dir)}: Error: {e}&quot;
                )

        if errors:
            print(f&quot;FAILED - Found {len(errors)} slide layout ID validation errors:&quot;)
            for error in errors:
                print(error)
            print(
                &quot;Remove invalid references or add missing slide layouts to the relationships file.&quot;
            )
            return False
        else:
            if self.verbose:
                print(&quot;PASSED - All slide layout IDs reference valid slide layouts&quot;)
            return True

    def validate_no_duplicate_slide_layouts(self):
        &quot;&quot;&quot;Validate that each slide has exactly one slideLayout reference.&quot;&quot;&quot;
        import lxml.etree

        errors = []
        slide_rels_files = list(self.unpacked_dir.glob(&quot;ppt/slides/_rels/*.xml.rels&quot;))

        for rels_file in slide_rels_files:
            try:
                root = lxml.etree.parse(str(rels_file)).getroot()

                # Find all slideLayout relationships
                layout_rels = [
                    rel
                    for rel in root.findall(
                        f&quot;.//{{{self.PACKAGE_RELATIONSHIPS_NAMESPACE}}}Relationship&quot;
                    )
                    if &quot;slideLayout&quot; in rel.get(&quot;Type&quot;, &quot;&quot;)
                ]

                if len(layout_rels) &gt; 1:
                    errors.append(
                        f&quot;  {rels_file.relative_to(self.unpacked_dir)}: has {len(layout_rels)} slideLayout references&quot;
                    )

            except Exception as e:
                errors.append(
                    f&quot;  {rels_file.relative_to(self.unpacked_dir)}: Error: {e}&quot;
                )

        if errors:
            print(&quot;FAILED - Found slides with duplicate slideLayout references:&quot;)
            for error in errors:
                print(error)
            return False
        else:
            if self.verbose:
                print(&quot;PASSED - All slides have exactly one slideLayout reference&quot;)
            return True

    def validate_notes_slide_references(self):
        &quot;&quot;&quot;Validate that each notesSlide file is referenced by only one slide.&quot;&quot;&quot;
        import lxml.etree

        errors = []
        notes_slide_references = {}  # Track which slides reference each notesSlide

        # Find all slide relationship files
        slide_rels_files = list(self.unpacked_dir.glob(&quot;ppt/slides/_rels/*.xml.rels&quot;))

        if not slide_rels_files:
            if self.verbose:
                print(&quot;PASSED - No slide relationship files found&quot;)
            return True

        for rels_file in slide_rels_files:
            try:
                # Parse the relationships file
                root = lxml.etree.parse(str(rels_file)).getroot()

                # Find all notesSlide relationships
                for rel in root.findall(
                    f&quot;.//{{{self.PACKAGE_RELATIONSHIPS_NAMESPACE}}}Relationship&quot;
                ):
                    rel_type = rel.get(&quot;Type&quot;, &quot;&quot;)
                    if &quot;notesSlide&quot; in rel_type:
                        target = rel.get(&quot;Target&quot;, &quot;&quot;)
                        if target:
                            # Normalize the target path to handle relative paths
                            normalized_target = target.replace(&quot;../&quot;, &quot;&quot;)

                            # Track which slide references this notesSlide
                            slide_name = rels_file.stem.replace(
                                &quot;.xml&quot;, &quot;&quot;
                            )  # e.g., &quot;slide1&quot;

                            if normalized_target not in notes_slide_references:
                                notes_slide_references[normalized_target] = []
                            notes_slide_references[normalized_target].append(
                                (slide_name, rels_file)
                            )

            except (lxml.etree.XMLSyntaxError, Exception) as e:
                errors.append(
                    f&quot;  {rels_file.relative_to(self.unpacked_dir)}: Error: {e}&quot;
                )

        # Check for duplicate references
        for target, references in notes_slide_references.items():
            if len(references) &gt; 1:
                slide_names = [ref[0] for ref in references]
                errors.append(
                    f&quot;  Notes slide &#x27;{target}&#x27; is referenced by multiple slides: {&#x27;, &#x27;.join(slide_names)}&quot;
                )
                for slide_name, rels_file in references:
                    errors.append(f&quot;    - {rels_file.relative_to(self.unpacked_dir)}&quot;)

        if errors:
            print(
                f&quot;FAILED - Found {len([e for e in errors if not e.startswith(&#x27;    &#x27;)])} notes slide reference validation errors:&quot;
            )
            for error in errors:
                print(error)
            print(&quot;Each slide may optionally have its own slide file.&quot;)
            return False
        else:
            if self.verbose:
                print(&quot;PASSED - All notes slide references are unique&quot;)
            return True


if __name__ == &quot;__main__&quot;:
    raise RuntimeError(&quot;This module should not be run directly.&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/pptx/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/ooxml/scripts/validation/pptx.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="python_mcp_server Imported skill python_mcp_server from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/mcp-builder/reference/python_mcp_server.md Unknown LICENSE.txt sources/anthropic/python_mcp_server/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">python_mcp_server</div>
                <button class="copy-btn" onclick="copyToClipboard('python_mcp_server')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill python_mcp_server from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Python MCP Server Implementation Guide

## Overview

This document provides Python-specific best practices and examples for implementing MCP servers using the MCP Python SDK. It covers server setup, tool registration patterns, input validation with Pydantic, error handling, and complete working examples.

---

## Quick Reference

### Key Imports
```python
from mcp.server.fastmcp import FastMCP
from pydantic import BaseModel, Field, field_validator, ConfigDict
from typing import Optional, List, Dict, Any
from enum import Enum
import httpx
```

### Server Initialization
```python
mcp = FastMCP(&quot;service_mcp&quot;)
```

### Tool Registration Pattern
```python
@mcp.tool(name=&quot;tool_name&quot;, annotations={...})
async def tool_function(params: InputModel) -&gt; str:
    # Implementation
    pass
```

---

## MCP Python SDK and FastMCP

The official MCP Python SDK provides FastMCP, a high-level framework for building MCP servers. It provides:
- Automatic description and inputSchema generation from function signatures and docstrings
- Pydantic model integration for input validation
- Decorator-based tool registration with `@mcp.tool`

**For complete SDK documentation, use WebFetch to load:**
`https://raw.githubusercontent.com/modelcontextprotocol/python-sdk/main/README.md`

## Server Naming Convention

Python MCP servers must follow this naming pattern:
- **Format**: `{service}_mcp` (lowercase with underscores)
- **Examples**: `github_mcp`, `jira_mcp`, `stripe_mcp`

The name should be:
- General (not tied to specific features)
- Descriptive of the service/API being integrated
- Easy to infer from the task description
- Without version numbers or dates

## Tool Implementation

### Tool Naming

Use snake_case for tool names (e.g., &quot;search_users&quot;, &quot;create_project&quot;, &quot;get_channel_info&quot;) with clear, action-oriented names.

**Avoid Naming Conflicts**: Include the service context to prevent overlaps:
- Use &quot;slack_send_message&quot; instead of just &quot;send_message&quot;
- Use &quot;github_create_issue&quot; instead of just &quot;create_issue&quot;
- Use &quot;asana_list_tasks&quot; instead of just &quot;list_tasks&quot;

### Tool Structure with FastMCP

Tools are defined using the `@mcp.tool` decorator with Pydantic models for input validation:

```python
from pydantic import BaseModel, Field, ConfigDict
from mcp.server.fastmcp import FastMCP

# Initialize the MCP server
mcp = FastMCP(&quot;example_mcp&quot;)

# Define Pydantic model for input validation
class ServiceToolInput(BaseModel):
    &#x27;&#x27;&#x27;Input model for service tool operation.&#x27;&#x27;&#x27;
    model_config = ConfigDict(
        str_strip_whitespace=True,  # Auto-strip whitespace from strings
        validate_assignment=True,    # Validate on assignment
        extra=&#x27;forbid&#x27;              # Forbid extra fields
    )

    param1: str = Field(..., description=&quot;First parameter description (e.g., &#x27;user123&#x27;, &#x27;project-abc&#x27;)&quot;, min_length=1, max_length=100)
    param2: Optional[int] = Field(default=None, description=&quot;Optional integer parameter with constraints&quot;, ge=0, le=1000)
    tags: Optional[List[str]] = Field(default_factory=list, description=&quot;List of tags to apply&quot;, max_items=10)

@mcp.tool(
    name=&quot;service_tool_name&quot;,
    annotations={
        &quot;title&quot;: &quot;Human-Readable Tool Title&quot;,
        &quot;readOnlyHint&quot;: True,     # Tool does not modify environment
        &quot;destructiveHint&quot;: False,  # Tool does not perform destructive operations
        &quot;idempotentHint&quot;: True,    # Repeated calls have no additional effect
        &quot;openWorldHint&quot;: False     # Tool does not interact with external entities
    }
)
async def service_tool_name(params: ServiceToolInput) -&gt; str:
    &#x27;&#x27;&#x27;Tool description automatically becomes the &#x27;description&#x27; field.

    This tool performs a specific operation on the service. It validates all inputs
    using the ServiceToolInput Pydantic model before processing.

    Args:
        params (ServiceToolInput): Validated input parameters containing:
            - param1 (str): First parameter description
            - param2 (Optional[int]): Optional parameter with default
            - tags (Optional[List[str]]): List of tags

    Returns:
        str: JSON-formatted response containing operation results
    &#x27;&#x27;&#x27;
    # Implementation here
    pass
```

## Pydantic v2 Key Features

- Use `model_config` instead of nested `Config` class
- Use `field_validator` instead of deprecated `validator`
- Use `model_dump()` instead of deprecated `dict()`
- Validators require `@classmethod` decorator
- Type hints are required for validator methods

```python
from pydantic import BaseModel, Field, field_validator, ConfigDict

class CreateUserInput(BaseModel):
    model_config = ConfigDict(
        str_strip_whitespace=True,
        validate_assignment=True
    )

    name: str = Field(..., description=&quot;User&#x27;s full name&quot;, min_length=1, max_length=100)
    email: str = Field(..., description=&quot;User&#x27;s email address&quot;, pattern=r&#x27;^[\w\.-]+@[\w\.-]+\.\w+$&#x27;)
    age: int = Field(..., description=&quot;User&#x27;s age&quot;, ge=0, le=150)

    @field_validator(&#x27;email&#x27;)
    @classmethod
    def validate_email(cls, v: str) -&gt; str:
        if not v.strip():
            raise ValueError(&quot;Email cannot be empty&quot;)
        return v.lower()
```

## Response Format Options

Support multiple output formats for flexibility:

```python
from enum import Enum

class ResponseFormat(str, Enum):
    &#x27;&#x27;&#x27;Output format for tool responses.&#x27;&#x27;&#x27;
    MARKDOWN = &quot;markdown&quot;
    JSON = &quot;json&quot;

class UserSearchInput(BaseModel):
    query: str = Field(..., description=&quot;Search query&quot;)
    response_format: ResponseFormat = Field(
        default=ResponseFormat.MARKDOWN,
        description=&quot;Output format: &#x27;markdown&#x27; for human-readable or &#x27;json&#x27; for machine-readable&quot;
    )
```

**Markdown format**:
- Use headers, lists, and formatting for clarity
- Convert timestamps to human-readable format (e.g., &quot;2024-01-15 10:30:00 UTC&quot; instead of epoch)
- Show display names with IDs in parentheses (e.g., &quot;@john.doe (U123456)&quot;)
- Omit verbose metadata (e.g., show only one profile image URL, not all sizes)
- Group related information logically

**JSON format**:
- Return complete, structured data suitable for programmatic processing
- Include all available fields and metadata
- Use consistent field names and types

## Pagination Implementation

For tools that list resources:

```python
class ListInput(BaseModel):
    limit: Optional[int] = Field(default=20, description=&quot;Maximum results to return&quot;, ge=1, le=100)
    offset: Optional[int] = Field(default=0, description=&quot;Number of results to skip for pagination&quot;, ge=0)

async def list_items(params: ListInput) -&gt; str:
    # Make API request with pagination
    data = await api_request(limit=params.limit, offset=params.offset)

    # Return pagination info
    response = {
        &quot;total&quot;: data[&quot;total&quot;],
        &quot;count&quot;: len(data[&quot;items&quot;]),
        &quot;offset&quot;: params.offset,
        &quot;items&quot;: data[&quot;items&quot;],
        &quot;has_more&quot;: data[&quot;total&quot;] &gt; params.offset + len(data[&quot;items&quot;]),
        &quot;next_offset&quot;: params.offset + len(data[&quot;items&quot;]) if data[&quot;total&quot;] &gt; params.offset + len(data[&quot;items&quot;]) else None
    }
    return json.dumps(response, indent=2)
```

## Error Handling

Provide clear, actionable error messages:

```python
def _handle_api_error(e: Exception) -&gt; str:
    &#x27;&#x27;&#x27;Consistent error formatting across all tools.&#x27;&#x27;&#x27;
    if isinstance(e, httpx.HTTPStatusError):
        if e.response.status_code == 404:
            return &quot;Error: Resource not found. Please check the ID is correct.&quot;
        elif e.response.status_code == 403:
            return &quot;Error: Permission denied. You don&#x27;t have access to this resource.&quot;
        elif e.response.status_code == 429:
            return &quot;Error: Rate limit exceeded. Please wait before making more requests.&quot;
        return f&quot;Error: API request failed with status {e.response.status_code}&quot;
    elif isinstance(e, httpx.TimeoutException):
        return &quot;Error: Request timed out. Please try again.&quot;
    return f&quot;Error: Unexpected error occurred: {type(e).__name__}&quot;
```

## Shared Utilities

Extract common functionality into reusable functions:

```python
# Shared API request function
async def _make_api_request(endpoint: str, method: str = &quot;GET&quot;, **kwargs) -&gt; dict:
    &#x27;&#x27;&#x27;Reusable function for all API calls.&#x27;&#x27;&#x27;
    async with httpx.AsyncClient() as client:
        response = await client.request(
            method,
            f&quot;{API_BASE_URL}/{endpoint}&quot;,
            timeout=30.0,
            **kwargs
        )
        response.raise_for_status()
        return response.json()
```

## Async/Await Best Practices

Always use async/await for network requests and I/O operations:

```python
# Good: Async network request
async def fetch_data(resource_id: str) -&gt; dict:
    async with httpx.AsyncClient() as client:
        response = await client.get(f&quot;{API_URL}/resource/{resource_id}&quot;)
        response.raise_for_status()
        return response.json()

# Bad: Synchronous request
def fetch_data(resource_id: str) -&gt; dict:
    response = requests.get(f&quot;{API_URL}/resource/{resource_id}&quot;)  # Blocks
    return response.json()
```

## Type Hints

Use type hints throughout:

```python
from typing import Optional, List, Dict, Any

async def get_user(user_id: str) -&gt; Dict[str, Any]:
    data = await fetch_user(user_id)
    return {&quot;id&quot;: data[&quot;id&quot;], &quot;name&quot;: data[&quot;name&quot;]}
```

## Tool Docstrings

Every tool must have comprehensive docstrings with explicit type information:

```python
async def search_users(params: UserSearchInput) -&gt; str:
    &#x27;&#x27;&#x27;
    Search for users in the Example system by name, email, or team.

    This tool searches across all user profiles in the Example platform,
    supporting partial matches and various search filters. It does NOT
    create or modify users, only searches existing ones.

    Args:
        params (UserSearchInput): Validated input parameters containing:
            - query (str): Search string to match against names/emails (e.g., &quot;john&quot;, &quot;@example.com&quot;, &quot;team:marketing&quot;)
            - limit (Optional[int]): Maximum results to return, between 1-100 (default: 20)
            - offset (Optional[int]): Number of results to skip for pagination (default: 0)

    Returns:
        str: JSON-formatted string containing search results with the following schema:

        Success response:
        {
            &quot;total&quot;: int,           # Total number of matches found
            &quot;count&quot;: int,           # Number of results in this response
            &quot;offset&quot;: int,          # Current pagination offset
            &quot;users&quot;: [
                {
                    &quot;id&quot;: str,      # User ID (e.g., &quot;U123456789&quot;)
                    &quot;name&quot;: str,    # Full name (e.g., &quot;John Doe&quot;)
                    &quot;email&quot;: str,   # Email address (e.g., &quot;john@example.com&quot;)
                    &quot;team&quot;: str     # Team name (e.g., &quot;Marketing&quot;) - optional
                }
            ]
        }

        Error response:
        &quot;Error: &lt;error message&gt;&quot; or &quot;No users found matching &#x27;&lt;query&gt;&#x27;&quot;

    Examples:
        - Use when: &quot;Find all marketing team members&quot; -&gt; params with query=&quot;team:marketing&quot;
        - Use when: &quot;Search for John&#x27;s account&quot; -&gt; params with query=&quot;john&quot;
        - Don&#x27;t use when: You need to create a user (use example_create_user instead)
        - Don&#x27;t use when: You have a user ID and need full details (use example_get_user instead)

    Error Handling:
        - Input validation errors are handled by Pydantic model
        - Returns &quot;Error: Rate limit exceeded&quot; if too many requests (429 status)
        - Returns &quot;Error: Invalid API authentication&quot; if API key is invalid (401 status)
        - Returns formatted list of results or &quot;No users found matching &#x27;query&#x27;&quot;
    &#x27;&#x27;&#x27;
```

## Complete Example

See below for a complete Python MCP server example:

```python
#!/usr/bin/env python3
&#x27;&#x27;&#x27;
MCP Server for Example Service.

This server provides tools to interact with Example API, including user search,
project management, and data export capabilities.
&#x27;&#x27;&#x27;

from typing import Optional, List, Dict, Any
from enum import Enum
import httpx
from pydantic import BaseModel, Field, field_validator, ConfigDict
from mcp.server.fastmcp import FastMCP

# Initialize the MCP server
mcp = FastMCP(&quot;example_mcp&quot;)

# Constants
API_BASE_URL = &quot;https://api.example.com/v1&quot;

# Enums
class ResponseFormat(str, Enum):
    &#x27;&#x27;&#x27;Output format for tool responses.&#x27;&#x27;&#x27;
    MARKDOWN = &quot;markdown&quot;
    JSON = &quot;json&quot;

# Pydantic Models for Input Validation
class UserSearchInput(BaseModel):
    &#x27;&#x27;&#x27;Input model for user search operations.&#x27;&#x27;&#x27;
    model_config = ConfigDict(
        str_strip_whitespace=True,
        validate_assignment=True
    )

    query: str = Field(..., description=&quot;Search string to match against names/emails&quot;, min_length=2, max_length=200)
    limit: Optional[int] = Field(default=20, description=&quot;Maximum results to return&quot;, ge=1, le=100)
    offset: Optional[int] = Field(default=0, description=&quot;Number of results to skip for pagination&quot;, ge=0)
    response_format: ResponseFormat = Field(default=ResponseFormat.MARKDOWN, description=&quot;Output format&quot;)

    @field_validator(&#x27;query&#x27;)
    @classmethod
    def validate_query(cls, v: str) -&gt; str:
        if not v.strip():
            raise ValueError(&quot;Query cannot be empty or whitespace only&quot;)
        return v.strip()

# Shared utility functions
async def _make_api_request(endpoint: str, method: str = &quot;GET&quot;, **kwargs) -&gt; dict:
    &#x27;&#x27;&#x27;Reusable function for all API calls.&#x27;&#x27;&#x27;
    async with httpx.AsyncClient() as client:
        response = await client.request(
            method,
            f&quot;{API_BASE_URL}/{endpoint}&quot;,
            timeout=30.0,
            **kwargs
        )
        response.raise_for_status()
        return response.json()

def _handle_api_error(e: Exception) -&gt; str:
    &#x27;&#x27;&#x27;Consistent error formatting across all tools.&#x27;&#x27;&#x27;
    if isinstance(e, httpx.HTTPStatusError):
        if e.response.status_code == 404:
            return &quot;Error: Resource not found. Please check the ID is correct.&quot;
        elif e.response.status_code == 403:
            return &quot;Error: Permission denied. You don&#x27;t have access to this resource.&quot;
        elif e.response.status_code == 429:
            return &quot;Error: Rate limit exceeded. Please wait before making more requests.&quot;
        return f&quot;Error: API request failed with status {e.response.status_code}&quot;
    elif isinstance(e, httpx.TimeoutException):
        return &quot;Error: Request timed out. Please try again.&quot;
    return f&quot;Error: Unexpected error occurred: {type(e).__name__}&quot;

# Tool definitions
@mcp.tool(
    name=&quot;example_search_users&quot;,
    annotations={
        &quot;title&quot;: &quot;Search Example Users&quot;,
        &quot;readOnlyHint&quot;: True,
        &quot;destructiveHint&quot;: False,
        &quot;idempotentHint&quot;: True,
        &quot;openWorldHint&quot;: True
    }
)
async def example_search_users(params: UserSearchInput) -&gt; str:
    &#x27;&#x27;&#x27;Search for users in the Example system by name, email, or team.

    [Full docstring as shown above]
    &#x27;&#x27;&#x27;
    try:
        # Make API request using validated parameters
        data = await _make_api_request(
            &quot;users/search&quot;,
            params={
                &quot;q&quot;: params.query,
                &quot;limit&quot;: params.limit,
                &quot;offset&quot;: params.offset
            }
        )

        users = data.get(&quot;users&quot;, [])
        total = data.get(&quot;total&quot;, 0)

        if not users:
            return f&quot;No users found matching &#x27;{params.query}&#x27;&quot;

        # Format response based on requested format
        if params.response_format == ResponseFormat.MARKDOWN:
            lines = [f&quot;# User Search Results: &#x27;{params.query}&#x27;&quot;, &quot;&quot;]
            lines.append(f&quot;Found {total} users (showing {len(users)})&quot;)
            lines.append(&quot;&quot;)

            for user in users:
                lines.append(f&quot;## {user[&#x27;name&#x27;]} ({user[&#x27;id&#x27;]})&quot;)
                lines.append(f&quot;- **Email**: {user[&#x27;email&#x27;]}&quot;)
                if user.get(&#x27;team&#x27;):
                    lines.append(f&quot;- **Team**: {user[&#x27;team&#x27;]}&quot;)
                lines.append(&quot;&quot;)

            return &quot;\n&quot;.join(lines)

        else:
            # Machine-readable JSON format
            import json
            response = {
                &quot;total&quot;: total,
                &quot;count&quot;: len(users),
                &quot;offset&quot;: params.offset,
                &quot;users&quot;: users
            }
            return json.dumps(response, indent=2)

    except Exception as e:
        return _handle_api_error(e)

if __name__ == &quot;__main__&quot;:
    mcp.run()
```

---

## Advanced FastMCP Features

### Context Parameter Injection

FastMCP can automatically inject a `Context` parameter into tools for advanced capabilities like logging, progress reporting, resource reading, and user interaction:

```python
from mcp.server.fastmcp import FastMCP, Context

mcp = FastMCP(&quot;example_mcp&quot;)

@mcp.tool()
async def advanced_search(query: str, ctx: Context) -&gt; str:
    &#x27;&#x27;&#x27;Advanced tool with context access for logging and progress.&#x27;&#x27;&#x27;

    # Report progress for long operations
    await ctx.report_progress(0.25, &quot;Starting search...&quot;)

    # Log information for debugging
    await ctx.log_info(&quot;Processing query&quot;, {&quot;query&quot;: query, &quot;timestamp&quot;: datetime.now()})

    # Perform search
    results = await search_api(query)
    await ctx.report_progress(0.75, &quot;Formatting results...&quot;)

    # Access server configuration
    server_name = ctx.fastmcp.name

    return format_results(results)

@mcp.tool()
async def interactive_tool(resource_id: str, ctx: Context) -&gt; str:
    &#x27;&#x27;&#x27;Tool that can request additional input from users.&#x27;&#x27;&#x27;

    # Request sensitive information when needed
    api_key = await ctx.elicit(
        prompt=&quot;Please provide your API key:&quot;,
        input_type=&quot;password&quot;
    )

    # Use the provided key
    return await api_call(resource_id, api_key)
```

**Context capabilities:**
- `ctx.report_progress(progress, message)` - Report progress for long operations
- `ctx.log_info(message, data)` / `ctx.log_error()` / `ctx.log_debug()` - Logging
- `ctx.elicit(prompt, input_type)` - Request input from users
- `ctx.fastmcp.name` - Access server configuration
- `ctx.read_resource(uri)` - Read MCP resources

### Resource Registration

Expose data as resources for efficient, template-based access:

```python
@mcp.resource(&quot;file://documents/{name}&quot;)
async def get_document(name: str) -&gt; str:
    &#x27;&#x27;&#x27;Expose documents as MCP resources.

    Resources are useful for static or semi-static data that doesn&#x27;t
    require complex parameters. They use URI templates for flexible access.
    &#x27;&#x27;&#x27;
    document_path = f&quot;./docs/{name}&quot;
    with open(document_path, &quot;r&quot;) as f:
        return f.read()

@mcp.resource(&quot;config://settings/{key}&quot;)
async def get_setting(key: str, ctx: Context) -&gt; str:
    &#x27;&#x27;&#x27;Expose configuration as resources with context.&#x27;&#x27;&#x27;
    settings = await load_settings()
    return json.dumps(settings.get(key, {}))
```

**When to use Resources vs Tools:**
- **Resources**: For data access with simple parameters (URI templates)
- **Tools**: For complex operations with validation and business logic

### Structured Output Types

FastMCP supports multiple return types beyond strings:

```python
from typing import TypedDict
from dataclasses import dataclass
from pydantic import BaseModel

# TypedDict for structured returns
class UserData(TypedDict):
    id: str
    name: str
    email: str

@mcp.tool()
async def get_user_typed(user_id: str) -&gt; UserData:
    &#x27;&#x27;&#x27;Returns structured data - FastMCP handles serialization.&#x27;&#x27;&#x27;
    return {&quot;id&quot;: user_id, &quot;name&quot;: &quot;John Doe&quot;, &quot;email&quot;: &quot;john@example.com&quot;}

# Pydantic models for complex validation
class DetailedUser(BaseModel):
    id: str
    name: str
    email: str
    created_at: datetime
    metadata: Dict[str, Any]

@mcp.tool()
async def get_user_detailed(user_id: str) -&gt; DetailedUser:
    &#x27;&#x27;&#x27;Returns Pydantic model - automatically generates schema.&#x27;&#x27;&#x27;
    user = await fetch_user(user_id)
    return DetailedUser(**user)
```

### Lifespan Management

Initialize resources that persist across requests:

```python
from contextlib import asynccontextmanager

@asynccontextmanager
async def app_lifespan():
    &#x27;&#x27;&#x27;Manage resources that live for the server&#x27;s lifetime.&#x27;&#x27;&#x27;
    # Initialize connections, load config, etc.
    db = await connect_to_database()
    config = load_configuration()

    # Make available to all tools
    yield {&quot;db&quot;: db, &quot;config&quot;: config}

    # Cleanup on shutdown
    await db.close()

mcp = FastMCP(&quot;example_mcp&quot;, lifespan=app_lifespan)

@mcp.tool()
async def query_data(query: str, ctx: Context) -&gt; str:
    &#x27;&#x27;&#x27;Access lifespan resources through context.&#x27;&#x27;&#x27;
    db = ctx.request_context.lifespan_state[&quot;db&quot;]
    results = await db.query(query)
    return format_results(results)
```

### Transport Options

FastMCP supports two main transport mechanisms:

```python
# stdio transport (for local tools) - default
if __name__ == &quot;__main__&quot;:
    mcp.run()

# Streamable HTTP transport (for remote servers)
if __name__ == &quot;__main__&quot;:
    mcp.run(transport=&quot;streamable_http&quot;, port=8000)
```

**Transport selection:**
- **stdio**: Command-line tools, local integrations, subprocess execution
- **Streamable HTTP**: Web services, remote access, multiple clients

---

## Code Best Practices

### Code Composability and Reusability

Your implementation MUST prioritize composability and code reuse:

1. **Extract Common Functionality**:
   - Create reusable helper functions for operations used across multiple tools
   - Build shared API clients for HTTP requests instead of duplicating code
   - Centralize error handling logic in utility functions
   - Extract business logic into dedicated functions that can be composed
   - Extract shared markdown or JSON field selection &amp; formatting functionality

2. **Avoid Duplication**:
   - NEVER copy-paste similar code between tools
   - If you find yourself writing similar logic twice, extract it into a function
   - Common operations like pagination, filtering, field selection, and formatting should be shared
   - Authentication/authorization logic should be centralized

### Python-Specific Best Practices

1. **Use Type Hints**: Always include type annotations for function parameters and return values
2. **Pydantic Models**: Define clear Pydantic models for all input validation
3. **Avoid Manual Validation**: Let Pydantic handle input validation with constraints
4. **Proper Imports**: Group imports (standard library, third-party, local)
5. **Error Handling**: Use specific exception types (httpx.HTTPStatusError, not generic Exception)
6. **Async Context Managers**: Use `async with` for resources that need cleanup
7. **Constants**: Define module-level constants in UPPER_CASE

## Quality Checklist

Before finalizing your Python MCP server implementation, ensure:

### Strategic Design
- [ ] Tools enable complete workflows, not just API endpoint wrappers
- [ ] Tool names reflect natural task subdivisions
- [ ] Response formats optimize for agent context efficiency
- [ ] Human-readable identifiers used where appropriate
- [ ] Error messages guide agents toward correct usage

### Implementation Quality
- [ ] FOCUSED IMPLEMENTATION: Most important and valuable tools implemented
- [ ] All tools have descriptive names and documentation
- [ ] Return types are consistent across similar operations
- [ ] Error handling is implemented for all external calls
- [ ] Server name follows format: `{service}_mcp`
- [ ] All network operations use async/await
- [ ] Common functionality is extracted into reusable functions
- [ ] Error messages are clear, actionable, and educational
- [ ] Outputs are properly validated and formatted

### Tool Configuration
- [ ] All tools implement &#x27;name&#x27; and &#x27;annotations&#x27; in the decorator
- [ ] Annotations correctly set (readOnlyHint, destructiveHint, idempotentHint, openWorldHint)
- [ ] All tools use Pydantic BaseModel for input validation with Field() definitions
- [ ] All Pydantic Fields have explicit types and descriptions with constraints
- [ ] All tools have comprehensive docstrings with explicit input/output types
- [ ] Docstrings include complete schema structure for dict/JSON returns
- [ ] Pydantic models handle input validation (no manual validation needed)

### Advanced Features (where applicable)
- [ ] Context injection used for logging, progress, or elicitation
- [ ] Resources registered for appropriate data endpoints
- [ ] Lifespan management implemented for persistent connections
- [ ] Structured output types used (TypedDict, Pydantic models)
- [ ] Appropriate transport configured (stdio or streamable HTTP)

### Code Quality
- [ ] File includes proper imports including Pydantic imports
- [ ] Pagination is properly implemented where applicable
- [ ] Filtering options are provided for potentially large result sets
- [ ] All async functions are properly defined with `async def`
- [ ] HTTP client usage follows async patterns with proper context managers
- [ ] Type hints are used throughout the code
- [ ] Constants are defined at module level in UPPER_CASE

### Testing
- [ ] Server runs successfully: `python your_server.py --help`
- [ ] All imports resolve correctly
- [ ] Sample tool calls work as expected
- [ ] Error scenarios handled gracefully</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/python_mcp_server/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/reference/python_mcp_server.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="quick_validate Imported skill quick_validate from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/skill-creator/scripts/quick_validate.py Unknown LICENSE.txt sources/anthropic/quick_validate/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">quick_validate</div>
                <button class="copy-btn" onclick="copyToClipboard('quick_validate')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill quick_validate from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Quick validation script for skills - minimal version
&quot;&quot;&quot;

import sys
import os
import re
import yaml
from pathlib import Path

def validate_skill(skill_path):
    &quot;&quot;&quot;Basic validation of a skill&quot;&quot;&quot;
    skill_path = Path(skill_path)

    # Check SKILL.md exists
    skill_md = skill_path / &#x27;SKILL.md&#x27;
    if not skill_md.exists():
        return False, &quot;SKILL.md not found&quot;

    # Read and validate frontmatter
    content = skill_md.read_text()
    if not content.startswith(&#x27;---&#x27;):
        return False, &quot;No YAML frontmatter found&quot;

    # Extract frontmatter
    match = re.match(r&#x27;^---\n(.*?)\n---&#x27;, content, re.DOTALL)
    if not match:
        return False, &quot;Invalid frontmatter format&quot;

    frontmatter_text = match.group(1)

    # Parse YAML frontmatter
    try:
        frontmatter = yaml.safe_load(frontmatter_text)
        if not isinstance(frontmatter, dict):
            return False, &quot;Frontmatter must be a YAML dictionary&quot;
    except yaml.YAMLError as e:
        return False, f&quot;Invalid YAML in frontmatter: {e}&quot;

    # Define allowed properties
    ALLOWED_PROPERTIES = {&#x27;name&#x27;, &#x27;description&#x27;, &#x27;license&#x27;, &#x27;allowed-tools&#x27;, &#x27;metadata&#x27;}

    # Check for unexpected properties (excluding nested keys under metadata)
    unexpected_keys = set(frontmatter.keys()) - ALLOWED_PROPERTIES
    if unexpected_keys:
        return False, (
            f&quot;Unexpected key(s) in SKILL.md frontmatter: {&#x27;, &#x27;.join(sorted(unexpected_keys))}. &quot;
            f&quot;Allowed properties are: {&#x27;, &#x27;.join(sorted(ALLOWED_PROPERTIES))}&quot;
        )

    # Check required fields
    if &#x27;name&#x27; not in frontmatter:
        return False, &quot;Missing &#x27;name&#x27; in frontmatter&quot;
    if &#x27;description&#x27; not in frontmatter:
        return False, &quot;Missing &#x27;description&#x27; in frontmatter&quot;

    # Extract name for validation
    name = frontmatter.get(&#x27;name&#x27;, &#x27;&#x27;)
    if not isinstance(name, str):
        return False, f&quot;Name must be a string, got {type(name).__name__}&quot;
    name = name.strip()
    if name:
        # Check naming convention (hyphen-case: lowercase with hyphens)
        if not re.match(r&#x27;^[a-z0-9-]+$&#x27;, name):
            return False, f&quot;Name &#x27;{name}&#x27; should be hyphen-case (lowercase letters, digits, and hyphens only)&quot;
        if name.startswith(&#x27;-&#x27;) or name.endswith(&#x27;-&#x27;) or &#x27;--&#x27; in name:
            return False, f&quot;Name &#x27;{name}&#x27; cannot start/end with hyphen or contain consecutive hyphens&quot;
        # Check name length (max 64 characters per spec)
        if len(name) &gt; 64:
            return False, f&quot;Name is too long ({len(name)} characters). Maximum is 64 characters.&quot;

    # Extract and validate description
    description = frontmatter.get(&#x27;description&#x27;, &#x27;&#x27;)
    if not isinstance(description, str):
        return False, f&quot;Description must be a string, got {type(description).__name__}&quot;
    description = description.strip()
    if description:
        # Check for angle brackets
        if &#x27;&lt;&#x27; in description or &#x27;&gt;&#x27; in description:
            return False, &quot;Description cannot contain angle brackets (&lt; or &gt;)&quot;
        # Check description length (max 1024 characters per spec)
        if len(description) &gt; 1024:
            return False, f&quot;Description is too long ({len(description)} characters). Maximum is 1024 characters.&quot;

    return True, &quot;Skill is valid!&quot;

if __name__ == &quot;__main__&quot;:
    if len(sys.argv) != 2:
        print(&quot;Usage: python quick_validate.py &lt;skill_directory&gt;&quot;)
        sys.exit(1)
    
    valid, message = validate_skill(sys.argv[1])
    print(message)
    sys.exit(0 if valid else 1)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/quick_validate/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/skill-creator/scripts/quick_validate.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/skill-creator/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="readme Imported skill readme from anthropic anthropic /a0/tmp/skills_research/anthropic/README.md Unknown LICENSE.txt sources/anthropic/readme/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">readme</div>
                <button class="copy-btn" onclick="copyToClipboard('readme')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill readme from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&gt; **Note:** This repository contains Anthropic&#x27;s implementation of skills for Claude. For information about the Agent Skills standard, see [agentskills.io](http://agentskills.io).

# Skills
Skills are folders of instructions, scripts, and resources that Claude loads dynamically to improve performance on specialized tasks. Skills teach Claude how to complete specific tasks in a repeatable way, whether that&#x27;s creating documents with your company&#x27;s brand guidelines, analyzing data using your organization&#x27;s specific workflows, or automating personal tasks.

For more information, check out:
- [What are skills?](https://support.claude.com/en/articles/12512176-what-are-skills)
- [Using skills in Claude](https://support.claude.com/en/articles/12512180-using-skills-in-claude)
- [How to create custom skills](https://support.claude.com/en/articles/12512198-creating-custom-skills)
- [Equipping agents for the real world with Agent Skills](https://anthropic.com/engineering/equipping-agents-for-the-real-world-with-agent-skills)

# About This Repository

This repository contains skills that demonstrate what&#x27;s possible with Claude&#x27;s skills system. These skills range from creative applications (art, music, design) to technical tasks (testing web apps, MCP server generation) to enterprise workflows (communications, branding, etc.).

Each skill is self-contained in its own folder with a `SKILL.md` file containing the instructions and metadata that Claude uses. Browse through these skills to get inspiration for your own skills or to understand different patterns and approaches.

Many skills in this repo are open source (Apache 2.0). We&#x27;ve also included the document creation &amp; editing skills that power [Claude&#x27;s document capabilities](https://www.anthropic.com/news/create-files) under the hood in the [`skills/docx`](./skills/docx), [`skills/pdf`](./skills/pdf), [`skills/pptx`](./skills/pptx), and [`skills/xlsx`](./skills/xlsx) subfolders. These are source-available, not open source, but we wanted to share these with developers as a reference for more complex skills that are actively used in a production AI application.

## Disclaimer

**These skills are provided for demonstration and educational purposes only.** While some of these capabilities may be available in Claude, the implementations and behaviors you receive from Claude may differ from what is shown in these skills. These skills are meant to illustrate patterns and possibilities. Always test skills thoroughly in your own environment before relying on them for critical tasks.

# Skill Sets
- [./skills](./skills): Skill examples for Creative &amp; Design, Development &amp; Technical, Enterprise &amp; Communication, and Document Skills
- [./spec](./spec): The Agent Skills specification
- [./template](./template): Skill template

# Try in Claude Code, Claude.ai, and the API

## Claude Code
You can register this repository as a Claude Code Plugin marketplace by running the following command in Claude Code:
```
/plugin marketplace add anthropics/skills
```

Then, to install a specific set of skills:
1. Select `Browse and install plugins`
2. Select `anthropic-agent-skills`
3. Select `document-skills` or `example-skills`
4. Select `Install now`

Alternatively, directly install either Plugin via:
```
/plugin install document-skills@anthropic-agent-skills
/plugin install example-skills@anthropic-agent-skills
```

After installing the plugin, you can use the skill by just mentioning it. For instance, if you install the `document-skills` plugin from the marketplace, you can ask Claude Code to do something like: &quot;Use the PDF skill to extract the form fields from `path/to/some-file.pdf`&quot;

## Claude.ai

These example skills are all already available to paid plans in Claude.ai. 

To use any skill from this repository or upload custom skills, follow the instructions in [Using skills in Claude](https://support.claude.com/en/articles/12512180-using-skills-in-claude#h_a4222fa77b).

## Claude API

You can use Anthropic&#x27;s pre-built skills, and upload custom skills, via the Claude API. See the [Skills API Quickstart](https://docs.claude.com/en/api/skills-guide#creating-a-skill) for more.

# Creating a Basic Skill

Skills are simple to create - just a folder with a `SKILL.md` file containing YAML frontmatter and instructions. You can use the **template-skill** in this repository as a starting point:

```markdown
---
name: my-skill-name
description: A clear description of what this skill does and when to use it
---

# My Skill Name

[Add your instructions here that Claude will follow when this skill is active]

## Examples
- Example usage 1
- Example usage 2

## Guidelines
- Guideline 1
- Guideline 2
```

The frontmatter requires only two fields:
- `name` - A unique identifier for your skill (lowercase, hyphens for spaces)
- `description` - A complete description of what the skill does and when to use it

The markdown content below contains the instructions, examples, and guidelines that Claude will follow. For more details, see [How to create custom skills](https://support.claude.com/en/articles/12512198-creating-custom-skills).

# Partner Skills

Skills are a great way to teach Claude how to get better at using specific pieces of software. As we see awesome example skills from partners, we may highlight some of them here:

- **Notion** - [Notion Skills for Claude](https://www.notion.so/notiondevs/Notion-Skills-for-Claude-28da4445d27180c7af1df7d8615723d0)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/readme/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/anthropics/skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <span class="badge muted">License: LICENSE.txt</span>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rearrange Imported skill rearrange from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/scripts/rearrange.py Unknown LICENSE.txt sources/anthropic/rearrange/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rearrange</div>
                <button class="copy-btn" onclick="copyToClipboard('rearrange')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rearrange from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Rearrange PowerPoint slides based on a sequence of indices.

Usage:
    python rearrange.py template.pptx output.pptx 0,34,34,50,52

This will create output.pptx using slides from template.pptx in the specified order.
Slides can be repeated (e.g., 34 appears twice).
&quot;&quot;&quot;

import argparse
import shutil
import sys
from copy import deepcopy
from pathlib import Path

import six
from pptx import Presentation


def main():
    parser = argparse.ArgumentParser(
        description=&quot;Rearrange PowerPoint slides based on a sequence of indices.&quot;,
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog=&quot;&quot;&quot;
Examples:
  python rearrange.py template.pptx output.pptx 0,34,34,50,52
    Creates output.pptx using slides 0, 34 (twice), 50, and 52 from template.pptx

  python rearrange.py template.pptx output.pptx 5,3,1,2,4
    Creates output.pptx with slides reordered as specified

Note: Slide indices are 0-based (first slide is 0, second is 1, etc.)
        &quot;&quot;&quot;,
    )

    parser.add_argument(&quot;template&quot;, help=&quot;Path to template PPTX file&quot;)
    parser.add_argument(&quot;output&quot;, help=&quot;Path for output PPTX file&quot;)
    parser.add_argument(
        &quot;sequence&quot;, help=&quot;Comma-separated sequence of slide indices (0-based)&quot;
    )

    args = parser.parse_args()

    # Parse the slide sequence
    try:
        slide_sequence = [int(x.strip()) for x in args.sequence.split(&quot;,&quot;)]
    except ValueError:
        print(
            &quot;Error: Invalid sequence format. Use comma-separated integers (e.g., 0,34,34,50,52)&quot;
        )
        sys.exit(1)

    # Check template exists
    template_path = Path(args.template)
    if not template_path.exists():
        print(f&quot;Error: Template file not found: {args.template}&quot;)
        sys.exit(1)

    # Create output directory if needed
    output_path = Path(args.output)
    output_path.parent.mkdir(parents=True, exist_ok=True)

    try:
        rearrange_presentation(template_path, output_path, slide_sequence)
    except ValueError as e:
        print(f&quot;Error: {e}&quot;)
        sys.exit(1)
    except Exception as e:
        print(f&quot;Error processing presentation: {e}&quot;)
        sys.exit(1)


def duplicate_slide(pres, index):
    &quot;&quot;&quot;Duplicate a slide in the presentation.&quot;&quot;&quot;
    source = pres.slides[index]

    # Use source&#x27;s layout to preserve formatting
    new_slide = pres.slides.add_slide(source.slide_layout)

    # Collect all image and media relationships from the source slide
    image_rels = {}
    for rel_id, rel in six.iteritems(source.part.rels):
        if &quot;image&quot; in rel.reltype or &quot;media&quot; in rel.reltype:
            image_rels[rel_id] = rel

    # CRITICAL: Clear placeholder shapes to avoid duplicates
    for shape in new_slide.shapes:
        sp = shape.element
        sp.getparent().remove(sp)

    # Copy all shapes from source
    for shape in source.shapes:
        el = shape.element
        new_el = deepcopy(el)
        new_slide.shapes._spTree.insert_element_before(new_el, &quot;p:extLst&quot;)

        # Handle picture shapes - need to update the blip reference
        # Look for all blip elements (they can be in pic or other contexts)
        # Using the element&#x27;s own xpath method without namespaces argument
        blips = new_el.xpath(&quot;.//a:blip[@r:embed]&quot;)
        for blip in blips:
            old_rId = blip.get(
                &quot;{http://schemas.openxmlformats.org/officeDocument/2006/relationships}embed&quot;
            )
            if old_rId in image_rels:
                # Create a new relationship in the destination slide for this image
                old_rel = image_rels[old_rId]
                # get_or_add returns the rId directly, or adds and returns new rId
                new_rId = new_slide.part.rels.get_or_add(
                    old_rel.reltype, old_rel._target
                )
                # Update the blip&#x27;s embed reference to use the new relationship ID
                blip.set(
                    &quot;{http://schemas.openxmlformats.org/officeDocument/2006/relationships}embed&quot;,
                    new_rId,
                )

    # Copy any additional image/media relationships that might be referenced elsewhere
    for rel_id, rel in image_rels.items():
        try:
            new_slide.part.rels.get_or_add(rel.reltype, rel._target)
        except Exception:
            pass  # Relationship might already exist

    return new_slide


def delete_slide(pres, index):
    &quot;&quot;&quot;Delete a slide from the presentation.&quot;&quot;&quot;
    rId = pres.slides._sldIdLst[index].rId
    pres.part.drop_rel(rId)
    del pres.slides._sldIdLst[index]


def reorder_slides(pres, slide_index, target_index):
    &quot;&quot;&quot;Move a slide from one position to another.&quot;&quot;&quot;
    slides = pres.slides._sldIdLst

    # Remove slide element from current position
    slide_element = slides[slide_index]
    slides.remove(slide_element)

    # Insert at target position
    slides.insert(target_index, slide_element)


def rearrange_presentation(template_path, output_path, slide_sequence):
    &quot;&quot;&quot;
    Create a new presentation with slides from template in specified order.

    Args:
        template_path: Path to template PPTX file
        output_path: Path for output PPTX file
        slide_sequence: List of slide indices (0-based) to include
    &quot;&quot;&quot;
    # Copy template to preserve dimensions and theme
    if template_path != output_path:
        shutil.copy2(template_path, output_path)
        prs = Presentation(output_path)
    else:
        prs = Presentation(template_path)

    total_slides = len(prs.slides)

    # Validate indices
    for idx in slide_sequence:
        if idx &lt; 0 or idx &gt;= total_slides:
            raise ValueError(f&quot;Slide index {idx} out of range (0-{total_slides - 1})&quot;)

    # Track original slides and their duplicates
    slide_map = []  # List of actual slide indices for final presentation
    duplicated = {}  # Track duplicates: original_idx -&gt; [duplicate_indices]

    # Step 1: DUPLICATE repeated slides
    print(f&quot;Processing {len(slide_sequence)} slides from template...&quot;)
    for i, template_idx in enumerate(slide_sequence):
        if template_idx in duplicated and duplicated[template_idx]:
            # Already duplicated this slide, use the duplicate
            slide_map.append(duplicated[template_idx].pop(0))
            print(f&quot;  [{i}] Using duplicate of slide {template_idx}&quot;)
        elif slide_sequence.count(template_idx) &gt; 1 and template_idx not in duplicated:
            # First occurrence of a repeated slide - create duplicates
            slide_map.append(template_idx)
            duplicates = []
            count = slide_sequence.count(template_idx) - 1
            print(
                f&quot;  [{i}] Using original slide {template_idx}, creating {count} duplicate(s)&quot;
            )
            for _ in range(count):
                duplicate_slide(prs, template_idx)
                duplicates.append(len(prs.slides) - 1)
            duplicated[template_idx] = duplicates
        else:
            # Unique slide or first occurrence already handled, use original
            slide_map.append(template_idx)
            print(f&quot;  [{i}] Using original slide {template_idx}&quot;)

    # Step 2: DELETE unwanted slides (work backwards)
    slides_to_keep = set(slide_map)
    print(f&quot;\nDeleting {len(prs.slides) - len(slides_to_keep)} unused slides...&quot;)
    for i in range(len(prs.slides) - 1, -1, -1):
        if i not in slides_to_keep:
            delete_slide(prs, i)
            # Update slide_map indices after deletion
            slide_map = [idx - 1 if idx &gt; i else idx for idx in slide_map]

    # Step 3: REORDER to final sequence
    print(f&quot;Reordering {len(slide_map)} slides to final sequence...&quot;)
    for target_pos in range(len(slide_map)):
        # Find which slide should be at target_pos
        current_pos = slide_map[target_pos]
        if current_pos != target_pos:
            reorder_slides(prs, current_pos, target_pos)
            # Update slide_map: the move shifts other slides
            for i in range(len(slide_map)):
                if slide_map[i] &gt; current_pos and slide_map[i] &lt;= target_pos:
                    slide_map[i] -= 1
                elif slide_map[i] &lt; current_pos and slide_map[i] &gt;= target_pos:
                    slide_map[i] += 1
            slide_map[target_pos] = target_pos

    # Save the presentation
    prs.save(output_path)
    print(f&quot;\nSaved rearranged presentation to: {output_path}&quot;)
    print(f&quot;Final presentation has {len(prs.slides)} slides&quot;)


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/rearrange/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/scripts/rearrange.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="recalc Imported skill recalc from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/xlsx/recalc.py Unknown LICENSE.txt sources/anthropic/recalc/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">recalc</div>
                <button class="copy-btn" onclick="copyToClipboard('recalc')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill recalc from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Excel Formula Recalculation Script
Recalculates all formulas in an Excel file using LibreOffice
&quot;&quot;&quot;

import json
import sys
import subprocess
import os
import platform
from pathlib import Path
from openpyxl import load_workbook


def setup_libreoffice_macro():
    &quot;&quot;&quot;Setup LibreOffice macro for recalculation if not already configured&quot;&quot;&quot;
    if platform.system() == &#x27;Darwin&#x27;:
        macro_dir = os.path.expanduser(&#x27;~/Library/Application Support/LibreOffice/4/user/basic/Standard&#x27;)
    else:
        macro_dir = os.path.expanduser(&#x27;~/.config/libreoffice/4/user/basic/Standard&#x27;)
    
    macro_file = os.path.join(macro_dir, &#x27;Module1.xba&#x27;)
    
    if os.path.exists(macro_file):
        with open(macro_file, &#x27;r&#x27;) as f:
            if &#x27;RecalculateAndSave&#x27; in f.read():
                return True
    
    if not os.path.exists(macro_dir):
        subprocess.run([&#x27;soffice&#x27;, &#x27;--headless&#x27;, &#x27;--terminate_after_init&#x27;], 
                      capture_output=True, timeout=10)
        os.makedirs(macro_dir, exist_ok=True)
    
    macro_content = &#x27;&#x27;&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE script:module PUBLIC &quot;-//OpenOffice.org//DTD OfficeDocument 1.0//EN&quot; &quot;module.dtd&quot;&gt;
&lt;script:module xmlns:script=&quot;http://openoffice.org/2000/script&quot; script:name=&quot;Module1&quot; script:language=&quot;StarBasic&quot;&gt;
    Sub RecalculateAndSave()
      ThisComponent.calculateAll()
      ThisComponent.store()
      ThisComponent.close(True)
    End Sub
&lt;/script:module&gt;&#x27;&#x27;&#x27;
    
    try:
        with open(macro_file, &#x27;w&#x27;) as f:
            f.write(macro_content)
        return True
    except Exception:
        return False


def recalc(filename, timeout=30):
    &quot;&quot;&quot;
    Recalculate formulas in Excel file and report any errors
    
    Args:
        filename: Path to Excel file
        timeout: Maximum time to wait for recalculation (seconds)
    
    Returns:
        dict with error locations and counts
    &quot;&quot;&quot;
    if not Path(filename).exists():
        return {&#x27;error&#x27;: f&#x27;File {filename} does not exist&#x27;}
    
    abs_path = str(Path(filename).absolute())
    
    if not setup_libreoffice_macro():
        return {&#x27;error&#x27;: &#x27;Failed to setup LibreOffice macro&#x27;}
    
    cmd = [
        &#x27;soffice&#x27;, &#x27;--headless&#x27;, &#x27;--norestore&#x27;,
        &#x27;vnd.sun.star.script:Standard.Module1.RecalculateAndSave?language=Basic&amp;location=application&#x27;,
        abs_path
    ]
    
    # Handle timeout command differences between Linux and macOS
    if platform.system() != &#x27;Windows&#x27;:
        timeout_cmd = &#x27;timeout&#x27; if platform.system() == &#x27;Linux&#x27; else None
        if platform.system() == &#x27;Darwin&#x27;:
            # Check if gtimeout is available on macOS
            try:
                subprocess.run([&#x27;gtimeout&#x27;, &#x27;--version&#x27;], capture_output=True, timeout=1, check=False)
                timeout_cmd = &#x27;gtimeout&#x27;
            except (FileNotFoundError, subprocess.TimeoutExpired):
                pass
        
        if timeout_cmd:
            cmd = [timeout_cmd, str(timeout)] + cmd
    
    result = subprocess.run(cmd, capture_output=True, text=True)
    
    if result.returncode != 0 and result.returncode != 124:  # 124 is timeout exit code
        error_msg = result.stderr or &#x27;Unknown error during recalculation&#x27;
        if &#x27;Module1&#x27; in error_msg or &#x27;RecalculateAndSave&#x27; not in error_msg:
            return {&#x27;error&#x27;: &#x27;LibreOffice macro not configured properly&#x27;}
        else:
            return {&#x27;error&#x27;: error_msg}
    
    # Check for Excel errors in the recalculated file - scan ALL cells
    try:
        wb = load_workbook(filename, data_only=True)
        
        excel_errors = [&#x27;#VALUE!&#x27;, &#x27;#DIV/0!&#x27;, &#x27;#REF!&#x27;, &#x27;#NAME?&#x27;, &#x27;#NULL!&#x27;, &#x27;#NUM!&#x27;, &#x27;#N/A&#x27;]
        error_details = {err: [] for err in excel_errors}
        total_errors = 0
        
        for sheet_name in wb.sheetnames:
            ws = wb[sheet_name]
            # Check ALL rows and columns - no limits
            for row in ws.iter_rows():
                for cell in row:
                    if cell.value is not None and isinstance(cell.value, str):
                        for err in excel_errors:
                            if err in cell.value:
                                location = f&quot;{sheet_name}!{cell.coordinate}&quot;
                                error_details[err].append(location)
                                total_errors += 1
                                break
        
        wb.close()
        
        # Build result summary
        result = {
            &#x27;status&#x27;: &#x27;success&#x27; if total_errors == 0 else &#x27;errors_found&#x27;,
            &#x27;total_errors&#x27;: total_errors,
            &#x27;error_summary&#x27;: {}
        }
        
        # Add non-empty error categories
        for err_type, locations in error_details.items():
            if locations:
                result[&#x27;error_summary&#x27;][err_type] = {
                    &#x27;count&#x27;: len(locations),
                    &#x27;locations&#x27;: locations[:20]  # Show up to 20 locations
                }
        
        # Add formula count for context - also check ALL cells
        wb_formulas = load_workbook(filename, data_only=False)
        formula_count = 0
        for sheet_name in wb_formulas.sheetnames:
            ws = wb_formulas[sheet_name]
            for row in ws.iter_rows():
                for cell in row:
                    if cell.value and isinstance(cell.value, str) and cell.value.startswith(&#x27;=&#x27;):
                        formula_count += 1
        wb_formulas.close()
        
        result[&#x27;total_formulas&#x27;] = formula_count
        
        return result
        
    except Exception as e:
        return {&#x27;error&#x27;: str(e)}


def main():
    if len(sys.argv) &lt; 2:
        print(&quot;Usage: python recalc.py &lt;excel_file&gt; [timeout_seconds]&quot;)
        print(&quot;\nRecalculates all formulas in an Excel file using LibreOffice&quot;)
        print(&quot;\nReturns JSON with error details:&quot;)
        print(&quot;  - status: &#x27;success&#x27; or &#x27;errors_found&#x27;&quot;)
        print(&quot;  - total_errors: Total number of Excel errors found&quot;)
        print(&quot;  - total_formulas: Number of formulas in the file&quot;)
        print(&quot;  - error_summary: Breakdown by error type with locations&quot;)
        print(&quot;    - #VALUE!, #DIV/0!, #REF!, #NAME?, #NULL!, #NUM!, #N/A&quot;)
        sys.exit(1)
    
    filename = sys.argv[1]
    timeout = int(sys.argv[2]) if len(sys.argv) &gt; 2 else 30
    
    result = recalc(filename, timeout)
    print(json.dumps(result, indent=2))


if __name__ == &#x27;__main__&#x27;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/recalc/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/xlsx/recalc.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/xlsx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="redhatmono_ofl Imported skill redhatmono_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/RedHatMono-OFL.txt Unknown LICENSE.txt sources/anthropic/redhatmono_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">redhatmono_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('redhatmono_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill redhatmono_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2024 The Red Hat Project Authors (https://github.com/RedHatOfficial/RedHatFont)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/redhatmono_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/RedHatMono-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="redlining Imported skill redlining from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/ooxml/scripts/validation/redlining.py Unknown LICENSE.txt sources/anthropic/redlining/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">redlining</div>
                <button class="copy-btn" onclick="copyToClipboard('redlining')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill redlining from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;
Validator for tracked changes in Word documents.
&quot;&quot;&quot;

import subprocess
import tempfile
import zipfile
from pathlib import Path


class RedliningValidator:
    &quot;&quot;&quot;Validator for tracked changes in Word documents.&quot;&quot;&quot;

    def __init__(self, unpacked_dir, original_docx, verbose=False):
        self.unpacked_dir = Path(unpacked_dir)
        self.original_docx = Path(original_docx)
        self.verbose = verbose
        self.namespaces = {
            &quot;w&quot;: &quot;http://schemas.openxmlformats.org/wordprocessingml/2006/main&quot;
        }

    def validate(self):
        &quot;&quot;&quot;Main validation method that returns True if valid, False otherwise.&quot;&quot;&quot;
        # Verify unpacked directory exists and has correct structure
        modified_file = self.unpacked_dir / &quot;word&quot; / &quot;document.xml&quot;
        if not modified_file.exists():
            print(f&quot;FAILED - Modified document.xml not found at {modified_file}&quot;)
            return False

        # First, check if there are any tracked changes by Claude to validate
        try:
            import xml.etree.ElementTree as ET

            tree = ET.parse(modified_file)
            root = tree.getroot()

            # Check for w:del or w:ins tags authored by Claude
            del_elements = root.findall(&quot;.//w:del&quot;, self.namespaces)
            ins_elements = root.findall(&quot;.//w:ins&quot;, self.namespaces)

            # Filter to only include changes by Claude
            claude_del_elements = [
                elem
                for elem in del_elements
                if elem.get(f&quot;{{{self.namespaces[&#x27;w&#x27;]}}}author&quot;) == &quot;Claude&quot;
            ]
            claude_ins_elements = [
                elem
                for elem in ins_elements
                if elem.get(f&quot;{{{self.namespaces[&#x27;w&#x27;]}}}author&quot;) == &quot;Claude&quot;
            ]

            # Redlining validation is only needed if tracked changes by Claude have been used.
            if not claude_del_elements and not claude_ins_elements:
                if self.verbose:
                    print(&quot;PASSED - No tracked changes by Claude found.&quot;)
                return True

        except Exception:
            # If we can&#x27;t parse the XML, continue with full validation
            pass

        # Create temporary directory for unpacking original docx
        with tempfile.TemporaryDirectory() as temp_dir:
            temp_path = Path(temp_dir)

            # Unpack original docx
            try:
                with zipfile.ZipFile(self.original_docx, &quot;r&quot;) as zip_ref:
                    zip_ref.extractall(temp_path)
            except Exception as e:
                print(f&quot;FAILED - Error unpacking original docx: {e}&quot;)
                return False

            original_file = temp_path / &quot;word&quot; / &quot;document.xml&quot;
            if not original_file.exists():
                print(
                    f&quot;FAILED - Original document.xml not found in {self.original_docx}&quot;
                )
                return False

            # Parse both XML files using xml.etree.ElementTree for redlining validation
            try:
                import xml.etree.ElementTree as ET

                modified_tree = ET.parse(modified_file)
                modified_root = modified_tree.getroot()
                original_tree = ET.parse(original_file)
                original_root = original_tree.getroot()
            except ET.ParseError as e:
                print(f&quot;FAILED - Error parsing XML files: {e}&quot;)
                return False

            # Remove Claude&#x27;s tracked changes from both documents
            self._remove_claude_tracked_changes(original_root)
            self._remove_claude_tracked_changes(modified_root)

            # Extract and compare text content
            modified_text = self._extract_text_content(modified_root)
            original_text = self._extract_text_content(original_root)

            if modified_text != original_text:
                # Show detailed character-level differences for each paragraph
                error_message = self._generate_detailed_diff(
                    original_text, modified_text
                )
                print(error_message)
                return False

            if self.verbose:
                print(&quot;PASSED - All changes by Claude are properly tracked&quot;)
            return True

    def _generate_detailed_diff(self, original_text, modified_text):
        &quot;&quot;&quot;Generate detailed word-level differences using git word diff.&quot;&quot;&quot;
        error_parts = [
            &quot;FAILED - Document text doesn&#x27;t match after removing Claude&#x27;s tracked changes&quot;,
            &quot;&quot;,
            &quot;Likely causes:&quot;,
            &quot;  1. Modified text inside another author&#x27;s &lt;w:ins&gt; or &lt;w:del&gt; tags&quot;,
            &quot;  2. Made edits without proper tracked changes&quot;,
            &quot;  3. Didn&#x27;t nest &lt;w:del&gt; inside &lt;w:ins&gt; when deleting another&#x27;s insertion&quot;,
            &quot;&quot;,
            &quot;For pre-redlined documents, use correct patterns:&quot;,
            &quot;  - To reject another&#x27;s INSERTION: Nest &lt;w:del&gt; inside their &lt;w:ins&gt;&quot;,
            &quot;  - To restore another&#x27;s DELETION: Add new &lt;w:ins&gt; AFTER their &lt;w:del&gt;&quot;,
            &quot;&quot;,
        ]

        # Show git word diff
        git_diff = self._get_git_word_diff(original_text, modified_text)
        if git_diff:
            error_parts.extend([&quot;Differences:&quot;, &quot;============&quot;, git_diff])
        else:
            error_parts.append(&quot;Unable to generate word diff (git not available)&quot;)

        return &quot;\n&quot;.join(error_parts)

    def _get_git_word_diff(self, original_text, modified_text):
        &quot;&quot;&quot;Generate word diff using git with character-level precision.&quot;&quot;&quot;
        try:
            with tempfile.TemporaryDirectory() as temp_dir:
                temp_path = Path(temp_dir)

                # Create two files
                original_file = temp_path / &quot;original.txt&quot;
                modified_file = temp_path / &quot;modified.txt&quot;

                original_file.write_text(original_text, encoding=&quot;utf-8&quot;)
                modified_file.write_text(modified_text, encoding=&quot;utf-8&quot;)

                # Try character-level diff first for precise differences
                result = subprocess.run(
                    [
                        &quot;git&quot;,
                        &quot;diff&quot;,
                        &quot;--word-diff=plain&quot;,
                        &quot;--word-diff-regex=.&quot;,  # Character-by-character diff
                        &quot;-U0&quot;,  # Zero lines of context - show only changed lines
                        &quot;--no-index&quot;,
                        str(original_file),
                        str(modified_file),
                    ],
                    capture_output=True,
                    text=True,
                )

                if result.stdout.strip():
                    # Clean up the output - remove git diff header lines
                    lines = result.stdout.split(&quot;\n&quot;)
                    # Skip the header lines (diff --git, index, +++, ---, @@)
                    content_lines = []
                    in_content = False
                    for line in lines:
                        if line.startswith(&quot;@@&quot;):
                            in_content = True
                            continue
                        if in_content and line.strip():
                            content_lines.append(line)

                    if content_lines:
                        return &quot;\n&quot;.join(content_lines)

                # Fallback to word-level diff if character-level is too verbose
                result = subprocess.run(
                    [
                        &quot;git&quot;,
                        &quot;diff&quot;,
                        &quot;--word-diff=plain&quot;,
                        &quot;-U0&quot;,  # Zero lines of context
                        &quot;--no-index&quot;,
                        str(original_file),
                        str(modified_file),
                    ],
                    capture_output=True,
                    text=True,
                )

                if result.stdout.strip():
                    lines = result.stdout.split(&quot;\n&quot;)
                    content_lines = []
                    in_content = False
                    for line in lines:
                        if line.startswith(&quot;@@&quot;):
                            in_content = True
                            continue
                        if in_content and line.strip():
                            content_lines.append(line)
                    return &quot;\n&quot;.join(content_lines)

        except (subprocess.CalledProcessError, FileNotFoundError, Exception):
            # Git not available or other error, return None to use fallback
            pass

        return None

    def _remove_claude_tracked_changes(self, root):
        &quot;&quot;&quot;Remove tracked changes authored by Claude from the XML root.&quot;&quot;&quot;
        ins_tag = f&quot;{{{self.namespaces[&#x27;w&#x27;]}}}ins&quot;
        del_tag = f&quot;{{{self.namespaces[&#x27;w&#x27;]}}}del&quot;
        author_attr = f&quot;{{{self.namespaces[&#x27;w&#x27;]}}}author&quot;

        # Remove w:ins elements
        for parent in root.iter():
            to_remove = []
            for child in parent:
                if child.tag == ins_tag and child.get(author_attr) == &quot;Claude&quot;:
                    to_remove.append(child)
            for elem in to_remove:
                parent.remove(elem)

        # Unwrap content in w:del elements where author is &quot;Claude&quot;
        deltext_tag = f&quot;{{{self.namespaces[&#x27;w&#x27;]}}}delText&quot;
        t_tag = f&quot;{{{self.namespaces[&#x27;w&#x27;]}}}t&quot;

        for parent in root.iter():
            to_process = []
            for child in parent:
                if child.tag == del_tag and child.get(author_attr) == &quot;Claude&quot;:
                    to_process.append((child, list(parent).index(child)))

            # Process in reverse order to maintain indices
            for del_elem, del_index in reversed(to_process):
                # Convert w:delText to w:t before moving
                for elem in del_elem.iter():
                    if elem.tag == deltext_tag:
                        elem.tag = t_tag

                # Move all children of w:del to its parent before removing w:del
                for child in reversed(list(del_elem)):
                    parent.insert(del_index, child)
                parent.remove(del_elem)

    def _extract_text_content(self, root):
        &quot;&quot;&quot;Extract text content from Word XML, preserving paragraph structure.

        Empty paragraphs are skipped to avoid false positives when tracked
        insertions add only structural elements without text content.
        &quot;&quot;&quot;
        p_tag = f&quot;{{{self.namespaces[&#x27;w&#x27;]}}}p&quot;
        t_tag = f&quot;{{{self.namespaces[&#x27;w&#x27;]}}}t&quot;

        paragraphs = []
        for p_elem in root.findall(f&quot;.//{p_tag}&quot;):
            # Get all text elements within this paragraph
            text_parts = []
            for t_elem in p_elem.findall(f&quot;.//{t_tag}&quot;):
                if t_elem.text:
                    text_parts.append(t_elem.text)
            paragraph_text = &quot;&quot;.join(text_parts)
            # Skip empty paragraphs - they don&#x27;t affect content validation
            if paragraph_text:
                paragraphs.append(paragraph_text)

        return &quot;\n&quot;.join(paragraphs)


if __name__ == &quot;__main__&quot;:
    raise RuntimeError(&quot;This module should not be run directly.&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/redlining/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/ooxml/scripts/validation/redlining.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="reference Imported skill reference from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pdf/reference.md Unknown LICENSE.txt sources/anthropic/reference/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">reference</div>
                <button class="copy-btn" onclick="copyToClipboard('reference')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill reference from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># PDF Processing Advanced Reference

This document contains advanced PDF processing features, detailed examples, and additional libraries not covered in the main skill instructions.

## pypdfium2 Library (Apache/BSD License)

### Overview
pypdfium2 is a Python binding for PDFium (Chromium&#x27;s PDF library). It&#x27;s excellent for fast PDF rendering, image generation, and serves as a PyMuPDF replacement.

### Render PDF to Images
```python
import pypdfium2 as pdfium
from PIL import Image

# Load PDF
pdf = pdfium.PdfDocument(&quot;document.pdf&quot;)

# Render page to image
page = pdf[0]  # First page
bitmap = page.render(
    scale=2.0,  # Higher resolution
    rotation=0  # No rotation
)

# Convert to PIL Image
img = bitmap.to_pil()
img.save(&quot;page_1.png&quot;, &quot;PNG&quot;)

# Process multiple pages
for i, page in enumerate(pdf):
    bitmap = page.render(scale=1.5)
    img = bitmap.to_pil()
    img.save(f&quot;page_{i+1}.jpg&quot;, &quot;JPEG&quot;, quality=90)
```

### Extract Text with pypdfium2
```python
import pypdfium2 as pdfium

pdf = pdfium.PdfDocument(&quot;document.pdf&quot;)
for i, page in enumerate(pdf):
    text = page.get_text()
    print(f&quot;Page {i+1} text length: {len(text)} chars&quot;)
```

## JavaScript Libraries

### pdf-lib (MIT License)

pdf-lib is a powerful JavaScript library for creating and modifying PDF documents in any JavaScript environment.

#### Load and Manipulate Existing PDF
```javascript
import { PDFDocument } from &#x27;pdf-lib&#x27;;
import fs from &#x27;fs&#x27;;

async function manipulatePDF() {
    // Load existing PDF
    const existingPdfBytes = fs.readFileSync(&#x27;input.pdf&#x27;);
    const pdfDoc = await PDFDocument.load(existingPdfBytes);

    // Get page count
    const pageCount = pdfDoc.getPageCount();
    console.log(`Document has ${pageCount} pages`);

    // Add new page
    const newPage = pdfDoc.addPage([600, 400]);
    newPage.drawText(&#x27;Added by pdf-lib&#x27;, {
        x: 100,
        y: 300,
        size: 16
    });

    // Save modified PDF
    const pdfBytes = await pdfDoc.save();
    fs.writeFileSync(&#x27;modified.pdf&#x27;, pdfBytes);
}
```

#### Create Complex PDFs from Scratch
```javascript
import { PDFDocument, rgb, StandardFonts } from &#x27;pdf-lib&#x27;;
import fs from &#x27;fs&#x27;;

async function createPDF() {
    const pdfDoc = await PDFDocument.create();

    // Add fonts
    const helveticaFont = await pdfDoc.embedFont(StandardFonts.Helvetica);
    const helveticaBold = await pdfDoc.embedFont(StandardFonts.HelveticaBold);

    // Add page
    const page = pdfDoc.addPage([595, 842]); // A4 size
    const { width, height } = page.getSize();

    // Add text with styling
    page.drawText(&#x27;Invoice #12345&#x27;, {
        x: 50,
        y: height - 50,
        size: 18,
        font: helveticaBold,
        color: rgb(0.2, 0.2, 0.8)
    });

    // Add rectangle (header background)
    page.drawRectangle({
        x: 40,
        y: height - 100,
        width: width - 80,
        height: 30,
        color: rgb(0.9, 0.9, 0.9)
    });

    // Add table-like content
    const items = [
        [&#x27;Item&#x27;, &#x27;Qty&#x27;, &#x27;Price&#x27;, &#x27;Total&#x27;],
        [&#x27;Widget&#x27;, &#x27;2&#x27;, &#x27;$50&#x27;, &#x27;$100&#x27;],
        [&#x27;Gadget&#x27;, &#x27;1&#x27;, &#x27;$75&#x27;, &#x27;$75&#x27;]
    ];

    let yPos = height - 150;
    items.forEach(row =&gt; {
        let xPos = 50;
        row.forEach(cell =&gt; {
            page.drawText(cell, {
                x: xPos,
                y: yPos,
                size: 12,
                font: helveticaFont
            });
            xPos += 120;
        });
        yPos -= 25;
    });

    const pdfBytes = await pdfDoc.save();
    fs.writeFileSync(&#x27;created.pdf&#x27;, pdfBytes);
}
```

#### Advanced Merge and Split Operations
```javascript
import { PDFDocument } from &#x27;pdf-lib&#x27;;
import fs from &#x27;fs&#x27;;

async function mergePDFs() {
    // Create new document
    const mergedPdf = await PDFDocument.create();

    // Load source PDFs
    const pdf1Bytes = fs.readFileSync(&#x27;doc1.pdf&#x27;);
    const pdf2Bytes = fs.readFileSync(&#x27;doc2.pdf&#x27;);

    const pdf1 = await PDFDocument.load(pdf1Bytes);
    const pdf2 = await PDFDocument.load(pdf2Bytes);

    // Copy pages from first PDF
    const pdf1Pages = await mergedPdf.copyPages(pdf1, pdf1.getPageIndices());
    pdf1Pages.forEach(page =&gt; mergedPdf.addPage(page));

    // Copy specific pages from second PDF (pages 0, 2, 4)
    const pdf2Pages = await mergedPdf.copyPages(pdf2, [0, 2, 4]);
    pdf2Pages.forEach(page =&gt; mergedPdf.addPage(page));

    const mergedPdfBytes = await mergedPdf.save();
    fs.writeFileSync(&#x27;merged.pdf&#x27;, mergedPdfBytes);
}
```

### pdfjs-dist (Apache License)

PDF.js is Mozilla&#x27;s JavaScript library for rendering PDFs in the browser.

#### Basic PDF Loading and Rendering
```javascript
import * as pdfjsLib from &#x27;pdfjs-dist&#x27;;

// Configure worker (important for performance)
pdfjsLib.GlobalWorkerOptions.workerSrc = &#x27;./pdf.worker.js&#x27;;

async function renderPDF() {
    // Load PDF
    const loadingTask = pdfjsLib.getDocument(&#x27;document.pdf&#x27;);
    const pdf = await loadingTask.promise;

    console.log(`Loaded PDF with ${pdf.numPages} pages`);

    // Get first page
    const page = await pdf.getPage(1);
    const viewport = page.getViewport({ scale: 1.5 });

    // Render to canvas
    const canvas = document.createElement(&#x27;canvas&#x27;);
    const context = canvas.getContext(&#x27;2d&#x27;);
    canvas.height = viewport.height;
    canvas.width = viewport.width;

    const renderContext = {
        canvasContext: context,
        viewport: viewport
    };

    await page.render(renderContext).promise;
    document.body.appendChild(canvas);
}
```

#### Extract Text with Coordinates
```javascript
import * as pdfjsLib from &#x27;pdfjs-dist&#x27;;

async function extractText() {
    const loadingTask = pdfjsLib.getDocument(&#x27;document.pdf&#x27;);
    const pdf = await loadingTask.promise;

    let fullText = &#x27;&#x27;;

    // Extract text from all pages
    for (let i = 1; i &lt;= pdf.numPages; i++) {
        const page = await pdf.getPage(i);
        const textContent = await page.getTextContent();

        const pageText = textContent.items
            .map(item =&gt; item.str)
            .join(&#x27; &#x27;);

        fullText += `\n--- Page ${i} ---\n${pageText}`;

        // Get text with coordinates for advanced processing
        const textWithCoords = textContent.items.map(item =&gt; ({
            text: item.str,
            x: item.transform[4],
            y: item.transform[5],
            width: item.width,
            height: item.height
        }));
    }

    console.log(fullText);
    return fullText;
}
```

#### Extract Annotations and Forms
```javascript
import * as pdfjsLib from &#x27;pdfjs-dist&#x27;;

async function extractAnnotations() {
    const loadingTask = pdfjsLib.getDocument(&#x27;annotated.pdf&#x27;);
    const pdf = await loadingTask.promise;

    for (let i = 1; i &lt;= pdf.numPages; i++) {
        const page = await pdf.getPage(i);
        const annotations = await page.getAnnotations();

        annotations.forEach(annotation =&gt; {
            console.log(`Annotation type: ${annotation.subtype}`);
            console.log(`Content: ${annotation.contents}`);
            console.log(`Coordinates: ${JSON.stringify(annotation.rect)}`);
        });
    }
}
```

## Advanced Command-Line Operations

### poppler-utils Advanced Features

#### Extract Text with Bounding Box Coordinates
```bash
# Extract text with bounding box coordinates (essential for structured data)
pdftotext -bbox-layout document.pdf output.xml

# The XML output contains precise coordinates for each text element
```

#### Advanced Image Conversion
```bash
# Convert to PNG images with specific resolution
pdftoppm -png -r 300 document.pdf output_prefix

# Convert specific page range with high resolution
pdftoppm -png -r 600 -f 1 -l 3 document.pdf high_res_pages

# Convert to JPEG with quality setting
pdftoppm -jpeg -jpegopt quality=85 -r 200 document.pdf jpeg_output
```

#### Extract Embedded Images
```bash
# Extract all embedded images with metadata
pdfimages -j -p document.pdf page_images

# List image info without extracting
pdfimages -list document.pdf

# Extract images in their original format
pdfimages -all document.pdf images/img
```

### qpdf Advanced Features

#### Complex Page Manipulation
```bash
# Split PDF into groups of pages
qpdf --split-pages=3 input.pdf output_group_%02d.pdf

# Extract specific pages with complex ranges
qpdf input.pdf --pages input.pdf 1,3-5,8,10-end -- extracted.pdf

# Merge specific pages from multiple PDFs
qpdf --empty --pages doc1.pdf 1-3 doc2.pdf 5-7 doc3.pdf 2,4 -- combined.pdf
```

#### PDF Optimization and Repair
```bash
# Optimize PDF for web (linearize for streaming)
qpdf --linearize input.pdf optimized.pdf

# Remove unused objects and compress
qpdf --optimize-level=all input.pdf compressed.pdf

# Attempt to repair corrupted PDF structure
qpdf --check input.pdf
qpdf --fix-qdf damaged.pdf repaired.pdf

# Show detailed PDF structure for debugging
qpdf --show-all-pages input.pdf &gt; structure.txt
```

#### Advanced Encryption
```bash
# Add password protection with specific permissions
qpdf --encrypt user_pass owner_pass 256 --print=none --modify=none -- input.pdf encrypted.pdf

# Check encryption status
qpdf --show-encryption encrypted.pdf

# Remove password protection (requires password)
qpdf --password=secret123 --decrypt encrypted.pdf decrypted.pdf
```

## Advanced Python Techniques

### pdfplumber Advanced Features

#### Extract Text with Precise Coordinates
```python
import pdfplumber

with pdfplumber.open(&quot;document.pdf&quot;) as pdf:
    page = pdf.pages[0]
    
    # Extract all text with coordinates
    chars = page.chars
    for char in chars[:10]:  # First 10 characters
        print(f&quot;Char: &#x27;{char[&#x27;text&#x27;]}&#x27; at x:{char[&#x27;x0&#x27;]:.1f} y:{char[&#x27;y0&#x27;]:.1f}&quot;)
    
    # Extract text by bounding box (left, top, right, bottom)
    bbox_text = page.within_bbox((100, 100, 400, 200)).extract_text()
```

#### Advanced Table Extraction with Custom Settings
```python
import pdfplumber
import pandas as pd

with pdfplumber.open(&quot;complex_table.pdf&quot;) as pdf:
    page = pdf.pages[0]
    
    # Extract tables with custom settings for complex layouts
    table_settings = {
        &quot;vertical_strategy&quot;: &quot;lines&quot;,
        &quot;horizontal_strategy&quot;: &quot;lines&quot;,
        &quot;snap_tolerance&quot;: 3,
        &quot;intersection_tolerance&quot;: 15
    }
    tables = page.extract_tables(table_settings)
    
    # Visual debugging for table extraction
    img = page.to_image(resolution=150)
    img.save(&quot;debug_layout.png&quot;)
```

### reportlab Advanced Features

#### Create Professional Reports with Tables
```python
from reportlab.platypus import SimpleDocTemplate, Table, TableStyle, Paragraph
from reportlab.lib.styles import getSampleStyleSheet
from reportlab.lib import colors

# Sample data
data = [
    [&#x27;Product&#x27;, &#x27;Q1&#x27;, &#x27;Q2&#x27;, &#x27;Q3&#x27;, &#x27;Q4&#x27;],
    [&#x27;Widgets&#x27;, &#x27;120&#x27;, &#x27;135&#x27;, &#x27;142&#x27;, &#x27;158&#x27;],
    [&#x27;Gadgets&#x27;, &#x27;85&#x27;, &#x27;92&#x27;, &#x27;98&#x27;, &#x27;105&#x27;]
]

# Create PDF with table
doc = SimpleDocTemplate(&quot;report.pdf&quot;)
elements = []

# Add title
styles = getSampleStyleSheet()
title = Paragraph(&quot;Quarterly Sales Report&quot;, styles[&#x27;Title&#x27;])
elements.append(title)

# Add table with advanced styling
table = Table(data)
table.setStyle(TableStyle([
    (&#x27;BACKGROUND&#x27;, (0, 0), (-1, 0), colors.grey),
    (&#x27;TEXTCOLOR&#x27;, (0, 0), (-1, 0), colors.whitesmoke),
    (&#x27;ALIGN&#x27;, (0, 0), (-1, -1), &#x27;CENTER&#x27;),
    (&#x27;FONTNAME&#x27;, (0, 0), (-1, 0), &#x27;Helvetica-Bold&#x27;),
    (&#x27;FONTSIZE&#x27;, (0, 0), (-1, 0), 14),
    (&#x27;BOTTOMPADDING&#x27;, (0, 0), (-1, 0), 12),
    (&#x27;BACKGROUND&#x27;, (0, 1), (-1, -1), colors.beige),
    (&#x27;GRID&#x27;, (0, 0), (-1, -1), 1, colors.black)
]))
elements.append(table)

doc.build(elements)
```

## Complex Workflows

### Extract Figures/Images from PDF

#### Method 1: Using pdfimages (fastest)
```bash
# Extract all images with original quality
pdfimages -all document.pdf images/img
```

#### Method 2: Using pypdfium2 + Image Processing
```python
import pypdfium2 as pdfium
from PIL import Image
import numpy as np

def extract_figures(pdf_path, output_dir):
    pdf = pdfium.PdfDocument(pdf_path)
    
    for page_num, page in enumerate(pdf):
        # Render high-resolution page
        bitmap = page.render(scale=3.0)
        img = bitmap.to_pil()
        
        # Convert to numpy for processing
        img_array = np.array(img)
        
        # Simple figure detection (non-white regions)
        mask = np.any(img_array != [255, 255, 255], axis=2)
        
        # Find contours and extract bounding boxes
        # (This is simplified - real implementation would need more sophisticated detection)
        
        # Save detected figures
        # ... implementation depends on specific needs
```

### Batch PDF Processing with Error Handling
```python
import os
import glob
from pypdf import PdfReader, PdfWriter
import logging

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

def batch_process_pdfs(input_dir, operation=&#x27;merge&#x27;):
    pdf_files = glob.glob(os.path.join(input_dir, &quot;*.pdf&quot;))
    
    if operation == &#x27;merge&#x27;:
        writer = PdfWriter()
        for pdf_file in pdf_files:
            try:
                reader = PdfReader(pdf_file)
                for page in reader.pages:
                    writer.add_page(page)
                logger.info(f&quot;Processed: {pdf_file}&quot;)
            except Exception as e:
                logger.error(f&quot;Failed to process {pdf_file}: {e}&quot;)
                continue
        
        with open(&quot;batch_merged.pdf&quot;, &quot;wb&quot;) as output:
            writer.write(output)
    
    elif operation == &#x27;extract_text&#x27;:
        for pdf_file in pdf_files:
            try:
                reader = PdfReader(pdf_file)
                text = &quot;&quot;
                for page in reader.pages:
                    text += page.extract_text()
                
                output_file = pdf_file.replace(&#x27;.pdf&#x27;, &#x27;.txt&#x27;)
                with open(output_file, &#x27;w&#x27;, encoding=&#x27;utf-8&#x27;) as f:
                    f.write(text)
                logger.info(f&quot;Extracted text from: {pdf_file}&quot;)
                
            except Exception as e:
                logger.error(f&quot;Failed to extract text from {pdf_file}: {e}&quot;)
                continue
```

### Advanced PDF Cropping
```python
from pypdf import PdfWriter, PdfReader

reader = PdfReader(&quot;input.pdf&quot;)
writer = PdfWriter()

# Crop page (left, bottom, right, top in points)
page = reader.pages[0]
page.mediabox.left = 50
page.mediabox.bottom = 50
page.mediabox.right = 550
page.mediabox.top = 750

writer.add_page(page)
with open(&quot;cropped.pdf&quot;, &quot;wb&quot;) as output:
    writer.write(output)
```

## Performance Optimization Tips

### 1. For Large PDFs
- Use streaming approaches instead of loading entire PDF in memory
- Use `qpdf --split-pages` for splitting large files
- Process pages individually with pypdfium2

### 2. For Text Extraction
- `pdftotext -bbox-layout` is fastest for plain text extraction
- Use pdfplumber for structured data and tables
- Avoid `pypdf.extract_text()` for very large documents

### 3. For Image Extraction
- `pdfimages` is much faster than rendering pages
- Use low resolution for previews, high resolution for final output

### 4. For Form Filling
- pdf-lib maintains form structure better than most alternatives
- Pre-validate form fields before processing

### 5. Memory Management
```python
# Process PDFs in chunks
def process_large_pdf(pdf_path, chunk_size=10):
    reader = PdfReader(pdf_path)
    total_pages = len(reader.pages)
    
    for start_idx in range(0, total_pages, chunk_size):
        end_idx = min(start_idx + chunk_size, total_pages)
        writer = PdfWriter()
        
        for i in range(start_idx, end_idx):
            writer.add_page(reader.pages[i])
        
        # Process chunk
        with open(f&quot;chunk_{start_idx//chunk_size}.pdf&quot;, &quot;wb&quot;) as output:
            writer.write(output)
```

## Troubleshooting Common Issues

### Encrypted PDFs
```python
# Handle password-protected PDFs
from pypdf import PdfReader

try:
    reader = PdfReader(&quot;encrypted.pdf&quot;)
    if reader.is_encrypted:
        reader.decrypt(&quot;password&quot;)
except Exception as e:
    print(f&quot;Failed to decrypt: {e}&quot;)
```

### Corrupted PDFs
```bash
# Use qpdf to repair
qpdf --check corrupted.pdf
qpdf --replace-input corrupted.pdf
```

### Text Extraction Issues
```python
# Fallback to OCR for scanned PDFs
import pytesseract
from pdf2image import convert_from_path

def extract_text_with_ocr(pdf_path):
    images = convert_from_path(pdf_path)
    text = &quot;&quot;
    for i, image in enumerate(images):
        text += pytesseract.image_to_string(image)
    return text
```

## License Information

- **pypdf**: BSD License
- **pdfplumber**: MIT License
- **pypdfium2**: Apache/BSD License
- **reportlab**: BSD License
- **poppler-utils**: GPL-2 License
- **qpdf**: Apache License
- **pdf-lib**: MIT License
- **pdfjs-dist**: Apache License</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/reference/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/reference.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pdf/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="replace Imported skill replace from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/scripts/replace.py Unknown LICENSE.txt sources/anthropic/replace/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">replace</div>
                <button class="copy-btn" onclick="copyToClipboard('replace')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill replace from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;Apply text replacements to PowerPoint presentation.

Usage:
    python replace.py &lt;input.pptx&gt; &lt;replacements.json&gt; &lt;output.pptx&gt;

The replacements JSON should have the structure output by inventory.py.
ALL text shapes identified by inventory.py will have their text cleared
unless &quot;paragraphs&quot; is specified in the replacements for that shape.
&quot;&quot;&quot;

import json
import sys
from pathlib import Path
from typing import Any, Dict, List

from inventory import InventoryData, extract_text_inventory
from pptx import Presentation
from pptx.dml.color import RGBColor
from pptx.enum.dml import MSO_THEME_COLOR
from pptx.enum.text import PP_ALIGN
from pptx.oxml.xmlchemy import OxmlElement
from pptx.util import Pt


def clear_paragraph_bullets(paragraph):
    &quot;&quot;&quot;Clear bullet formatting from a paragraph.&quot;&quot;&quot;
    pPr = paragraph._element.get_or_add_pPr()

    # Remove existing bullet elements
    for child in list(pPr):
        if (
            child.tag.endswith(&quot;buChar&quot;)
            or child.tag.endswith(&quot;buNone&quot;)
            or child.tag.endswith(&quot;buAutoNum&quot;)
            or child.tag.endswith(&quot;buFont&quot;)
        ):
            pPr.remove(child)

    return pPr


def apply_paragraph_properties(paragraph, para_data: Dict[str, Any]):
    &quot;&quot;&quot;Apply formatting properties to a paragraph.&quot;&quot;&quot;
    # Get the text but don&#x27;t set it on paragraph directly yet
    text = para_data.get(&quot;text&quot;, &quot;&quot;)

    # Get or create paragraph properties
    pPr = clear_paragraph_bullets(paragraph)

    # Handle bullet formatting
    if para_data.get(&quot;bullet&quot;, False):
        level = para_data.get(&quot;level&quot;, 0)
        paragraph.level = level

        # Calculate font-proportional indentation
        font_size = para_data.get(&quot;font_size&quot;, 18.0)
        level_indent_emu = int((font_size * (1.6 + level * 1.6)) * 12700)
        hanging_indent_emu = int(-font_size * 0.8 * 12700)

        # Set indentation
        pPr.attrib[&quot;marL&quot;] = str(level_indent_emu)
        pPr.attrib[&quot;indent&quot;] = str(hanging_indent_emu)

        # Add bullet character
        buChar = OxmlElement(&quot;a:buChar&quot;)
        buChar.set(&quot;char&quot;, &quot;&quot;)
        pPr.append(buChar)

        # Default to left alignment for bullets if not specified
        if &quot;alignment&quot; not in para_data:
            paragraph.alignment = PP_ALIGN.LEFT
    else:
        # Remove indentation for non-bullet text
        pPr.attrib[&quot;marL&quot;] = &quot;0&quot;
        pPr.attrib[&quot;indent&quot;] = &quot;0&quot;

        # Add buNone element
        buNone = OxmlElement(&quot;a:buNone&quot;)
        pPr.insert(0, buNone)

    # Apply alignment
    if &quot;alignment&quot; in para_data:
        alignment_map = {
            &quot;LEFT&quot;: PP_ALIGN.LEFT,
            &quot;CENTER&quot;: PP_ALIGN.CENTER,
            &quot;RIGHT&quot;: PP_ALIGN.RIGHT,
            &quot;JUSTIFY&quot;: PP_ALIGN.JUSTIFY,
        }
        if para_data[&quot;alignment&quot;] in alignment_map:
            paragraph.alignment = alignment_map[para_data[&quot;alignment&quot;]]

    # Apply spacing
    if &quot;space_before&quot; in para_data:
        paragraph.space_before = Pt(para_data[&quot;space_before&quot;])
    if &quot;space_after&quot; in para_data:
        paragraph.space_after = Pt(para_data[&quot;space_after&quot;])
    if &quot;line_spacing&quot; in para_data:
        paragraph.line_spacing = Pt(para_data[&quot;line_spacing&quot;])

    # Apply run-level formatting
    if not paragraph.runs:
        run = paragraph.add_run()
        run.text = text
    else:
        run = paragraph.runs[0]
        run.text = text

    # Apply font properties
    apply_font_properties(run, para_data)


def apply_font_properties(run, para_data: Dict[str, Any]):
    &quot;&quot;&quot;Apply font properties to a text run.&quot;&quot;&quot;
    if &quot;bold&quot; in para_data:
        run.font.bold = para_data[&quot;bold&quot;]
    if &quot;italic&quot; in para_data:
        run.font.italic = para_data[&quot;italic&quot;]
    if &quot;underline&quot; in para_data:
        run.font.underline = para_data[&quot;underline&quot;]
    if &quot;font_size&quot; in para_data:
        run.font.size = Pt(para_data[&quot;font_size&quot;])
    if &quot;font_name&quot; in para_data:
        run.font.name = para_data[&quot;font_name&quot;]

    # Apply color - prefer RGB, fall back to theme_color
    if &quot;color&quot; in para_data:
        color_hex = para_data[&quot;color&quot;].lstrip(&quot;#&quot;)
        if len(color_hex) == 6:
            r = int(color_hex[0:2], 16)
            g = int(color_hex[2:4], 16)
            b = int(color_hex[4:6], 16)
            run.font.color.rgb = RGBColor(r, g, b)
    elif &quot;theme_color&quot; in para_data:
        # Get theme color by name (e.g., &quot;DARK_1&quot;, &quot;ACCENT_1&quot;)
        theme_name = para_data[&quot;theme_color&quot;]
        try:
            run.font.color.theme_color = getattr(MSO_THEME_COLOR, theme_name)
        except AttributeError:
            print(f&quot;  WARNING: Unknown theme color name &#x27;{theme_name}&#x27;&quot;)


def detect_frame_overflow(inventory: InventoryData) -&gt; Dict[str, Dict[str, float]]:
    &quot;&quot;&quot;Detect text overflow in shapes (text exceeding shape bounds).

    Returns dict of slide_key -&gt; shape_key -&gt; overflow_inches.
    Only includes shapes that have text overflow.
    &quot;&quot;&quot;
    overflow_map = {}

    for slide_key, shapes_dict in inventory.items():
        for shape_key, shape_data in shapes_dict.items():
            # Check for frame overflow (text exceeding shape bounds)
            if shape_data.frame_overflow_bottom is not None:
                if slide_key not in overflow_map:
                    overflow_map[slide_key] = {}
                overflow_map[slide_key][shape_key] = shape_data.frame_overflow_bottom

    return overflow_map


def validate_replacements(inventory: InventoryData, replacements: Dict) -&gt; List[str]:
    &quot;&quot;&quot;Validate that all shapes in replacements exist in inventory.

    Returns list of error messages.
    &quot;&quot;&quot;
    errors = []

    for slide_key, shapes_data in replacements.items():
        if not slide_key.startswith(&quot;slide-&quot;):
            continue

        # Check if slide exists
        if slide_key not in inventory:
            errors.append(f&quot;Slide &#x27;{slide_key}&#x27; not found in inventory&quot;)
            continue

        # Check each shape
        for shape_key in shapes_data.keys():
            if shape_key not in inventory[slide_key]:
                # Find shapes without replacements defined and show their content
                unused_with_content = []
                for k in inventory[slide_key].keys():
                    if k not in shapes_data:
                        shape_data = inventory[slide_key][k]
                        # Get text from paragraphs as preview
                        paragraphs = shape_data.paragraphs
                        if paragraphs and paragraphs[0].text:
                            first_text = paragraphs[0].text[:50]
                            if len(paragraphs[0].text) &gt; 50:
                                first_text += &quot;...&quot;
                            unused_with_content.append(f&quot;{k} (&#x27;{first_text}&#x27;)&quot;)
                        else:
                            unused_with_content.append(k)

                errors.append(
                    f&quot;Shape &#x27;{shape_key}&#x27; not found on &#x27;{slide_key}&#x27;. &quot;
                    f&quot;Shapes without replacements: {&#x27;, &#x27;.join(sorted(unused_with_content)) if unused_with_content else &#x27;none&#x27;}&quot;
                )

    return errors


def check_duplicate_keys(pairs):
    &quot;&quot;&quot;Check for duplicate keys when loading JSON.&quot;&quot;&quot;
    result = {}
    for key, value in pairs:
        if key in result:
            raise ValueError(f&quot;Duplicate key found in JSON: &#x27;{key}&#x27;&quot;)
        result[key] = value
    return result


def apply_replacements(pptx_file: str, json_file: str, output_file: str):
    &quot;&quot;&quot;Apply text replacements from JSON to PowerPoint presentation.&quot;&quot;&quot;

    # Load presentation
    prs = Presentation(pptx_file)

    # Get inventory of all text shapes (returns ShapeData objects)
    # Pass prs to use same Presentation instance
    inventory = extract_text_inventory(Path(pptx_file), prs)

    # Detect text overflow in original presentation
    original_overflow = detect_frame_overflow(inventory)

    # Load replacement data with duplicate key detection
    with open(json_file, &quot;r&quot;) as f:
        replacements = json.load(f, object_pairs_hook=check_duplicate_keys)

    # Validate replacements
    errors = validate_replacements(inventory, replacements)
    if errors:
        print(&quot;ERROR: Invalid shapes in replacement JSON:&quot;)
        for error in errors:
            print(f&quot;  - {error}&quot;)
        print(&quot;\nPlease check the inventory and update your replacement JSON.&quot;)
        print(
            &quot;You can regenerate the inventory with: python inventory.py &lt;input.pptx&gt; &lt;output.json&gt;&quot;
        )
        raise ValueError(f&quot;Found {len(errors)} validation error(s)&quot;)

    # Track statistics
    shapes_processed = 0
    shapes_cleared = 0
    shapes_replaced = 0

    # Process each slide from inventory
    for slide_key, shapes_dict in inventory.items():
        if not slide_key.startswith(&quot;slide-&quot;):
            continue

        slide_index = int(slide_key.split(&quot;-&quot;)[1])

        if slide_index &gt;= len(prs.slides):
            print(f&quot;Warning: Slide {slide_index} not found&quot;)
            continue

        # Process each shape from inventory
        for shape_key, shape_data in shapes_dict.items():
            shapes_processed += 1

            # Get the shape directly from ShapeData
            shape = shape_data.shape
            if not shape:
                print(f&quot;Warning: {shape_key} has no shape reference&quot;)
                continue

            # ShapeData already validates text_frame in __init__
            text_frame = shape.text_frame  # type: ignore

            text_frame.clear()  # type: ignore
            shapes_cleared += 1

            # Check for replacement paragraphs
            replacement_shape_data = replacements.get(slide_key, {}).get(shape_key, {})
            if &quot;paragraphs&quot; not in replacement_shape_data:
                continue

            shapes_replaced += 1

            # Add replacement paragraphs
            for i, para_data in enumerate(replacement_shape_data[&quot;paragraphs&quot;]):
                if i == 0:
                    p = text_frame.paragraphs[0]  # type: ignore
                else:
                    p = text_frame.add_paragraph()  # type: ignore

                apply_paragraph_properties(p, para_data)

    # Check for issues after replacements
    # Save to a temporary file and reload to avoid modifying the presentation during inventory
    # (extract_text_inventory accesses font.color which adds empty &lt;a:solidFill/&gt; elements)
    import tempfile

    with tempfile.NamedTemporaryFile(suffix=&quot;.pptx&quot;, delete=False) as tmp:
        tmp_path = Path(tmp.name)
        prs.save(str(tmp_path))

    try:
        updated_inventory = extract_text_inventory(tmp_path)
        updated_overflow = detect_frame_overflow(updated_inventory)
    finally:
        tmp_path.unlink()  # Clean up temp file

    # Check if any text overflow got worse
    overflow_errors = []
    for slide_key, shape_overflows in updated_overflow.items():
        for shape_key, new_overflow in shape_overflows.items():
            # Get original overflow (0 if there was no overflow before)
            original = original_overflow.get(slide_key, {}).get(shape_key, 0.0)

            # Error if overflow increased
            if new_overflow &gt; original + 0.01:  # Small tolerance for rounding
                increase = new_overflow - original
                overflow_errors.append(
                    f&#x27;{slide_key}/{shape_key}: overflow worsened by {increase:.2f}&quot; &#x27;
                    f&#x27;(was {original:.2f}&quot;, now {new_overflow:.2f}&quot;)&#x27;
                )

    # Collect warnings from updated shapes
    warnings = []
    for slide_key, shapes_dict in updated_inventory.items():
        for shape_key, shape_data in shapes_dict.items():
            if shape_data.warnings:
                for warning in shape_data.warnings:
                    warnings.append(f&quot;{slide_key}/{shape_key}: {warning}&quot;)

    # Fail if there are any issues
    if overflow_errors or warnings:
        print(&quot;\nERROR: Issues detected in replacement output:&quot;)
        if overflow_errors:
            print(&quot;\nText overflow worsened:&quot;)
            for error in overflow_errors:
                print(f&quot;  - {error}&quot;)
        if warnings:
            print(&quot;\nFormatting warnings:&quot;)
            for warning in warnings:
                print(f&quot;  - {warning}&quot;)
        print(&quot;\nPlease fix these issues before saving.&quot;)
        raise ValueError(
            f&quot;Found {len(overflow_errors)} overflow error(s) and {len(warnings)} warning(s)&quot;
        )

    # Save the presentation
    prs.save(output_file)

    # Report results
    print(f&quot;Saved updated presentation to: {output_file}&quot;)
    print(f&quot;Processed {len(prs.slides)} slides&quot;)
    print(f&quot;  - Shapes processed: {shapes_processed}&quot;)
    print(f&quot;  - Shapes cleared: {shapes_cleared}&quot;)
    print(f&quot;  - Shapes replaced: {shapes_replaced}&quot;)


def main():
    &quot;&quot;&quot;Main entry point for command-line usage.&quot;&quot;&quot;
    if len(sys.argv) != 4:
        print(__doc__)
        sys.exit(1)

    input_pptx = Path(sys.argv[1])
    replacements_json = Path(sys.argv[2])
    output_pptx = Path(sys.argv[3])

    if not input_pptx.exists():
        print(f&quot;Error: Input file &#x27;{input_pptx}&#x27; not found&quot;)
        sys.exit(1)

    if not replacements_json.exists():
        print(f&quot;Error: Replacements JSON file &#x27;{replacements_json}&#x27; not found&quot;)
        sys.exit(1)

    try:
        apply_replacements(str(input_pptx), str(replacements_json), str(output_pptx))
    except Exception as e:
        print(f&quot;Error applying replacements: {e}&quot;)
        import traceback

        traceback.print_exc()
        sys.exit(1)


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/replace/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/scripts/replace.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="requirements Imported skill requirements from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/mcp-builder/scripts/requirements.txt Unknown LICENSE.txt sources/anthropic/requirements/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">requirements</div>
                <button class="copy-btn" onclick="copyToClipboard('requirements')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill requirements from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">anthropic&gt;=0.39.0
mcp&gt;=1.1.0</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/requirements/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/scripts/requirements.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/mcp-builder/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="silkscreen_ofl Imported skill silkscreen_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/Silkscreen-OFL.txt Unknown LICENSE.txt sources/anthropic/silkscreen_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">silkscreen_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('silkscreen_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill silkscreen_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2001 The Silkscreen Project Authors (https://github.com/googlefonts/silkscreen)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/silkscreen_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/Silkscreen-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="skill Imported skill skill from anthropic anthropic /a0/tmp/skills_research/anthropic/template/SKILL.md Unknown LICENSE.txt sources/anthropic/skill/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">skill</div>
                <button class="copy-btn" onclick="copyToClipboard('skill')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill skill from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
name: template-skill
description: Replace with description of the skill and when Claude should use it.
---

# Insert instructions below</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/skill/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/anthropics/skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <span class="badge muted">License: LICENSE.txt</span>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="smoochsans_ofl Imported skill smoochsans_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/SmoochSans-OFL.txt Unknown LICENSE.txt sources/anthropic/smoochsans_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">smoochsans_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('smoochsans_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill smoochsans_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2016 The Smooch Sans Project Authors (https://github.com/googlefonts/smooch-sans)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/smoochsans_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/SmoochSans-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="sunset_boulevard Imported skill sunset_boulevard from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/theme-factory/themes/sunset-boulevard.md Unknown LICENSE.txt sources/anthropic/sunset_boulevard/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">sunset_boulevard</div>
                <button class="copy-btn" onclick="copyToClipboard('sunset_boulevard')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill sunset_boulevard from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Sunset Boulevard

A warm and vibrant theme inspired by golden hour sunsets, perfect for energetic and creative presentations.

## Color Palette

- **Burnt Orange**: `#e76f51` - Primary accent color
- **Coral**: `#f4a261` - Secondary warm accent
- **Warm Sand**: `#e9c46a` - Highlighting and backgrounds
- **Deep Purple**: `#264653` - Dark contrast and text

## Typography

- **Headers**: DejaVu Serif Bold
- **Body Text**: DejaVu Sans

## Best Used For

Creative pitches, marketing presentations, lifestyle brands, event promotions, inspirational content.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/sunset_boulevard/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/themes/sunset-boulevard.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="tech_innovation Imported skill tech_innovation from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/theme-factory/themes/tech-innovation.md Unknown LICENSE.txt sources/anthropic/tech_innovation/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">tech_innovation</div>
                <button class="copy-btn" onclick="copyToClipboard('tech_innovation')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill tech_innovation from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Tech Innovation

A bold and modern theme with high-contrast colors perfect for cutting-edge technology presentations.

## Color Palette

- **Electric Blue**: `#0066ff` - Vibrant primary accent
- **Neon Cyan**: `#00ffff` - Bright highlight color
- **Dark Gray**: `#1e1e1e` - Deep backgrounds
- **White**: `#ffffff` - Clean text and contrast

## Typography

- **Headers**: DejaVu Sans Bold
- **Body Text**: DejaVu Sans

## Best Used For

Tech startups, software launches, innovation showcases, AI/ML presentations, digital transformation content.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/tech_innovation/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/themes/tech-innovation.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/theme-factory/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="tektur_ofl Imported skill tektur_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/Tektur-OFL.txt Unknown LICENSE.txt sources/anthropic/tektur_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">tektur_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('tektur_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill tektur_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2023 The Tektur Project Authors (https://www.github.com/hyvyys/Tektur)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/tektur_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/Tektur-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="third_party_notices Imported skill third_party_notices from anthropic anthropic /a0/tmp/skills_research/anthropic/THIRD_PARTY_NOTICES.md Unknown LICENSE.txt sources/anthropic/third_party_notices/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">third_party_notices</div>
                <button class="copy-btn" onclick="copyToClipboard('third_party_notices')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill third_party_notices from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># **Third-Party Notices**

THE FOLLOWING SETS FORTH ATTRIBUTION NOTICES FOR THIRD PARTY SOFTWARE THAT MAY BE CONTAINED IN PORTIONS OF THIS PRODUCT.

---

## **BSD 2-Clause License**

The following components are licensed under BSD 2-Clause License reproduced below:

**imageio 2.37.0**, Copyright (c) 2014-2022, imageio developers

**imageio-ffmpeg 0.6.0**, Copyright (c) 2019-2025, imageio 

**License Text:**

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.  
     
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

---

## **GNU General Public License v3.0**

The following components are licensed under GNU General Public License v3.0 reproduced below:

**FFmpeg 7.0.2**, Copyright (c) 2000-2024 the FFmpeg developers

Source Code: [https://ffmpeg.org/releases/ffmpeg-7.0.2.tar.xz](https://ffmpeg.org/releases/ffmpeg-7.0.2.tar.xz)

**License Text:**

GNU GENERAL PUBLIC LICENSE Version 3, 29 June 2007

Copyright  2007 Free Software Foundation, Inc. [https://fsf.org/](https://fsf.org/)

Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.

Preamble

The GNU General Public License is a free, copyleft license for software and other kinds of works.

The licenses for most software and other practical works are designed to take away your freedom to share and change the works. By contrast, the GNU General Public License is intended to guarantee your freedom to share and change all versions of a program--to make sure it remains free software for all its users. We, the Free Software Foundation, use the GNU General Public License for most of our software; it applies also to any other work released this way by its authors. You can apply it to your programs, too.

When we speak of free software, we are referring to freedom, not price. Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for them if you wish), that you receive source code or can get it if you want it, that you can change the software or use pieces of it in new free programs, and that you know you can do these things.

To protect your rights, we need to prevent others from denying you these rights or asking you to surrender the rights. Therefore, you have certain responsibilities if you distribute copies of the software, or if you modify it: responsibilities to respect the freedom of others.

For example, if you distribute copies of such a program, whether gratis or for a fee, you must pass on to the recipients the same freedoms that you received. You must make sure that they, too, receive or can get the source code. And you must show them these terms so they know their rights.

Developers that use the GNU GPL protect your rights with two steps: (1) assert copyright on the software, and (2) offer you this License giving you legal permission to copy, distribute and/or modify it.

For the developers&#x27; and authors&#x27; protection, the GPL clearly explains that there is no warranty for this free software. For both users&#x27; and authors&#x27; sake, the GPL requires that modified versions be marked as changed, so that their problems will not be attributed erroneously to authors of previous versions.

Some devices are designed to deny users access to install or run modified versions of the software inside them, although the manufacturer can do so. This is fundamentally incompatible with the aim of protecting users&#x27; freedom to change the software. The systematic pattern of such abuse occurs in the area of products for individuals to use, which is precisely where it is most unacceptable. Therefore, we have designed this version of the GPL to prohibit the practice for those products. If such problems arise substantially in other domains, we stand ready to extend this provision to those domains in future versions of the GPL, as needed to protect the freedom of users.

Finally, every program is threatened constantly by software patents. States should not allow patents to restrict development and use of software on general-purpose computers, but in those that do, we wish to avoid the special danger that patents applied to a free program could make it effectively proprietary. To prevent this, the GPL assures that patents cannot be used to render the program non-free.

The precise terms and conditions for copying, distribution and modification follow.

TERMS AND CONDITIONS

0. Definitions.

&quot;This License&quot; refers to version 3 of the GNU General Public License.

&quot;Copyright&quot; also means copyright-like laws that apply to other kinds of works, such as semiconductor masks.

&quot;The Program&quot; refers to any copyrightable work licensed under this License. Each licensee is addressed as &quot;you&quot;. &quot;Licensees&quot; and &quot;recipients&quot; may be individuals or organizations.

To &quot;modify&quot; a work means to copy from or adapt all or part of the work in a fashion requiring copyright permission, other than the making of an exact copy. The resulting work is called a &quot;modified version&quot; of the earlier work or a work &quot;based on&quot; the earlier work.

A &quot;covered work&quot; means either the unmodified Program or a work based on the Program.

To &quot;propagate&quot; a work means to do anything with it that, without permission, would make you directly or secondarily liable for infringement under applicable copyright law, except executing it on a computer or modifying a private copy. Propagation includes copying, distribution (with or without modification), making available to the public, and in some countries other activities as well.

To &quot;convey&quot; a work means any kind of propagation that enables other parties to make or receive copies. Mere interaction with a user through a computer network, with no transfer of a copy, is not conveying.

An interactive user interface displays &quot;Appropriate Legal Notices&quot; to the extent that it includes a convenient and prominently visible feature that (1) displays an appropriate copyright notice, and (2) tells the user that there is no warranty for the work (except to the extent that warranties are provided), that licensees may convey the work under this License, and how to view a copy of this License. If the interface presents a list of user commands or options, such as a menu, a prominent item in the list meets this criterion.

1. Source Code.

The &quot;source code&quot; for a work means the preferred form of the work for making modifications to it. &quot;Object code&quot; means any non-source form of a work.

A &quot;Standard Interface&quot; means an interface that either is an official standard defined by a recognized standards body, or, in the case of interfaces specified for a particular programming language, one that is widely used among developers working in that language.

The &quot;System Libraries&quot; of an executable work include anything, other than the work as a whole, that (a) is included in the normal form of packaging a Major Component, but which is not part of that Major Component, and (b) serves only to enable use of the work with that Major Component, or to implement a Standard Interface for which an implementation is available to the public in source code form. A &quot;Major Component&quot;, in this context, means a major essential component (kernel, window system, and so on) of the specific operating system (if any) on which the executable work runs, or a compiler used to produce the work, or an object code interpreter used to run it.

The &quot;Corresponding Source&quot; for a work in object code form means all the source code needed to generate, install, and (for an executable work) run the object code and to modify the work, including scripts to control those activities. However, it does not include the work&#x27;s System Libraries, or general-purpose tools or generally available free programs which are used unmodified in performing those activities but which are not part of the work. For example, Corresponding Source includes interface definition files associated with source files for the work, and the source code for shared libraries and dynamically linked subprograms that the work is specifically designed to require, such as by intimate data communication or control flow between those subprograms and other parts of the work.

The Corresponding Source need not include anything that users can regenerate automatically from other parts of the Corresponding Source.

The Corresponding Source for a work in source code form is that same work.

2. Basic Permissions.

All rights granted under this License are granted for the term of copyright on the Program, and are irrevocable provided the stated conditions are met. This License explicitly affirms your unlimited permission to run the unmodified Program. The output from running a covered work is covered by this License only if the output, given its content, constitutes a covered work. This License acknowledges your rights of fair use or other equivalent, as provided by copyright law.

You may make, run and propagate covered works that you do not convey, without conditions so long as your license otherwise remains in force. You may convey covered works to others for the sole purpose of having them make modifications exclusively for you, or provide you with facilities for running those works, provided that you comply with the terms of this License in conveying all material for which you do not control copyright. Those thus making or running the covered works for you must do so exclusively on your behalf, under your direction and control, on terms that prohibit them from making any copies of your copyrighted material outside their relationship with you.

Conveying under any other circumstances is permitted solely under the conditions stated below. Sublicensing is not allowed; section 10 makes it unnecessary.

3. Protecting Users&#x27; Legal Rights From Anti-Circumvention Law.

No covered work shall be deemed part of an effective technological measure under any applicable law fulfilling obligations under article 11 of the WIPO copyright treaty adopted on 20 December 1996, or similar laws prohibiting or restricting circumvention of such measures.

When you convey a covered work, you waive any legal power to forbid circumvention of technological measures to the extent such circumvention is effected by exercising rights under this License with respect to the covered work, and you disclaim any intention to limit operation or modification of the work as a means of enforcing, against the work&#x27;s users, your or third parties&#x27; legal rights to forbid circumvention of technological measures.

4. Conveying Verbatim Copies.

You may convey verbatim copies of the Program&#x27;s source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice; keep intact all notices stating that this License and any non-permissive terms added in accord with section 7 apply to the code; keep intact all notices of the absence of any warranty; and give all recipients a copy of this License along with the Program.

You may charge any price or no price for each copy that you convey, and you may offer support or warranty protection for a fee.

5. Conveying Modified Source Versions.

You may convey a work based on the Program, or the modifications to produce it from the Program, in the form of source code under the terms of section 4, provided that you also meet all of these conditions:

a) The work must carry prominent notices stating that you modified it, and giving a relevant date.

b) The work must carry prominent notices stating that it is released under this License and any conditions added under section 7\. This requirement modifies the requirement in section 4 to &quot;keep intact all notices&quot;.

c) You must license the entire work, as a whole, under this License to anyone who comes into possession of a copy. This License will therefore apply, along with any applicable section 7 additional terms, to the whole of the work, and all its parts, regardless of how they are packaged. This License gives no permission to license the work in any other way, but it does not invalidate such permission if you have separately received it.

d) If the work has interactive user interfaces, each must display Appropriate Legal Notices; however, if the Program has interactive interfaces that do not display Appropriate Legal Notices, your work need not make them do so.

A compilation of a covered work with other separate and independent works, which are not by their nature extensions of the covered work, and which are not combined with it such as to form a larger program, in or on a volume of a storage or distribution medium, is called an &quot;aggregate&quot; if the compilation and its resulting copyright are not used to limit the access or legal rights of the compilation&#x27;s users beyond what the individual works permit. Inclusion of a covered work in an aggregate does not cause this License to apply to the other parts of the aggregate.

6. Conveying Non-Source Forms.

You may convey a covered work in object code form under the terms of sections 4 and 5, provided that you also convey the machine-readable Corresponding Source under the terms of this License, in one of these ways:

a) Convey the object code in, or embodied in, a physical product (including a physical distribution medium), accompanied by the Corresponding Source fixed on a durable physical medium customarily used for software interchange.

b) Convey the object code in, or embodied in, a physical product (including a physical distribution medium), accompanied by a written offer, valid for at least three years and valid for as long as you offer spare parts or customer support for that product model, to give anyone who possesses the object code either (1) a copy of the Corresponding Source for all the software in the product that is covered by this License, on a durable physical medium customarily used for software interchange, for a price no more than your reasonable cost of physically performing this conveying of source, or (2) access to copy the Corresponding Source from a network server at no charge.

c) Convey individual copies of the object code with a copy of the written offer to provide the Corresponding Source. This alternative is allowed only occasionally and noncommercially, and only if you received the object code with such an offer, in accord with subsection 6b.

d) Convey the object code by offering access from a designated place (gratis or for a charge), and offer equivalent access to the Corresponding Source in the same way through the same place at no further charge. You need not require recipients to copy the Corresponding Source along with the object code. If the place to copy the object code is a network server, the Corresponding Source may be on a different server (operated by you or a third party) that supports equivalent copying facilities, provided you maintain clear directions next to the object code saying where to find the Corresponding Source. Regardless of what server hosts the Corresponding Source, you remain obligated to ensure that it is available for as long as needed to satisfy these requirements.

e) Convey the object code using peer-to-peer transmission, provided you inform other peers where the object code and Corresponding Source of the work are being offered to the general public at no charge under subsection 6d.

A separable portion of the object code, whose source code is excluded from the Corresponding Source as a System Library, need not be included in conveying the object code work.

A &quot;User Product&quot; is either (1) a &quot;consumer product&quot;, which means any tangible personal property which is normally used for personal, family, or household purposes, or (2) anything designed or sold for incorporation into a dwelling. In determining whether a product is a consumer product, doubtful cases shall be resolved in favor of coverage. For a particular product received by a particular user, &quot;normally used&quot; refers to a typical or common use of that class of product, regardless of the status of the particular user or of the way in which the particular user actually uses, or expects or is expected to use, the product. A product is a consumer product regardless of whether the product has substantial commercial, industrial or non-consumer uses, unless such uses represent the only significant mode of use of the product.

&quot;Installation Information&quot; for a User Product means any methods, procedures, authorization keys, or other information required to install and execute modified versions of a covered work in that User Product from a modified version of its Corresponding Source. The information must suffice to ensure that the continued functioning of the modified object code is in no case prevented or interfered with solely because modification has been made.

If you convey an object code work under this section in, or with, or specifically for use in, a User Product, and the conveying occurs as part of a transaction in which the right of possession and use of the User Product is transferred to the recipient in perpetuity or for a fixed term (regardless of how the transaction is characterized), the Corresponding Source conveyed under this section must be accompanied by the Installation Information. But this requirement does not apply if neither you nor any third party retains the ability to install modified object code on the User Product (for example, the work has been installed in ROM).

The requirement to provide Installation Information does not include a requirement to continue to provide support service, warranty, or updates for a work that has been modified or installed by the recipient, or for the User Product in which it has been modified or installed. Access to a network may be denied when the modification itself materially and adversely affects the operation of the network or violates the rules and protocols for communication across the network.

Corresponding Source conveyed, and Installation Information provided, in accord with this section must be in a format that is publicly documented (and with an implementation available to the public in source code form), and must require no special password or key for unpacking, reading or copying.

7. Additional Terms.

&quot;Additional permissions&quot; are terms that supplement the terms of this License by making exceptions from one or more of its conditions. Additional permissions that are applicable to the entire Program shall be treated as though they were included in this License, to the extent that they are valid under applicable law. If additional permissions apply only to part of the Program, that part may be used separately under those permissions, but the entire Program remains governed by this License without regard to the additional permissions.

When you convey a copy of a covered work, you may at your option remove any additional permissions from that copy, or from any part of it. (Additional permissions may be written to require their own removal in certain cases when you modify the work.) You may place additional permissions on material, added by you to a covered work, for which you have or can give appropriate copyright permission.

Notwithstanding any other provision of this License, for material you add to a covered work, you may (if authorized by the copyright holders of that material) supplement the terms of this License with terms:

a) Disclaiming warranty or limiting liability differently from the terms of sections 15 and 16 of this License; or

b) Requiring preservation of specified reasonable legal notices or author attributions in that material or in the Appropriate Legal Notices displayed by works containing it; or

c) Prohibiting misrepresentation of the origin of that material, or requiring that modified versions of such material be marked in reasonable ways as different from the original version; or

d) Limiting the use for publicity purposes of names of licensors or authors of the material; or

e) Declining to grant rights under trademark law for use of some trade names, trademarks, or service marks; or

f) Requiring indemnification of licensors and authors of that material by anyone who conveys the material (or modified versions of it) with contractual assumptions of liability to the recipient, for any liability that these contractual assumptions directly impose on those licensors and authors.

All other non-permissive additional terms are considered &quot;further restrictions&quot; within the meaning of section 10\. If the Program as you received it, or any part of it, contains a notice stating that it is governed by this License along with a term that is a further restriction, you may remove that term. If a license document contains a further restriction but permits relicensing or conveying under this License, you may add to a covered work material governed by the terms of that license document, provided that the further restriction does not survive such relicensing or conveying.

If you add terms to a covered work in accord with this section, you must place, in the relevant source files, a statement of the additional terms that apply to those files, or a notice indicating where to find the applicable terms.

Additional terms, permissive or non-permissive, may be stated in the form of a separately written license, or stated as exceptions; the above requirements apply either way.

8. Termination.

You may not propagate or modify a covered work except as expressly provided under this License. Any attempt otherwise to propagate or modify it is void, and will automatically terminate your rights under this License (including any patent licenses granted under the third paragraph of section 11).

However, if you cease all violation of this License, then your license from a particular copyright holder is reinstated (a) provisionally, unless and until the copyright holder explicitly and finally terminates your license, and (b) permanently, if the copyright holder fails to notify you of the violation by some reasonable means prior to 60 days after the cessation.

Moreover, your license from a particular copyright holder is reinstated permanently if the copyright holder notifies you of the violation by some reasonable means, this is the first time you have received notice of violation of this License (for any work) from that copyright holder, and you cure the violation prior to 30 days after your receipt of the notice.

Termination of your rights under this section does not terminate the licenses of parties who have received copies or rights from you under this License. If your rights have been terminated and not permanently reinstated, you do not qualify to receive new licenses for the same material under section 10\.

9. Acceptance Not Required for Having Copies.

You are not required to accept this License in order to receive or run a copy of the Program. Ancillary propagation of a covered work occurring solely as a consequence of using peer-to-peer transmission to receive a copy likewise does not require acceptance. However, nothing other than this License grants you permission to propagate or modify any covered work. These actions infringe copyright if you do not accept this License. Therefore, by modifying or propagating a covered work, you indicate your acceptance of this License to do so.

10. Automatic Licensing of Downstream Recipients.

Each time you convey a covered work, the recipient automatically receives a license from the original licensors, to run, modify and propagate that work, subject to this License. You are not responsible for enforcing compliance by third parties with this License.

An &quot;entity transaction&quot; is a transaction transferring control of an organization, or substantially all assets of one, or subdividing an organization, or merging organizations. If propagation of a covered work results from an entity transaction, each party to that transaction who receives a copy of the work also receives whatever licenses to the work the party&#x27;s predecessor in interest had or could give under the previous paragraph, plus a right to possession of the Corresponding Source of the work from the predecessor in interest, if the predecessor has it or can get it with reasonable efforts.

You may not impose any further restrictions on the exercise of the rights granted or affirmed under this License. For example, you may not impose a license fee, royalty, or other charge for exercise of rights granted under this License, and you may not initiate litigation (including a cross-claim or counterclaim in a lawsuit) alleging that any patent claim is infringed by making, using, selling, offering for sale, or importing the Program or any portion of it.

11. Patents.

A &quot;contributor&quot; is a copyright holder who authorizes use under this License of the Program or a work on which the Program is based. The work thus licensed is called the contributor&#x27;s &quot;contributor version&quot;.

A contributor&#x27;s &quot;essential patent claims&quot; are all patent claims owned or controlled by the contributor, whether already acquired or hereafter acquired, that would be infringed by some manner, permitted by this License, of making, using, or selling its contributor version, but do not include claims that would be infringed only as a consequence of further modification of the contributor version. For purposes of this definition, &quot;control&quot; includes the right to grant patent sublicenses in a manner consistent with the requirements of this License.

Each contributor grants you a non-exclusive, worldwide, royalty-free patent license under the contributor&#x27;s essential patent claims, to make, use, sell, offer for sale, import and otherwise run, modify and propagate the contents of its contributor version.

In the following three paragraphs, a &quot;patent license&quot; is any express agreement or commitment, however denominated, not to enforce a patent (such as an express permission to practice a patent or covenant not to sue for patent infringement). To &quot;grant&quot; such a patent license to a party means to make such an agreement or commitment not to enforce a patent against the party.

If you convey a covered work, knowingly relying on a patent license, and the Corresponding Source of the work is not available for anyone to copy, free of charge and under the terms of this License, through a publicly available network server or other readily accessible means, then you must either (1) cause the Corresponding Source to be so available, or (2) arrange to deprive yourself of the benefit of the patent license for this particular work, or (3) arrange, in a manner consistent with the requirements of this License, to extend the patent license to downstream recipients. &quot;Knowingly relying&quot; means you have actual knowledge that, but for the patent license, your conveying the covered work in a country, or your recipient&#x27;s use of the covered work in a country, would infringe one or more identifiable patents in that country that you have reason to believe are valid.

If, pursuant to or in connection with a single transaction or arrangement, you convey, or propagate by procuring conveyance of, a covered work, and grant a patent license to some of the parties receiving the covered work authorizing them to use, propagate, modify or convey a specific copy of the covered work, then the patent license you grant is automatically extended to all recipients of the covered work and works based on it.

A patent license is &quot;discriminatory&quot; if it does not include within the scope of its coverage, prohibits the exercise of, or is conditioned on the non-exercise of one or more of the rights that are specifically granted under this License. You may not convey a covered work if you are a party to an arrangement with a third party that is in the business of distributing software, under which you make payment to the third party based on the extent of your activity of conveying the work, and under which the third party grants, to any of the parties who would receive the covered work from you, a discriminatory patent license (a) in connection with copies of the covered work conveyed by you (or copies made from those copies), or (b) primarily for and in connection with specific products or compilations that contain the covered work, unless you entered into that arrangement, or that patent license was granted, prior to 28 March 2007\.

Nothing in this License shall be construed as excluding or limiting any implied license or other defenses to infringement that may otherwise be available to you under applicable patent law.

12. No Surrender of Others&#x27; Freedom.

If conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License. If you cannot convey a covered work so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not convey it at all. For example, if you agree to terms that obligate you to collect a royalty for further conveying from those to whom you convey the Program, the only way you could satisfy both those terms and this License would be to refrain entirely from conveying the Program.

13. Use with the GNU Affero General Public License.

Notwithstanding any other provision of this License, you have permission to link or combine any covered work with a work licensed under version 3 of the GNU Affero General Public License into a single combined work, and to convey the resulting work. The terms of this License will continue to apply to the part which is the covered work, but the special requirements of the GNU Affero General Public License, section 13, concerning interaction through a network will apply to the combination as such.

14. Revised Versions of this License.

The Free Software Foundation may publish revised and/or new versions of the GNU General Public License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.

Each version is given a distinguishing version number. If the Program specifies that a certain numbered version of the GNU General Public License &quot;or any later version&quot; applies to it, you have the option of following the terms and conditions either of that numbered version or of any later version published by the Free Software Foundation. If the Program does not specify a version number of the GNU General Public License, you may choose any version ever published by the Free Software Foundation.

If the Program specifies that a proxy can decide which future versions of the GNU General Public License can be used, that proxy&#x27;s public statement of acceptance of a version permanently authorizes you to choose that version for the Program.

Later license versions may give you additional or different permissions. However, no additional obligations are imposed on any author or copyright holder as a result of your choosing to follow a later version.

15. Disclaimer of Warranty.

THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM &quot;AS IS&quot; WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

16. Limitation of Liability.

IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

17. Interpretation of Sections 15 and 16\.

If the disclaimer of warranty and limitation of liability provided above cannot be given local legal effect according to their terms, reviewing courts shall apply local law that most closely approximates an absolute waiver of all civil liability in connection with the Program, unless a warranty or assumption of liability accompanies a copy of the Program in return for a fee.

END OF TERMS AND CONDITIONS

How to Apply These Terms to Your New Programs

If you develop a new program, and you want it to be of the greatest possible use to the public, the best way to achieve this is to make it free software which everyone can redistribute and change under these terms.

To do so, attach the following notices to the program. It is safest to attach them to the start of each source file to most effectively state the exclusion of warranty; and each file should have at least the &quot;copyright&quot; line and a pointer to where the full notice is found.

\&lt;one line to give the program&#x27;s name and a brief idea of what it does.\&gt;   
Copyright (C) \&lt;year\&gt;  \&lt;name of author\&gt;

This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with this program. If not, see [https://www.gnu.org/licenses/](https://www.gnu.org/licenses/).

Also add information on how to contact you by electronic and paper mail.

If the program does terminal interaction, make it output a short notice like this when it starts in an interactive mode:

\&lt;program\&gt; Copyright (C) \&lt;year\&gt; \&lt;name of author\&gt;  
This program comes with ABSOLUTELY NO WARRANTY; for details type &#x27;show w&#x27;. This is free software, and you are welcome to redistribute it under certain conditions; type &#x27;show c&#x27; for details.

The hypothetical commands &#x27;show w&#x27; and &#x27;show c&#x27; should show the appropriate parts of the General Public License. Of course, your program&#x27;s commands might be different; for a GUI interface, you would use an &quot;about box&quot;.

You should also get your employer (if you work as a programmer) or school, if any, to sign a &quot;copyright disclaimer&quot; for the program, if necessary. For more information on this, and how to apply and follow the GNU GPL, see [https://www.gnu.org/licenses/](https://www.gnu.org/licenses/).

The GNU General Public License does not permit incorporating your program into proprietary programs. If your program is a subroutine library, you may consider it more useful to permit linking proprietary applications with the library. If this is what you want to do, use the GNU Lesser General Public License instead of this License. But first, please read [https://www.gnu.org/licenses/why-not-lgpl.html](https://www.gnu.org/licenses/why-not-lgpl.html).

---

## **MIT-CMU License (HPND)**

The following components are licensed under MIT-CMU License (HPND) reproduced below:

**Pillow 11.3.0**, Copyright  1997-2011 by Secret Labs AB, Copyright  1995-2011 by Fredrik Lundh and contributors, Copyright  2010 by Jeffrey A. Clark and contributors

**License Text:**

By obtaining, using, and/or copying this software and/or its associated documentation, you agree that you have read, understood, and will comply with the following terms and conditions:

Permission to use, copy, modify and distribute this software and its documentation for any purpose and without fee is hereby granted, provided that the above copyright notice appears in all copies, and that both that copyright notice and this permission notice appear in supporting documentation, and that the name of Secret Labs AB or the author not be used in advertising or publicity pertaining to distribution of the software without specific, written prior permission.

SECRET LABS AB AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL SECRET LABS AB OR THE AUTHOR BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

---

## **SIL Open Font License v1.1**

The following fonts are licensed under SIL Open Font License v1.1 reproduced below:

**Arsenal SC**, Copyright 2012 The Arsenal Project Authors ([andrij.design@gmail.com](mailto:andrij.design@gmail.com))

**Big Shoulders**, Copyright 2019 The Big Shoulders Project Authors ([https://github.com/xotypeco/big\_shoulders](https://github.com/xotypeco/big_shoulders))

**Boldonse**, Copyright 2024 The Boldonse Project Authors ([https://github.com/googlefonts/boldonse](https://github.com/googlefonts/boldonse))

**Bricolage Grotesque**, Copyright 2022 The Bricolage Grotesque Project Authors ([https://github.com/ateliertriay/bricolage](https://github.com/ateliertriay/bricolage))

**Crimson Pro**, Copyright 2018 The Crimson Pro Project Authors ([https://github.com/Fonthausen/CrimsonPro](https://github.com/Fonthausen/CrimsonPro))

**DM Mono**, Copyright 2020 The DM Mono Project Authors ([https://www.github.com/googlefonts/dm-mono](https://www.github.com/googlefonts/dm-mono))

**Erica One**, Copyright (c) 2011 by LatinoType Limitada ([luciano@latinotype.com](mailto:luciano@latinotype.com)), with Reserved Font Name &quot;Erica One&quot;

**Geist Mono**, Copyright 2024 The Geist Project Authors ([https://github.com/vercel/geist-font.git](https://github.com/vercel/geist-font.git))

**Gloock**, Copyright 2022 The Gloock Project Authors ([https://github.com/duartp/gloock](https://github.com/duartp/gloock))

**IBM Plex Mono**, Copyright  2017 IBM Corp., with Reserved Font Name &quot;Plex&quot;

**Instrument Sans**, Copyright 2022 The Instrument Sans Project Authors ([https://github.com/Instrument/instrument-sans](https://github.com/Instrument/instrument-sans))

**Italiana**, Copyright (c) 2011, Santiago Orozco ([hi@typemade.mx](mailto:hi@typemade.mx)), with Reserved Font Name &quot;Italiana&quot;

**JetBrains Mono**, Copyright 2020 The JetBrains Mono Project Authors ([https://github.com/JetBrains/JetBrainsMono](https://github.com/JetBrains/JetBrainsMono))

**Jura**, Copyright 2019 The Jura Project Authors ([https://github.com/ossobuffo/jura](https://github.com/ossobuffo/jura))

**Libre Baskerville**, Copyright 2012 The Libre Baskerville Project Authors ([https://github.com/impallari/Libre-Baskerville](https://github.com/impallari/Libre-Baskerville)), with Reserved Font Name &quot;Libre Baskerville&quot;

**Lora**, Copyright 2011 The Lora Project Authors ([https://github.com/cyrealtype/Lora-Cyrillic](https://github.com/cyrealtype/Lora-Cyrillic)), with Reserved Font Name &quot;Lora&quot;

**National Park**, Copyright 2025 The National Park Project Authors ([https://github.com/benhoepner/National-Park](https://github.com/benhoepner/National-Park))

**Nothing You Could Do**, Copyright (c) 2010, Kimberly Geswein (kimberlygeswein.com)

**Outfit**, Copyright 2021 The Outfit Project Authors ([https://github.com/Outfitio/Outfit-Fonts](https://github.com/Outfitio/Outfit-Fonts))

**Pixelify Sans**, Copyright 2021 The Pixelify Sans Project Authors ([https://github.com/eifetx/Pixelify-Sans](https://github.com/eifetx/Pixelify-Sans))

**Poiret One**, Copyright (c) 2011, Denis Masharov ([denis.masharov@gmail.com](mailto:denis.masharov@gmail.com))

**Red Hat Mono**, Copyright 2024 The Red Hat Project Authors ([https://github.com/RedHatOfficial/RedHatFont](https://github.com/RedHatOfficial/RedHatFont))

**Silkscreen**, Copyright 2001 The Silkscreen Project Authors ([https://github.com/googlefonts/silkscreen](https://github.com/googlefonts/silkscreen))

**Smooch Sans**, Copyright 2016 The Smooch Sans Project Authors ([https://github.com/googlefonts/smooch-sans](https://github.com/googlefonts/smooch-sans))

**Tektur**, Copyright 2023 The Tektur Project Authors ([https://www.github.com/hyvyys/Tektur](https://www.github.com/hyvyys/Tektur))

**Work Sans**, Copyright 2019 The Work Sans Project Authors ([https://github.com/weiweihuanghuang/Work-Sans](https://github.com/weiweihuanghuang/Work-Sans))

**Young Serif**, Copyright 2023 The Young Serif Project Authors ([https://github.com/noirblancrouge/YoungSerif](https://github.com/noirblancrouge/YoungSerif))

**License Text:**

---

## **SIL OPEN FONT LICENSE Version 1.1 \- 26 February 2007**

PREAMBLE

The goals of the Open Font License (OFL) are to stimulate worldwide development of collaborative font projects, to support the font creation efforts of academic and linguistic communities, and to provide a free and open framework in which fonts may be shared and improved in partnership with others.

The OFL allows the licensed fonts to be used, studied, modified and redistributed freely as long as they are not sold by themselves. The fonts, including any derivative works, can be bundled, embedded, redistributed and/or sold with any software provided that any reserved names are not used by derivative works. The fonts and derivatives, however, cannot be released under any other type of license. The requirement for fonts to remain under this license does not apply to any document created using the fonts or their derivatives.

DEFINITIONS

&quot;Font Software&quot; refers to the set of files released by the Copyright Holder(s) under this license and clearly marked as such. This may include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting, or substituting \-- in part or in whole \-- any of the components of the Original Version, by changing formats or by porting the Font Software to a new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS

Permission is hereby granted, free of charge, to any person obtaining a copy of the Font Software, to use, study, copy, merge, embed, modify, redistribute, and sell modified and unmodified copies of the Font Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components, in Original or Modified Versions, may be sold by itself.  
     
2) Original or Modified Versions of the Font Software may be bundled, redistributed and/or sold with any software, provided that each copy contains the above copyright notice and this license. These can be included either as stand-alone text files, human-readable headers or in the appropriate machine-readable metadata fields within text or binary files as long as those fields can be easily viewed by the user.  
     
3) No Modified Version of the Font Software may use the Reserved Font Name(s) unless explicit written permission is granted by the corresponding Copyright Holder. This restriction only applies to the primary font name as presented to the users.  
     
4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font Software shall not be used to promote, endorse or advertise any Modified Version, except to acknowledge the contribution(s) of the Copyright Holder(s) and the Author(s) or with their explicit written permission.  
     
5) The Font Software, modified or unmodified, in part or in whole, must be distributed entirely under this license, and must not be distributed under any other license. The requirement for fonts to remain under this license does not apply to any document created using the Font Software.

TERMINATION

This license becomes null and void if any of the above conditions are not met.

DISCLAIMER

THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/third_party_notices/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/anthropics/skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <span class="badge muted">License: LICENSE.txt</span>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="thumbnail Imported skill thumbnail from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/scripts/thumbnail.py Unknown LICENSE.txt sources/anthropic/thumbnail/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">thumbnail</div>
                <button class="copy-btn" onclick="copyToClipboard('thumbnail')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill thumbnail from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Create thumbnail grids from PowerPoint presentation slides.

Creates a grid layout of slide thumbnails with configurable columns (max 6).
Each grid contains up to cols(cols+1) images. For presentations with more
slides, multiple numbered grid files are created automatically.

The program outputs the names of all files created.

Output:
- Single grid: {prefix}.jpg (if slides fit in one grid)
- Multiple grids: {prefix}-1.jpg, {prefix}-2.jpg, etc.

Grid limits by column count:
- 3 cols: max 12 slides per grid (34)
- 4 cols: max 20 slides per grid (45)
- 5 cols: max 30 slides per grid (56) [default]
- 6 cols: max 42 slides per grid (67)

Usage:
    python thumbnail.py input.pptx [output_prefix] [--cols N] [--outline-placeholders]

Examples:
    python thumbnail.py presentation.pptx
    # Creates: thumbnails.jpg (using default prefix)
    # Outputs:
    #   Created 1 grid(s):
    #     - thumbnails.jpg

    python thumbnail.py large-deck.pptx grid --cols 4
    # Creates: grid-1.jpg, grid-2.jpg, grid-3.jpg
    # Outputs:
    #   Created 3 grid(s):
    #     - grid-1.jpg
    #     - grid-2.jpg
    #     - grid-3.jpg

    python thumbnail.py template.pptx analysis --outline-placeholders
    # Creates thumbnail grids with red outlines around text placeholders
&quot;&quot;&quot;

import argparse
import subprocess
import sys
import tempfile
from pathlib import Path

from inventory import extract_text_inventory
from PIL import Image, ImageDraw, ImageFont
from pptx import Presentation

# Constants
THUMBNAIL_WIDTH = 300  # Fixed thumbnail width in pixels
CONVERSION_DPI = 100  # DPI for PDF to image conversion
MAX_COLS = 6  # Maximum number of columns
DEFAULT_COLS = 5  # Default number of columns
JPEG_QUALITY = 95  # JPEG compression quality

# Grid layout constants
GRID_PADDING = 20  # Padding between thumbnails
BORDER_WIDTH = 2  # Border width around thumbnails
FONT_SIZE_RATIO = 0.12  # Font size as fraction of thumbnail width
LABEL_PADDING_RATIO = 0.4  # Label padding as fraction of font size


def main():
    parser = argparse.ArgumentParser(
        description=&quot;Create thumbnail grids from PowerPoint slides.&quot;
    )
    parser.add_argument(&quot;input&quot;, help=&quot;Input PowerPoint file (.pptx)&quot;)
    parser.add_argument(
        &quot;output_prefix&quot;,
        nargs=&quot;?&quot;,
        default=&quot;thumbnails&quot;,
        help=&quot;Output prefix for image files (default: thumbnails, will create prefix.jpg or prefix-N.jpg)&quot;,
    )
    parser.add_argument(
        &quot;--cols&quot;,
        type=int,
        default=DEFAULT_COLS,
        help=f&quot;Number of columns (default: {DEFAULT_COLS}, max: {MAX_COLS})&quot;,
    )
    parser.add_argument(
        &quot;--outline-placeholders&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Outline text placeholders with a colored border&quot;,
    )

    args = parser.parse_args()

    # Validate columns
    cols = min(args.cols, MAX_COLS)
    if args.cols &gt; MAX_COLS:
        print(f&quot;Warning: Columns limited to {MAX_COLS} (requested {args.cols})&quot;)

    # Validate input
    input_path = Path(args.input)
    if not input_path.exists() or input_path.suffix.lower() != &quot;.pptx&quot;:
        print(f&quot;Error: Invalid PowerPoint file: {args.input}&quot;)
        sys.exit(1)

    # Construct output path (always JPG)
    output_path = Path(f&quot;{args.output_prefix}.jpg&quot;)

    print(f&quot;Processing: {args.input}&quot;)

    try:
        with tempfile.TemporaryDirectory() as temp_dir:
            # Get placeholder regions if outlining is enabled
            placeholder_regions = None
            slide_dimensions = None
            if args.outline_placeholders:
                print(&quot;Extracting placeholder regions...&quot;)
                placeholder_regions, slide_dimensions = get_placeholder_regions(
                    input_path
                )
                if placeholder_regions:
                    print(f&quot;Found placeholders on {len(placeholder_regions)} slides&quot;)

            # Convert slides to images
            slide_images = convert_to_images(input_path, Path(temp_dir), CONVERSION_DPI)
            if not slide_images:
                print(&quot;Error: No slides found&quot;)
                sys.exit(1)

            print(f&quot;Found {len(slide_images)} slides&quot;)

            # Create grids (max cols(cols+1) images per grid)
            grid_files = create_grids(
                slide_images,
                cols,
                THUMBNAIL_WIDTH,
                output_path,
                placeholder_regions,
                slide_dimensions,
            )

            # Print saved files
            print(f&quot;Created {len(grid_files)} grid(s):&quot;)
            for grid_file in grid_files:
                print(f&quot;  - {grid_file}&quot;)

    except Exception as e:
        print(f&quot;Error: {e}&quot;)
        sys.exit(1)


def create_hidden_slide_placeholder(size):
    &quot;&quot;&quot;Create placeholder image for hidden slides.&quot;&quot;&quot;
    img = Image.new(&quot;RGB&quot;, size, color=&quot;#F0F0F0&quot;)
    draw = ImageDraw.Draw(img)
    line_width = max(5, min(size) // 100)
    draw.line([(0, 0), size], fill=&quot;#CCCCCC&quot;, width=line_width)
    draw.line([(size[0], 0), (0, size[1])], fill=&quot;#CCCCCC&quot;, width=line_width)
    return img


def get_placeholder_regions(pptx_path):
    &quot;&quot;&quot;Extract ALL text regions from the presentation.

    Returns a tuple of (placeholder_regions, slide_dimensions).
    text_regions is a dict mapping slide indices to lists of text regions.
    Each region is a dict with &#x27;left&#x27;, &#x27;top&#x27;, &#x27;width&#x27;, &#x27;height&#x27; in inches.
    slide_dimensions is a tuple of (width_inches, height_inches).
    &quot;&quot;&quot;
    prs = Presentation(str(pptx_path))
    inventory = extract_text_inventory(pptx_path, prs)
    placeholder_regions = {}

    # Get actual slide dimensions in inches (EMU to inches conversion)
    slide_width_inches = (prs.slide_width or 9144000) / 914400.0
    slide_height_inches = (prs.slide_height or 5143500) / 914400.0

    for slide_key, shapes in inventory.items():
        # Extract slide index from &quot;slide-N&quot; format
        slide_idx = int(slide_key.split(&quot;-&quot;)[1])
        regions = []

        for shape_key, shape_data in shapes.items():
            # The inventory only contains shapes with text, so all shapes should be highlighted
            regions.append(
                {
                    &quot;left&quot;: shape_data.left,
                    &quot;top&quot;: shape_data.top,
                    &quot;width&quot;: shape_data.width,
                    &quot;height&quot;: shape_data.height,
                }
            )

        if regions:
            placeholder_regions[slide_idx] = regions

    return placeholder_regions, (slide_width_inches, slide_height_inches)


def convert_to_images(pptx_path, temp_dir, dpi):
    &quot;&quot;&quot;Convert PowerPoint to images via PDF, handling hidden slides.&quot;&quot;&quot;
    # Detect hidden slides
    print(&quot;Analyzing presentation...&quot;)
    prs = Presentation(str(pptx_path))
    total_slides = len(prs.slides)

    # Find hidden slides (1-based indexing for display)
    hidden_slides = {
        idx + 1
        for idx, slide in enumerate(prs.slides)
        if slide.element.get(&quot;show&quot;) == &quot;0&quot;
    }

    print(f&quot;Total slides: {total_slides}&quot;)
    if hidden_slides:
        print(f&quot;Hidden slides: {sorted(hidden_slides)}&quot;)

    pdf_path = temp_dir / f&quot;{pptx_path.stem}.pdf&quot;

    # Convert to PDF
    print(&quot;Converting to PDF...&quot;)
    result = subprocess.run(
        [
            &quot;soffice&quot;,
            &quot;--headless&quot;,
            &quot;--convert-to&quot;,
            &quot;pdf&quot;,
            &quot;--outdir&quot;,
            str(temp_dir),
            str(pptx_path),
        ],
        capture_output=True,
        text=True,
    )
    if result.returncode != 0 or not pdf_path.exists():
        raise RuntimeError(&quot;PDF conversion failed&quot;)

    # Convert PDF to images
    print(f&quot;Converting to images at {dpi} DPI...&quot;)
    result = subprocess.run(
        [&quot;pdftoppm&quot;, &quot;-jpeg&quot;, &quot;-r&quot;, str(dpi), str(pdf_path), str(temp_dir / &quot;slide&quot;)],
        capture_output=True,
        text=True,
    )
    if result.returncode != 0:
        raise RuntimeError(&quot;Image conversion failed&quot;)

    visible_images = sorted(temp_dir.glob(&quot;slide-*.jpg&quot;))

    # Create full list with placeholders for hidden slides
    all_images = []
    visible_idx = 0

    # Get placeholder dimensions from first visible slide
    if visible_images:
        with Image.open(visible_images[0]) as img:
            placeholder_size = img.size
    else:
        placeholder_size = (1920, 1080)

    for slide_num in range(1, total_slides + 1):
        if slide_num in hidden_slides:
            # Create placeholder image for hidden slide
            placeholder_path = temp_dir / f&quot;hidden-{slide_num:03d}.jpg&quot;
            placeholder_img = create_hidden_slide_placeholder(placeholder_size)
            placeholder_img.save(placeholder_path, &quot;JPEG&quot;)
            all_images.append(placeholder_path)
        else:
            # Use the actual visible slide image
            if visible_idx &lt; len(visible_images):
                all_images.append(visible_images[visible_idx])
                visible_idx += 1

    return all_images


def create_grids(
    image_paths,
    cols,
    width,
    output_path,
    placeholder_regions=None,
    slide_dimensions=None,
):
    &quot;&quot;&quot;Create multiple thumbnail grids from slide images, max cols(cols+1) images per grid.&quot;&quot;&quot;
    # Maximum images per grid is cols  (cols + 1) for better proportions
    max_images_per_grid = cols * (cols + 1)
    grid_files = []

    print(
        f&quot;Creating grids with {cols} columns (max {max_images_per_grid} images per grid)&quot;
    )

    # Split images into chunks
    for chunk_idx, start_idx in enumerate(
        range(0, len(image_paths), max_images_per_grid)
    ):
        end_idx = min(start_idx + max_images_per_grid, len(image_paths))
        chunk_images = image_paths[start_idx:end_idx]

        # Create grid for this chunk
        grid = create_grid(
            chunk_images, cols, width, start_idx, placeholder_regions, slide_dimensions
        )

        # Generate output filename
        if len(image_paths) &lt;= max_images_per_grid:
            # Single grid - use base filename without suffix
            grid_filename = output_path
        else:
            # Multiple grids - insert index before extension with dash
            stem = output_path.stem
            suffix = output_path.suffix
            grid_filename = output_path.parent / f&quot;{stem}-{chunk_idx + 1}{suffix}&quot;

        # Save grid
        grid_filename.parent.mkdir(parents=True, exist_ok=True)
        grid.save(str(grid_filename), quality=JPEG_QUALITY)
        grid_files.append(str(grid_filename))

    return grid_files


def create_grid(
    image_paths,
    cols,
    width,
    start_slide_num=0,
    placeholder_regions=None,
    slide_dimensions=None,
):
    &quot;&quot;&quot;Create thumbnail grid from slide images with optional placeholder outlining.&quot;&quot;&quot;
    font_size = int(width * FONT_SIZE_RATIO)
    label_padding = int(font_size * LABEL_PADDING_RATIO)

    # Get dimensions
    with Image.open(image_paths[0]) as img:
        aspect = img.height / img.width
    height = int(width * aspect)

    # Calculate grid size
    rows = (len(image_paths) + cols - 1) // cols
    grid_w = cols * width + (cols + 1) * GRID_PADDING
    grid_h = rows * (height + font_size + label_padding * 2) + (rows + 1) * GRID_PADDING

    # Create grid
    grid = Image.new(&quot;RGB&quot;, (grid_w, grid_h), &quot;white&quot;)
    draw = ImageDraw.Draw(grid)

    # Load font with size based on thumbnail width
    try:
        # Use Pillow&#x27;s default font with size
        font = ImageFont.load_default(size=font_size)
    except Exception:
        # Fall back to basic default font if size parameter not supported
        font = ImageFont.load_default()

    # Place thumbnails
    for i, img_path in enumerate(image_paths):
        row, col = i // cols, i % cols
        x = col * width + (col + 1) * GRID_PADDING
        y_base = (
            row * (height + font_size + label_padding * 2) + (row + 1) * GRID_PADDING
        )

        # Add label with actual slide number
        label = f&quot;{start_slide_num + i}&quot;
        bbox = draw.textbbox((0, 0), label, font=font)
        text_w = bbox[2] - bbox[0]
        draw.text(
            (x + (width - text_w) // 2, y_base + label_padding),
            label,
            fill=&quot;black&quot;,
            font=font,
        )

        # Add thumbnail below label with proportional spacing
        y_thumbnail = y_base + label_padding + font_size + label_padding

        with Image.open(img_path) as img:
            # Get original dimensions before thumbnail
            orig_w, orig_h = img.size

            # Apply placeholder outlines if enabled
            if placeholder_regions and (start_slide_num + i) in placeholder_regions:
                # Convert to RGBA for transparency support
                if img.mode != &quot;RGBA&quot;:
                    img = img.convert(&quot;RGBA&quot;)

                # Get the regions for this slide
                regions = placeholder_regions[start_slide_num + i]

                # Calculate scale factors using actual slide dimensions
                if slide_dimensions:
                    slide_width_inches, slide_height_inches = slide_dimensions
                else:
                    # Fallback: estimate from image size at CONVERSION_DPI
                    slide_width_inches = orig_w / CONVERSION_DPI
                    slide_height_inches = orig_h / CONVERSION_DPI

                x_scale = orig_w / slide_width_inches
                y_scale = orig_h / slide_height_inches

                # Create a highlight overlay
                overlay = Image.new(&quot;RGBA&quot;, img.size, (255, 255, 255, 0))
                overlay_draw = ImageDraw.Draw(overlay)

                # Highlight each placeholder region
                for region in regions:
                    # Convert from inches to pixels in the original image
                    px_left = int(region[&quot;left&quot;] * x_scale)
                    px_top = int(region[&quot;top&quot;] * y_scale)
                    px_width = int(region[&quot;width&quot;] * x_scale)
                    px_height = int(region[&quot;height&quot;] * y_scale)

                    # Draw highlight outline with red color and thick stroke
                    # Using a bright red outline instead of fill
                    stroke_width = max(
                        5, min(orig_w, orig_h) // 150
                    )  # Thicker proportional stroke width
                    overlay_draw.rectangle(
                        [(px_left, px_top), (px_left + px_width, px_top + px_height)],
                        outline=(255, 0, 0, 255),  # Bright red, fully opaque
                        width=stroke_width,
                    )

                # Composite the overlay onto the image using alpha blending
                img = Image.alpha_composite(img, overlay)
                # Convert back to RGB for JPEG saving
                img = img.convert(&quot;RGB&quot;)

            img.thumbnail((width, height), Image.Resampling.LANCZOS)
            w, h = img.size
            tx = x + (width - w) // 2
            ty = y_thumbnail + (height - h) // 2
            grid.paste(img, (tx, ty))

            # Add border
            if BORDER_WIDTH &gt; 0:
                draw.rectangle(
                    [
                        (tx - BORDER_WIDTH, ty - BORDER_WIDTH),
                        (tx + w + BORDER_WIDTH - 1, ty + h + BORDER_WIDTH - 1),
                    ],
                    outline=&quot;gray&quot;,
                    width=BORDER_WIDTH,
                )

    return grid


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/thumbnail/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/scripts/thumbnail.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="unpack Imported skill unpack from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/ooxml/scripts/unpack.py Unknown LICENSE.txt sources/anthropic/unpack/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">unpack</div>
                <button class="copy-btn" onclick="copyToClipboard('unpack')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill unpack from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;Unpack and format XML contents of Office files (.docx, .pptx, .xlsx)&quot;&quot;&quot;

import random
import sys
import defusedxml.minidom
import zipfile
from pathlib import Path

# Get command line arguments
assert len(sys.argv) == 3, &quot;Usage: python unpack.py &lt;office_file&gt; &lt;output_dir&gt;&quot;
input_file, output_dir = sys.argv[1], sys.argv[2]

# Extract and format
output_path = Path(output_dir)
output_path.mkdir(parents=True, exist_ok=True)
zipfile.ZipFile(input_file).extractall(output_path)

# Pretty print all XML files
xml_files = list(output_path.rglob(&quot;*.xml&quot;)) + list(output_path.rglob(&quot;*.rels&quot;))
for xml_file in xml_files:
    content = xml_file.read_text(encoding=&quot;utf-8&quot;)
    dom = defusedxml.minidom.parseString(content)
    xml_file.write_bytes(dom.toprettyxml(indent=&quot;  &quot;, encoding=&quot;ascii&quot;))

# For .docx files, suggest an RSID for tracked changes
if input_file.endswith(&quot;.docx&quot;):
    suggested_rsid = &quot;&quot;.join(random.choices(&quot;0123456789ABCDEF&quot;, k=8))
    print(f&quot;Suggested RSID for edit session: {suggested_rsid}&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/unpack/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/ooxml/scripts/unpack.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="utilities Imported skill utilities from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/docx/scripts/utilities.py Unknown LICENSE.txt sources/anthropic/utilities/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">utilities</div>
                <button class="copy-btn" onclick="copyToClipboard('utilities')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill utilities from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Utilities for editing OOXML documents.

This module provides XMLEditor, a tool for manipulating XML files with support for
line-number-based node finding and DOM manipulation. Each element is automatically
annotated with its original line and column position during parsing.

Example usage:
    editor = XMLEditor(&quot;document.xml&quot;)

    # Find node by line number or range
    elem = editor.get_node(tag=&quot;w:r&quot;, line_number=519)
    elem = editor.get_node(tag=&quot;w:p&quot;, line_number=range(100, 200))

    # Find node by text content
    elem = editor.get_node(tag=&quot;w:p&quot;, contains=&quot;specific text&quot;)

    # Find node by attributes
    elem = editor.get_node(tag=&quot;w:r&quot;, attrs={&quot;w:id&quot;: &quot;target&quot;})

    # Combine filters
    elem = editor.get_node(tag=&quot;w:p&quot;, line_number=range(1, 50), contains=&quot;text&quot;)

    # Replace, insert, or manipulate
    new_elem = editor.replace_node(elem, &quot;&lt;w:r&gt;&lt;w:t&gt;new text&lt;/w:t&gt;&lt;/w:r&gt;&quot;)
    editor.insert_after(new_elem, &quot;&lt;w:r&gt;&lt;w:t&gt;more&lt;/w:t&gt;&lt;/w:r&gt;&quot;)

    # Save changes
    editor.save()
&quot;&quot;&quot;

import html
from pathlib import Path
from typing import Optional, Union

import defusedxml.minidom
import defusedxml.sax


class XMLEditor:
    &quot;&quot;&quot;
    Editor for manipulating OOXML XML files with line-number-based node finding.

    This class parses XML files and tracks the original line and column position
    of each element. This enables finding nodes by their line number in the original
    file, which is useful when working with Read tool output.

    Attributes:
        xml_path: Path to the XML file being edited
        encoding: Detected encoding of the XML file (&#x27;ascii&#x27; or &#x27;utf-8&#x27;)
        dom: Parsed DOM tree with parse_position attributes on elements
    &quot;&quot;&quot;

    def __init__(self, xml_path):
        &quot;&quot;&quot;
        Initialize with path to XML file and parse with line number tracking.

        Args:
            xml_path: Path to XML file to edit (str or Path)

        Raises:
            ValueError: If the XML file does not exist
        &quot;&quot;&quot;
        self.xml_path = Path(xml_path)
        if not self.xml_path.exists():
            raise ValueError(f&quot;XML file not found: {xml_path}&quot;)

        with open(self.xml_path, &quot;rb&quot;) as f:
            header = f.read(200).decode(&quot;utf-8&quot;, errors=&quot;ignore&quot;)
        self.encoding = &quot;ascii&quot; if &#x27;encoding=&quot;ascii&quot;&#x27; in header else &quot;utf-8&quot;

        parser = _create_line_tracking_parser()
        self.dom = defusedxml.minidom.parse(str(self.xml_path), parser)

    def get_node(
        self,
        tag: str,
        attrs: Optional[dict[str, str]] = None,
        line_number: Optional[Union[int, range]] = None,
        contains: Optional[str] = None,
    ):
        &quot;&quot;&quot;
        Get a DOM element by tag and identifier.

        Finds an element by either its line number in the original file or by
        matching attribute values. Exactly one match must be found.

        Args:
            tag: The XML tag name (e.g., &quot;w:del&quot;, &quot;w:ins&quot;, &quot;w:r&quot;)
            attrs: Dictionary of attribute name-value pairs to match (e.g., {&quot;w:id&quot;: &quot;1&quot;})
            line_number: Line number (int) or line range (range) in original XML file (1-indexed)
            contains: Text string that must appear in any text node within the element.
                      Supports both entity notation (&amp;#8220;) and Unicode characters (\u201c).

        Returns:
            defusedxml.minidom.Element: The matching DOM element

        Raises:
            ValueError: If node not found or multiple matches found

        Example:
            elem = editor.get_node(tag=&quot;w:r&quot;, line_number=519)
            elem = editor.get_node(tag=&quot;w:r&quot;, line_number=range(100, 200))
            elem = editor.get_node(tag=&quot;w:del&quot;, attrs={&quot;w:id&quot;: &quot;1&quot;})
            elem = editor.get_node(tag=&quot;w:p&quot;, attrs={&quot;w14:paraId&quot;: &quot;12345678&quot;})
            elem = editor.get_node(tag=&quot;w:commentRangeStart&quot;, attrs={&quot;w:id&quot;: &quot;0&quot;})
            elem = editor.get_node(tag=&quot;w:p&quot;, contains=&quot;specific text&quot;)
            elem = editor.get_node(tag=&quot;w:t&quot;, contains=&quot;&amp;#8220;Agreement&quot;)  # Entity notation
            elem = editor.get_node(tag=&quot;w:t&quot;, contains=&quot;\u201cAgreement&quot;)   # Unicode character
        &quot;&quot;&quot;
        matches = []
        for elem in self.dom.getElementsByTagName(tag):
            # Check line_number filter
            if line_number is not None:
                parse_pos = getattr(elem, &quot;parse_position&quot;, (None,))
                elem_line = parse_pos[0]

                # Handle both single line number and range
                if isinstance(line_number, range):
                    if elem_line not in line_number:
                        continue
                else:
                    if elem_line != line_number:
                        continue

            # Check attrs filter
            if attrs is not None:
                if not all(
                    elem.getAttribute(attr_name) == attr_value
                    for attr_name, attr_value in attrs.items()
                ):
                    continue

            # Check contains filter
            if contains is not None:
                elem_text = self._get_element_text(elem)
                # Normalize the search string: convert HTML entities to Unicode characters
                # This allows searching for both &quot;&amp;#8220;Rowan&quot; and &quot;&quot;Rowan&quot;
                normalized_contains = html.unescape(contains)
                if normalized_contains not in elem_text:
                    continue

            # If all applicable filters passed, this is a match
            matches.append(elem)

        if not matches:
            # Build descriptive error message
            filters = []
            if line_number is not None:
                line_str = (
                    f&quot;lines {line_number.start}-{line_number.stop - 1}&quot;
                    if isinstance(line_number, range)
                    else f&quot;line {line_number}&quot;
                )
                filters.append(f&quot;at {line_str}&quot;)
            if attrs is not None:
                filters.append(f&quot;with attributes {attrs}&quot;)
            if contains is not None:
                filters.append(f&quot;containing &#x27;{contains}&#x27;&quot;)

            filter_desc = &quot; &quot;.join(filters) if filters else &quot;&quot;
            base_msg = f&quot;Node not found: &lt;{tag}&gt; {filter_desc}&quot;.strip()

            # Add helpful hint based on filters used
            if contains:
                hint = &quot;Text may be split across elements or use different wording.&quot;
            elif line_number:
                hint = &quot;Line numbers may have changed if document was modified.&quot;
            elif attrs:
                hint = &quot;Verify attribute values are correct.&quot;
            else:
                hint = &quot;Try adding filters (attrs, line_number, or contains).&quot;

            raise ValueError(f&quot;{base_msg}. {hint}&quot;)
        if len(matches) &gt; 1:
            raise ValueError(
                f&quot;Multiple nodes found: &lt;{tag}&gt;. &quot;
                f&quot;Add more filters (attrs, line_number, or contains) to narrow the search.&quot;
            )
        return matches[0]

    def _get_element_text(self, elem):
        &quot;&quot;&quot;
        Recursively extract all text content from an element.

        Skips text nodes that contain only whitespace (spaces, tabs, newlines),
        which typically represent XML formatting rather than document content.

        Args:
            elem: defusedxml.minidom.Element to extract text from

        Returns:
            str: Concatenated text from all non-whitespace text nodes within the element
        &quot;&quot;&quot;
        text_parts = []
        for node in elem.childNodes:
            if node.nodeType == node.TEXT_NODE:
                # Skip whitespace-only text nodes (XML formatting)
                if node.data.strip():
                    text_parts.append(node.data)
            elif node.nodeType == node.ELEMENT_NODE:
                text_parts.append(self._get_element_text(node))
        return &quot;&quot;.join(text_parts)

    def replace_node(self, elem, new_content):
        &quot;&quot;&quot;
        Replace a DOM element with new XML content.

        Args:
            elem: defusedxml.minidom.Element to replace
            new_content: String containing XML to replace the node with

        Returns:
            List[defusedxml.minidom.Node]: All inserted nodes

        Example:
            new_nodes = editor.replace_node(old_elem, &quot;&lt;w:r&gt;&lt;w:t&gt;text&lt;/w:t&gt;&lt;/w:r&gt;&quot;)
        &quot;&quot;&quot;
        parent = elem.parentNode
        nodes = self._parse_fragment(new_content)
        for node in nodes:
            parent.insertBefore(node, elem)
        parent.removeChild(elem)
        return nodes

    def insert_after(self, elem, xml_content):
        &quot;&quot;&quot;
        Insert XML content after a DOM element.

        Args:
            elem: defusedxml.minidom.Element to insert after
            xml_content: String containing XML to insert

        Returns:
            List[defusedxml.minidom.Node]: All inserted nodes

        Example:
            new_nodes = editor.insert_after(elem, &quot;&lt;w:r&gt;&lt;w:t&gt;text&lt;/w:t&gt;&lt;/w:r&gt;&quot;)
        &quot;&quot;&quot;
        parent = elem.parentNode
        next_sibling = elem.nextSibling
        nodes = self._parse_fragment(xml_content)
        for node in nodes:
            if next_sibling:
                parent.insertBefore(node, next_sibling)
            else:
                parent.appendChild(node)
        return nodes

    def insert_before(self, elem, xml_content):
        &quot;&quot;&quot;
        Insert XML content before a DOM element.

        Args:
            elem: defusedxml.minidom.Element to insert before
            xml_content: String containing XML to insert

        Returns:
            List[defusedxml.minidom.Node]: All inserted nodes

        Example:
            new_nodes = editor.insert_before(elem, &quot;&lt;w:r&gt;&lt;w:t&gt;text&lt;/w:t&gt;&lt;/w:r&gt;&quot;)
        &quot;&quot;&quot;
        parent = elem.parentNode
        nodes = self._parse_fragment(xml_content)
        for node in nodes:
            parent.insertBefore(node, elem)
        return nodes

    def append_to(self, elem, xml_content):
        &quot;&quot;&quot;
        Append XML content as a child of a DOM element.

        Args:
            elem: defusedxml.minidom.Element to append to
            xml_content: String containing XML to append

        Returns:
            List[defusedxml.minidom.Node]: All inserted nodes

        Example:
            new_nodes = editor.append_to(elem, &quot;&lt;w:r&gt;&lt;w:t&gt;text&lt;/w:t&gt;&lt;/w:r&gt;&quot;)
        &quot;&quot;&quot;
        nodes = self._parse_fragment(xml_content)
        for node in nodes:
            elem.appendChild(node)
        return nodes

    def get_next_rid(self):
        &quot;&quot;&quot;Get the next available rId for relationships files.&quot;&quot;&quot;
        max_id = 0
        for rel_elem in self.dom.getElementsByTagName(&quot;Relationship&quot;):
            rel_id = rel_elem.getAttribute(&quot;Id&quot;)
            if rel_id.startswith(&quot;rId&quot;):
                try:
                    max_id = max(max_id, int(rel_id[3:]))
                except ValueError:
                    pass
        return f&quot;rId{max_id + 1}&quot;

    def save(self):
        &quot;&quot;&quot;
        Save the edited XML back to the file.

        Serializes the DOM tree and writes it back to the original file path,
        preserving the original encoding (ascii or utf-8).
        &quot;&quot;&quot;
        content = self.dom.toxml(encoding=self.encoding)
        self.xml_path.write_bytes(content)

    def _parse_fragment(self, xml_content):
        &quot;&quot;&quot;
        Parse XML fragment and return list of imported nodes.

        Args:
            xml_content: String containing XML fragment

        Returns:
            List of defusedxml.minidom.Node objects imported into this document

        Raises:
            AssertionError: If fragment contains no element nodes
        &quot;&quot;&quot;
        # Extract namespace declarations from the root document element
        root_elem = self.dom.documentElement
        namespaces = []
        if root_elem and root_elem.attributes:
            for i in range(root_elem.attributes.length):
                attr = root_elem.attributes.item(i)
                if attr.name.startswith(&quot;xmlns&quot;):  # type: ignore
                    namespaces.append(f&#x27;{attr.name}=&quot;{attr.value}&quot;&#x27;)  # type: ignore

        ns_decl = &quot; &quot;.join(namespaces)
        wrapper = f&quot;&lt;root {ns_decl}&gt;{xml_content}&lt;/root&gt;&quot;
        fragment_doc = defusedxml.minidom.parseString(wrapper)
        nodes = [
            self.dom.importNode(child, deep=True)
            for child in fragment_doc.documentElement.childNodes  # type: ignore
        ]
        elements = [n for n in nodes if n.nodeType == n.ELEMENT_NODE]
        assert elements, &quot;Fragment must contain at least one element&quot;
        return nodes


def _create_line_tracking_parser():
    &quot;&quot;&quot;
    Create a SAX parser that tracks line and column numbers for each element.

    Monkey patches the SAX content handler to store the current line and column
    position from the underlying expat parser onto each element as a parse_position
    attribute (line, column) tuple.

    Returns:
        defusedxml.sax.xmlreader.XMLReader: Configured SAX parser
    &quot;&quot;&quot;

    def set_content_handler(dom_handler):
        def startElementNS(name, tagName, attrs):
            orig_start_cb(name, tagName, attrs)
            cur_elem = dom_handler.elementStack[-1]
            cur_elem.parse_position = (
                parser._parser.CurrentLineNumber,  # type: ignore
                parser._parser.CurrentColumnNumber,  # type: ignore
            )

        orig_start_cb = dom_handler.startElementNS
        dom_handler.startElementNS = startElementNS
        orig_set_content_handler(dom_handler)

    parser = defusedxml.sax.make_parser()
    orig_set_content_handler = parser.setContentHandler
    parser.setContentHandler = set_content_handler  # type: ignore
    return parser</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/utilities/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/docx/scripts/utilities.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/docx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="validate Imported skill validate from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/pptx/ooxml/scripts/validate.py Unknown LICENSE.txt sources/anthropic/validate/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">validate</div>
                <button class="copy-btn" onclick="copyToClipboard('validate')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill validate from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Command line tool to validate Office document XML files against XSD schemas and tracked changes.

Usage:
    python validate.py &lt;dir&gt; --original &lt;original_file&gt;
&quot;&quot;&quot;

import argparse
import sys
from pathlib import Path

from validation import DOCXSchemaValidator, PPTXSchemaValidator, RedliningValidator


def main():
    parser = argparse.ArgumentParser(description=&quot;Validate Office document XML files&quot;)
    parser.add_argument(
        &quot;unpacked_dir&quot;,
        help=&quot;Path to unpacked Office document directory&quot;,
    )
    parser.add_argument(
        &quot;--original&quot;,
        required=True,
        help=&quot;Path to original file (.docx/.pptx/.xlsx)&quot;,
    )
    parser.add_argument(
        &quot;-v&quot;,
        &quot;--verbose&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Enable verbose output&quot;,
    )
    args = parser.parse_args()

    # Validate paths
    unpacked_dir = Path(args.unpacked_dir)
    original_file = Path(args.original)
    file_extension = original_file.suffix.lower()
    assert unpacked_dir.is_dir(), f&quot;Error: {unpacked_dir} is not a directory&quot;
    assert original_file.is_file(), f&quot;Error: {original_file} is not a file&quot;
    assert file_extension in [&quot;.docx&quot;, &quot;.pptx&quot;, &quot;.xlsx&quot;], (
        f&quot;Error: {original_file} must be a .docx, .pptx, or .xlsx file&quot;
    )

    # Run validations
    match file_extension:
        case &quot;.docx&quot;:
            validators = [DOCXSchemaValidator, RedliningValidator]
        case &quot;.pptx&quot;:
            validators = [PPTXSchemaValidator]
        case _:
            print(f&quot;Error: Validation not supported for file type {file_extension}&quot;)
            sys.exit(1)

    # Run validators
    success = True
    for V in validators:
        validator = V(unpacked_dir, original_file, verbose=args.verbose)
        if not validator.validate():
            success = False

    if success:
        print(&quot;All validations PASSED!&quot;)

    sys.exit(0 if success else 1)


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/validate/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/ooxml/scripts/validate.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/pptx/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="validators Imported skill validators from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/slack-gif-creator/core/validators.py Unknown LICENSE.txt sources/anthropic/validators/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">validators</div>
                <button class="copy-btn" onclick="copyToClipboard('validators')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill validators from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Validators - Check if GIFs meet Slack&#x27;s requirements.

These validators help ensure your GIFs meet Slack&#x27;s size and dimension constraints.
&quot;&quot;&quot;

from pathlib import Path


def validate_gif(
    gif_path: str | Path, is_emoji: bool = True, verbose: bool = True
) -&gt; tuple[bool, dict]:
    &quot;&quot;&quot;
    Validate GIF for Slack (dimensions, size, frame count).

    Args:
        gif_path: Path to GIF file
        is_emoji: True for emoji (128x128 recommended), False for message GIF
        verbose: Print validation details

    Returns:
        Tuple of (passes: bool, results: dict with all details)
    &quot;&quot;&quot;
    from PIL import Image

    gif_path = Path(gif_path)

    if not gif_path.exists():
        return False, {&quot;error&quot;: f&quot;File not found: {gif_path}&quot;}

    # Get file size
    size_bytes = gif_path.stat().st_size
    size_kb = size_bytes / 1024
    size_mb = size_kb / 1024

    # Get dimensions and frame info
    try:
        with Image.open(gif_path) as img:
            width, height = img.size

            # Count frames
            frame_count = 0
            try:
                while True:
                    img.seek(frame_count)
                    frame_count += 1
            except EOFError:
                pass

            # Get duration
            try:
                duration_ms = img.info.get(&quot;duration&quot;, 100)
                total_duration = (duration_ms * frame_count) / 1000
                fps = frame_count / total_duration if total_duration &gt; 0 else 0
            except:
                total_duration = None
                fps = None

    except Exception as e:
        return False, {&quot;error&quot;: f&quot;Failed to read GIF: {e}&quot;}

    # Validate dimensions
    if is_emoji:
        optimal = width == height == 128
        acceptable = width == height and 64 &lt;= width &lt;= 128
        dim_pass = acceptable
    else:
        aspect_ratio = (
            max(width, height) / min(width, height)
            if min(width, height) &gt; 0
            else float(&quot;inf&quot;)
        )
        dim_pass = aspect_ratio &lt;= 2.0 and 320 &lt;= min(width, height) &lt;= 640

    results = {
        &quot;file&quot;: str(gif_path),
        &quot;passes&quot;: dim_pass,
        &quot;width&quot;: width,
        &quot;height&quot;: height,
        &quot;size_kb&quot;: size_kb,
        &quot;size_mb&quot;: size_mb,
        &quot;frame_count&quot;: frame_count,
        &quot;duration_seconds&quot;: total_duration,
        &quot;fps&quot;: fps,
        &quot;is_emoji&quot;: is_emoji,
        &quot;optimal&quot;: optimal if is_emoji else None,
    }

    # Print if verbose
    if verbose:
        print(f&quot;\nValidating {gif_path.name}:&quot;)
        print(
            f&quot;  Dimensions: {width}x{height}&quot;
            + (
                f&quot; ({&#x27;optimal&#x27; if optimal else &#x27;acceptable&#x27;})&quot;
                if is_emoji and acceptable
                else &quot;&quot;
            )
        )
        print(
            f&quot;  Size: {size_kb:.1f} KB&quot;
            + (f&quot; ({size_mb:.2f} MB)&quot; if size_mb &gt;= 1.0 else &quot;&quot;)
        )
        print(
            f&quot;  Frames: {frame_count}&quot;
            + (f&quot; @ {fps:.1f} fps ({total_duration:.1f}s)&quot; if fps else &quot;&quot;)
        )

        if not dim_pass:
            print(
                f&quot;  Note: {&#x27;Emoji should be 128x128&#x27; if is_emoji else &#x27;Unusual dimensions for Slack&#x27;}&quot;
            )

        if size_mb &gt; 5.0:
            print(f&quot;  Note: Large file size - consider fewer frames/colors&quot;)

    return dim_pass, results


def is_slack_ready(
    gif_path: str | Path, is_emoji: bool = True, verbose: bool = True
) -&gt; bool:
    &quot;&quot;&quot;
    Quick check if GIF is ready for Slack.

    Args:
        gif_path: Path to GIF file
        is_emoji: True for emoji GIF, False for message GIF
        verbose: Print feedback

    Returns:
        True if dimensions are acceptable
    &quot;&quot;&quot;
    passes, _ = validate_gif(gif_path, is_emoji, verbose)
    return passes</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/validators/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/slack-gif-creator/core/validators.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/slack-gif-creator/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="workflows Imported skill workflows from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/skill-creator/references/workflows.md Unknown LICENSE.txt sources/anthropic/workflows/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">workflows</div>
                <button class="copy-btn" onclick="copyToClipboard('workflows')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill workflows from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Workflow Patterns

## Sequential Workflows

For complex tasks, break operations into clear, sequential steps. It is often helpful to give Claude an overview of the process towards the beginning of SKILL.md:

```markdown
Filling a PDF form involves these steps:

1. Analyze the form (run analyze_form.py)
2. Create field mapping (edit fields.json)
3. Validate mapping (run validate_fields.py)
4. Fill the form (run fill_form.py)
5. Verify output (run verify_output.py)
```

## Conditional Workflows

For tasks with branching logic, guide Claude through decision points:

```markdown
1. Determine the modification type:
   **Creating new content?**  Follow &quot;Creation workflow&quot; below
   **Editing existing content?**  Follow &quot;Editing workflow&quot; below

2. Creation workflow: [steps]
3. Editing workflow: [steps]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/workflows/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/skill-creator/references/workflows.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/skill-creator/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="worksans_ofl Imported skill worksans_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/WorkSans-OFL.txt Unknown LICENSE.txt sources/anthropic/worksans_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">worksans_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('worksans_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill worksans_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2019 The Work Sans Project Authors (https://github.com/weiweihuanghuang/Work-Sans)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/worksans_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/WorkSans-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="youngserif_ofl Imported skill youngserif_ofl from anthropic anthropic /a0/tmp/skills_research/anthropic/skills/canvas-design/canvas-fonts/YoungSerif-OFL.txt Unknown LICENSE.txt sources/anthropic/youngserif_ofl/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">youngserif_ofl</div>
                <button class="copy-btn" onclick="copyToClipboard('youngserif_ofl')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">anthropic</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill youngserif_ofl from anthropic</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Copyright 2023 The Young Serif Project Authors (https://github.com/noirblancrouge/YoungSerif)

This Font Software is licensed under the SIL Open Font License, Version 1.1.
This license is copied below, and is also available with a FAQ at:
https://openfontlicense.org


-----------------------------------------------------------
SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007
-----------------------------------------------------------

PREAMBLE
The goals of the Open Font License (OFL) are to stimulate worldwide
development of collaborative font projects, to support the font creation
efforts of academic and linguistic communities, and to provide a free and
open framework in which fonts may be shared and improved in partnership
with others.

The OFL allows the licensed fonts to be used, studied, modified and
redistributed freely as long as they are not sold by themselves. The
fonts, including any derivative works, can be bundled, embedded, 
redistributed and/or sold with any software provided that any reserved
names are not used by derivative works. The fonts and derivatives,
however, cannot be released under any other type of license. The
requirement for fonts to remain under this license does not apply
to any document created using the fonts or their derivatives.

DEFINITIONS
&quot;Font Software&quot; refers to the set of files released by the Copyright
Holder(s) under this license and clearly marked as such. This may
include source files, build scripts and documentation.

&quot;Reserved Font Name&quot; refers to any names specified as such after the
copyright statement(s).

&quot;Original Version&quot; refers to the collection of Font Software components as
distributed by the Copyright Holder(s).

&quot;Modified Version&quot; refers to any derivative made by adding to, deleting,
or substituting -- in part or in whole -- any of the components of the
Original Version, by changing formats or by porting the Font Software to a
new environment.

&quot;Author&quot; refers to any designer, engineer, programmer, technical
writer or other person who contributed to the Font Software.

PERMISSION &amp; CONDITIONS
Permission is hereby granted, free of charge, to any person obtaining
a copy of the Font Software, to use, study, copy, merge, embed, modify,
redistribute, and sell modified and unmodified copies of the Font
Software, subject to the following conditions:

1) Neither the Font Software nor any of its individual components,
in Original or Modified Versions, may be sold by itself.

2) Original or Modified Versions of the Font Software may be bundled,
redistributed and/or sold with any software, provided that each copy
contains the above copyright notice and this license. These can be
included either as stand-alone text files, human-readable headers or
in the appropriate machine-readable metadata fields within text or
binary files as long as those fields can be easily viewed by the user.

3) No Modified Version of the Font Software may use the Reserved Font
Name(s) unless explicit written permission is granted by the corresponding
Copyright Holder. This restriction only applies to the primary font name as
presented to the users.

4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font
Software shall not be used to promote, endorse or advertise any
Modified Version, except to acknowledge the contribution(s) of the
Copyright Holder(s) and the Author(s) or with their explicit written
permission.

5) The Font Software, modified or unmodified, in part or in whole,
must be distributed entirely under this license, and must not be
distributed under any other license. The requirement for fonts to
remain under this license does not apply to any document created
using the Font Software.

TERMINATION
This license becomes null and void if any of the above conditions are
not met.

DISCLAIMER
THE FONT SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE
COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM
OTHER DEALINGS IN THE FONT SOFTWARE.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/anthropic/youngserif_ofl/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/canvas-fonts/YoungSerif-OFL.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/anthropics/skills/blob/main/skills/canvas-design/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="bithub.file-io /* global Deno */ // Read file asynchronously export async function readFile(path) { return Deno.readTextFile(path); } bithub https://github.com/bitwikiorg/skills.md 1.0.0 Apache-2.0 sources/bithub/file-io.js js">
            <div class="card-header">
                <div class="skill-title">bithub.file-io</div>
                <button class="copy-btn" onclick="copyToClipboard('bithub.file-io')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">bithub</span>
                <span class="pill">js</span>
                <span class="badge muted">License: Apache-2.0</span>
                <span class="badge muted">Version: 1.0.0</span>
            </div>
            <div class="card-body">/* global Deno */ // Read file asynchronously export async function readFile(path) { return Deno.readTextFile(path); }</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">/* global Deno */
// Read file asynchronously
export async function readFile(path) { return Deno.readTextFile(path); }</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/bithub/file-io.js" class="source-link">Registry File</a>
                    <a href="https://github.com/bitwikiorg/skills.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://spdx.org/licenses/Apache-2.0.html" class="source-link" target="_blank" rel="noopener">License: Apache-2.0</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="__init__ Imported skill __init__ from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/widgets/__init__.py Unknown LICENSE sources/langchain/__init__/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">__init__</div>
                <button class="copy-btn" onclick="copyToClipboard('__init__')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill __init__ from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Textual widgets for deepagents-cli.&quot;&quot;&quot;

from __future__ import annotations

from deepagents_cli.widgets.chat_input import ChatInput
from deepagents_cli.widgets.messages import (
    AssistantMessage,
    DiffMessage,
    ErrorMessage,
    SystemMessage,
    ToolCallMessage,
    UserMessage,
)
from deepagents_cli.widgets.status import StatusBar
from deepagents_cli.widgets.welcome import WelcomeBanner

__all__ = [
    &quot;AssistantMessage&quot;,
    &quot;ChatInput&quot;,
    &quot;DiffMessage&quot;,
    &quot;ErrorMessage&quot;,
    &quot;StatusBar&quot;,
    &quot;SystemMessage&quot;,
    &quot;ToolCallMessage&quot;,
    &quot;UserMessage&quot;,
    &quot;WelcomeBanner&quot;,
]</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/__init__/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="__main__ Imported skill __main__ from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/__main__.py Unknown LICENSE sources/langchain/__main__/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">__main__</div>
                <button class="copy-btn" onclick="copyToClipboard('__main__')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill __main__ from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Allow running the CLI as: python -m deepagents.cli.&quot;&quot;&quot;

from deepagents_cli.main import cli_main

if __name__ == &quot;__main__&quot;:
    cli_main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/__main__/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="_utils Imported skill _utils from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/middleware/_utils.py Unknown LICENSE sources/langchain/_utils/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">_utils</div>
                <button class="copy-btn" onclick="copyToClipboard('_utils')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill _utils from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Utility functions for middleware.&quot;&quot;&quot;

from langchain_core.messages import SystemMessage


def append_to_system_message(
    system_message: SystemMessage | None,
    text: str,
) -&gt; SystemMessage:
    &quot;&quot;&quot;Append text to a system message.

    Args:
        system_message: Existing system message or None.
        text: Text to add to the system message.

    Returns:
        New SystemMessage with the text appended.
    &quot;&quot;&quot;
    new_content: list[str | dict[str, str]] = list(system_message.content_blocks) if system_message else []
    if new_content:
        text = f&quot;\n\n{text}&quot;
    new_content.append({&quot;type&quot;: &quot;text&quot;, &quot;text&quot;: text})
    return SystemMessage(content=new_content)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/_utils/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/middleware/_utils.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="_version Imported skill _version from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/_version.py Unknown LICENSE sources/langchain/_version/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">_version</div>
                <button class="copy-btn" onclick="copyToClipboard('_version')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill _version from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Version information for deepagents-cli.&quot;&quot;&quot;

__version__ = &quot;0.0.13a2&quot;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/_version/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="agent Imported skill agent from langchain langchain /a0/tmp/skills_research/langchain/examples/text-to-sql-agent/agent.py Unknown LICENSE sources/langchain/agent/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">agent</div>
                <button class="copy-btn" onclick="copyToClipboard('agent')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill agent from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">import os
import sys
import argparse
from dotenv import load_dotenv
from langchain_community.utilities import SQLDatabase
from langchain_community.agent_toolkits import SQLDatabaseToolkit
from deepagents import create_deep_agent
from deepagents.backends import FilesystemBackend
from langchain_anthropic import ChatAnthropic
from rich.console import Console
from rich.panel import Panel

# Load environment variables
load_dotenv()

console = Console()


def create_sql_deep_agent():
    &quot;&quot;&quot;Create and return a text-to-SQL Deep Agent&quot;&quot;&quot;

    # Get base directory
    base_dir = os.path.dirname(os.path.abspath(__file__))

    # Connect to Chinook database
    db_path = os.path.join(base_dir, &quot;chinook.db&quot;)
    db = SQLDatabase.from_uri(
        f&quot;sqlite:///{db_path}&quot;,
        sample_rows_in_table_info=3
    )

    # Initialize Claude Sonnet 4.5 for toolkit initialization
    model = ChatAnthropic(
        model=&quot;claude-sonnet-4-5-20250929&quot;,
        temperature=0
    )

    # Create SQL toolkit and get tools
    toolkit = SQLDatabaseToolkit(db=db, llm=model)
    sql_tools = toolkit.get_tools()

    # Create the Deep Agent with all parameters
    agent = create_deep_agent(
        model=model,                                  # Claude Sonnet 4.5 with temperature=0
        memory=[&quot;./AGENTS.md&quot;],                       # Agent identity and general instructions
        skills=[&quot;./skills/&quot;],                         # Specialized workflows (query-writing, schema-exploration)
        tools=sql_tools,                              # SQL database tools
        subagents=[],                                 # No subagents needed
        backend=FilesystemBackend(root_dir=base_dir)  # Persistent file storage
    )

    return agent


def main():
    &quot;&quot;&quot;Main entry point for the SQL Deep Agent CLI&quot;&quot;&quot;
    parser = argparse.ArgumentParser(
        description=&quot;Text-to-SQL Deep Agent powered by LangChain DeepAgents and Claude Sonnet 4.5&quot;,
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog=&quot;&quot;&quot;
Examples:
  python agent.py &quot;What are the top 5 best-selling artists?&quot;
  python agent.py &quot;Which employee generated the most revenue by country?&quot;
  python agent.py &quot;How many customers are from Canada?&quot;
        &quot;&quot;&quot;
    )
    parser.add_argument(
        &quot;question&quot;,
        type=str,
        help=&quot;Natural language question to answer using the Chinook database&quot;
    )

    args = parser.parse_args()

    # Display the question
    console.print(Panel(
        f&quot;[bold cyan]Question:[/bold cyan] {args.question}&quot;,
        border_style=&quot;cyan&quot;
    ))
    console.print()

    # Create the agent
    console.print(&quot;[dim]Creating SQL Deep Agent...[/dim]&quot;)
    agent = create_sql_deep_agent()

    # Invoke the agent
    console.print(&quot;[dim]Processing query...[/dim]\n&quot;)

    try:
        result = agent.invoke({
            &quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: args.question}]
        })

        # Extract and display the final answer
        final_message = result[&quot;messages&quot;][-1]
        answer = final_message.content if hasattr(final_message, &#x27;content&#x27;) else str(final_message)

        console.print(Panel(
            f&quot;[bold green]Answer:[/bold green]\n\n{answer}&quot;,
            border_style=&quot;green&quot;
        ))

    except Exception as e:
        console.print(Panel(
            f&quot;[bold red]Error:[/bold red]\n\n{str(e)}&quot;,
            border_style=&quot;red&quot;
        ))
        sys.exit(1)


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/agent/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="agents Imported skill agents from langchain langchain /a0/tmp/skills_research/langchain/examples/content-builder-agent/AGENTS.md Unknown LICENSE sources/langchain/agents/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">agents</div>
                <button class="copy-btn" onclick="copyToClipboard('agents')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill agents from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Content Writer Agent

You are a content writer for a technology company. Your job is to create engaging, informative content that educates readers about AI, software development, and emerging technologies.

## Brand Voice

- **Professional but approachable**: Write like a knowledgeable colleague, not a textbook
- **Clear and direct**: Avoid jargon unless necessary; explain technical concepts simply
- **Confident but not arrogant**: Share expertise without being condescending
- **Engaging**: Use concrete examples, analogies, and stories to illustrate points

## Writing Standards

1. **Use active voice**: &quot;The agent processes requests&quot; not &quot;Requests are processed by the agent&quot;
2. **Lead with value**: Start with what matters to the reader, not background
3. **One idea per paragraph**: Keep paragraphs focused and scannable
4. **Concrete over abstract**: Use specific examples, numbers, and case studies
5. **End with action**: Every piece should leave the reader knowing what to do next

## Content Pillars

Our content focuses on:
- AI agents and automation
- Developer tools and productivity
- Software architecture and best practices
- Emerging technologies and trends

## Formatting Guidelines

- Use headers (H2, H3) to break up long content
- Include code examples where relevant (with syntax highlighting)
- Add bullet points for lists of 3+ items
- Keep sentences under 25 words when possible
- Include a clear call-to-action at the end

## Research Requirements

Before writing on any topic:
1. Use the `researcher` subagent for in-depth topic research
2. Gather at least 3 credible sources
3. Identify the key points readers need to understand
4. Find concrete examples or case studies to illustrate concepts</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/agents/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="analyze Imported skill analyze from langchain langchain /a0/tmp/skills_research/langchain/libs/harbor/scripts/analyze.py Unknown LICENSE sources/langchain/analyze/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">analyze</div>
                <button class="copy-btn" onclick="copyToClipboard('analyze')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill analyze from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;Analyze job trials from a jobs directory.

Scans through trial directories, extracts trajectory data and success metrics.
&quot;&quot;&quot;

import argparse
import asyncio
import json
from dataclasses import dataclass
from enum import Enum
from pathlib import Path
from typing import Optional

from deepagents import create_deep_agent


def scan_dataset_for_solutions(dataset_path: Path) -&gt; dict[str, Path]:
    &quot;&quot;&quot;Scan a dataset directory and create a mapping from task names to solution paths.

    Args:
        dataset_path: Path to the dataset directory (e.g., terminal-bench/)

    Returns:
        Dictionary mapping task names to their solution/solve.sh paths
        Example: {&quot;chess-best-move&quot;: Path(&quot;terminal-bench/7bFm.../chess-best-move/solution/solve.sh&quot;)}
    &quot;&quot;&quot;
    task_to_solution: dict[str, Path] = {}

    if not dataset_path.exists():
        print(f&quot;Warning: Dataset path {dataset_path} does not exist&quot;)
        return task_to_solution

    # Iterate through hash directories
    for hash_dir in dataset_path.iterdir():
        if not hash_dir.is_dir():
            continue

        # Iterate through task directories within each hash
        for task_dir in hash_dir.iterdir():
            if not task_dir.is_dir():
                continue

            # Check if this is a valid task directory (has solution/solve.sh)
            solution_path = task_dir / &quot;solution&quot; / &quot;solve.sh&quot;
            if solution_path.exists():
                task_name = task_dir.name
                # Store the mapping (if task appears multiple times, last one wins)
                task_to_solution[task_name] = solution_path

    return task_to_solution


def find_task_directory(trial_dir: Path, task_name: str, task_source: str) -&gt; Optional[Path]:
    &quot;&quot;&quot;Find the task directory for a given trial.

    Args:
        trial_dir: Path to the trial directory
        task_name: Name of the task (from config.json)
        task_source: Source of the task (e.g., &quot;terminal-bench&quot;)

    Returns:
        Path to the task directory if found, None otherwise
    &quot;&quot;&quot;
    # Start from the trial directory and search for the task directory
    # The structure is typically: {task_source}/{hash}/{task_name}

    # Go up to find the task source directory
    current = trial_dir.parent.parent  # Go up from trial to jobs root
    task_source_dir = current / task_source

    if not task_source_dir.exists():
        return None

    # Search for the task in any hash subdirectory
    for hash_dir in task_source_dir.iterdir():
        if hash_dir.is_dir():
            task_dir = hash_dir / task_name
            if task_dir.exists():
                return task_dir

    return None


class TrialStatus(Enum):
    &quot;&quot;&quot;Status of a trial execution.&quot;&quot;&quot;

    PENDING = &quot;pending&quot;
    COMPLETED = &quot;completed&quot;
    FAILED = &quot;failed&quot;


@dataclass
class Trial:
    &quot;&quot;&quot;Metadata for a single trial run.&quot;&quot;&quot;

    trial_id: str
    status: TrialStatus
    reward: Optional[bool] = None
    trajectory_path: Optional[Path] = None
    reward_path: Optional[Path] = None
    exception_path: Optional[Path] = None
    solution_path: Optional[Path] = None
    trial_dir: Optional[Path] = None
    tool_usage: Optional[dict[str, int]] = None


async def parse_reward(reward_path: Path) -&gt; bool:
    &quot;&quot;&quot;Parse the reward file. Returns True if reward is 1, False otherwise.&quot;&quot;&quot;
    content = reward_path.read_text()
    reward_value = content.strip()
    return reward_value == &quot;1&quot;


def extract_task_metadata(trial_dir: Path) -&gt; dict:
    &quot;&quot;&quot;Extract task metadata from config.json and other files.

    Args:
        trial_dir: Path to the trial directory

    Returns:
        Dictionary containing task metadata
    &quot;&quot;&quot;
    metadata = {}

    # Read config.json
    config_path = trial_dir / &quot;config.json&quot;
    if config_path.exists():
        try:
            with open(config_path, &quot;r&quot;) as f:
                config = json.load(f)
                metadata[&quot;task_name&quot;] = config.get(&quot;task&quot;, {}).get(&quot;path&quot;, &quot;&quot;)
                metadata[&quot;task_source&quot;] = config.get(&quot;task&quot;, {}).get(&quot;source&quot;, &quot;&quot;)
                metadata[&quot;git_url&quot;] = config.get(&quot;task&quot;, {}).get(&quot;git_url&quot;, &quot;&quot;)
                metadata[&quot;git_commit_id&quot;] = config.get(&quot;task&quot;, {}).get(&quot;git_commit_id&quot;, &quot;&quot;)
        except Exception:
            pass

    # Read result.json for additional metadata
    result_path = trial_dir / &quot;result.json&quot;
    if result_path.exists():
        try:
            with open(result_path, &quot;r&quot;) as f:
                result = json.load(f)
                metadata[&quot;reward&quot;] = (
                    result.get(&quot;verifier_result&quot;, {}).get(&quot;rewards&quot;, {}).get(&quot;reward&quot;, 0.0)
                )
                metadata[&quot;started_at&quot;] = result.get(&quot;started_at&quot;, &quot;&quot;)
                metadata[&quot;finished_at&quot;] = result.get(&quot;finished_at&quot;, &quot;&quot;)
        except Exception:
            pass

    return metadata


def extract_task_instructions(trajectory_path: Path) -&gt; Optional[str]:
    &quot;&quot;&quot;Extract the task instructions from the trajectory file.

    Looks for the user message in the trajectory steps.
    &quot;&quot;&quot;
    try:
        with open(trajectory_path, &quot;r&quot;) as f:
            trajectory_data = json.load(f)

        # Find the user message in the steps
        for step in trajectory_data.get(&quot;steps&quot;, []):
            if step.get(&quot;source&quot;) == &quot;user&quot;:
                return step.get(&quot;message&quot;, &quot;&quot;)

        return None
    except Exception:
        return None


def count_tool_usage(trajectory_path: Path) -&gt; dict[str, int]:
    &quot;&quot;&quot;Count tool usage across all steps in a trajectory.

    Args:
        trajectory_path: Path to the trajectory.json file in ATIF format

    Returns:
        Dictionary mapping tool names to their usage counts
    &quot;&quot;&quot;
    tool_counts: dict[str, int] = {}

    try:
        with open(trajectory_path, &quot;r&quot;) as f:
            trajectory_data = json.load(f)

        # Iterate through all steps
        for step in trajectory_data.get(&quot;steps&quot;, []):
            # Check if this step has tool calls
            tool_calls = step.get(&quot;tool_calls&quot;)
            if tool_calls:
                # Count each tool call
                for tool_call in tool_calls:
                    tool_name = tool_call.get(&quot;function_name&quot;, &quot;unknown&quot;)
                    tool_counts[tool_name] = tool_counts.get(tool_name, 0) + 1

        return tool_counts
    except Exception:
        return {}


def get_task_name_from_trial(trial_dir: Path) -&gt; Optional[str]:
    &quot;&quot;&quot;Extract the task name from a trial&#x27;s config.json.

    Args:
        trial_dir: Path to the trial directory

    Returns:
        Task name if found, None otherwise
    &quot;&quot;&quot;
    config_path = trial_dir / &quot;config.json&quot;
    if config_path.exists():
        try:
            with open(config_path, &quot;r&quot;) as f:
                config = json.load(f)
                return config.get(&quot;task&quot;, {}).get(&quot;path&quot;, &quot;&quot;)
        except Exception:
            pass
    return None


def enrich_trials_with_solutions(
    trials: list[Trial], solution_mapping: dict[str, Path]
) -&gt; list[Trial]:
    &quot;&quot;&quot;Update trials with solution paths from a pre-computed solution mapping.

    Args:
        trials: List of Trial objects to enrich
        solution_mapping: Dictionary mapping task names to solution paths

    Returns:
        The same list of trials (modified in place) for convenience
    &quot;&quot;&quot;
    for trial in trials:
        if trial.trial_dir:
            task_name = get_task_name_from_trial(trial.trial_dir)
            if task_name and task_name in solution_mapping:
                trial.solution_path = solution_mapping[task_name]
    return trials


async def analyze_trial(
    trial_dir: Path, solution_mapping: Optional[dict[str, Path]] = None
) -&gt; Optional[Trial]:
    &quot;&quot;&quot;Analyze a single trial directory.

    Returns a Trial object even if trajectory or reward files are missing so incomplete
    trials can be reported.

    Status is determined as follows:
    - FAILED: If exception.txt exists or reward is False
    - COMPLETED: If reward is True
    - PENDING: Otherwise (no reward, no exception)
    &quot;&quot;&quot;
    trajectory_path = trial_dir / &quot;agent&quot; / &quot;trajectory.json&quot;
    reward_path = trial_dir / &quot;verifier&quot; / &quot;reward.txt&quot;
    exception_path = trial_dir / &quot;exception.txt&quot;

    # Read config to find the task directory for the solution
    config_path = trial_dir / &quot;config.json&quot;
    solution_path = None

    # First try to use the solution_mapping if provided
    if solution_mapping:
        task_name = get_task_name_from_trial(trial_dir)
        if task_name and task_name in solution_mapping:
            solution_path = solution_mapping[task_name]

    # Fall back to searching for the task directory
    if not solution_path and config_path.exists():
        try:
            with open(config_path, &quot;r&quot;) as f:
                config = json.load(f)
                task_name = config.get(&quot;task&quot;, {}).get(&quot;path&quot;, &quot;&quot;)
                task_source = config.get(&quot;task&quot;, {}).get(&quot;source&quot;, &quot;&quot;)
                if task_name and task_source:
                    task_dir = find_task_directory(trial_dir, task_name, task_source)
                    if task_dir:
                        solution_path = task_dir / &quot;solution&quot; / &quot;solve.sh&quot;
        except Exception:
            pass

    traj_exists = trajectory_path.exists()
    reward_exists = reward_path.exists()
    exception_exists = exception_path.exists()
    solution_exists = solution_path and solution_path.exists()

    reward_value: Optional[bool]
    if reward_exists:
        reward_value = reward_path.read_text().strip() == &quot;1&quot;
    else:
        reward_value = None

    # Determine status
    if exception_exists:
        status = TrialStatus.FAILED
    elif reward_value is True:
        status = TrialStatus.COMPLETED
    elif reward_value is False:
        status = TrialStatus.FAILED
    else:
        status = TrialStatus.PENDING

    # Count tool usage if trajectory exists
    tool_usage = None
    if traj_exists:
        tool_usage = count_tool_usage(trajectory_path)

    trial_id = trial_dir.name
    return Trial(
        trial_id=trial_id,
        status=status,
        reward=reward_value,
        trajectory_path=trajectory_path if traj_exists else None,
        reward_path=reward_path if reward_exists else None,
        exception_path=exception_path if exception_exists else None,
        solution_path=solution_path if solution_exists else None,
        trial_dir=trial_dir,
        tool_usage=tool_usage,
    )


async def scan_jobs_directory(
    jobs_dir: Path, solution_mapping: Optional[dict[str, Path]] = None
) -&gt; list[Trial]:
    &quot;&quot;&quot;Scan the jobs directory and extract all trial metadata.

    Args:
        jobs_dir: Path to the jobs directory containing trial subdirectories
        solution_mapping: Optional pre-computed mapping from task names to solution paths.
                         If not provided, solutions will be searched for individually.
    &quot;&quot;&quot;
    if not jobs_dir.exists():
        print(f&quot;Error: Directory {jobs_dir} does not exist&quot;)
        return []

    # List all directories within jobs_dir - each directory is a trial
    trial_dirs: list[Path] = [d for d in jobs_dir.iterdir() if d.is_dir()]

    print(f&quot;Found {len(trial_dirs)} trial directories&quot;)

    trials: list[Trial] = []
    for trial_dir in trial_dirs:
        trial = await analyze_trial(trial_dir, solution_mapping=solution_mapping)
        trials.append(trial)
    return trials


def print_summary(trials: list[Trial]) -&gt; None:
    &quot;&quot;&quot;Print a summary of the analyzed trials.&quot;&quot;&quot;
    print(&quot;\n&quot; + &quot;=&quot; * 80)
    print(&quot;ANALYSIS SUMMARY&quot;)
    print(&quot;=&quot; * 80)
    print(f&quot;Total trials: {len(trials)}&quot;)

    completed = sum(1 for t in trials if t.status == TrialStatus.COMPLETED)
    failed = sum(1 for t in trials if t.status == TrialStatus.FAILED)
    pending = sum(1 for t in trials if t.status == TrialStatus.PENDING)

    print(f&quot;Completed: {completed}&quot;)
    print(f&quot;Failed: {failed}&quot;)
    print(f&quot;Pending: {pending}&quot;)

    if trials:
        complete_trials = completed + failed
        if complete_trials &gt; 0:
            success_rate = (completed / complete_trials) * 100
            print(f&quot;Success rate (excluding pending): {success_rate:.1f}%&quot;)

        # Also show success rate including pending trials
        total_trials = len(trials)
        if total_trials &gt; 0:
            overall_success_rate = (completed / total_trials) * 100
            print(f&quot;Success rate (of all trials): {overall_success_rate:.1f}%&quot;)

    # Compute overall tool usage across all trials
    overall_tool_usage: dict[str, int] = {}
    trials_with_tools = 0
    for trial in trials:
        if trial.tool_usage:
            trials_with_tools += 1
            for tool_name, count in trial.tool_usage.items():
                overall_tool_usage[tool_name] = overall_tool_usage.get(tool_name, 0) + count

    if overall_tool_usage:
        print(f&quot;\n{&#x27;=&#x27; * 80}&quot;)
        print(&quot;OVERALL TOOL USAGE&quot;)
        print(f&quot;{&#x27;=&#x27; * 80}&quot;)
        print(f&quot;Trials with tool usage data: {trials_with_tools}/{len(trials)}&quot;)
        print(&quot;\nTool usage across all trials:&quot;)
        # Sort by usage count (descending) then alphabetically
        sorted_overall_tools = sorted(overall_tool_usage.items(), key=lambda x: (-x[1], x[0]))
        for tool_name, count in sorted_overall_tools:
            print(f&quot;  {tool_name}: {count}&quot;)

    print(&quot;\n&quot; + &quot;=&quot; * 80)
    print(&quot;TRIAL DETAILS&quot;)
    print(&quot;=&quot; * 80)

    # Sort trials: COMPLETED first, then FAILED, then PENDING
    status_order = {TrialStatus.COMPLETED: 0, TrialStatus.FAILED: 1, TrialStatus.PENDING: 2}
    sorted_trials = sorted(trials, key=lambda t: status_order[t.status])

    for trial in sorted_trials:
        if trial.status == TrialStatus.COMPLETED:
            status = &quot; COMPLETED&quot;
        elif trial.status == TrialStatus.FAILED:
            status = &quot; FAILED&quot;
        else:
            status = &quot; PENDING&quot;

        print(f&quot;\n{status} | {trial.trial_id}&quot;)

        if trial.trajectory_path:
            print(f&quot;  Trajectory: {trial.trajectory_path}&quot;)
        else:
            print(&quot;  Trajectory: MISSING&quot;)

        if trial.reward_path:
            print(f&quot;  Reward file: {trial.reward_path}&quot;)
        else:
            print(&quot;  Reward file: MISSING&quot;)

        if trial.exception_path and trial.exception_path.exists():
            try:
                exception_content = trial.exception_path.read_text()
                # Show last 100 characters
                exception_snippet = (
                    exception_content[-100:] if len(exception_content) &gt; 100 else exception_content
                )
                print(f&quot;  Exception: ...{exception_snippet}&quot;)
            except Exception:
                print(&quot;  Exception: [Error reading exception file]&quot;)

        # Display tool usage if available
        if trial.tool_usage:
            # Sort tools by usage count (descending) then alphabetically
            sorted_tools = sorted(trial.tool_usage.items(), key=lambda x: (-x[1], x[0]))
            tool_summary = &quot;, &quot;.join([f&quot;{tool}: {count}&quot; for tool, count in sorted_tools])
            print(f&quot;  Tool usage: {tool_summary}&quot;)


ANALYSIS_PROMPT = &quot;&quot;&quot;\
# Trajectory Analysis Prompt

You are analyzing an agent execution trajectory. Your goal is to identify what happened during execution and, if the trial failed, determine why.

## IMPORTANT: Trial Status

The trial status will be explicitly provided to you. This status is the ground truth:
- **FAILED**: The agent did not successfully complete the task (reward = 0 or exception occurred)
- **PENDING**: The trial has not finished executing yet
- **COMPLETED**: The agent successfully completed the task (reward = 1)

**If the status is FAILED, then something went wrong, even if the agent reported success or the trajectory appears successful.** Your job is to identify what went wrong by carefully examining the details.

## Reference Solution

A reference solution script (solve.sh) will be provided when available. This script shows the correct approach to solving the task. Use this to:
- Compare the agent&#x27;s approach against the known working solution
- Identify where the agent&#x27;s actions diverged from the correct approach
- Understand what steps or commands the agent missed or executed incorrectly
- Determine if the agent used different tools/methods that led to failure

## Trajectory Format

The trajectory is in ATIF (Agent Trajectory Interchange Format) with sequential steps:
- `source`: Who generated the step (system/user/agent)
- `message`: The content of the step
- `tool_calls`: (if present) Tools the agent attempted to use
- `observation`: (if present) Results from tool execution

## Analysis Task

Review the trajectory with careful attention to subtle details and provide:

### 1. FAILURE IDENTIFICATION (for FAILED trials)

**Start by comparing the user&#x27;s request to the agent&#x27;s actual actions:**
- What exactly did the user ask for? (Quote the specific request)
- What exactly did the agent do? (Quote the actual tool calls and parameters)
- If a reference solution is provided, how does the agent&#x27;s approach differ from it?
- Are there any discrepancies between what was requested and what was executed?

**Then identify:**
- **Failure Step**: Which step number failed or where did things go wrong?
- **What Failed**: Describe what went wrong (tool error, incorrect logic, incomplete execution, subtle mistakes, etc.)
- **Error Details**: Quote any error messages or failure indicators
- **Subtle Issues**: Look for problems that aren&#x27;t obvious errors - small differences in parameters, values, or execution that don&#x27;t match the request

**Special Case: Max Iterations Reached**
If the agent failed due to reaching the maximum iteration/recursion limit:
- **Evaluate Progress**: Was the agent making sensible progress toward the solution?
- **Direction Assessment**: Were the agent&#x27;s actions moving it closer to completing the task?
- **Correctness**: Despite not finishing, were the steps taken correct and logical?
- **Compare to Solution**: If a reference solution is provided, was the agent following a similar approach?
- **Estimate Completion**: How close was the agent to completing the task when it hit the limit?
- **Root Cause**: Was the limit hit due to:
  - Agent making good progress but task simply required more steps?
  - Agent spinning in circles or repeating ineffective actions?
  - Agent pursuing a suboptimal approach that would take too many steps?
  - Agent getting stuck on a subtask or error recovery loop?

### 2. EXECUTION ANALYSIS
- **What the Agent Did**: Trace the agent&#x27;s actions step by step
- **What Was Expected**: Based on the user&#x27;s request and reference solution (if provided), what should have happened?
- **Where It Went Wrong**: Identify the specific point where the agent&#x27;s actions diverged from what was needed
- **Tool Usage**: Examine all tool parameters carefully - verify they match what the user requested

### 3. ROOT CAUSE
Determine the underlying cause:
- Is this incorrect tool usage (wrong tool or wrong parameters)?
- Is this a logical/reasoning error (agent made wrong decision)?
- Is this a tool execution error (tool failed or returned error)?
- Is this incomplete execution (agent stopped too early)?
- Is this a resource/permission error?
- Is this agent confusion about the task requirements?
- Is this a subtle parameter mismatch (values that look correct but differ from the request)?

### 4. SUGGESTED IMPROVEMENTS
If clear from the trajectory, suggest:
- What the agent should have done differently (reference the solution script if available)
- Which component or capability needs improvement
- How to prevent this type of failure

## Guidelines

- **Pay close attention to details**: Even if the agent reported success, if the trial failed, find what went wrong
- **Use the reference solution**: When provided, compare the agent&#x27;s approach systematically against it
- Look for subtle issues like path mistakes, incorrect values, or logical errors
- Be concise but specific
- Quote exact error messages when present
- Focus on actionable insights
- Identify patterns in agent behavior that led to failure
- Don&#x27;t assume the agent is correct just because it reported success
&quot;&quot;&quot;  # noqa: E501


async def analyze_failed_trial(trial: Trial, analyze_pending: bool = False) -&gt; Optional[str]:
    &quot;&quot;&quot;
    Run deep agent analysis on a failed or pending trial trajectory.

    Args:
        trial: The trial to analyze
        analyze_pending: If True, analyze pending trials in addition to failed ones

    Returns:
        Analysis result as a string, or None if trajectory cannot be read
    &quot;&quot;&quot;
    # Create the deep agent for trajectory analysis
    analysis_agent = create_deep_agent(tools=[], system_prompt=ANALYSIS_PROMPT)

    # Skip completed trials
    if trial.status == TrialStatus.COMPLETED:
        return None

    # Skip pending trials unless explicitly requested
    if trial.status == TrialStatus.PENDING and not analyze_pending:
        return None

    if not trial.trajectory_path or not trial.trajectory_path.exists():
        return None

    # Read the trajectory file
    with open(trial.trajectory_path, &quot;r&quot;) as f:
        trajectory_data = json.load(f)

    # Format trajectory as JSON string for the prompt
    trajectory_json = json.dumps(trajectory_data, indent=2)

    # Read the solution script if available
    solution_content = None
    if trial.solution_path and trial.solution_path.exists():
        solution_content = trial.solution_path.read_text()

    # Create the user message with the trajectory and explicit status
    status_desc = &quot;failed&quot; if trial.status == TrialStatus.FAILED else &quot;pending&quot;
    status_upper = trial.status.value.upper()
    user_message = f&quot;**TRIAL STATUS: {status_upper}**\n\n&quot;

    # Add reference solution if available
    if solution_content:
        user_message += (
            f&quot;**REFERENCE SOLUTION (solve.sh):**\n\n```bash\n{solution_content}\n```\n\n&quot;
        )
    else:
        user_message += &quot;**REFERENCE SOLUTION:** Not provided\n\n&quot;

    user_message += (
        f&quot;Please analyze this {status_desc} agent trajectory:\n\n```json\n{trajectory_json}\n```\n&quot;
    )

    # Run the deep agent analysis
    result = analysis_agent.invoke({&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: user_message}]})

    # Extract the analysis from the response
    analysis = result[&quot;messages&quot;][-1].content
    return analysis


async def write_trial_analysis(
    trial: Trial,
    trial_dir: Path,
    output_dir: Path,
    summary_only: bool = False,
    analyze_pending: bool = False,
) -&gt; Optional[Path]:
    &quot;&quot;&quot;
    Analyze a failed or pending trial and write the results to a file.

    Args:
        trial: The trial to analyze
        trial_dir: Path to the trial directory
        output_dir: Directory where analysis files should be written
        summary_only: If True, skip LLM analysis and only write metadata summary
        analyze_pending: If True, analyze pending trials in addition to failed ones

    Returns:
        Path to the written analysis file, or None if analysis was skipped
    &quot;&quot;&quot;
    # Skip completed trials
    if trial.status == TrialStatus.COMPLETED:
        return None

    # Skip pending trials unless explicitly requested
    if trial.status == TrialStatus.PENDING and not analyze_pending:
        return None

    # Extract metadata
    metadata = extract_task_metadata(trial_dir)

    # Extract task instructions
    task_instructions = None
    if trial.trajectory_path:
        task_instructions = extract_task_instructions(trial.trajectory_path)

    # Run the LLM analysis unless summary_only is True
    analysis = None
    if not summary_only:
        analysis = await analyze_failed_trial(trial, analyze_pending=analyze_pending)
        if not analysis:
            # If we couldn&#x27;t get analysis (e.g., missing trajectory), skip this trial
            return None

    # Create output file
    output_dir.mkdir(parents=True, exist_ok=True)
    output_file = output_dir / f&quot;{trial.trial_id}.md&quot;

    # Write the analysis with metadata
    with open(output_file, &quot;w&quot;) as f:
        f.write(f&quot;# Analysis: {trial.trial_id}\n\n&quot;)

        # Write metadata section
        f.write(&quot;## Task Metadata\n\n&quot;)
        f.write(f&quot;- **Trial ID**: {trial.trial_id}\n&quot;)
        f.write(f&quot;- **Status**: {trial.status.value}\n&quot;)
        f.write(f&quot;- **Task Name**: {metadata.get(&#x27;task_name&#x27;, &#x27;N/A&#x27;)}\n&quot;)
        f.write(f&quot;- **Task Source**: {metadata.get(&#x27;task_source&#x27;, &#x27;N/A&#x27;)}\n&quot;)
        f.write(f&quot;- **Reward**: {metadata.get(&#x27;reward&#x27;, 0.0)}\n&quot;)

        if metadata.get(&quot;git_url&quot;):
            f.write(f&quot;- **Git URL**: {metadata[&#x27;git_url&#x27;]}\n&quot;)
        if metadata.get(&quot;git_commit_id&quot;):
            f.write(f&quot;- **Git Commit**: {metadata[&#x27;git_commit_id&#x27;]}\n&quot;)
        if metadata.get(&quot;started_at&quot;):
            f.write(f&quot;- **Started**: {metadata[&#x27;started_at&#x27;]}\n&quot;)
        if metadata.get(&quot;finished_at&quot;):
            f.write(f&quot;- **Finished**: {metadata[&#x27;finished_at&#x27;]}\n&quot;)

        # Write task instructions
        if task_instructions:
            f.write(&quot;\n## Task Instructions\n\n&quot;)
            f.write(&quot;```\n&quot;)
            f.write(task_instructions)
            f.write(&quot;\n```\n&quot;)

        # Write the analysis if not summary_only
        if analysis:
            f.write(&quot;\n## Failure Analysis\n\n&quot;)
            f.write(analysis)
            f.write(&quot;\n&quot;)
        elif summary_only:
            f.write(&quot;\n## Analysis\n\n&quot;)
            f.write(&quot;*Summary only mode - detailed LLM analysis skipped*\n&quot;)

    return output_file


async def main():
    &quot;&quot;&quot;Main entry point.&quot;&quot;&quot;
    parser = argparse.ArgumentParser(description=&quot;Analyze job trials from a jobs directory&quot;)
    parser.add_argument(
        &quot;jobs_dir&quot;, type=Path, help=&quot;Path to the jobs directory (e.g., jobs-terminal-bench/)&quot;
    )
    parser.add_argument(
        &quot;--dataset&quot;,
        &quot;-d&quot;,
        type=Path,
        help=&quot;Path to the dataset directory (e.g., terminal-bench/) to scan for solution files&quot;,
    )
    parser.add_argument(
        &quot;--output-dir&quot;,
        type=Path,
        help=&quot;Output directory for detailed analysis files (one per failed/pending trial)&quot;,
    )
    parser.add_argument(
        &quot;--summary-only&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Only print summary, skip detailed LLM analysis of trials&quot;,
    )
    parser.add_argument(
        &quot;--analyze-pending&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Analyze pending trials in addition to failed trials&quot;,
    )
    parser.add_argument(
        &quot;--json&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Output results as JSON instead of human-readable format&quot;,
    )

    args = parser.parse_args()

    # Scan dataset for solutions if provided
    solution_mapping = None
    if args.dataset:
        print(f&quot;Scanning dataset directory: {args.dataset}&quot;)
        solution_mapping = scan_dataset_for_solutions(args.dataset)
        print(f&quot;Found {len(solution_mapping)} tasks with solutions\n&quot;)

    # Scan and analyze all trials
    trials = await scan_jobs_directory(args.jobs_dir, solution_mapping=solution_mapping)

    # Print human-readable summary
    print_summary(trials)

    # If output directory specified, run analysis on trials
    if args.output_dir:
        # Determine which trials to analyze based on status
        trials_to_analyze = [
            t for t in trials
            if t.status == TrialStatus.FAILED or (args.analyze_pending and t.status == TrialStatus.PENDING)
        ]

        if not trials_to_analyze:
            status_desc = &quot;failed or pending&quot; if args.analyze_pending else &quot;failed&quot;
            print(f&quot;\nNo {status_desc} trials to analyze.&quot;)
        else:
            print(f&quot;\n{&#x27;=&#x27; * 80}&quot;)
            analysis_mode = &quot;SUMMARY&quot; if args.summary_only else &quot;DEEP ANALYSIS&quot;
            trial_types = &quot;FAILED/PENDING&quot; if args.analyze_pending else &quot;FAILED&quot;
            print(f&quot;RUNNING {analysis_mode} ON {trial_types} TRIALS&quot;)
            print(f&quot;{&#x27;=&#x27; * 80}&quot;)
            print(f&quot;Processing {len(trials_to_analyze)} trials...&quot;)
            print(f&quot;Output directory: {args.output_dir}&quot;)
            if args.summary_only:
                print(&quot;Mode: Summary only (LLM analysis disabled)&quot;)
            if args.analyze_pending:
                print(&quot;Mode: Including pending trials&quot;)
            print()

            # Analyze each trial
            for i, trial in enumerate(trials_to_analyze, 1):
                status_label = trial.status.value.upper()
                print(f&quot;[{i}/{len(trials_to_analyze)}] Analyzing {trial.trial_id} ({status_label})...&quot;)

                if trial.trial_dir is None:
                    print(f&quot;  Warning: No trial directory found for {trial.trial_id}&quot;)
                    continue

                # Run the analysis and write to file
                try:
                    output_file = await write_trial_analysis(
                        trial,
                        trial.trial_dir,
                        args.output_dir,
                        summary_only=args.summary_only,
                        analyze_pending=args.analyze_pending,
                    )
                    if output_file:
                        print(f&quot;   Analysis written to: {output_file}&quot;)
                    else:
                        print(&quot;   Skipped (no trajectory or already completed)&quot;)
                except Exception as e:
                    print(f&quot;   Error: {e}&quot;)

            print(f&quot;\n{&#x27;=&#x27; * 80}&quot;)
            print(f&quot;Analysis complete. Results saved to: {args.output_dir}&quot;)
            print(f&quot;{&#x27;=&#x27; * 80}&quot;)


if __name__ == &quot;__main__&quot;:
    asyncio.run(main())</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/analyze/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="app Imported skill app from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/app.py Unknown LICENSE sources/langchain/app/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">app</div>
                <button class="copy-btn" onclick="copyToClipboard('app')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill app from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Textual UI application for deepagents-cli.&quot;&quot;&quot;
# ruff: noqa: BLE001, PLR0912, PLR2004, S110, SIM108

from __future__ import annotations

import asyncio
import contextlib
import subprocess
import uuid
from pathlib import Path
from typing import TYPE_CHECKING, Any, ClassVar

from textual.app import App
from textual.binding import Binding, BindingType
from textual.containers import Container, VerticalScroll
from textual.css.query import NoMatches
from textual.events import Click, MouseUp  # noqa: TC002 - used in type annotation
from textual.widgets import Static  # noqa: TC002 - used at runtime

from deepagents_cli.clipboard import copy_selection_to_clipboard
from deepagents_cli.textual_adapter import TextualUIAdapter, execute_task_textual
from deepagents_cli.widgets.approval import ApprovalMenu
from deepagents_cli.widgets.chat_input import ChatInput
from deepagents_cli.widgets.loading import LoadingWidget
from deepagents_cli.widgets.messages import (
    AssistantMessage,
    ErrorMessage,
    SystemMessage,
    ToolCallMessage,
    UserMessage,
)
from deepagents_cli.widgets.status import StatusBar
from deepagents_cli.widgets.welcome import WelcomeBanner

if TYPE_CHECKING:
    from langgraph.pregel import Pregel
    from textual.app import ComposeResult
    from textual.worker import Worker


class TextualTokenTracker:
    &quot;&quot;&quot;Token tracker that updates the status bar.&quot;&quot;&quot;

    def __init__(self, update_callback: callable, hide_callback: callable | None = None) -&gt; None:
        &quot;&quot;&quot;Initialize with callbacks to update the display.&quot;&quot;&quot;
        self._update_callback = update_callback
        self._hide_callback = hide_callback
        self.current_context = 0

    def add(self, total_tokens: int, _output_tokens: int = 0) -&gt; None:
        &quot;&quot;&quot;Update token count from a response.

        Args:
            total_tokens: Total context tokens (input + output from usage_metadata)
            _output_tokens: Unused, kept for backwards compatibility
        &quot;&quot;&quot;
        self.current_context = total_tokens
        self._update_callback(self.current_context)

    def reset(self) -&gt; None:
        &quot;&quot;&quot;Reset token count.&quot;&quot;&quot;
        self.current_context = 0
        self._update_callback(0)

    def hide(self) -&gt; None:
        &quot;&quot;&quot;Hide the token display (e.g., during streaming).&quot;&quot;&quot;
        if self._hide_callback:
            self._hide_callback()

    def show(self) -&gt; None:
        &quot;&quot;&quot;Show the token display with current value (e.g., after interrupt).&quot;&quot;&quot;
        self._update_callback(self.current_context)


class TextualSessionState:
    &quot;&quot;&quot;Session state for the Textual app.&quot;&quot;&quot;

    def __init__(
        self,
        *,
        auto_approve: bool = False,
        thread_id: str | None = None,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize session state.

        Args:
            auto_approve: Whether to auto-approve tool calls
            thread_id: Optional thread ID (generates 8-char hex if not provided)
        &quot;&quot;&quot;
        self.auto_approve = auto_approve
        self.thread_id = thread_id if thread_id else uuid.uuid4().hex[:8]

    def reset_thread(self) -&gt; str:
        &quot;&quot;&quot;Reset to a new thread. Returns the new thread_id.&quot;&quot;&quot;
        self.thread_id = uuid.uuid4().hex[:8]
        return self.thread_id


class DeepAgentsApp(App):
    &quot;&quot;&quot;Main Textual application for deepagents-cli.&quot;&quot;&quot;

    TITLE = &quot;DeepAgents&quot;
    CSS_PATH = &quot;app.tcss&quot;
    ENABLE_COMMAND_PALETTE = False

    # Slow down scroll speed (default is 3 lines per scroll event)
    # Using 0.25 to require 4 scroll events per line - very smooth
    SCROLL_SENSITIVITY_Y = 0.25

    BINDINGS: ClassVar[list[BindingType]] = [
        Binding(&quot;escape&quot;, &quot;interrupt&quot;, &quot;Interrupt&quot;, show=False, priority=True),
        Binding(&quot;ctrl+c&quot;, &quot;quit_or_interrupt&quot;, &quot;Quit/Interrupt&quot;, show=False),
        Binding(&quot;ctrl+d&quot;, &quot;quit_app&quot;, &quot;Quit&quot;, show=False, priority=True),
        Binding(&quot;ctrl+t&quot;, &quot;toggle_auto_approve&quot;, &quot;Toggle Auto-Approve&quot;, show=False),
        Binding(
            &quot;shift+tab&quot;, &quot;toggle_auto_approve&quot;, &quot;Toggle Auto-Approve&quot;, show=False, priority=True
        ),
        Binding(&quot;ctrl+o&quot;, &quot;toggle_tool_output&quot;, &quot;Toggle Tool Output&quot;, show=False),
        # Approval menu keys (handled at App level for reliability)
        Binding(&quot;up&quot;, &quot;approval_up&quot;, &quot;Up&quot;, show=False),
        Binding(&quot;k&quot;, &quot;approval_up&quot;, &quot;Up&quot;, show=False),
        Binding(&quot;down&quot;, &quot;approval_down&quot;, &quot;Down&quot;, show=False),
        Binding(&quot;j&quot;, &quot;approval_down&quot;, &quot;Down&quot;, show=False),
        Binding(&quot;enter&quot;, &quot;approval_select&quot;, &quot;Select&quot;, show=False),
        Binding(&quot;y&quot;, &quot;approval_yes&quot;, &quot;Yes&quot;, show=False),
        Binding(&quot;1&quot;, &quot;approval_yes&quot;, &quot;Yes&quot;, show=False),
        Binding(&quot;n&quot;, &quot;approval_no&quot;, &quot;No&quot;, show=False),
        Binding(&quot;2&quot;, &quot;approval_no&quot;, &quot;No&quot;, show=False),
        Binding(&quot;a&quot;, &quot;approval_auto&quot;, &quot;Auto&quot;, show=False),
        Binding(&quot;3&quot;, &quot;approval_auto&quot;, &quot;Auto&quot;, show=False),
    ]

    def __init__(
        self,
        *,
        agent: Pregel | None = None,
        assistant_id: str | None = None,
        backend: Any = None,  # noqa: ANN401  # CompositeBackend
        auto_approve: bool = False,
        cwd: str | Path | None = None,
        thread_id: str | None = None,
        initial_prompt: str | None = None,
        **kwargs: Any,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize the DeepAgents application.

        Args:
            agent: Pre-configured LangGraph agent (optional for standalone mode)
            assistant_id: Agent identifier for memory storage
            backend: Backend for file operations
            auto_approve: Whether to start with auto-approve enabled
            cwd: Current working directory to display
            thread_id: Optional thread ID for session persistence
            initial_prompt: Optional prompt to auto-submit when session starts
            **kwargs: Additional arguments passed to parent
        &quot;&quot;&quot;
        super().__init__(**kwargs)
        self._agent = agent
        self._assistant_id = assistant_id
        self._backend = backend
        self._auto_approve = auto_approve
        self._cwd = str(cwd) if cwd else str(Path.cwd())
        # Avoid collision with App._thread_id
        self._lc_thread_id = thread_id
        self._initial_prompt = initial_prompt
        self._status_bar: StatusBar | None = None
        self._chat_input: ChatInput | None = None
        self._quit_pending = False
        self._session_state: TextualSessionState | None = None
        self._ui_adapter: TextualUIAdapter | None = None
        self._pending_approval: asyncio.Future | None = None
        self._pending_approval_widget: Any = None
        # Agent task tracking for interruption
        self._agent_worker: Worker[None] | None = None
        self._agent_running = False
        self._loading_widget: LoadingWidget | None = None
        self._token_tracker: TextualTokenTracker | None = None

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the application layout.&quot;&quot;&quot;
        # Main chat area with scrollable messages
        with VerticalScroll(id=&quot;chat&quot;):
            yield WelcomeBanner(id=&quot;welcome-banner&quot;)
            yield Container(id=&quot;messages&quot;)  # Container can have children mounted

        # Bottom app container - holds either ChatInput OR ApprovalMenu (swapped)
        # This is OUTSIDE VerticalScroll so arrow keys work in approval
        with Container(id=&quot;bottom-app-container&quot;):
            yield ChatInput(cwd=self._cwd, id=&quot;input-area&quot;)

        # Status bar at bottom
        yield StatusBar(cwd=self._cwd, id=&quot;status-bar&quot;)

    async def on_mount(self) -&gt; None:
        &quot;&quot;&quot;Initialize components after mount.&quot;&quot;&quot;
        self._status_bar = self.query_one(&quot;#status-bar&quot;, StatusBar)
        self._chat_input = self.query_one(&quot;#input-area&quot;, ChatInput)

        # Set initial auto-approve state
        if self._auto_approve:
            self._status_bar.set_auto_approve(enabled=True)

        # Create session state
        self._session_state = TextualSessionState(
            auto_approve=self._auto_approve,
            thread_id=self._lc_thread_id,
        )

        # Create token tracker that updates status bar
        self._token_tracker = TextualTokenTracker(self._update_tokens, self._hide_tokens)

        # Create UI adapter if agent is provided
        if self._agent:
            self._ui_adapter = TextualUIAdapter(
                mount_message=self._mount_message,
                update_status=self._update_status,
                request_approval=self._request_approval,
                on_auto_approve_enabled=self._on_auto_approve_enabled,
                scroll_to_bottom=self._scroll_chat_to_bottom,
            )
            self._ui_adapter.set_token_tracker(self._token_tracker)

        # Focus the input (autocomplete is now built into ChatInput)
        self._chat_input.focus_input()

        # Auto-submit initial prompt if provided
        if self._initial_prompt and self._initial_prompt.strip():
            # Use call_after_refresh to ensure UI is fully mounted before submitting
            self.call_after_refresh(
                lambda: asyncio.create_task(self._handle_user_message(self._initial_prompt))
            )

    def _update_status(self, message: str) -&gt; None:
        &quot;&quot;&quot;Update the status bar with a message.&quot;&quot;&quot;
        if self._status_bar:
            self._status_bar.set_status_message(message)

    def _update_tokens(self, count: int) -&gt; None:
        &quot;&quot;&quot;Update the token count in status bar.&quot;&quot;&quot;
        if self._status_bar:
            self._status_bar.set_tokens(count)

    def _hide_tokens(self) -&gt; None:
        &quot;&quot;&quot;Hide the token display during streaming.&quot;&quot;&quot;
        if self._status_bar:
            self._status_bar.hide_tokens()

    def _scroll_chat_to_bottom(self) -&gt; None:
        &quot;&quot;&quot;Scroll the chat area to the bottom.

        Uses anchor() for smoother streaming - keeps scroll locked to bottom
        as new content is added without causing visual jumps.
        &quot;&quot;&quot;
        try:
            chat = self.query_one(&quot;#chat&quot;, VerticalScroll)
            # anchor() locks scroll to bottom and auto-scrolls as content grows
            # Much smoother than calling scroll_end() on every chunk
            chat.anchor()
        except NoMatches:
            pass

    async def _request_approval(
        self,
        action_request: Any,  # noqa: ANN401
        assistant_id: str | None,
    ) -&gt; asyncio.Future:
        &quot;&quot;&quot;Request user approval inline in the messages area.

        Returns a Future that resolves to the user&#x27;s decision.
        Mounts ApprovalMenu in the messages area (inline with chat).
        ChatInput stays visible - user can still see it.

        If another approval is already pending, queue this one.
        &quot;&quot;&quot;
        loop = asyncio.get_running_loop()
        result_future: asyncio.Future = loop.create_future()

        # If there&#x27;s already a pending approval, wait for it to complete first
        if self._pending_approval_widget is not None:
            while self._pending_approval_widget is not None:  # noqa: ASYNC110
                await asyncio.sleep(0.1)

        # Create menu with unique ID to avoid conflicts
        unique_id = f&quot;approval-menu-{uuid.uuid4().hex[:8]}&quot;
        menu = ApprovalMenu(action_request, assistant_id, id=unique_id)
        menu.set_future(result_future)

        # Store reference
        self._pending_approval_widget = menu

        # Pause the loading spinner during approval
        if self._loading_widget:
            self._loading_widget.pause(&quot;Awaiting decision&quot;)

        # Update status to show we&#x27;re waiting for approval
        self._update_status(&quot;Waiting for approval...&quot;)

        # Mount approval inline in messages area (not replacing ChatInput)
        try:
            messages = self.query_one(&quot;#messages&quot;, Container)
            await messages.mount(menu)
            self._scroll_chat_to_bottom()
            # Focus approval menu
            self.call_after_refresh(menu.focus)
        except Exception as e:
            self._pending_approval_widget = None
            if not result_future.done():
                result_future.set_exception(e)

        return result_future

    def _on_auto_approve_enabled(self) -&gt; None:
        &quot;&quot;&quot;Callback when auto-approve mode is enabled via HITL.&quot;&quot;&quot;
        self._auto_approve = True
        if self._status_bar:
            self._status_bar.set_auto_approve(enabled=True)
        if self._session_state:
            self._session_state.auto_approve = True

    async def on_chat_input_submitted(self, event: ChatInput.Submitted) -&gt; None:
        &quot;&quot;&quot;Handle submitted input from ChatInput widget.&quot;&quot;&quot;
        value = event.value
        mode = event.mode

        # Reset quit pending state on any input
        self._quit_pending = False

        # Handle different modes
        if mode == &quot;bash&quot;:
            # Bash command - strip the ! prefix
            await self._handle_bash_command(value.removeprefix(&quot;!&quot;))
        elif mode == &quot;command&quot;:
            # Slash command
            await self._handle_command(value)
        else:
            # Normal message - will be sent to agent
            await self._handle_user_message(value)

    def on_chat_input_mode_changed(self, event: ChatInput.ModeChanged) -&gt; None:
        &quot;&quot;&quot;Update status bar when input mode changes.&quot;&quot;&quot;
        if self._status_bar:
            self._status_bar.set_mode(event.mode)

    async def on_approval_menu_decided(
        self,
        event: Any,  # noqa: ANN401, ARG002
    ) -&gt; None:
        &quot;&quot;&quot;Handle approval menu decision - remove from messages and refocus input.&quot;&quot;&quot;
        # Remove ApprovalMenu using stored reference
        if self._pending_approval_widget:
            await self._pending_approval_widget.remove()
            self._pending_approval_widget = None

        # Resume the loading spinner after approval
        if self._loading_widget:
            self._loading_widget.resume()

        # Clear status message
        self._update_status(&quot;&quot;)

        # Refocus the chat input
        if self._chat_input:
            self.call_after_refresh(self._chat_input.focus_input)

    async def _handle_bash_command(self, command: str) -&gt; None:
        &quot;&quot;&quot;Handle a bash command (! prefix).

        Args:
            command: The bash command to execute
        &quot;&quot;&quot;
        # Mount user message showing the bash command
        await self._mount_message(UserMessage(f&quot;!{command}&quot;))

        # Execute the bash command (shell=True is intentional for user-requested bash)
        try:
            result = await asyncio.to_thread(  # noqa: S604
                subprocess.run,
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=self._cwd,
                timeout=60,
            )
            output = result.stdout.strip()
            if result.stderr:
                output += f&quot;\n[stderr]\n{result.stderr.strip()}&quot;

            if output:
                # Display output as assistant message (uses markdown for code blocks)
                msg = AssistantMessage(f&quot;```\n{output}\n```&quot;)
                await self._mount_message(msg)
                await msg.write_initial_content()
            else:
                await self._mount_message(SystemMessage(&quot;Command completed (no output)&quot;))

            if result.returncode != 0:
                await self._mount_message(ErrorMessage(f&quot;Exit code: {result.returncode}&quot;))

            # Scroll to show the output
            self._scroll_chat_to_bottom()

        except subprocess.TimeoutExpired:
            await self._mount_message(ErrorMessage(&quot;Command timed out (60s limit)&quot;))
        except OSError as e:
            await self._mount_message(ErrorMessage(str(e)))

    async def _handle_command(self, command: str) -&gt; None:
        &quot;&quot;&quot;Handle a slash command.

        Args:
            command: The slash command (including /)
        &quot;&quot;&quot;
        cmd = command.lower().strip()

        if cmd in (&quot;/quit&quot;, &quot;/exit&quot;, &quot;/q&quot;):
            self.exit()
        elif cmd == &quot;/help&quot;:
            await self._mount_message(UserMessage(command))
            await self._mount_message(
                SystemMessage(&quot;Commands: /quit, /clear, /tokens, /threads, /help&quot;)
            )

        elif cmd == &quot;/version&quot;:
            await self._mount_message(UserMessage(command))
            # Show CLI package version
            try:
                from deepagents_cli._version import __version__

                await self._mount_message(SystemMessage(f&quot;deepagents version: {__version__}&quot;))
            except Exception:
                await self._mount_message(SystemMessage(&quot;deepagents version: unknown&quot;))
        elif cmd == &quot;/clear&quot;:
            await self._clear_messages()
            if self._token_tracker:
                self._token_tracker.reset()
            # Clear status message (e.g., &quot;Interrupted&quot; from previous session)
            self._update_status(&quot;&quot;)
            # Reset thread to start fresh conversation
            if self._session_state:
                new_thread_id = self._session_state.reset_thread()
                await self._mount_message(SystemMessage(f&quot;Started new session: {new_thread_id}&quot;))
        elif cmd == &quot;/threads&quot;:
            await self._mount_message(UserMessage(command))
            if self._session_state:
                await self._mount_message(
                    SystemMessage(f&quot;Current session: {self._session_state.thread_id}&quot;)
                )
            else:
                await self._mount_message(SystemMessage(&quot;No active session&quot;))
        elif cmd == &quot;/tokens&quot;:
            await self._mount_message(UserMessage(command))
            if self._token_tracker and self._token_tracker.current_context &gt; 0:
                count = self._token_tracker.current_context
                if count &gt;= 1000:
                    formatted = f&quot;{count / 1000:.1f}K&quot;
                else:
                    formatted = str(count)
                await self._mount_message(SystemMessage(f&quot;Current context: {formatted} tokens&quot;))
            else:
                await self._mount_message(SystemMessage(&quot;No token usage yet&quot;))
        else:
            await self._mount_message(UserMessage(command))
            await self._mount_message(SystemMessage(f&quot;Unknown command: {cmd}&quot;))

    async def _handle_user_message(self, message: str) -&gt; None:
        &quot;&quot;&quot;Handle a user message to send to the agent.

        Args:
            message: The user&#x27;s message
        &quot;&quot;&quot;
        # Mount the user message
        await self._mount_message(UserMessage(message))

        # Check if agent is available
        if self._agent and self._ui_adapter and self._session_state:
            # Show loading widget
            self._loading_widget = LoadingWidget(&quot;Thinking&quot;)
            await self._mount_message(self._loading_widget)
            self._agent_running = True

            # Disable cursor blink while agent is working
            if self._chat_input:
                self._chat_input.set_cursor_active(active=False)

            # Use run_worker to avoid blocking the main event loop
            # This allows the UI to remain responsive during agent execution
            self._agent_worker = self.run_worker(
                self._run_agent_task(message),
                exclusive=False,
            )
        else:
            await self._mount_message(
                SystemMessage(&quot;Agent not configured. Run with --agent flag or use standalone mode.&quot;)
            )

    async def _run_agent_task(self, message: str) -&gt; None:
        &quot;&quot;&quot;Run the agent task in a background worker.

        This runs in a worker thread so the main event loop stays responsive.
        &quot;&quot;&quot;
        try:
            await execute_task_textual(
                user_input=message,
                agent=self._agent,
                assistant_id=self._assistant_id,
                session_state=self._session_state,
                adapter=self._ui_adapter,
                backend=self._backend,
            )
        except Exception as e:
            await self._mount_message(ErrorMessage(f&quot;Agent error: {e}&quot;))
        finally:
            # Clean up loading widget and agent state
            await self._cleanup_agent_task()

    async def _cleanup_agent_task(self) -&gt; None:
        &quot;&quot;&quot;Clean up after agent task completes or is cancelled.&quot;&quot;&quot;
        self._agent_running = False
        self._agent_worker = None

        # Remove loading widget if present
        if self._loading_widget:
            with contextlib.suppress(Exception):
                await self._loading_widget.remove()
            self._loading_widget = None

        # Re-enable cursor blink now that agent is done
        if self._chat_input:
            self._chat_input.set_cursor_active(active=True)

        # Ensure token display is restored (in case of early cancellation)
        if self._token_tracker:
            self._token_tracker.show()

    async def _mount_message(self, widget: Static) -&gt; None:
        &quot;&quot;&quot;Mount a message widget to the messages area.

        Args:
            widget: The message widget to mount
        &quot;&quot;&quot;
        try:
            messages = self.query_one(&quot;#messages&quot;, Container)
            await messages.mount(widget)
            # Scroll to bottom
            chat = self.query_one(&quot;#chat&quot;, VerticalScroll)
            chat.scroll_end(animate=False)
        except NoMatches:
            pass

    async def _clear_messages(self) -&gt; None:
        &quot;&quot;&quot;Clear the messages area.&quot;&quot;&quot;
        try:
            messages = self.query_one(&quot;#messages&quot;, Container)
            await messages.remove_children()
        except NoMatches:
            # Widget not found - can happen during shutdown
            pass

    def action_quit_or_interrupt(self) -&gt; None:
        &quot;&quot;&quot;Handle Ctrl+C - interrupt agent, reject approval, or quit on double press.

        Priority order:
        1. If agent is running, interrupt it (preserve input)
        2. If approval menu is active, reject it
        3. If double press (quit_pending), quit
        4. Otherwise show quit hint
        &quot;&quot;&quot;
        # If agent is running, interrupt it
        if self._agent_running and self._agent_worker:
            self._agent_worker.cancel()
            self._quit_pending = False
            return

        # If approval menu is active, reject it
        if self._pending_approval_widget:
            self._pending_approval_widget.action_select_reject()
            self._quit_pending = False
            return

        # Double Ctrl+C to quit
        if self._quit_pending:
            self.exit()
        else:
            self._quit_pending = True
            self.notify(&quot;Press Ctrl+C again to quit&quot;, timeout=3)

    def action_interrupt(self) -&gt; None:
        &quot;&quot;&quot;Handle escape key - interrupt agent or reject approval.

        This is the primary way to stop a running agent.
        &quot;&quot;&quot;
        # If agent is running, interrupt it
        if self._agent_running and self._agent_worker:
            self._agent_worker.cancel()
            return

        # If approval menu is active, reject it
        if self._pending_approval_widget:
            self._pending_approval_widget.action_select_reject()

    def action_quit_app(self) -&gt; None:
        &quot;&quot;&quot;Handle quit action (Ctrl+D).&quot;&quot;&quot;
        self.exit()

    def action_toggle_auto_approve(self) -&gt; None:
        &quot;&quot;&quot;Toggle auto-approve mode.&quot;&quot;&quot;
        self._auto_approve = not self._auto_approve
        if self._status_bar:
            self._status_bar.set_auto_approve(enabled=self._auto_approve)
        if self._session_state:
            self._session_state.auto_approve = self._auto_approve

    def action_toggle_tool_output(self) -&gt; None:
        &quot;&quot;&quot;Toggle expand/collapse of the most recent tool output.&quot;&quot;&quot;
        # Find all tool messages with output, get the most recent one
        try:
            tool_messages = list(self.query(ToolCallMessage))
            # Find ones with output, toggle the most recent
            for tool_msg in reversed(tool_messages):
                if tool_msg.has_output:
                    tool_msg.toggle_output()
                    return
        except Exception:
            pass

    # Approval menu action handlers (delegated from App-level bindings)
    # NOTE: These only activate when approval widget is pending AND input is not focused
    def action_approval_up(self) -&gt; None:
        &quot;&quot;&quot;Handle up arrow in approval menu.&quot;&quot;&quot;
        # Only handle if approval is active (input handles its own up for history/completion)
        if self._pending_approval_widget and not self._is_input_focused():
            self._pending_approval_widget.action_move_up()

    def action_approval_down(self) -&gt; None:
        &quot;&quot;&quot;Handle down arrow in approval menu.&quot;&quot;&quot;
        if self._pending_approval_widget and not self._is_input_focused():
            self._pending_approval_widget.action_move_down()

    def action_approval_select(self) -&gt; None:
        &quot;&quot;&quot;Handle enter in approval menu.&quot;&quot;&quot;
        # Only handle if approval is active AND input is not focused
        if self._pending_approval_widget and not self._is_input_focused():
            self._pending_approval_widget.action_select()

    def _is_input_focused(self) -&gt; bool:
        &quot;&quot;&quot;Check if the chat input (or its text area) has focus.&quot;&quot;&quot;
        if not self._chat_input:
            return False
        focused = self.focused
        if focused is None:
            return False
        # Check if focused widget is the text area inside chat input
        return focused.id == &quot;chat-input&quot; or focused in self._chat_input.walk_children()

    def action_approval_yes(self) -&gt; None:
        &quot;&quot;&quot;Handle yes/1 in approval menu.&quot;&quot;&quot;
        if self._pending_approval_widget:
            self._pending_approval_widget.action_select_approve()

    def action_approval_no(self) -&gt; None:
        &quot;&quot;&quot;Handle no/2 in approval menu.&quot;&quot;&quot;
        if self._pending_approval_widget:
            self._pending_approval_widget.action_select_reject()

    def action_approval_auto(self) -&gt; None:
        &quot;&quot;&quot;Handle auto/3 in approval menu.&quot;&quot;&quot;
        if self._pending_approval_widget:
            self._pending_approval_widget.action_select_auto()

    def action_approval_escape(self) -&gt; None:
        &quot;&quot;&quot;Handle escape in approval menu - reject.&quot;&quot;&quot;
        if self._pending_approval_widget:
            self._pending_approval_widget.action_select_reject()

    def on_click(self, _event: Click) -&gt; None:
        &quot;&quot;&quot;Handle clicks anywhere in the terminal to focus on the command line.&quot;&quot;&quot;
        if not self._chat_input:
            return

        self.call_after_refresh(self._chat_input.focus_input)

    def on_mouse_up(self, event: MouseUp) -&gt; None:  # noqa: ARG002
        &quot;&quot;&quot;Copy selection to clipboard on mouse release.&quot;&quot;&quot;
        copy_selection_to_clipboard(self)


async def run_textual_app(
    *,
    agent: Pregel | None = None,
    assistant_id: str | None = None,
    backend: Any = None,  # noqa: ANN401  # CompositeBackend
    auto_approve: bool = False,
    cwd: str | Path | None = None,
    thread_id: str | None = None,
    initial_prompt: str | None = None,
) -&gt; None:
    &quot;&quot;&quot;Run the Textual application.

    Args:
        agent: Pre-configured LangGraph agent (optional)
        assistant_id: Agent identifier for memory storage
        backend: Backend for file operations
        auto_approve: Whether to start with auto-approve enabled
        cwd: Current working directory to display
        thread_id: Optional thread ID for session persistence
        initial_prompt: Optional prompt to auto-submit when session starts
    &quot;&quot;&quot;
    app = DeepAgentsApp(
        agent=agent,
        assistant_id=assistant_id,
        backend=backend,
        auto_approve=auto_approve,
        cwd=cwd,
        thread_id=thread_id,
        initial_prompt=initial_prompt,
    )
    await app.run_async()


if __name__ == &quot;__main__&quot;:
    import asyncio

    asyncio.run(run_textual_app())</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/app/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="approval Imported skill approval from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/widgets/approval.py Unknown LICENSE sources/langchain/approval/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">approval</div>
                <button class="copy-btn" onclick="copyToClipboard('approval')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill approval from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Approval widget for HITL - using standard Textual patterns.&quot;&quot;&quot;

from __future__ import annotations

import asyncio
from typing import Any, ClassVar

from textual import events
from textual.app import ComposeResult
from textual.binding import Binding, BindingType
from textual.containers import Container, Vertical, VerticalScroll
from textual.message import Message
from textual.widgets import Static

from deepagents_cli.widgets.tool_renderers import get_renderer


class ApprovalMenu(Container):
    &quot;&quot;&quot;Approval menu using standard Textual patterns.

    Key design decisions (following mistral-vibe reference):
    - Container base class with compose()
    - BINDINGS for key handling (not on_key)
    - can_focus_children = False to prevent focus theft
    - Simple Static widgets for options
    - Standard message posting
    - Tool-specific widgets via renderer pattern
    &quot;&quot;&quot;

    can_focus = True
    can_focus_children = False

    # CSS is in app.tcss - no DEFAULT_CSS needed

    BINDINGS: ClassVar[list[BindingType]] = [
        Binding(&quot;up&quot;, &quot;move_up&quot;, &quot;Up&quot;, show=False),
        Binding(&quot;k&quot;, &quot;move_up&quot;, &quot;Up&quot;, show=False),
        Binding(&quot;down&quot;, &quot;move_down&quot;, &quot;Down&quot;, show=False),
        Binding(&quot;j&quot;, &quot;move_down&quot;, &quot;Down&quot;, show=False),
        Binding(&quot;enter&quot;, &quot;select&quot;, &quot;Select&quot;, show=False),
        Binding(&quot;1&quot;, &quot;select_approve&quot;, &quot;Approve&quot;, show=False),
        Binding(&quot;y&quot;, &quot;select_approve&quot;, &quot;Approve&quot;, show=False),
        Binding(&quot;2&quot;, &quot;select_reject&quot;, &quot;Reject&quot;, show=False),
        Binding(&quot;n&quot;, &quot;select_reject&quot;, &quot;Reject&quot;, show=False),
        Binding(&quot;3&quot;, &quot;select_auto&quot;, &quot;Auto-approve&quot;, show=False),
        Binding(&quot;a&quot;, &quot;select_auto&quot;, &quot;Auto-approve&quot;, show=False),
    ]

    class Decided(Message):
        &quot;&quot;&quot;Message sent when user makes a decision.&quot;&quot;&quot;

        def __init__(self, decision: dict[str, str]) -&gt; None:
            super().__init__()
            self.decision = decision

    def __init__(
        self,
        action_request: dict[str, Any],
        assistant_id: str | None = None,
        id: str | None = None,  # noqa: A002
        **kwargs: Any,
    ) -&gt; None:
        super().__init__(id=id or &quot;approval-menu&quot;, classes=&quot;approval-menu&quot;, **kwargs)
        self._action_request = action_request
        self._assistant_id = assistant_id
        self._tool_name = action_request.get(&quot;name&quot;, &quot;unknown&quot;)
        self._tool_args = action_request.get(&quot;args&quot;, {})
        self._description = action_request.get(&quot;description&quot;, &quot;&quot;)
        self._selected = 0
        self._future: asyncio.Future[dict[str, str]] | None = None
        self._option_widgets: list[Static] = []
        self._tool_info_container: Vertical | None = None

    def set_future(self, future: asyncio.Future[dict[str, str]]) -&gt; None:
        &quot;&quot;&quot;Set the future to resolve when user decides.&quot;&quot;&quot;
        self._future = future

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the widget with Static children.

        Layout prioritizes options visibility - they appear at the top so users
        always see them even in small terminals.
        &quot;&quot;&quot;
        # Title
        yield Static(
            f&quot;&gt;&gt;&gt; {self._tool_name} Requires Approval &lt;&lt;&lt;&quot;,
            classes=&quot;approval-title&quot;,
        )

        # Options container FIRST - always visible at top
        with Container(classes=&quot;approval-options-container&quot;):
            # Options - create 3 Static widgets
            for i in range(3):
                widget = Static(&quot;&quot;, classes=&quot;approval-option&quot;)
                self._option_widgets.append(widget)
                yield widget

        # Help text right after options
        yield Static(
            &quot;/ navigate  Enter select  y/n/a quick keys&quot;,
            classes=&quot;approval-help&quot;,
        )

        # Separator between options and tool details
        yield Static(&quot;&quot; * 40, classes=&quot;approval-separator&quot;)

        # Tool info in scrollable container BELOW options
        with VerticalScroll(classes=&quot;tool-info-scroll&quot;):
            self._tool_info_container = Vertical(classes=&quot;tool-info-container&quot;)
            yield self._tool_info_container

    async def on_mount(self) -&gt; None:
        &quot;&quot;&quot;Focus self on mount and update tool info.&quot;&quot;&quot;
        await self._update_tool_info()
        self._update_options()
        self.focus()

    async def _update_tool_info(self) -&gt; None:
        &quot;&quot;&quot;Mount the tool-specific approval widget.&quot;&quot;&quot;
        if not self._tool_info_container:
            return

        # Get the appropriate renderer for this tool
        renderer = get_renderer(self._tool_name)
        widget_class, data = renderer.get_approval_widget(self._tool_args)

        # Clear existing content and mount new widget
        await self._tool_info_container.remove_children()
        approval_widget = widget_class(data)
        await self._tool_info_container.mount(approval_widget)

    def _update_options(self) -&gt; None:
        &quot;&quot;&quot;Update option widgets based on selection.&quot;&quot;&quot;
        options = [
            &quot;1. Approve (y)&quot;,
            &quot;2. Reject (n)&quot;,
            &quot;3. Auto-approve all this session (a)&quot;,
        ]

        for i, (text, widget) in enumerate(zip(options, self._option_widgets, strict=True)):
            cursor = &quot; &quot; if i == self._selected else &quot;  &quot;
            widget.update(f&quot;{cursor}{text}&quot;)

            # Update classes
            widget.remove_class(&quot;approval-option-selected&quot;)
            if i == self._selected:
                widget.add_class(&quot;approval-option-selected&quot;)

    def action_move_up(self) -&gt; None:
        &quot;&quot;&quot;Move selection up.&quot;&quot;&quot;
        self._selected = (self._selected - 1) % 3
        self._update_options()

    def action_move_down(self) -&gt; None:
        &quot;&quot;&quot;Move selection down.&quot;&quot;&quot;
        self._selected = (self._selected + 1) % 3
        self._update_options()

    def action_select(self) -&gt; None:
        &quot;&quot;&quot;Select current option.&quot;&quot;&quot;
        self._handle_selection(self._selected)

    def action_select_approve(self) -&gt; None:
        &quot;&quot;&quot;Select approve option.&quot;&quot;&quot;
        self._selected = 0
        self._update_options()
        self._handle_selection(0)

    def action_select_reject(self) -&gt; None:
        &quot;&quot;&quot;Select reject option.&quot;&quot;&quot;
        self._selected = 1
        self._update_options()
        self._handle_selection(1)

    def action_select_auto(self) -&gt; None:
        &quot;&quot;&quot;Select auto-approve option.&quot;&quot;&quot;
        self._selected = 2
        self._update_options()
        self._handle_selection(2)

    def _handle_selection(self, option: int) -&gt; None:
        &quot;&quot;&quot;Handle the selected option.&quot;&quot;&quot;
        decision_map = {
            0: &quot;approve&quot;,
            1: &quot;reject&quot;,
            2: &quot;auto_approve_all&quot;,
        }
        decision = {&quot;type&quot;: decision_map[option]}

        # Resolve the future
        if self._future and not self._future.done():
            self._future.set_result(decision)

        # Post message
        self.post_message(self.Decided(decision))

    def on_blur(self, event: events.Blur) -&gt; None:
        &quot;&quot;&quot;Re-focus on blur to keep focus trapped.&quot;&quot;&quot;
        self.call_after_refresh(self.focus)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/approval/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="arxiv_search Imported skill arxiv_search from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/examples/skills/arxiv-search/arxiv_search.py Unknown LICENSE sources/langchain/arxiv_search/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">arxiv_search</div>
                <button class="copy-btn" onclick="copyToClipboard('arxiv_search')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill arxiv_search from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;arXiv Search.

Searches the arXiv preprint repository for research papers.
&quot;&quot;&quot;

import argparse


def query_arxiv(query: str, max_papers: int = 10) -&gt; str:
    &quot;&quot;&quot;Query arXiv for papers based on the provided search query.

    Parameters
    ----------
    query : str
        The search query string.
    max_papers : int
        The maximum number of papers to retrieve (default: 10).

    Returns:
        The formatted search results or an error message.
    &quot;&quot;&quot;
    try:
        import arxiv
    except ImportError:
        return &quot;Error: arxiv package not installed. Install with: pip install arxiv&quot;

    try:
        client = arxiv.Client()
        search = arxiv.Search(
            query=query, max_results=max_papers, sort_by=arxiv.SortCriterion.Relevance
        )
        results = &quot;\n\n&quot;.join(
            [f&quot;Title: {paper.title}\nSummary: {paper.summary}&quot; for paper in client.results(search)]
        )
        return results if results else &quot;No papers found on arXiv.&quot;
    except Exception as e:
        return f&quot;Error querying arXiv: {e}&quot;


def main() -&gt; None:
    parser = argparse.ArgumentParser(description=&quot;Search arXiv for research papers&quot;)
    parser.add_argument(&quot;query&quot;, type=str, help=&quot;Search query string&quot;)
    parser.add_argument(
        &quot;--max-papers&quot;,
        type=int,
        default=10,
        help=&quot;Maximum number of papers to retrieve (default: 10)&quot;,
    )

    args = parser.parse_args()

    query_arxiv(args.query, max_papers=args.max_papers)


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/arxiv_search/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="autocomplete Imported skill autocomplete from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/widgets/autocomplete.py Unknown LICENSE sources/langchain/autocomplete/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">autocomplete</div>
                <button class="copy-btn" onclick="copyToClipboard('autocomplete')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill autocomplete from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Autocomplete system for @ mentions and / commands.

This is a custom implementation that handles trigger-based completion
for slash commands (/) and file mentions (@).
&quot;&quot;&quot;

from __future__ import annotations

import subprocess
from difflib import SequenceMatcher
from enum import StrEnum
from pathlib import Path
from typing import TYPE_CHECKING, Protocol

if TYPE_CHECKING:
    from textual import events


class CompletionResult(StrEnum):
    &quot;&quot;&quot;Result of handling a key event in the completion system.&quot;&quot;&quot;

    IGNORED = &quot;ignored&quot;  # Key not handled, let default behavior proceed
    HANDLED = &quot;handled&quot;  # Key handled, prevent default
    SUBMIT = &quot;submit&quot;  # Key triggers submission (e.g., Enter on slash command)


class CompletionView(Protocol):
    &quot;&quot;&quot;Protocol for views that can display completion suggestions.&quot;&quot;&quot;

    def render_completion_suggestions(
        self, suggestions: list[tuple[str, str]], selected_index: int
    ) -&gt; None:
        &quot;&quot;&quot;Render the completion suggestions popup.

        Args:
            suggestions: List of (label, description) tuples
            selected_index: Index of currently selected item
        &quot;&quot;&quot;
        ...

    def clear_completion_suggestions(self) -&gt; None:
        &quot;&quot;&quot;Hide/clear the completion suggestions popup.&quot;&quot;&quot;
        ...

    def replace_completion_range(self, start: int, end: int, replacement: str) -&gt; None:
        &quot;&quot;&quot;Replace text in the input from start to end with replacement.

        Args:
            start: Start index in the input text
            end: End index in the input text
            replacement: Text to insert
        &quot;&quot;&quot;
        ...


class CompletionController(Protocol):
    &quot;&quot;&quot;Protocol for completion controllers.&quot;&quot;&quot;

    def can_handle(self, text: str, cursor_index: int) -&gt; bool:
        &quot;&quot;&quot;Check if this controller can handle the current input state.&quot;&quot;&quot;
        ...

    def on_text_changed(self, text: str, cursor_index: int) -&gt; None:
        &quot;&quot;&quot;Called when input text changes.&quot;&quot;&quot;
        ...

    def on_key(self, event: events.Key, text: str, cursor_index: int) -&gt; CompletionResult:
        &quot;&quot;&quot;Handle a key event. Returns how the event was handled.&quot;&quot;&quot;
        ...

    def reset(self) -&gt; None:
        &quot;&quot;&quot;Reset/clear the completion state.&quot;&quot;&quot;
        ...


# ============================================================================
# Slash Command Completion
# ============================================================================

SLASH_COMMANDS: list[tuple[str, str]] = [
    (&quot;/help&quot;, &quot;Show help&quot;),
    (&quot;/clear&quot;, &quot;Clear chat and start new session&quot;),
    (&quot;/quit&quot;, &quot;Exit app&quot;),
    (&quot;/exit&quot;, &quot;Exit app&quot;),
    (&quot;/tokens&quot;, &quot;Token usage&quot;),
    (&quot;/threads&quot;, &quot;Show session info&quot;),
    (&quot;/version&quot;, &quot;Show version&quot;),
]
&quot;&quot;&quot;Built-in slash commands with descriptions.&quot;&quot;&quot;

MAX_SUGGESTIONS = 10


class SlashCommandController:
    &quot;&quot;&quot;Controller for / slash command completion.&quot;&quot;&quot;

    def __init__(
        self,
        commands: list[tuple[str, str]],
        view: CompletionView,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize the slash command controller.

        Args:
            commands: List of (command, description) tuples
            view: View to render suggestions to
        &quot;&quot;&quot;
        self._commands = commands
        self._view = view
        self._suggestions: list[tuple[str, str]] = []
        self._selected_index = 0

    def can_handle(self, text: str, cursor_index: int) -&gt; bool:  # noqa: ARG002
        &quot;&quot;&quot;Handle input that starts with /.&quot;&quot;&quot;
        return text.startswith(&quot;/&quot;)

    def reset(self) -&gt; None:
        &quot;&quot;&quot;Clear suggestions.&quot;&quot;&quot;
        if self._suggestions:
            self._suggestions.clear()
            self._selected_index = 0
            self._view.clear_completion_suggestions()

    def on_text_changed(self, text: str, cursor_index: int) -&gt; None:
        &quot;&quot;&quot;Update suggestions when text changes.&quot;&quot;&quot;
        if cursor_index &lt; 0 or cursor_index &gt; len(text):
            self.reset()
            return

        if not self.can_handle(text, cursor_index):
            self.reset()
            return

        # Get the search string (text after /)
        search = text[1:cursor_index].lower()

        # Filter commands that match
        suggestions = [
            (cmd, desc) for cmd, desc in self._commands if cmd.lower().startswith(&quot;/&quot; + search)
        ]

        if len(suggestions) &gt; MAX_SUGGESTIONS:
            suggestions = suggestions[:MAX_SUGGESTIONS]

        if suggestions:
            self._suggestions = suggestions
            self._selected_index = 0
            self._view.render_completion_suggestions(self._suggestions, self._selected_index)
        else:
            self.reset()

    def on_key(  # noqa: PLR0911
        self, event: events.Key, _text: str, cursor_index: int
    ) -&gt; CompletionResult:
        &quot;&quot;&quot;Handle key events for navigation and selection.&quot;&quot;&quot;
        if not self._suggestions:
            return CompletionResult.IGNORED

        match event.key:
            case &quot;tab&quot;:
                if self._apply_selected_completion(cursor_index):
                    return CompletionResult.HANDLED
                return CompletionResult.IGNORED
            case &quot;enter&quot;:
                if self._apply_selected_completion(cursor_index):
                    return CompletionResult.SUBMIT
                return CompletionResult.HANDLED
            case &quot;down&quot;:
                self._move_selection(1)
                return CompletionResult.HANDLED
            case &quot;up&quot;:
                self._move_selection(-1)
                return CompletionResult.HANDLED
            case &quot;escape&quot;:
                self.reset()
                return CompletionResult.HANDLED
            case _:
                return CompletionResult.IGNORED

    def _move_selection(self, delta: int) -&gt; None:
        &quot;&quot;&quot;Move selection up or down.&quot;&quot;&quot;
        if not self._suggestions:
            return
        count = len(self._suggestions)
        self._selected_index = (self._selected_index + delta) % count
        self._view.render_completion_suggestions(self._suggestions, self._selected_index)

    def _apply_selected_completion(self, cursor_index: int) -&gt; bool:
        &quot;&quot;&quot;Apply the currently selected completion.&quot;&quot;&quot;
        if not self._suggestions:
            return False

        command, _ = self._suggestions[self._selected_index]
        # Replace from start to cursor with the command
        self._view.replace_completion_range(0, cursor_index, command)
        self.reset()
        return True


# ============================================================================
# Fuzzy File Completion (from project root)
# ============================================================================

# Constants for fuzzy file completion
_MAX_FALLBACK_FILES = 1000
_MIN_FUZZY_RATIO = 0.4
_MIN_FUZZY_SCORE = 15  # Minimum score to include in results


def _find_project_root(start_path: Path) -&gt; Path:
    &quot;&quot;&quot;Find git root or return start_path.&quot;&quot;&quot;
    current = start_path.resolve()
    for parent in [current, *list(current.parents)]:
        if (parent / &quot;.git&quot;).exists():
            return parent
    return start_path


def _get_project_files(root: Path) -&gt; list[str]:
    &quot;&quot;&quot;Get project files using git ls-files or fallback to glob.&quot;&quot;&quot;
    try:
        result = subprocess.run(
            [&quot;git&quot;, &quot;ls-files&quot;],  # noqa: S607
            cwd=root,
            capture_output=True,
            text=True,
            timeout=5,
            check=False,
        )
        if result.returncode == 0:
            files = result.stdout.strip().split(&quot;\n&quot;)
            return [f for f in files if f]  # Filter empty strings
    except (subprocess.TimeoutExpired, FileNotFoundError, OSError):
        pass

    # Fallback: simple glob (limited depth to avoid slowness)
    files = []
    try:
        for pattern in [&quot;*&quot;, &quot;*/*&quot;, &quot;*/*/*&quot;, &quot;*/*/*/*&quot;]:
            for p in root.glob(pattern):
                if p.is_file() and not any(part.startswith(&quot;.&quot;) for part in p.parts):
                    files.append(str(p.relative_to(root)))
                if len(files) &gt;= _MAX_FALLBACK_FILES:
                    break
            if len(files) &gt;= _MAX_FALLBACK_FILES:
                break
    except OSError:
        pass
    return files


def _fuzzy_score(query: str, candidate: str) -&gt; float:  # noqa: PLR0911
    &quot;&quot;&quot;Score a candidate against query. Higher = better match.&quot;&quot;&quot;
    query_lower = query.lower()
    candidate_lower = candidate.lower()

    # Extract filename for matching (prioritize filename over full path)
    filename = candidate.rsplit(&quot;/&quot;, 1)[-1].lower()
    filename_start = candidate_lower.rfind(&quot;/&quot;) + 1

    # Check filename first (higher priority)
    if query_lower in filename:
        idx = filename.find(query_lower)
        # Bonus for being at start of filename
        if idx == 0:
            return 150 + (1 / len(candidate))
        # Bonus for word boundary in filename
        if idx &gt; 0 and filename[idx - 1] in &quot;_-.&quot;:
            return 120 + (1 / len(candidate))
        return 100 + (1 / len(candidate))

    # Check full path
    if query_lower in candidate_lower:
        idx = candidate_lower.find(query_lower)
        # At start of filename
        if idx == filename_start:
            return 80 + (1 / len(candidate))
        # At word boundary in path
        if idx == 0 or candidate[idx - 1] in &quot;/_-.&quot;:
            return 60 + (1 / len(candidate))
        return 40 + (1 / len(candidate))

    # Fuzzy match on filename only (more relevant)
    filename_ratio = SequenceMatcher(None, query_lower, filename).ratio()
    if filename_ratio &gt; _MIN_FUZZY_RATIO:
        return filename_ratio * 30

    # Fallback: fuzzy on full path
    ratio = SequenceMatcher(None, query_lower, candidate_lower).ratio()
    return ratio * 15


def _is_dotpath(path: str) -&gt; bool:
    &quot;&quot;&quot;Check if path contains dotfiles/dotdirs (e.g., .github/...).&quot;&quot;&quot;
    return any(part.startswith(&quot;.&quot;) for part in path.split(&quot;/&quot;))


def _path_depth(path: str) -&gt; int:
    &quot;&quot;&quot;Get depth of path (number of / separators).&quot;&quot;&quot;
    return path.count(&quot;/&quot;)


def _fuzzy_search(
    query: str, candidates: list[str], limit: int = 10, *, include_dotfiles: bool = False
) -&gt; list[str]:
    &quot;&quot;&quot;Return top matches sorted by score.

    Args:
        query: Search query
        candidates: List of file paths to search
        limit: Max results to return
        include_dotfiles: Whether to include dotfiles (default False)
    &quot;&quot;&quot;
    # Filter dotfiles unless explicitly searching for them
    filtered = candidates if include_dotfiles else [c for c in candidates if not _is_dotpath(c)]

    if not query:
        # Empty query: show root-level files first, sorted by depth then name
        sorted_files = sorted(filtered, key=lambda p: (_path_depth(p), p.lower()))
        return sorted_files[:limit]

    scored = [(score, c) for c in filtered if (score := _fuzzy_score(query, c)) &gt;= _MIN_FUZZY_SCORE]
    scored.sort(key=lambda x: -x[0])
    return [c for _, c in scored[:limit]]


class FuzzyFileController:
    &quot;&quot;&quot;Controller for @ file completion with fuzzy matching from project root.&quot;&quot;&quot;

    def __init__(
        self,
        view: CompletionView,
        cwd: Path | None = None,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize the fuzzy file controller.

        Args:
            view: View to render suggestions to
            cwd: Starting directory to find project root from
        &quot;&quot;&quot;
        self._view = view
        self._cwd = cwd or Path.cwd()
        self._project_root = _find_project_root(self._cwd)
        self._suggestions: list[tuple[str, str]] = []
        self._selected_index = 0
        self._file_cache: list[str] | None = None

    def _get_files(self) -&gt; list[str]:
        &quot;&quot;&quot;Get cached file list or refresh.&quot;&quot;&quot;
        if self._file_cache is None:
            self._file_cache = _get_project_files(self._project_root)
        return self._file_cache

    def refresh_cache(self) -&gt; None:
        &quot;&quot;&quot;Force refresh of file cache.&quot;&quot;&quot;
        self._file_cache = None

    def can_handle(self, text: str, cursor_index: int) -&gt; bool:
        &quot;&quot;&quot;Handle input that contains @ not followed by space.&quot;&quot;&quot;
        if cursor_index &lt;= 0 or cursor_index &gt; len(text):
            return False

        before_cursor = text[:cursor_index]
        if &quot;@&quot; not in before_cursor:
            return False

        at_index = before_cursor.rfind(&quot;@&quot;)
        if cursor_index &lt;= at_index:
            return False

        # Fragment from @ to cursor must not contain spaces
        fragment = before_cursor[at_index:cursor_index]
        return bool(fragment) and &quot; &quot; not in fragment

    def reset(self) -&gt; None:
        &quot;&quot;&quot;Clear suggestions.&quot;&quot;&quot;
        if self._suggestions:
            self._suggestions.clear()
            self._selected_index = 0
            self._view.clear_completion_suggestions()

    def on_text_changed(self, text: str, cursor_index: int) -&gt; None:
        &quot;&quot;&quot;Update suggestions when text changes.&quot;&quot;&quot;
        if not self.can_handle(text, cursor_index):
            self.reset()
            return

        before_cursor = text[:cursor_index]
        at_index = before_cursor.rfind(&quot;@&quot;)
        search = before_cursor[at_index + 1 :]

        suggestions = self._get_fuzzy_suggestions(search)

        if suggestions:
            self._suggestions = suggestions
            self._selected_index = 0
            self._view.render_completion_suggestions(self._suggestions, self._selected_index)
        else:
            self.reset()

    def _get_fuzzy_suggestions(self, search: str) -&gt; list[tuple[str, str]]:
        &quot;&quot;&quot;Get fuzzy file suggestions.&quot;&quot;&quot;
        files = self._get_files()
        # Include dotfiles only if query starts with &quot;.&quot;
        include_dots = search.startswith(&quot;.&quot;)
        matches = _fuzzy_search(search, files, limit=MAX_SUGGESTIONS, include_dotfiles=include_dots)

        suggestions: list[tuple[str, str]] = []
        for path in matches:
            # Get file extension for type hint
            ext = Path(path).suffix.lower()
            type_hint = ext[1:] if ext else &quot;file&quot;
            suggestions.append((f&quot;@{path}&quot;, type_hint))

        return suggestions

    def on_key(  # noqa: PLR0911
        self, event: events.Key, text: str, cursor_index: int
    ) -&gt; CompletionResult:
        &quot;&quot;&quot;Handle key events for navigation and selection.&quot;&quot;&quot;
        if not self._suggestions:
            return CompletionResult.IGNORED

        match event.key:
            case &quot;tab&quot; | &quot;enter&quot;:
                if self._apply_selected_completion(text, cursor_index):
                    return CompletionResult.HANDLED
                return CompletionResult.IGNORED
            case &quot;down&quot;:
                self._move_selection(1)
                return CompletionResult.HANDLED
            case &quot;up&quot;:
                self._move_selection(-1)
                return CompletionResult.HANDLED
            case &quot;escape&quot;:
                self.reset()
                return CompletionResult.HANDLED
            case _:
                return CompletionResult.IGNORED

    def _move_selection(self, delta: int) -&gt; None:
        &quot;&quot;&quot;Move selection up or down.&quot;&quot;&quot;
        if not self._suggestions:
            return
        count = len(self._suggestions)
        self._selected_index = (self._selected_index + delta) % count
        self._view.render_completion_suggestions(self._suggestions, self._selected_index)

    def _apply_selected_completion(self, text: str, cursor_index: int) -&gt; bool:
        &quot;&quot;&quot;Apply the currently selected completion.&quot;&quot;&quot;
        if not self._suggestions:
            return False

        label, _ = self._suggestions[self._selected_index]
        before_cursor = text[:cursor_index]
        at_index = before_cursor.rfind(&quot;@&quot;)

        if at_index &lt; 0:
            return False

        # Replace from @ to cursor with the completion
        self._view.replace_completion_range(at_index, cursor_index, label)
        self.reset()
        return True


# Keep old name as alias for backwards compatibility
PathCompletionController = FuzzyFileController


# ============================================================================
# Multi-Completion Manager
# ============================================================================


class MultiCompletionManager:
    &quot;&quot;&quot;Manages multiple completion controllers, delegating to the active one.&quot;&quot;&quot;

    def __init__(self, controllers: list[CompletionController]) -&gt; None:
        &quot;&quot;&quot;Initialize with a list of controllers.

        Args:
            controllers: List of completion controllers (checked in order)
        &quot;&quot;&quot;
        self._controllers = controllers
        self._active: CompletionController | None = None

    def on_text_changed(self, text: str, cursor_index: int) -&gt; None:
        &quot;&quot;&quot;Handle text change, activating the appropriate controller.&quot;&quot;&quot;
        # Find the first controller that can handle this input
        candidate = None
        for controller in self._controllers:
            if controller.can_handle(text, cursor_index):
                candidate = controller
                break

        # No controller can handle - reset if we had one active
        if candidate is None:
            if self._active is not None:
                self._active.reset()
                self._active = None
            return

        # Switch to new controller if different
        if candidate is not self._active:
            if self._active is not None:
                self._active.reset()
            self._active = candidate

        # Let the active controller process the change
        candidate.on_text_changed(text, cursor_index)

    def on_key(self, event: events.Key, text: str, cursor_index: int) -&gt; CompletionResult:
        &quot;&quot;&quot;Handle key event, delegating to active controller.&quot;&quot;&quot;
        if self._active is None:
            return CompletionResult.IGNORED
        return self._active.on_key(event, text, cursor_index)

    def reset(self) -&gt; None:
        &quot;&quot;&quot;Reset all controllers.&quot;&quot;&quot;
        if self._active is not None:
            self._active.reset()
            self._active = None</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/autocomplete/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="backend Imported skill backend from langchain langchain /a0/tmp/skills_research/langchain/libs/harbor/deepagents_harbor/backend.py Unknown LICENSE sources/langchain/backend/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">backend</div>
                <button class="copy-btn" onclick="copyToClipboard('backend')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill backend from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Implement harbor backend.&quot;&quot;&quot;

import base64
import shlex

from deepagents.backends.protocol import (
    EditResult,
    ExecuteResponse,
    FileInfo,
    GrepMatch,
    SandboxBackendProtocol,
    WriteResult,
)
from harbor.environments.base import BaseEnvironment


class HarborSandbox(SandboxBackendProtocol):
    &quot;&quot;&quot;A sandbox implementation without assuming that python3 is available.&quot;&quot;&quot;

    def __init__(self, environment: BaseEnvironment) -&gt; None:
        &quot;&quot;&quot;Initialize HarborSandbox with the given environment.&quot;&quot;&quot;
        self.environment = environment

    async def aexecute(
        self,
        command: str,
    ) -&gt; ExecuteResponse:
        &quot;&quot;&quot;Execute a bash command in the task environment.&quot;&quot;&quot;
        result = await self.environment.exec(command)

        # These errors appear in harbor environments when running bash commands
        # in non-interactive/non-TTY contexts. They&#x27;re harmless artifacts.
        # Filter them from both stdout and stderr, then collect them to show in stderr.
        error_messages = [
            &quot;bash: cannot set terminal process group (-1): Inappropriate ioctl for device&quot;,
            &quot;bash: no job control in this shell&quot;,
            &quot;bash: initialize_job_control: no job control in background: Bad file descriptor&quot;,
        ]

        stdout = result.stdout or &quot;&quot;
        stderr = result.stderr or &quot;&quot;

        # Collect the bash messages if they appear (to move to stderr)
        bash_messages = []
        for error_msg in error_messages:
            if error_msg in stdout:
                bash_messages.append(error_msg)
                stdout = stdout.replace(error_msg, &quot;&quot;)
            if error_msg in stderr:
                stderr = stderr.replace(error_msg, &quot;&quot;)

        stdout = stdout.strip()
        stderr = stderr.strip()

        # Add bash messages to stderr
        if bash_messages:
            bash_msg_text = &quot;\n&quot;.join(bash_messages)
            stderr = f&quot;{bash_msg_text}\n{stderr}&quot;.strip() if stderr else bash_msg_text

        # Only append stderr label if there&#x27;s actual stderr content
        if stderr:
            output = stdout + &quot;\n\n stderr: &quot; + stderr if stdout else &quot;\n stderr: &quot; + stderr
        else:
            output = stdout
        return ExecuteResponse(
            output=output,
            exit_code=result.return_code,
        )

    def execute(
        self,
        command: str,
    ) -&gt; ExecuteResponse:
        &quot;&quot;&quot;Execute a bash command in the task environment.&quot;&quot;&quot;
        raise NotImplementedError(&quot;This backend only supports async execution&quot;)

    @property
    def id(self) -&gt; str:
        &quot;&quot;&quot;Unique identifier for the sandbox backend.&quot;&quot;&quot;
        return self.environment.session_id

    async def aread(
        self,
        file_path: str,
        offset: int = 0,
        limit: int = 2000,
    ) -&gt; str:
        &quot;&quot;&quot;Read file content with line numbers using shell commands.&quot;&quot;&quot;
        # Escape file path for shell
        safe_path = shlex.quote(file_path)

        # Check if file exists and handle empty files
        cmd = f&quot;&quot;&quot;
if [ ! -f {safe_path} ]; then
    echo &quot;Error: File not found&quot;
    exit 1
fi
if [ ! -s {safe_path} ]; then
    echo &quot;System reminder: File exists but has empty contents&quot;
    exit 0
fi
# Use awk to add line numbers and handle offset/limit
awk -v offset={offset} -v limit={limit} &#x27;
    NR &gt; offset &amp;&amp; NR &lt;= offset + limit {{
        printf &quot;%6d\\t%s\\n&quot;, NR, $0
    }}
    NR &gt; offset + limit {{ exit }}
&#x27; {safe_path}
&quot;&quot;&quot;
        result = await self.aexecute(cmd)

        if result.exit_code != 0 or &quot;Error: File not found&quot; in result.output:
            return f&quot;Error: File &#x27;{file_path}&#x27; not found&quot;

        return result.output.rstrip()

    def read(
        self,
        file_path: str,
        offset: int = 0,
        limit: int = 2000,
    ) -&gt; str:
        &quot;&quot;&quot;Read file content with line numbers using shell commands.&quot;&quot;&quot;
        raise NotImplementedError(&quot;Use aread instead&quot;)

    async def awrite(
        self,
        file_path: str,
        content: str,
    ) -&gt; WriteResult:
        &quot;&quot;&quot;Create a new file using shell commands.&quot;&quot;&quot;
        # Encode content as base64 to avoid escaping issues
        content_b64 = base64.b64encode(content.encode(&quot;utf-8&quot;)).decode(&quot;ascii&quot;)
        safe_path = shlex.quote(file_path)

        cmd = f&quot;&quot;&quot;
if [ -e {safe_path} ]; then
    echo &quot;Error: File &#x27;{file_path}&#x27; already exists&quot; &gt;&amp;2
    exit 1
fi
parent_dir=$(dirname {safe_path})
mkdir -p &quot;$parent_dir&quot; 2&gt;/dev/null
echo &#x27;{content_b64}&#x27; | base64 -d &gt; {safe_path}
&quot;&quot;&quot;
        result = await self.aexecute(cmd)

        if result.exit_code != 0 or &quot;Error:&quot; in result.output:
            error_msg = result.output.strip() or f&quot;Failed to write file &#x27;{file_path}&#x27;&quot;
            return WriteResult(error=error_msg)

        return WriteResult(path=file_path, files_update=None)

    def write(
        self,
        file_path: str,
        content: str,
    ) -&gt; WriteResult:
        &quot;&quot;&quot;Create a new file using shell commands.&quot;&quot;&quot;
        raise NotImplementedError(&quot;Use awrite instead&quot;)

    async def aedit(
        self,
        file_path: str,
        old_string: str,
        new_string: str,
        replace_all: bool = False,
    ) -&gt; EditResult:
        &quot;&quot;&quot;Edit a file by replacing string occurrences using shell commands.&quot;&quot;&quot;
        # Encode strings as base64 to avoid escaping issues
        old_b64 = base64.b64encode(old_string.encode(&quot;utf-8&quot;)).decode(&quot;ascii&quot;)
        new_b64 = base64.b64encode(new_string.encode(&quot;utf-8&quot;)).decode(&quot;ascii&quot;)
        safe_path = shlex.quote(file_path)
        replace_all_str = &quot;true&quot; if replace_all else &quot;false&quot;

        # Use a shell script with perl for reliable string replacement
        cmd = f&quot;&quot;&quot;
if [ ! -f {safe_path} ]; then
    exit 3
fi

old=$(echo &#x27;{old_b64}&#x27; | base64 -d)
new=$(echo &#x27;{new_b64}&#x27; | base64 -d)

# Count occurrences using grep -F (fixed strings)
count=$(grep -o -F &quot;$old&quot; {safe_path} | wc -l)

if [ &quot;$count&quot; -eq 0 ]; then
    exit 1
elif [ &quot;$count&quot; -gt 1 ] &amp;&amp; [ &quot;{replace_all_str}&quot; = &quot;false&quot; ]; then
    exit 2
fi

# Use perl for reliable string replacement (handles special chars)
if [ &quot;{replace_all_str}&quot; = &quot;true&quot; ]; then
    perl -i -pe &#x27;s/\\Q&#x27;&quot;$old&quot;&#x27;\\E/&#x27;&quot;$new&quot;&#x27;/g&#x27; {safe_path}
else
    perl -i -pe &#x27;s/\\Q&#x27;&quot;$old&quot;&#x27;\\E/&#x27;&quot;$new&quot;&#x27;/&#x27; {safe_path}
fi

echo &quot;$count&quot;
&quot;&quot;&quot;
        result = await self.aexecute(cmd)

        exit_code = result.exit_code
        output = result.output.strip()

        if exit_code == 1:
            return EditResult(error=f&quot;Error: String not found in file: &#x27;{old_string}&#x27;&quot;)
        if exit_code == 2:
            return EditResult(
                error=f&quot;Error: String &#x27;{old_string}&#x27; appears multiple times. Use replace_all=True to replace all occurrences.&quot;
            )
        if exit_code == 3:
            return EditResult(error=f&quot;Error: File &#x27;{file_path}&#x27; not found&quot;)
        if exit_code != 0:
            return EditResult(error=f&quot;Error editing file: {output}&quot;)

        try:
            count = int(output.split(&quot;\n&quot;)[0])
        except (ValueError, IndexError):
            count = 1

        return EditResult(path=file_path, files_update=None, occurrences=count)

    def edit(
        self,
        file_path: str,
        old_string: str,
        new_string: str,
        replace_all: bool = False,
    ) -&gt; EditResult:
        &quot;&quot;&quot;Edit a file by replacing string occurrences using shell commands.&quot;&quot;&quot;
        raise NotImplementedError(&quot;Use aedit instead&quot;)

    async def als_info(self, path: str) -&gt; list[FileInfo]:
        &quot;&quot;&quot;List directory contents with metadata using shell commands.&quot;&quot;&quot;
        safe_path = shlex.quote(path)

        cmd = f&quot;&quot;&quot;
if [ ! -d {safe_path} ]; then
    exit 1
fi
for entry in {safe_path}/*; do
    if [ -e &quot;$entry&quot; ]; then
        name=$(basename &quot;$entry&quot;)
        if [ -d &quot;$entry&quot; ]; then
            printf &#x27;%s|true\\n&#x27; &quot;$name&quot;
        else
            printf &#x27;%s|false\\n&#x27; &quot;$name&quot;
        fi
    fi
done
&quot;&quot;&quot;
        result = await self.aexecute(cmd)

        if result.exit_code != 0:
            return []

        file_infos: list[FileInfo] = []
        for line in result.output.strip().split(&quot;\n&quot;):
            if not line:
                continue
            parts = line.split(&quot;|&quot;)
            if len(parts) == 2:
                file_infos.append({&quot;path&quot;: parts[0], &quot;is_dir&quot;: parts[1] == &quot;true&quot;})

        return file_infos

    def ls_info(self, path: str) -&gt; list[FileInfo]:
        &quot;&quot;&quot;List directory contents with metadata using shell commands.&quot;&quot;&quot;
        raise NotImplementedError(&quot;Use als_info instead&quot;)

    async def agrep_raw(
        self,
        pattern: str,
        path: str | None = None,
        glob: str | None = None,
    ) -&gt; list[GrepMatch] | str:
        &quot;&quot;&quot;Search for pattern in files using grep.&quot;&quot;&quot;
        search_path = shlex.quote(path or &quot;.&quot;)

        # Build grep command
        grep_opts = &quot;-rHn&quot;  # recursive, with filename, with line number

        # Add glob pattern if specified
        glob_pattern = &quot;&quot;
        if glob:
            glob_pattern = f&quot;--include={shlex.quote(glob)}&quot;

        # Escape pattern for grep
        safe_pattern = shlex.quote(pattern)

        cmd = f&quot;grep {grep_opts} {glob_pattern} -e {safe_pattern} {search_path} 2&gt;/dev/null || true&quot;
        result = await self.aexecute(cmd)

        output = result.output.rstrip()
        if not output:
            return []

        # Parse grep output into GrepMatch objects
        matches: list[GrepMatch] = []
        for line in output.split(&quot;\n&quot;):
            # Format is: path:line_number:text
            parts = line.split(&quot;:&quot;, 2)
            if len(parts) &gt;= 3:
                try:
                    matches.append(
                        {
                            &quot;path&quot;: parts[0],
                            &quot;line&quot;: int(parts[1]),
                            &quot;text&quot;: parts[2],
                        }
                    )
                except ValueError:
                    continue

        return matches

    def grep_raw(
        self,
        pattern: str,
        path: str | None = None,
        glob: str | None = None,
    ) -&gt; list[GrepMatch] | str:
        &quot;&quot;&quot;Search for pattern in files using grep.&quot;&quot;&quot;
        raise NotImplementedError(&quot;Use agrep_raw instead&quot;)

    async def aglob_info(self, pattern: str, path: str = &quot;/&quot;) -&gt; list[FileInfo]:
        &quot;&quot;&quot;Find files matching glob pattern using shell commands.

        Please note that this implementation does not currently support all glob
        patterns.
        &quot;&quot;&quot;
        safe_path = shlex.quote(path)
        safe_pattern = shlex.quote(pattern)

        cmd = f&quot;&quot;&quot;
cd {safe_path} 2&gt;/dev/null || exit 1
# Use find with shell globbing
for file in {safe_pattern}; do
    if [ -e &quot;$file&quot; ]; then
        if [ -d &quot;$file&quot; ]; then
            printf &#x27;%s|true\\n&#x27; &quot;$file&quot;
        else
            printf &#x27;%s|false\\n&#x27; &quot;$file&quot;
        fi
    fi
done
&quot;&quot;&quot;
        result = await self.aexecute(cmd)

        if result.exit_code != 0:
            return []

        output = result.output.strip()
        if not output:
            return []

        # Parse output into FileInfo dicts
        file_infos: list[FileInfo] = []
        for line in output.split(&quot;\n&quot;):
            if not line:
                continue
            parts = line.split(&quot;|&quot;)
            if len(parts) == 2:
                file_infos.append(
                    {
                        &quot;path&quot;: parts[0],
                        &quot;is_dir&quot;: parts[1] == &quot;true&quot;,
                    }
                )

        return file_infos

    def glob_info(self, pattern: str, path: str = &quot;/&quot;) -&gt; list[FileInfo]:
        &quot;&quot;&quot;Find files matching glob pattern using shell commands.&quot;&quot;&quot;
        raise NotImplementedError(&quot;Use aglob_info instead&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/backend/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="chat_input Imported skill chat_input from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/widgets/chat_input.py Unknown LICENSE sources/langchain/chat_input/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">chat_input</div>
                <button class="copy-btn" onclick="copyToClipboard('chat_input')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill chat_input from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Chat input widget for deepagents-cli with autocomplete and history support.&quot;&quot;&quot;

from __future__ import annotations

from pathlib import Path
from typing import TYPE_CHECKING, Any, ClassVar

from rich.text import Text
from textual import events  # noqa: TC002 - used at runtime in _on_key
from textual.binding import Binding
from textual.containers import Horizontal, Vertical
from textual.message import Message
from textual.reactive import reactive
from textual.widgets import Static, TextArea

from deepagents_cli.widgets.autocomplete import (
    SLASH_COMMANDS,
    CompletionResult,
    FuzzyFileController,
    MultiCompletionManager,
    SlashCommandController,
)
from deepagents_cli.widgets.history import HistoryManager

if TYPE_CHECKING:
    from textual.app import ComposeResult


class CompletionPopup(Static):
    &quot;&quot;&quot;Popup widget that displays completion suggestions.&quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    CompletionPopup {
        display: none;
    }
    &quot;&quot;&quot;

    def __init__(self, **kwargs: Any) -&gt; None:
        &quot;&quot;&quot;Initialize the completion popup.&quot;&quot;&quot;
        super().__init__(&quot;&quot;, **kwargs)
        self.can_focus = False

    def update_suggestions(self, suggestions: list[tuple[str, str]], selected_index: int) -&gt; None:
        &quot;&quot;&quot;Update the popup with new suggestions.&quot;&quot;&quot;
        if not suggestions:
            self.hide()
            return

        text = Text()
        for idx, (label, description) in enumerate(suggestions):
            if idx:
                text.append(&quot;\n&quot;)

            if idx == selected_index:
                label_style = &quot;bold reverse&quot;
                desc_style = &quot;italic&quot;
            else:
                label_style = &quot;bold&quot;
                desc_style = &quot;dim&quot;

            text.append(label, style=label_style)
            if description:
                text.append(&quot;  &quot;)
                text.append(description, style=desc_style)

        self.update(text)
        self.show()

    def hide(self) -&gt; None:
        &quot;&quot;&quot;Hide the popup.&quot;&quot;&quot;
        self.update(&quot;&quot;)
        self.styles.display = &quot;none&quot;

    def show(self) -&gt; None:
        &quot;&quot;&quot;Show the popup.&quot;&quot;&quot;
        self.styles.display = &quot;block&quot;


class ChatTextArea(TextArea):
    &quot;&quot;&quot;TextArea subclass with custom key handling for chat input.&quot;&quot;&quot;

    BINDINGS: ClassVar[list[Binding]] = [
        Binding(
            &quot;shift+enter,ctrl+j,alt+enter,ctrl+enter&quot;,
            &quot;insert_newline&quot;,
            &quot;New Line&quot;,
            show=False,
            priority=True,
        ),
        Binding(
            &quot;ctrl+a&quot;,
            &quot;select_all_text&quot;,
            &quot;Select All&quot;,
            show=False,
            priority=True,
        ),
        # Mac Cmd+Z/Cmd+Shift+Z for undo/redo (in addition to Ctrl+Z/Y)
        Binding(&quot;cmd+z,super+z&quot;, &quot;undo&quot;, &quot;Undo&quot;, show=False, priority=True),
        Binding(&quot;cmd+shift+z,super+shift+z&quot;, &quot;redo&quot;, &quot;Redo&quot;, show=False, priority=True),
    ]

    class Submitted(Message):
        &quot;&quot;&quot;Message sent when text is submitted.&quot;&quot;&quot;

        def __init__(self, value: str) -&gt; None:
            &quot;&quot;&quot;Initialize with submitted value.&quot;&quot;&quot;
            self.value = value
            super().__init__()

    class HistoryPrevious(Message):
        &quot;&quot;&quot;Request previous history entry.&quot;&quot;&quot;

        def __init__(self, current_text: str) -&gt; None:
            &quot;&quot;&quot;Initialize with current text for saving.&quot;&quot;&quot;
            self.current_text = current_text
            super().__init__()

    class HistoryNext(Message):
        &quot;&quot;&quot;Request next history entry.&quot;&quot;&quot;

    def __init__(self, **kwargs: Any) -&gt; None:
        &quot;&quot;&quot;Initialize the chat text area.&quot;&quot;&quot;
        # Remove placeholder if passed, TextArea doesn&#x27;t support it the same way
        kwargs.pop(&quot;placeholder&quot;, None)
        super().__init__(**kwargs)
        self._navigating_history = False
        self._completion_active = False
        self._app_has_focus = True

    def set_app_focus(self, *, has_focus: bool) -&gt; None:
        &quot;&quot;&quot;Set whether the app should show the cursor as active.

        When has_focus=False (e.g., agent is running), disables cursor blink
        so the cursor doesn&#x27;t flash while waiting for a response.
        &quot;&quot;&quot;
        self._app_has_focus = has_focus
        self.cursor_blink = has_focus
        if has_focus and not self.has_focus:
            self.call_after_refresh(self.focus)

    def set_completion_active(self, *, active: bool) -&gt; None:
        &quot;&quot;&quot;Set whether completion suggestions are visible.&quot;&quot;&quot;
        self._completion_active = active

    def action_insert_newline(self) -&gt; None:
        &quot;&quot;&quot;Insert a newline character.&quot;&quot;&quot;
        self.insert(&quot;\n&quot;)

    def action_select_all_text(self) -&gt; None:
        &quot;&quot;&quot;Select all text in the text area.&quot;&quot;&quot;
        if not self.text:
            return
        # Select from start to end
        lines = self.text.split(&quot;\n&quot;)
        end_row = len(lines) - 1
        end_col = len(lines[end_row])
        self.selection = ((0, 0), (end_row, end_col))

    async def _on_key(self, event: events.Key) -&gt; None:
        &quot;&quot;&quot;Handle key events.&quot;&quot;&quot;
        # Modifier+Enter inserts newline (Ctrl+J is most reliable across terminals)
        if event.key in (&quot;shift+enter&quot;, &quot;ctrl+j&quot;, &quot;alt+enter&quot;, &quot;ctrl+enter&quot;):
            event.prevent_default()
            event.stop()
            self.insert(&quot;\n&quot;)
            return

        # If completion is active, let parent handle navigation keys
        if self._completion_active and event.key in (&quot;up&quot;, &quot;down&quot;, &quot;tab&quot;, &quot;enter&quot;):
            # Prevent TextArea&#x27;s default behavior (e.g., Enter inserting newline)
            # but let event bubble to ChatInput for completion handling
            event.prevent_default()
            return

        # Plain Enter submits
        if event.key == &quot;enter&quot;:
            event.prevent_default()
            event.stop()
            value = self.text.strip()
            if value:
                self.post_message(self.Submitted(value))
            return

        # Up arrow on first line = history previous
        if event.key == &quot;up&quot;:
            row, _ = self.cursor_location
            if row == 0:
                event.prevent_default()
                event.stop()
                self._navigating_history = True
                self.post_message(self.HistoryPrevious(self.text))
                return

        # Down arrow on last line = history next
        if event.key == &quot;down&quot;:
            row, _ = self.cursor_location
            total_lines = self.text.count(&quot;\n&quot;) + 1
            if row == total_lines - 1:
                event.prevent_default()
                event.stop()
                self._navigating_history = True
                self.post_message(self.HistoryNext())
                return

        await super()._on_key(event)

    def set_text_from_history(self, text: str) -&gt; None:
        &quot;&quot;&quot;Set text from history navigation.&quot;&quot;&quot;
        self._navigating_history = True
        self.text = text
        # Move cursor to end
        lines = text.split(&quot;\n&quot;)
        last_row = len(lines) - 1
        last_col = len(lines[last_row])
        self.move_cursor((last_row, last_col))
        self._navigating_history = False

    def clear_text(self) -&gt; None:
        &quot;&quot;&quot;Clear the text area.&quot;&quot;&quot;
        self.text = &quot;&quot;
        self.move_cursor((0, 0))


class ChatInput(Vertical):
    &quot;&quot;&quot;Chat input widget with prompt indicator, multi-line text, autocomplete, and history.

    Features:
    - Multi-line input with TextArea
    - Enter to submit, Ctrl+J for newlines (most reliable across terminals)
    - Up/Down arrows for command history on first/last line
    - Autocomplete for @ (files) and / (commands)
    &quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    ChatInput {
        height: auto;
        min-height: 3;
        max-height: 12;
        padding: 0;
        background: $surface;
        border: solid $primary;
    }

    ChatInput .input-row {
        height: auto;
        width: 100%;
    }

    ChatInput .input-prompt {
        width: 3;
        height: 1;
        padding: 0 1;
        color: $primary;
        text-style: bold;
    }

    ChatInput ChatTextArea {
        width: 1fr;
        height: auto;
        min-height: 1;
        max-height: 8;
        border: none;
        background: transparent;
        padding: 0;
    }

    ChatInput ChatTextArea:focus {
        border: none;
    }
    &quot;&quot;&quot;

    class Submitted(Message):
        &quot;&quot;&quot;Message sent when input is submitted.&quot;&quot;&quot;

        def __init__(self, value: str, mode: str = &quot;normal&quot;) -&gt; None:
            &quot;&quot;&quot;Initialize with value and mode.&quot;&quot;&quot;
            super().__init__()
            self.value = value
            self.mode = mode

    class ModeChanged(Message):
        &quot;&quot;&quot;Message sent when input mode changes.&quot;&quot;&quot;

        def __init__(self, mode: str) -&gt; None:
            &quot;&quot;&quot;Initialize with new mode.&quot;&quot;&quot;
            super().__init__()
            self.mode = mode

    mode: reactive[str] = reactive(&quot;normal&quot;)

    def __init__(
        self,
        cwd: str | Path | None = None,
        history_file: Path | None = None,
        **kwargs: Any,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize the chat input widget.

        Args:
            cwd: Current working directory for file completion
            history_file: Path to history file (default: ~/.deepagents/history.jsonl)
            **kwargs: Additional arguments for parent
        &quot;&quot;&quot;
        super().__init__(**kwargs)
        self._cwd = Path(cwd) if cwd else Path.cwd()
        self._text_area: ChatTextArea | None = None
        self._popup: CompletionPopup | None = None
        self._completion_manager: MultiCompletionManager | None = None

        # Set up history manager
        if history_file is None:
            history_file = Path.home() / &quot;.deepagents&quot; / &quot;history.jsonl&quot;
        self._history = HistoryManager(history_file)

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the chat input layout.&quot;&quot;&quot;
        with Horizontal(classes=&quot;input-row&quot;):
            yield Static(&quot;&gt;&quot;, classes=&quot;input-prompt&quot;, id=&quot;prompt&quot;)
            yield ChatTextArea(id=&quot;chat-input&quot;)

        yield CompletionPopup(id=&quot;completion-popup&quot;)

    def on_mount(self) -&gt; None:
        &quot;&quot;&quot;Initialize components after mount.&quot;&quot;&quot;
        self._text_area = self.query_one(&quot;#chat-input&quot;, ChatTextArea)
        self._popup = self.query_one(&quot;#completion-popup&quot;, CompletionPopup)

        self._completion_manager = MultiCompletionManager(
            [
                SlashCommandController(SLASH_COMMANDS, self),
                FuzzyFileController(self, cwd=self._cwd),
            ]
        )

        self._text_area.focus()

    def on_text_area_changed(self, event: TextArea.Changed) -&gt; None:
        &quot;&quot;&quot;Detect input mode and update completions.&quot;&quot;&quot;
        text = event.text_area.text

        # Update mode based on first character
        if text.startswith(&quot;!&quot;):
            self.mode = &quot;bash&quot;
        elif text.startswith(&quot;/&quot;):
            self.mode = &quot;command&quot;
        else:
            self.mode = &quot;normal&quot;

        # Skip completion during history navigation to avoid popup flashing
        if self._text_area and self._text_area._navigating_history:
            if self._completion_manager:
                self._completion_manager.reset()
            return

        # Update completion suggestions
        if self._completion_manager and self._text_area:
            cursor_offset = self._get_cursor_offset()
            self._completion_manager.on_text_changed(text, cursor_offset)

    def on_chat_text_area_submitted(self, event: ChatTextArea.Submitted) -&gt; None:
        &quot;&quot;&quot;Handle text submission.&quot;&quot;&quot;
        value = event.value
        if value:
            if self._completion_manager:
                self._completion_manager.reset()

            self._history.add(value)
            self.post_message(self.Submitted(value, self.mode))
            if self._text_area:
                self._text_area.clear_text()
            self.mode = &quot;normal&quot;

    def on_chat_text_area_history_previous(self, event: ChatTextArea.HistoryPrevious) -&gt; None:
        &quot;&quot;&quot;Handle history previous request.&quot;&quot;&quot;
        entry = self._history.get_previous(event.current_text)
        if entry is not None and self._text_area:
            self._text_area.set_text_from_history(entry)

    def on_chat_text_area_history_next(
        self,
        event: ChatTextArea.HistoryNext,  # noqa: ARG002
    ) -&gt; None:
        &quot;&quot;&quot;Handle history next request.&quot;&quot;&quot;
        entry = self._history.get_next()
        if entry is not None and self._text_area:
            self._text_area.set_text_from_history(entry)

    async def on_key(self, event: events.Key) -&gt; None:
        &quot;&quot;&quot;Handle key events for completion navigation.&quot;&quot;&quot;
        if not self._completion_manager or not self._text_area:
            return

        text = self._text_area.text
        cursor = self._get_cursor_offset()

        result = self._completion_manager.on_key(event, text, cursor)

        match result:
            case CompletionResult.HANDLED:
                event.prevent_default()
                event.stop()
            case CompletionResult.SUBMIT:
                event.prevent_default()
                event.stop()
                value = self._text_area.text.strip()
                if value:
                    self._completion_manager.reset()
                    self._history.add(value)
                    self.post_message(self.Submitted(value, self.mode))
                    self._text_area.clear_text()
                    self.mode = &quot;normal&quot;
            case CompletionResult.IGNORED if event.key == &quot;enter&quot;:
                # Handle Enter when completion is not active (bash/normal modes)
                value = self._text_area.text.strip()
                if value:
                    event.prevent_default()
                    event.stop()
                    self._history.add(value)
                    self.post_message(self.Submitted(value, self.mode))
                    self._text_area.clear_text()
                    self.mode = &quot;normal&quot;

    def _get_cursor_offset(self) -&gt; int:
        &quot;&quot;&quot;Get the cursor offset as a single integer.&quot;&quot;&quot;
        if not self._text_area:
            return 0

        text = self._text_area.text
        row, col = self._text_area.cursor_location

        if not text:
            return 0

        lines = text.split(&quot;\n&quot;)
        row = max(0, min(row, len(lines) - 1))
        col = max(0, col)

        offset = sum(len(lines[i]) + 1 for i in range(row))
        return offset + min(col, len(lines[row]))

    def watch_mode(self, mode: str) -&gt; None:
        &quot;&quot;&quot;Post mode changed message when mode changes.&quot;&quot;&quot;
        self.post_message(self.ModeChanged(mode))

    def focus_input(self) -&gt; None:
        &quot;&quot;&quot;Focus the input field.&quot;&quot;&quot;
        if self._text_area:
            self._text_area.focus()

    @property
    def value(self) -&gt; str:
        &quot;&quot;&quot;Get the current input value.&quot;&quot;&quot;
        if self._text_area:
            return self._text_area.text
        return &quot;&quot;

    @value.setter
    def value(self, val: str) -&gt; None:
        &quot;&quot;&quot;Set the input value.&quot;&quot;&quot;
        if self._text_area:
            self._text_area.text = val

    @property
    def input_widget(self) -&gt; ChatTextArea | None:
        &quot;&quot;&quot;Get the underlying TextArea widget.&quot;&quot;&quot;
        return self._text_area

    def set_disabled(self, *, disabled: bool) -&gt; None:
        &quot;&quot;&quot;Enable or disable the input widget.&quot;&quot;&quot;
        if self._text_area:
            self._text_area.disabled = disabled
            if disabled:
                self._text_area.blur()
                if self._completion_manager:
                    self._completion_manager.reset()

    def set_cursor_active(self, *, active: bool) -&gt; None:
        &quot;&quot;&quot;Set whether the cursor should be actively blinking.

        When active=False (e.g., agent is working), disables cursor blink
        so the cursor doesn&#x27;t flash while waiting for a response.
        &quot;&quot;&quot;
        if self._text_area:
            self._text_area.set_app_focus(has_focus=active)

    # =========================================================================
    # CompletionView protocol implementation
    # =========================================================================

    def render_completion_suggestions(
        self, suggestions: list[tuple[str, str]], selected_index: int
    ) -&gt; None:
        &quot;&quot;&quot;Render completion suggestions in the popup.&quot;&quot;&quot;
        if self._popup:
            self._popup.update_suggestions(suggestions, selected_index)
        # Tell TextArea that completion is active so it yields navigation keys
        if self._text_area:
            self._text_area.set_completion_active(active=bool(suggestions))

    def clear_completion_suggestions(self) -&gt; None:
        &quot;&quot;&quot;Clear/hide the completion popup.&quot;&quot;&quot;
        if self._popup:
            self._popup.hide()
        # Tell TextArea that completion is no longer active
        if self._text_area:
            self._text_area.set_completion_active(active=False)

    def replace_completion_range(self, start: int, end: int, replacement: str) -&gt; None:
        &quot;&quot;&quot;Replace text in the input field.&quot;&quot;&quot;
        if not self._text_area:
            return

        text = self._text_area.text
        start = max(0, min(start, len(text)))
        end = max(start, min(end, len(text)))

        prefix = text[:start]
        suffix = text[end:]

        # Add space after completion unless it&#x27;s a directory path
        if replacement.endswith(&quot;/&quot;):
            insertion = replacement
        else:
            insertion = replacement + &quot; &quot; if not suffix.startswith(&quot; &quot;) else replacement

        new_text = f&quot;{prefix}{insertion}{suffix}&quot;
        self._text_area.text = new_text

        # Calculate new cursor position and move cursor
        new_offset = start + len(insertion)
        lines = new_text.split(&quot;\n&quot;)
        remaining = new_offset
        for row, line in enumerate(lines):
            if remaining &lt;= len(line):
                self._text_area.move_cursor((row, remaining))
                break
            remaining -= len(line) + 1</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/chat_input/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="clipboard Imported skill clipboard from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/clipboard.py Unknown LICENSE sources/langchain/clipboard/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">clipboard</div>
                <button class="copy-btn" onclick="copyToClipboard('clipboard')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill clipboard from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Clipboard utilities for deepagents-cli.&quot;&quot;&quot;

from __future__ import annotations

import base64
import os
from typing import TYPE_CHECKING

if TYPE_CHECKING:
    from textual.app import App

_PREVIEW_MAX_LENGTH = 40


def _copy_osc52(text: str) -&gt; None:
    &quot;&quot;&quot;Copy text using OSC 52 escape sequence (works over SSH/tmux).&quot;&quot;&quot;
    encoded = base64.b64encode(text.encode(&quot;utf-8&quot;)).decode(&quot;ascii&quot;)
    osc52_seq = f&quot;\033]52;c;{encoded}\a&quot;
    if os.environ.get(&quot;TMUX&quot;):
        osc52_seq = f&quot;\033Ptmux;\033{osc52_seq}\033\\&quot;

    with open(&quot;/dev/tty&quot;, &quot;w&quot;) as tty:
        tty.write(osc52_seq)
        tty.flush()


def _shorten_preview(texts: list[str]) -&gt; str:
    &quot;&quot;&quot;Shorten text for notification preview.&quot;&quot;&quot;
    dense_text = &quot;&quot;.join(texts).replace(&quot;\n&quot;, &quot;&quot;)
    if len(dense_text) &gt; _PREVIEW_MAX_LENGTH:
        return f&quot;{dense_text[: _PREVIEW_MAX_LENGTH - 1]}&quot;
    return dense_text


def copy_selection_to_clipboard(app: App) -&gt; None:
    &quot;&quot;&quot;Copy selected text from app widgets to clipboard.

    This queries all widgets for their text_selection and copies
    any selected text to the system clipboard.
    &quot;&quot;&quot;
    selected_texts = []

    for widget in app.query(&quot;*&quot;):
        if not hasattr(widget, &quot;text_selection&quot;) or not widget.text_selection:
            continue

        selection = widget.text_selection

        try:
            result = widget.get_selection(selection)
        except Exception:
            continue

        if not result:
            continue

        selected_text, _ = result
        if selected_text.strip():
            selected_texts.append(selected_text)

    if not selected_texts:
        return

    combined_text = &quot;\n&quot;.join(selected_texts)

    # Try multiple clipboard methods
    copy_methods = [_copy_osc52, app.copy_to_clipboard]

    # Try pyperclip if available
    try:
        import pyperclip

        copy_methods.insert(1, pyperclip.copy)
    except ImportError:
        pass

    for copy_fn in copy_methods:
        try:
            copy_fn(combined_text)
            # Use markup=False to prevent copied text from being parsed as Rich markup
            app.notify(
                f&#x27;&quot;{_shorten_preview(selected_texts)}&quot; copied&#x27;,
                severity=&quot;information&quot;,
                timeout=2,
                markup=False,
            )
            return
        except Exception:
            continue

    # If all methods fail, still notify but warn
    app.notify(
        &quot;Failed to copy - no clipboard method available&quot;,
        severity=&quot;warning&quot;,
        timeout=3,
    )</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/clipboard/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="commands Imported skill commands from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/skills/commands.py Unknown LICENSE sources/langchain/commands/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">commands</div>
                <button class="copy-btn" onclick="copyToClipboard('commands')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill commands from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;CLI commands for skill management.

These commands are registered with the CLI via cli.py:
- deepagents skills list --agent &lt;agent&gt; [--project]
- deepagents skills create &lt;name&gt;
- deepagents skills info &lt;name&gt;
&quot;&quot;&quot;

import argparse
import re
from pathlib import Path
from typing import Any

from deepagents_cli.config import COLORS, Settings, console
from deepagents_cli.skills.load import list_skills

MAX_SKILL_NAME_LENGTH = 64


def _validate_name(name: str) -&gt; tuple[bool, str]:
    &quot;&quot;&quot;Validate name per Agent Skills spec.

    Requirements (https://agentskills.io/specification):
    - Max 64 characters
    - Lowercase alphanumeric and hyphens only (a-z, 0-9, -)
    - Cannot start or end with hyphen
    - No consecutive hyphens
    - No path traversal sequences

    Args:
        name: The name to validate

    Returns:
        Tuple of (is_valid, error_message). If valid, error_message is empty.
    &quot;&quot;&quot;
    # Check for empty or whitespace-only names
    if not name or not name.strip():
        return False, &quot;cannot be empty&quot;

    # Check length (spec: max 64 chars)
    if len(name) &gt; MAX_SKILL_NAME_LENGTH:
        return False, &quot;cannot exceed 64 characters&quot;

    # Check for path traversal sequences
    if &quot;..&quot; in name or &quot;/&quot; in name or &quot;\\&quot; in name:
        return False, &quot;cannot contain path components&quot;

    # Spec: lowercase alphanumeric and hyphens only
    # Pattern ensures: no start/end hyphen, no consecutive hyphens
    if not re.match(r&quot;^[a-z0-9]+(-[a-z0-9]+)*$&quot;, name):
        return (
            False,
            &quot;must be lowercase letters, numbers, and hyphens only &quot;
            &quot;(no uppercase, no underscores, cannot start/end with hyphen)&quot;,
        )

    return True, &quot;&quot;


def _validate_skill_path(skill_dir: Path, base_dir: Path) -&gt; tuple[bool, str]:
    &quot;&quot;&quot;Validate that the resolved skill directory is within the base directory.

    Args:
        skill_dir: The skill directory path to validate
        base_dir: The base skills directory that should contain skill_dir

    Returns:
        Tuple of (is_valid, error_message). If valid, error_message is empty.
    &quot;&quot;&quot;
    try:
        # Resolve both paths to their canonical form
        resolved_skill = skill_dir.resolve()
        resolved_base = base_dir.resolve()

        # Check if skill_dir is within base_dir
        # Use is_relative_to if available (Python 3.9+), otherwise use string comparison
        if hasattr(resolved_skill, &quot;is_relative_to&quot;):
            if not resolved_skill.is_relative_to(resolved_base):
                return False, f&quot;Skill directory must be within {base_dir}&quot;
        else:
            # Fallback for older Python versions
            try:
                resolved_skill.relative_to(resolved_base)
            except ValueError:
                return False, f&quot;Skill directory must be within {base_dir}&quot;

        return True, &quot;&quot;
    except (OSError, RuntimeError) as e:
        return False, f&quot;Invalid path: {e}&quot;


def _list(agent: str, *, project: bool = False) -&gt; None:
    &quot;&quot;&quot;List all available skills for the specified agent.

    Args:
        agent: Agent identifier for skills (default: agent).
        project: If True, show only project skills.
            If False, show all skills (user + project).
    &quot;&quot;&quot;
    settings = Settings.from_environment()
    user_skills_dir = settings.get_user_skills_dir(agent)
    project_skills_dir = settings.get_project_skills_dir()

    # If --project flag is used, only show project skills
    if project:
        if not project_skills_dir:
            console.print(&quot;[yellow]Not in a project directory.[/yellow]&quot;)
            console.print(
                &quot;[dim]Project skills require a .git directory in the project root.[/dim]&quot;,
                style=COLORS[&quot;dim&quot;],
            )
            return

        if not project_skills_dir.exists() or not any(project_skills_dir.iterdir()):
            console.print(&quot;[yellow]No project skills found.[/yellow]&quot;)
            console.print(
                f&quot;[dim]Project skills will be created in {project_skills_dir}/ when you add them.[/dim]&quot;,
                style=COLORS[&quot;dim&quot;],
            )
            console.print(
                &quot;\n[dim]Create a project skill:\n  deepagents skills create my-skill --project[/dim]&quot;,
                style=COLORS[&quot;dim&quot;],
            )
            return

        skills = list_skills(user_skills_dir=None, project_skills_dir=project_skills_dir)
        console.print(&quot;\n[bold]Project Skills:[/bold]\n&quot;, style=COLORS[&quot;primary&quot;])
    else:
        # Load both user and project skills
        skills = list_skills(user_skills_dir=user_skills_dir, project_skills_dir=project_skills_dir)

        if not skills:
            console.print(&quot;[yellow]No skills found.[/yellow]&quot;)
            console.print(
                &quot;[dim]Skills will be created in ~/.deepagents/agent/skills/ when you add them.[/dim]&quot;,
                style=COLORS[&quot;dim&quot;],
            )
            console.print(
                &quot;\n[dim]Create your first skill:\n  deepagents skills create my-skill[/dim]&quot;,
                style=COLORS[&quot;dim&quot;],
            )
            return

        console.print(&quot;\n[bold]Available Skills:[/bold]\n&quot;, style=COLORS[&quot;primary&quot;])

    # Group skills by source
    user_skills = [s for s in skills if s[&quot;source&quot;] == &quot;user&quot;]
    project_skills_list = [s for s in skills if s[&quot;source&quot;] == &quot;project&quot;]

    # Show user skills
    if user_skills and not project:
        console.print(&quot;[bold cyan]User Skills:[/bold cyan]&quot;, style=COLORS[&quot;primary&quot;])
        for skill in user_skills:
            skill_path = Path(skill[&quot;path&quot;])
            console.print(f&quot;   [bold]{skill[&#x27;name&#x27;]}[/bold]&quot;, style=COLORS[&quot;primary&quot;])
            console.print(f&quot;    {skill[&#x27;description&#x27;]}&quot;, style=COLORS[&quot;dim&quot;])
            console.print(f&quot;    Location: {skill_path.parent}/&quot;, style=COLORS[&quot;dim&quot;])
            console.print()

    # Show project skills
    if project_skills_list:
        if not project and user_skills:
            console.print()
        console.print(&quot;[bold green]Project Skills:[/bold green]&quot;, style=COLORS[&quot;primary&quot;])
        for skill in project_skills_list:
            skill_path = Path(skill[&quot;path&quot;])
            console.print(f&quot;   [bold]{skill[&#x27;name&#x27;]}[/bold]&quot;, style=COLORS[&quot;primary&quot;])
            console.print(f&quot;    {skill[&#x27;description&#x27;]}&quot;, style=COLORS[&quot;dim&quot;])
            console.print(f&quot;    Location: {skill_path.parent}/&quot;, style=COLORS[&quot;dim&quot;])
            console.print()


def _create(skill_name: str, agent: str, project: bool = False) -&gt; None:
    &quot;&quot;&quot;Create a new skill with a template SKILL.md file.

    Args:
        skill_name: Name of the skill to create.
        agent: Agent identifier for skills
        project: If True, create in project skills directory.
            If False, create in user skills directory.
    &quot;&quot;&quot;
    # Validate skill name first (per Agent Skills spec)
    is_valid, error_msg = _validate_name(skill_name)
    if not is_valid:
        console.print(f&quot;[bold red]Error:[/bold red] Invalid skill name: {error_msg}&quot;)
        console.print(
            &quot;[dim]Per Agent Skills spec: names must be lowercase alphanumeric with hyphens only.\n&quot;
            &quot;Examples: web-research, code-review, data-analysis[/dim]&quot;,
            style=COLORS[&quot;dim&quot;],
        )
        return

    # Determine target directory
    settings = Settings.from_environment()
    if project:
        if not settings.project_root:
            console.print(&quot;[bold red]Error:[/bold red] Not in a project directory.&quot;)
            console.print(
                &quot;[dim]Project skills require a .git directory in the project root.[/dim]&quot;,
                style=COLORS[&quot;dim&quot;],
            )
            return
        skills_dir = settings.ensure_project_skills_dir()
    else:
        skills_dir = settings.ensure_user_skills_dir(agent)

    skill_dir = skills_dir / skill_name

    # Validate the resolved path is within skills_dir
    is_valid_path, path_error = _validate_skill_path(skill_dir, skills_dir)
    if not is_valid_path:
        console.print(f&quot;[bold red]Error:[/bold red] {path_error}&quot;)
        return

    if skill_dir.exists():
        console.print(
            f&quot;[bold red]Error:[/bold red] Skill &#x27;{skill_name}&#x27; already exists at {skill_dir}&quot;
        )
        return

    # Create skill directory
    skill_dir.mkdir(parents=True, exist_ok=True)

    # Create template SKILL.md (per Agent Skills spec: https://agentskills.io/specification)
    template = f&quot;&quot;&quot;---
name: {skill_name}
description: Brief description of what this skill does and when to use it.
# Optional fields per Agent Skills spec:
# license: Apache-2.0
# compatibility: Designed for deepagents CLI
# metadata:
#   author: your-org
#   version: &quot;1.0&quot;
# allowed-tools: Bash(git:*) Read
---

# {skill_name.title().replace(&quot;-&quot;, &quot; &quot;)} Skill

## Description

[Provide a detailed explanation of what this skill does and when it should be used]

## When to Use

- [Scenario 1: When the user asks...]
- [Scenario 2: When you need to...]
- [Scenario 3: When the task involves...]

## How to Use

### Step 1: [First Action]
[Explain what to do first]

### Step 2: [Second Action]
[Explain what to do next]

### Step 3: [Final Action]
[Explain how to complete the task]

## Best Practices

- [Best practice 1]
- [Best practice 2]
- [Best practice 3]

## Supporting Files

This skill directory can include supporting files referenced in the instructions:
- `helper.py` - Python scripts for automation
- `config.json` - Configuration files
- `reference.md` - Additional reference documentation

## Examples

### Example 1: [Scenario Name]

**User Request:** &quot;[Example user request]&quot;

**Approach:**
1. [Step-by-step breakdown]
2. [Using tools and commands]
3. [Expected outcome]

### Example 2: [Another Scenario]

**User Request:** &quot;[Another example]&quot;

**Approach:**
1. [Different approach]
2. [Relevant commands]
3. [Expected result]

## Notes

- [Additional tips, warnings, or context]
- [Known limitations or edge cases]
- [Links to external resources if helpful]
&quot;&quot;&quot;

    skill_md = skill_dir / &quot;SKILL.md&quot;
    skill_md.write_text(template)

    console.print(f&quot; Skill &#x27;{skill_name}&#x27; created successfully!&quot;, style=COLORS[&quot;primary&quot;])
    console.print(f&quot;Location: {skill_dir}\n&quot;, style=COLORS[&quot;dim&quot;])
    console.print(
        &quot;[dim]Edit the SKILL.md file to customize:\n&quot;
        &quot;  1. Update the description in YAML frontmatter\n&quot;
        &quot;  2. Fill in the instructions and examples\n&quot;
        &quot;  3. Add any supporting files (scripts, configs, etc.)\n&quot;
        &quot;\n&quot;
        f&quot;  nano {skill_md}\n&quot;
        &quot;\n&quot;
        &quot; See examples/skills/ in the deepagents repo for example skills:\n&quot;
        &quot;   - web-research: Structured research workflow\n&quot;
        &quot;   - langgraph-docs: LangGraph documentation lookup\n&quot;
        &quot;\n&quot;
        &quot;   Copy an example: cp -r examples/skills/web-research ~/.deepagents/agent/skills/\n&quot;,
        style=COLORS[&quot;dim&quot;],
    )


def _info(skill_name: str, *, agent: str = &quot;agent&quot;, project: bool = False) -&gt; None:
    &quot;&quot;&quot;Show detailed information about a specific skill.

    Args:
        skill_name: Name of the skill to show info for.
        agent: Agent identifier for skills (default: agent).
        project: If True, only search in project skills. If False, search in both user and project skills.
    &quot;&quot;&quot;
    settings = Settings.from_environment()
    user_skills_dir = settings.get_user_skills_dir(agent)
    project_skills_dir = settings.get_project_skills_dir()

    # Load skills based on --project flag
    if project:
        if not project_skills_dir:
            console.print(&quot;[bold red]Error:[/bold red] Not in a project directory.&quot;)
            return
        skills = list_skills(user_skills_dir=None, project_skills_dir=project_skills_dir)
    else:
        skills = list_skills(user_skills_dir=user_skills_dir, project_skills_dir=project_skills_dir)

    # Find the skill
    skill = next((s for s in skills if s[&quot;name&quot;] == skill_name), None)

    if not skill:
        console.print(f&quot;[bold red]Error:[/bold red] Skill &#x27;{skill_name}&#x27; not found.&quot;)
        console.print(&quot;\n[dim]Available skills:[/dim]&quot;, style=COLORS[&quot;dim&quot;])
        for s in skills:
            console.print(f&quot;  - {s[&#x27;name&#x27;]}&quot;, style=COLORS[&quot;dim&quot;])
        return

    # Read the full SKILL.md file
    skill_path = Path(skill[&quot;path&quot;])
    skill_content = skill_path.read_text()

    # Determine source label
    source_label = &quot;Project Skill&quot; if skill[&quot;source&quot;] == &quot;project&quot; else &quot;User Skill&quot;
    source_color = &quot;green&quot; if skill[&quot;source&quot;] == &quot;project&quot; else &quot;cyan&quot;

    console.print(
        f&quot;\n[bold]Skill: {skill[&#x27;name&#x27;]}[/bold] [bold {source_color}]({source_label})[/bold {source_color}]\n&quot;,
        style=COLORS[&quot;primary&quot;],
    )
    console.print(f&quot;[bold]Description:[/bold] {skill[&#x27;description&#x27;]}\n&quot;, style=COLORS[&quot;dim&quot;])
    console.print(f&quot;[bold]Location:[/bold] {skill_path.parent}/\n&quot;, style=COLORS[&quot;dim&quot;])

    # List supporting files
    skill_dir = skill_path.parent
    supporting_files = [f for f in skill_dir.iterdir() if f.name != &quot;SKILL.md&quot;]

    if supporting_files:
        console.print(&quot;[bold]Supporting Files:[/bold]&quot;, style=COLORS[&quot;dim&quot;])
        for file in supporting_files:
            console.print(f&quot;  - {file.name}&quot;, style=COLORS[&quot;dim&quot;])
        console.print()

    # Show the full SKILL.md content
    console.print(&quot;[bold]Full SKILL.md Content:[/bold]\n&quot;, style=COLORS[&quot;primary&quot;])
    console.print(skill_content, style=COLORS[&quot;dim&quot;])
    console.print()


def setup_skills_parser(
    subparsers: Any,
) -&gt; argparse.ArgumentParser:
    &quot;&quot;&quot;Setup the skills subcommand parser with all its subcommands.&quot;&quot;&quot;
    skills_parser = subparsers.add_parser(
        &quot;skills&quot;,
        help=&quot;Manage agent skills&quot;,
        description=&quot;Manage agent skills - create, list, and view skill information&quot;,
    )
    skills_subparsers = skills_parser.add_subparsers(dest=&quot;skills_command&quot;, help=&quot;Skills command&quot;)

    # Skills list
    list_parser = skills_subparsers.add_parser(
        &quot;list&quot;, help=&quot;List all available skills&quot;, description=&quot;List all available skills&quot;
    )
    list_parser.add_argument(
        &quot;--agent&quot;,
        default=&quot;agent&quot;,
        help=&quot;Agent identifier for skills (default: agent)&quot;,
    )
    list_parser.add_argument(
        &quot;--project&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Show only project-level skills&quot;,
    )

    # Skills create
    create_parser = skills_subparsers.add_parser(
        &quot;create&quot;,
        help=&quot;Create a new skill&quot;,
        description=&quot;Create a new skill with a template SKILL.md file&quot;,
    )
    create_parser.add_argument(&quot;name&quot;, help=&quot;Name of the skill to create (e.g., web-research)&quot;)
    create_parser.add_argument(
        &quot;--agent&quot;,
        default=&quot;agent&quot;,
        help=&quot;Agent identifier for skills (default: agent)&quot;,
    )
    create_parser.add_argument(
        &quot;--project&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Create skill in project directory instead of user directory&quot;,
    )

    # Skills info
    info_parser = skills_subparsers.add_parser(
        &quot;info&quot;,
        help=&quot;Show detailed information about a skill&quot;,
        description=&quot;Show detailed information about a specific skill&quot;,
    )
    info_parser.add_argument(&quot;name&quot;, help=&quot;Name of the skill to show info for&quot;)
    info_parser.add_argument(
        &quot;--agent&quot;,
        default=&quot;agent&quot;,
        help=&quot;Agent identifier for skills (default: agent)&quot;,
    )
    info_parser.add_argument(
        &quot;--project&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Search only in project skills&quot;,
    )
    return skills_parser


def execute_skills_command(args: argparse.Namespace) -&gt; None:
    &quot;&quot;&quot;Execute skills subcommands based on parsed arguments.

    Args:
        args: Parsed command line arguments with skills_command attribute
    &quot;&quot;&quot;
    # validate agent argument
    if args.agent:
        is_valid, error_msg = _validate_name(args.agent)
        if not is_valid:
            console.print(f&quot;[bold red]Error:[/bold red] Invalid agent name: {error_msg}&quot;)
            console.print(
                &quot;[dim]Agent names must only contain letters, numbers, hyphens, and underscores.[/dim]&quot;,
                style=COLORS[&quot;dim&quot;],
            )
            return

    if args.skills_command == &quot;list&quot;:
        _list(agent=args.agent, project=args.project)
    elif args.skills_command == &quot;create&quot;:
        _create(args.name, agent=args.agent, project=args.project)
    elif args.skills_command == &quot;info&quot;:
        _info(args.name, agent=args.agent, project=args.project)
    else:
        # No subcommand provided, show help
        console.print(&quot;[yellow]Please specify a skills subcommand: list, create, or info[/yellow]&quot;)
        console.print(&quot;\n[bold]Usage:[/bold]&quot;, style=COLORS[&quot;primary&quot;])
        console.print(&quot;  deepagents skills &lt;command&gt; [options]\n&quot;)
        console.print(&quot;[bold]Available commands:[/bold]&quot;, style=COLORS[&quot;primary&quot;])
        console.print(&quot;  list              List all available skills&quot;)
        console.print(&quot;  create &lt;name&gt;     Create a new skill&quot;)
        console.print(&quot;  info &lt;name&gt;       Show detailed information about a skill&quot;)
        console.print(&quot;\n[bold]Examples:[/bold]&quot;, style=COLORS[&quot;primary&quot;])
        console.print(&quot;  deepagents skills list&quot;)
        console.print(&quot;  deepagents skills create web-research&quot;)
        console.print(&quot;  deepagents skills info web-research&quot;)
        console.print(&quot;\n[dim]For more help on a specific command:[/dim]&quot;, style=COLORS[&quot;dim&quot;])
        console.print(&quot;  deepagents skills &lt;command&gt; --help&quot;, style=COLORS[&quot;dim&quot;])


__all__ = [
    &quot;execute_skills_command&quot;,
    &quot;setup_skills_parser&quot;,
]</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/commands/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="composite Imported skill composite from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/backends/composite.py Unknown LICENSE sources/langchain/composite/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">composite</div>
                <button class="copy-btn" onclick="copyToClipboard('composite')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill composite from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Composite backend that routes file operations by path prefix.

Routes operations to different backends based on path prefixes. Use this when you
need different storage strategies for different paths (e.g., state for temp files,
persistent store for memories).

Examples:
    ```python
    from deepagents.backends.composite import CompositeBackend
    from deepagents.backends.state import StateBackend
    from deepagents.backends.store import StoreBackend

    runtime = make_runtime()
    composite = CompositeBackend(default=StateBackend(runtime), routes={&quot;/memories/&quot;: StoreBackend(runtime)})

    composite.write(&quot;/temp.txt&quot;, &quot;ephemeral&quot;)
    composite.write(&quot;/memories/note.md&quot;, &quot;persistent&quot;)
    ```
&quot;&quot;&quot;

from collections import defaultdict

from deepagents.backends.protocol import (
    BackendProtocol,
    EditResult,
    ExecuteResponse,
    FileDownloadResponse,
    FileInfo,
    FileUploadResponse,
    GrepMatch,
    SandboxBackendProtocol,
    WriteResult,
)
from deepagents.backends.state import StateBackend


class CompositeBackend(BackendProtocol):
    &quot;&quot;&quot;Routes file operations to different backends by path prefix.

    Matches paths against route prefixes (longest first) and delegates to the
    corresponding backend. Unmatched paths use the default backend.

    Attributes:
        default: Backend for paths that don&#x27;t match any route.
        routes: Map of path prefixes to backends (e.g., {&quot;/memories/&quot;: store_backend}).
        sorted_routes: Routes sorted by length (longest first) for correct matching.

    Examples:
        ```python
        composite = CompositeBackend(default=StateBackend(runtime), routes={&quot;/memories/&quot;: StoreBackend(runtime), &quot;/cache/&quot;: StoreBackend(runtime)})

        composite.write(&quot;/temp.txt&quot;, &quot;data&quot;)
        composite.write(&quot;/memories/note.txt&quot;, &quot;data&quot;)
        ```
    &quot;&quot;&quot;

    def __init__(
        self,
        default: BackendProtocol | StateBackend,
        routes: dict[str, BackendProtocol],
    ) -&gt; None:
        &quot;&quot;&quot;Initialize composite backend.

        Args:
            default: Backend for paths that don&#x27;t match any route.
            routes: Map of path prefixes to backends. Prefixes must start with &quot;/&quot;
                and should end with &quot;/&quot; (e.g., &quot;/memories/&quot;).
        &quot;&quot;&quot;
        # Default backend
        self.default = default

        # Virtual routes
        self.routes = routes

        # Sort routes by length (longest first) for correct prefix matching
        self.sorted_routes = sorted(routes.items(), key=lambda x: len(x[0]), reverse=True)

    def _get_backend_and_key(self, key: str) -&gt; tuple[BackendProtocol, str]:
        &quot;&quot;&quot;Get backend for path and strip route prefix.

        Args:
            key: File path to route.

        Returns:
            Tuple of (backend, stripped_path). The stripped path has the route
            prefix removed but keeps the leading slash.
        &quot;&quot;&quot;
        # Check routes in order of length (longest first)
        for prefix, backend in self.sorted_routes:
            if key.startswith(prefix):
                # Strip full prefix and ensure a leading slash remains
                # e.g., &quot;/memories/notes.txt&quot;  &quot;/notes.txt&quot;; &quot;/memories/&quot;  &quot;/&quot;
                suffix = key[len(prefix) :]
                stripped_key = f&quot;/{suffix}&quot; if suffix else &quot;/&quot;
                return backend, stripped_key

        return self.default, key

    def ls_info(self, path: str) -&gt; list[FileInfo]:
        &quot;&quot;&quot;List directory contents (non-recursive).

        If path matches a route, lists only that backend. If path is &quot;/&quot;, aggregates
        default backend plus virtual route directories. Otherwise lists default backend.

        Args:
            path: Absolute directory path starting with &quot;/&quot;.

        Returns:
            List of FileInfo dicts. Directories have trailing &quot;/&quot; and is_dir=True.
            Route prefixes are restored in returned paths.

        Examples:
            ```python
            infos = composite.ls_info(&quot;/&quot;)
            infos = composite.ls_info(&quot;/memories/&quot;)
            ```
        &quot;&quot;&quot;
        # Check if path matches a specific route
        for route_prefix, backend in self.sorted_routes:
            if path.startswith(route_prefix.rstrip(&quot;/&quot;)):
                # Query only the matching routed backend
                suffix = path[len(route_prefix) :]
                search_path = f&quot;/{suffix}&quot; if suffix else &quot;/&quot;
                infos = backend.ls_info(search_path)
                prefixed: list[FileInfo] = []
                for fi in infos:
                    fi = dict(fi)
                    fi[&quot;path&quot;] = f&quot;{route_prefix[:-1]}{fi[&#x27;path&#x27;]}&quot;
                    prefixed.append(fi)
                return prefixed

        # At root, aggregate default and all routed backends
        if path == &quot;/&quot;:
            results: list[FileInfo] = []
            results.extend(self.default.ls_info(path))
            for route_prefix, backend in self.sorted_routes:
                # Add the route itself as a directory (e.g., /memories/)
                results.append(
                    {
                        &quot;path&quot;: route_prefix,
                        &quot;is_dir&quot;: True,
                        &quot;size&quot;: 0,
                        &quot;modified_at&quot;: &quot;&quot;,
                    }
                )

            results.sort(key=lambda x: x.get(&quot;path&quot;, &quot;&quot;))
            return results

        # Path doesn&#x27;t match a route: query only default backend
        return self.default.ls_info(path)

    async def als_info(self, path: str) -&gt; list[FileInfo]:
        &quot;&quot;&quot;Async version of ls_info.&quot;&quot;&quot;
        # Check if path matches a specific route
        for route_prefix, backend in self.sorted_routes:
            if path.startswith(route_prefix.rstrip(&quot;/&quot;)):
                # Query only the matching routed backend
                suffix = path[len(route_prefix) :]
                search_path = f&quot;/{suffix}&quot; if suffix else &quot;/&quot;
                infos = await backend.als_info(search_path)
                prefixed: list[FileInfo] = []
                for fi in infos:
                    fi = dict(fi)
                    fi[&quot;path&quot;] = f&quot;{route_prefix[:-1]}{fi[&#x27;path&#x27;]}&quot;
                    prefixed.append(fi)
                return prefixed

        # At root, aggregate default and all routed backends
        if path == &quot;/&quot;:
            results: list[FileInfo] = []
            results.extend(await self.default.als_info(path))
            for route_prefix, backend in self.sorted_routes:
                # Add the route itself as a directory (e.g., /memories/)
                results.append(
                    {
                        &quot;path&quot;: route_prefix,
                        &quot;is_dir&quot;: True,
                        &quot;size&quot;: 0,
                        &quot;modified_at&quot;: &quot;&quot;,
                    }
                )

            results.sort(key=lambda x: x.get(&quot;path&quot;, &quot;&quot;))
            return results

        # Path doesn&#x27;t match a route: query only default backend
        return await self.default.als_info(path)

    def read(
        self,
        file_path: str,
        offset: int = 0,
        limit: int = 2000,
    ) -&gt; str:
        &quot;&quot;&quot;Read file content, routing to appropriate backend.

        Args:
            file_path: Absolute file path.
            offset: Line offset to start reading from (0-indexed).
            limit: Maximum number of lines to read.

        Returns:
            Formatted file content with line numbers, or error message.
        &quot;&quot;&quot;
        backend, stripped_key = self._get_backend_and_key(file_path)
        return backend.read(stripped_key, offset=offset, limit=limit)

    async def aread(
        self,
        file_path: str,
        offset: int = 0,
        limit: int = 2000,
    ) -&gt; str:
        &quot;&quot;&quot;Async version of read.&quot;&quot;&quot;
        backend, stripped_key = self._get_backend_and_key(file_path)
        return await backend.aread(stripped_key, offset=offset, limit=limit)

    def grep_raw(
        self,
        pattern: str,
        path: str | None = None,
        glob: str | None = None,
    ) -&gt; list[GrepMatch] | str:
        &quot;&quot;&quot;Search files for regex pattern.

        Routes to backends based on path: specific route searches one backend,
        &quot;/&quot; or None searches all backends, otherwise searches default backend.

        Args:
            pattern: Regex pattern to search for.
            path: Directory to search. None searches all backends.
            glob: Glob pattern to filter files (e.g., &quot;*.py&quot;, &quot;**/*.txt&quot;).
                Filters by filename, not content.

        Returns:
            List of GrepMatch dicts with path (route prefix restored), line
            (1-indexed), and text. Returns error string on failure.

        Examples:
            ```python
            matches = composite.grep_raw(&quot;TODO&quot;, path=&quot;/memories/&quot;)
            matches = composite.grep_raw(&quot;error&quot;, path=&quot;/&quot;)
            matches = composite.grep_raw(&quot;import&quot;, path=&quot;/&quot;, glob=&quot;*.py&quot;)
            ```
        &quot;&quot;&quot;
        # If path targets a specific route, search only that backend
        for route_prefix, backend in self.sorted_routes:
            if path is not None and path.startswith(route_prefix.rstrip(&quot;/&quot;)):
                search_path = path[len(route_prefix) - 1 :]
                raw = backend.grep_raw(pattern, search_path if search_path else &quot;/&quot;, glob)
                if isinstance(raw, str):
                    return raw
                return [{**m, &quot;path&quot;: f&quot;{route_prefix[:-1]}{m[&#x27;path&#x27;]}&quot;} for m in raw]

        # If path is None or &quot;/&quot;, search default and all routed backends and merge
        # Otherwise, search only the default backend
        if path is None or path == &quot;/&quot;:
            all_matches: list[GrepMatch] = []
            raw_default = self.default.grep_raw(pattern, path, glob)  # type: ignore[attr-defined]
            if isinstance(raw_default, str):
                # This happens if error occurs
                return raw_default
            all_matches.extend(raw_default)

            for route_prefix, backend in self.routes.items():
                raw = backend.grep_raw(pattern, &quot;/&quot;, glob)
                if isinstance(raw, str):
                    # This happens if error occurs
                    return raw
                all_matches.extend({**m, &quot;path&quot;: f&quot;{route_prefix[:-1]}{m[&#x27;path&#x27;]}&quot;} for m in raw)

            return all_matches
        # Path specified but doesn&#x27;t match a route - search only default
        return self.default.grep_raw(pattern, path, glob)  # type: ignore[attr-defined]

    async def agrep_raw(
        self,
        pattern: str,
        path: str | None = None,
        glob: str | None = None,
    ) -&gt; list[GrepMatch] | str:
        &quot;&quot;&quot;Async version of grep_raw.

        See grep_raw() for detailed documentation on routing behavior and parameters.
        &quot;&quot;&quot;
        # If path targets a specific route, search only that backend
        for route_prefix, backend in self.sorted_routes:
            if path is not None and path.startswith(route_prefix.rstrip(&quot;/&quot;)):
                search_path = path[len(route_prefix) - 1 :]
                raw = await backend.agrep_raw(pattern, search_path if search_path else &quot;/&quot;, glob)
                if isinstance(raw, str):
                    return raw
                return [{**m, &quot;path&quot;: f&quot;{route_prefix[:-1]}{m[&#x27;path&#x27;]}&quot;} for m in raw]

        # If path is None or &quot;/&quot;, search default and all routed backends and merge
        # Otherwise, search only the default backend
        if path is None or path == &quot;/&quot;:
            all_matches: list[GrepMatch] = []
            raw_default = await self.default.agrep_raw(pattern, path, glob)  # type: ignore[attr-defined]
            if isinstance(raw_default, str):
                # This happens if error occurs
                return raw_default
            all_matches.extend(raw_default)

            for route_prefix, backend in self.routes.items():
                raw = await backend.agrep_raw(pattern, &quot;/&quot;, glob)
                if isinstance(raw, str):
                    # This happens if error occurs
                    return raw
                all_matches.extend({**m, &quot;path&quot;: f&quot;{route_prefix[:-1]}{m[&#x27;path&#x27;]}&quot;} for m in raw)

            return all_matches
        # Path specified but doesn&#x27;t match a route - search only default
        return await self.default.agrep_raw(pattern, path, glob)  # type: ignore[attr-defined]

    def glob_info(self, pattern: str, path: str = &quot;/&quot;) -&gt; list[FileInfo]:
        results: list[FileInfo] = []

        # Route based on path, not pattern
        for route_prefix, backend in self.sorted_routes:
            if path.startswith(route_prefix.rstrip(&quot;/&quot;)):
                search_path = path[len(route_prefix) - 1 :]
                infos = backend.glob_info(pattern, search_path if search_path else &quot;/&quot;)
                return [{**fi, &quot;path&quot;: f&quot;{route_prefix[:-1]}{fi[&#x27;path&#x27;]}&quot;} for fi in infos]

        # Path doesn&#x27;t match any specific route - search default backend AND all routed backends
        results.extend(self.default.glob_info(pattern, path))

        for route_prefix, backend in self.routes.items():
            infos = backend.glob_info(pattern, &quot;/&quot;)
            results.extend({**fi, &quot;path&quot;: f&quot;{route_prefix[:-1]}{fi[&#x27;path&#x27;]}&quot;} for fi in infos)

        # Deterministic ordering
        results.sort(key=lambda x: x.get(&quot;path&quot;, &quot;&quot;))
        return results

    async def aglob_info(self, pattern: str, path: str = &quot;/&quot;) -&gt; list[FileInfo]:
        &quot;&quot;&quot;Async version of glob_info.&quot;&quot;&quot;
        results: list[FileInfo] = []

        # Route based on path, not pattern
        for route_prefix, backend in self.sorted_routes:
            if path.startswith(route_prefix.rstrip(&quot;/&quot;)):
                search_path = path[len(route_prefix) - 1 :]
                infos = await backend.aglob_info(pattern, search_path if search_path else &quot;/&quot;)
                return [{**fi, &quot;path&quot;: f&quot;{route_prefix[:-1]}{fi[&#x27;path&#x27;]}&quot;} for fi in infos]

        # Path doesn&#x27;t match any specific route - search default backend AND all routed backends
        results.extend(await self.default.aglob_info(pattern, path))

        for route_prefix, backend in self.routes.items():
            infos = await backend.aglob_info(pattern, &quot;/&quot;)
            results.extend({**fi, &quot;path&quot;: f&quot;{route_prefix[:-1]}{fi[&#x27;path&#x27;]}&quot;} for fi in infos)

        # Deterministic ordering
        results.sort(key=lambda x: x.get(&quot;path&quot;, &quot;&quot;))
        return results

    def write(
        self,
        file_path: str,
        content: str,
    ) -&gt; WriteResult:
        &quot;&quot;&quot;Create a new file, routing to appropriate backend.

        Args:
            file_path: Absolute file path.
            content: File content as a string.

        Returns:
            Success message or Command object, or error if file already exists.
        &quot;&quot;&quot;
        backend, stripped_key = self._get_backend_and_key(file_path)
        res = backend.write(stripped_key, content)
        # If this is a state-backed update and default has state, merge so listings reflect changes
        if res.files_update:
            try:
                runtime = getattr(self.default, &quot;runtime&quot;, None)
                if runtime is not None:
                    state = runtime.state
                    files = state.get(&quot;files&quot;, {})
                    files.update(res.files_update)
                    state[&quot;files&quot;] = files
            except Exception:
                pass
        return res

    async def awrite(
        self,
        file_path: str,
        content: str,
    ) -&gt; WriteResult:
        &quot;&quot;&quot;Async version of write.&quot;&quot;&quot;
        backend, stripped_key = self._get_backend_and_key(file_path)
        res = await backend.awrite(stripped_key, content)
        # If this is a state-backed update and default has state, merge so listings reflect changes
        if res.files_update:
            try:
                runtime = getattr(self.default, &quot;runtime&quot;, None)
                if runtime is not None:
                    state = runtime.state
                    files = state.get(&quot;files&quot;, {})
                    files.update(res.files_update)
                    state[&quot;files&quot;] = files
            except Exception:
                pass
        return res

    def edit(
        self,
        file_path: str,
        old_string: str,
        new_string: str,
        replace_all: bool = False,
    ) -&gt; EditResult:
        &quot;&quot;&quot;Edit a file, routing to appropriate backend.

        Args:
            file_path: Absolute file path.
            old_string: String to find and replace.
            new_string: Replacement string.
            replace_all: If True, replace all occurrences.

        Returns:
            Success message or Command object, or error message on failure.
        &quot;&quot;&quot;
        backend, stripped_key = self._get_backend_and_key(file_path)
        res = backend.edit(stripped_key, old_string, new_string, replace_all=replace_all)
        if res.files_update:
            try:
                runtime = getattr(self.default, &quot;runtime&quot;, None)
                if runtime is not None:
                    state = runtime.state
                    files = state.get(&quot;files&quot;, {})
                    files.update(res.files_update)
                    state[&quot;files&quot;] = files
            except Exception:
                pass
        return res

    async def aedit(
        self,
        file_path: str,
        old_string: str,
        new_string: str,
        replace_all: bool = False,
    ) -&gt; EditResult:
        &quot;&quot;&quot;Async version of edit.&quot;&quot;&quot;
        backend, stripped_key = self._get_backend_and_key(file_path)
        res = await backend.aedit(stripped_key, old_string, new_string, replace_all=replace_all)
        if res.files_update:
            try:
                runtime = getattr(self.default, &quot;runtime&quot;, None)
                if runtime is not None:
                    state = runtime.state
                    files = state.get(&quot;files&quot;, {})
                    files.update(res.files_update)
                    state[&quot;files&quot;] = files
            except Exception:
                pass
        return res

    def execute(
        self,
        command: str,
    ) -&gt; ExecuteResponse:
        &quot;&quot;&quot;Execute shell command via default backend.

        Args:
            command: Shell command to execute.

        Returns:
            ExecuteResponse with output, exit code, and truncation flag.

        Raises:
            NotImplementedError: If default backend doesn&#x27;t implement SandboxBackendProtocol.

        Examples:
            ```python
            composite = CompositeBackend(default=FilesystemBackend(root_dir=&quot;/tmp&quot;), routes={&quot;/memories/&quot;: StoreBackend(runtime)})

            result = composite.execute(&quot;ls -la&quot;)
            ```
        &quot;&quot;&quot;
        if isinstance(self.default, SandboxBackendProtocol):
            return self.default.execute(command)

        # This shouldn&#x27;t be reached if the runtime check in the execute tool works correctly,
        # but we include it as a safety fallback.
        raise NotImplementedError(
            &quot;Default backend doesn&#x27;t support command execution (SandboxBackendProtocol). &quot;
            &quot;To enable execution, provide a default backend that implements SandboxBackendProtocol.&quot;
        )

    async def aexecute(
        self,
        command: str,
    ) -&gt; ExecuteResponse:
        &quot;&quot;&quot;Async version of execute.&quot;&quot;&quot;
        if isinstance(self.default, SandboxBackendProtocol):
            return await self.default.aexecute(command)

        # This shouldn&#x27;t be reached if the runtime check in the execute tool works correctly,
        # but we include it as a safety fallback.
        raise NotImplementedError(
            &quot;Default backend doesn&#x27;t support command execution (SandboxBackendProtocol). &quot;
            &quot;To enable execution, provide a default backend that implements SandboxBackendProtocol.&quot;
        )

    def upload_files(self, files: list[tuple[str, bytes]]) -&gt; list[FileUploadResponse]:
        &quot;&quot;&quot;Upload multiple files, batching by backend for efficiency.

        Groups files by their target backend, calls each backend&#x27;s upload_files
        once with all files for that backend, then merges results in original order.

        Args:
            files: List of (path, content) tuples to upload.

        Returns:
            List of FileUploadResponse objects, one per input file.
            Response order matches input order.
        &quot;&quot;&quot;
        # Pre-allocate result list
        results: list[FileUploadResponse | None] = [None] * len(files)

        # Group files by backend, tracking original indices
        from collections import defaultdict

        backend_batches: dict[BackendProtocol, list[tuple[int, str, bytes]]] = defaultdict(list)

        for idx, (path, content) in enumerate(files):
            backend, stripped_path = self._get_backend_and_key(path)
            backend_batches[backend].append((idx, stripped_path, content))

        # Process each backend&#x27;s batch
        for backend, batch in backend_batches.items():
            # Extract data for backend call
            indices, stripped_paths, contents = zip(*batch, strict=False)
            batch_files = list(zip(stripped_paths, contents, strict=False))

            # Call backend once with all its files
            batch_responses = backend.upload_files(batch_files)

            # Place responses at original indices with original paths
            for i, orig_idx in enumerate(indices):
                results[orig_idx] = FileUploadResponse(
                    path=files[orig_idx][0],  # Original path
                    error=batch_responses[i].error if i &lt; len(batch_responses) else None,
                )

        return results  # type: ignore[return-value]

    async def aupload_files(self, files: list[tuple[str, bytes]]) -&gt; list[FileUploadResponse]:
        &quot;&quot;&quot;Async version of upload_files.&quot;&quot;&quot;
        # Pre-allocate result list
        results: list[FileUploadResponse | None] = [None] * len(files)

        # Group files by backend, tracking original indices
        backend_batches: dict[BackendProtocol, list[tuple[int, str, bytes]]] = defaultdict(list)

        for idx, (path, content) in enumerate(files):
            backend, stripped_path = self._get_backend_and_key(path)
            backend_batches[backend].append((idx, stripped_path, content))

        # Process each backend&#x27;s batch
        for backend, batch in backend_batches.items():
            # Extract data for backend call
            indices, stripped_paths, contents = zip(*batch, strict=False)
            batch_files = list(zip(stripped_paths, contents, strict=False))

            # Call backend once with all its files
            batch_responses = await backend.aupload_files(batch_files)

            # Place responses at original indices with original paths
            for i, orig_idx in enumerate(indices):
                results[orig_idx] = FileUploadResponse(
                    path=files[orig_idx][0],  # Original path
                    error=batch_responses[i].error if i &lt; len(batch_responses) else None,
                )

        return results  # type: ignore[return-value]

    def download_files(self, paths: list[str]) -&gt; list[FileDownloadResponse]:
        &quot;&quot;&quot;Download multiple files, batching by backend for efficiency.

        Groups paths by their target backend, calls each backend&#x27;s download_files
        once with all paths for that backend, then merges results in original order.

        Args:
            paths: List of file paths to download.

        Returns:
            List of FileDownloadResponse objects, one per input path.
            Response order matches input order.
        &quot;&quot;&quot;
        # Pre-allocate result list
        results: list[FileDownloadResponse | None] = [None] * len(paths)

        backend_batches: dict[BackendProtocol, list[tuple[int, str]]] = defaultdict(list)

        for idx, path in enumerate(paths):
            backend, stripped_path = self._get_backend_and_key(path)
            backend_batches[backend].append((idx, stripped_path))

        # Process each backend&#x27;s batch
        for backend, batch in backend_batches.items():
            # Extract data for backend call
            indices, stripped_paths = zip(*batch, strict=False)

            # Call backend once with all its paths
            batch_responses = backend.download_files(list(stripped_paths))

            # Place responses at original indices with original paths
            for i, orig_idx in enumerate(indices):
                results[orig_idx] = FileDownloadResponse(
                    path=paths[orig_idx],  # Original path
                    content=batch_responses[i].content if i &lt; len(batch_responses) else None,
                    error=batch_responses[i].error if i &lt; len(batch_responses) else None,
                )

        return results  # type: ignore[return-value]

    async def adownload_files(self, paths: list[str]) -&gt; list[FileDownloadResponse]:
        &quot;&quot;&quot;Async version of download_files.&quot;&quot;&quot;
        # Pre-allocate result list
        results: list[FileDownloadResponse | None] = [None] * len(paths)

        backend_batches: dict[BackendProtocol, list[tuple[int, str]]] = defaultdict(list)

        for idx, path in enumerate(paths):
            backend, stripped_path = self._get_backend_and_key(path)
            backend_batches[backend].append((idx, stripped_path))

        # Process each backend&#x27;s batch
        for backend, batch in backend_batches.items():
            # Extract data for backend call
            indices, stripped_paths = zip(*batch, strict=False)

            # Call backend once with all its paths
            batch_responses = await backend.adownload_files(list(stripped_paths))

            # Place responses at original indices with original paths
            for i, orig_idx in enumerate(indices):
                results[orig_idx] = FileDownloadResponse(
                    path=paths[orig_idx],  # Original path
                    content=batch_responses[i].content if i &lt; len(batch_responses) else None,
                    error=batch_responses[i].error if i &lt; len(batch_responses) else None,
                )

        return results  # type: ignore[return-value]</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/composite/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/backends/composite.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="config Imported skill config from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/config.py Unknown LICENSE sources/langchain/config/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">config</div>
                <button class="copy-btn" onclick="copyToClipboard('config')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill config from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Configuration, constants, and model creation for the CLI.&quot;&quot;&quot;

import os
import re
import sys
import uuid
from dataclasses import dataclass
from pathlib import Path

import dotenv
from rich.console import Console

from deepagents_cli._version import __version__

dotenv.load_dotenv()

# CRITICAL: Override LANGSMITH_PROJECT to route agent traces to separate project
# LangSmith reads LANGSMITH_PROJECT at invocation time, so we override it here
# and preserve the user&#x27;s original value for shell commands
_deepagents_project = os.environ.get(&quot;DEEPAGENTS_LANGSMITH_PROJECT&quot;)
_original_langsmith_project = os.environ.get(&quot;LANGSMITH_PROJECT&quot;)
if _deepagents_project:
    # Override LANGSMITH_PROJECT for agent traces
    os.environ[&quot;LANGSMITH_PROJECT&quot;] = _deepagents_project

# Now safe to import LangChain modules
from langchain_core.language_models import BaseChatModel

# Color scheme
COLORS = {
    &quot;primary&quot;: &quot;#10b981&quot;,
    &quot;dim&quot;: &quot;#6b7280&quot;,
    &quot;user&quot;: &quot;#ffffff&quot;,
    &quot;agent&quot;: &quot;#10b981&quot;,
    &quot;thinking&quot;: &quot;#34d399&quot;,
    &quot;tool&quot;: &quot;#fbbf24&quot;,
}

# ASCII art banner

DEEP_AGENTS_ASCII = f&quot;&quot;&quot;
     
    
          
          
    
     

             
         
                 
                 
               
                  
                                              v{__version__}
&quot;&quot;&quot;

# Interactive commands
COMMANDS = {
    &quot;clear&quot;: &quot;Clear screen and reset conversation&quot;,
    &quot;help&quot;: &quot;Show help information&quot;,
    &quot;tokens&quot;: &quot;Show token usage for current session&quot;,
    &quot;quit&quot;: &quot;Exit the CLI&quot;,
    &quot;exit&quot;: &quot;Exit the CLI&quot;,
}


# Maximum argument length for display
MAX_ARG_LENGTH = 150

# Agent configuration
config = {&quot;recursion_limit&quot;: 1000}

# Rich console instance
console = Console(highlight=False)


def _find_project_root(start_path: Path | None = None) -&gt; Path | None:
    &quot;&quot;&quot;Find the project root by looking for .git directory.

    Walks up the directory tree from start_path (or cwd) looking for a .git
    directory, which indicates the project root.

    Args:
        start_path: Directory to start searching from. Defaults to current working directory.

    Returns:
        Path to the project root if found, None otherwise.
    &quot;&quot;&quot;
    current = Path(start_path or Path.cwd()).resolve()

    # Walk up the directory tree
    for parent in [current, *list(current.parents)]:
        git_dir = parent / &quot;.git&quot;
        if git_dir.exists():
            return parent

    return None


def _find_project_agent_md(project_root: Path) -&gt; list[Path]:
    &quot;&quot;&quot;Find project-specific AGENTS.md file(s).

    Checks two locations and returns ALL that exist:
    1. project_root/.deepagents/AGENTS.md
    2. project_root/AGENTS.md

    Both files will be loaded and combined if both exist.

    Args:
        project_root: Path to the project root directory.

    Returns:
        List of paths to project AGENTS.md files (may contain 0, 1, or 2 paths).
    &quot;&quot;&quot;
    paths = []

    # Check .deepagents/AGENTS.md (preferred)
    deepagents_md = project_root / &quot;.deepagents&quot; / &quot;AGENTS.md&quot;
    if deepagents_md.exists():
        paths.append(deepagents_md)

    # Check root AGENTS.md (fallback, but also include if both exist)
    root_md = project_root / &quot;AGENTS.md&quot;
    if root_md.exists():
        paths.append(root_md)

    return paths


@dataclass
class Settings:
    &quot;&quot;&quot;Global settings and environment detection for deepagents-cli.

    This class is initialized once at startup and provides access to:
    - Available models and API keys
    - Current project information
    - Tool availability (e.g., Tavily)
    - File system paths

    Attributes:
        project_root: Current project root directory (if in a git project)

        openai_api_key: OpenAI API key if available
        anthropic_api_key: Anthropic API key if available
        tavily_api_key: Tavily API key if available
        deepagents_langchain_project: LangSmith project name for deepagents agent tracing
        user_langchain_project: Original LANGSMITH_PROJECT from environment (for user code)
    &quot;&quot;&quot;

    # API keys
    openai_api_key: str | None
    anthropic_api_key: str | None
    google_api_key: str | None
    tavily_api_key: str | None

    # LangSmith configuration
    deepagents_langchain_project: str | None  # For deepagents agent tracing
    user_langchain_project: str | None  # Original LANGSMITH_PROJECT for user code

    # Model configuration
    model_name: str | None = None  # Currently active model name
    model_provider: str | None = None  # Provider (openai, anthropic, google)

    # Project information
    project_root: Path | None = None

    @classmethod
    def from_environment(cls, *, start_path: Path | None = None) -&gt; &quot;Settings&quot;:
        &quot;&quot;&quot;Create settings by detecting the current environment.

        Args:
            start_path: Directory to start project detection from (defaults to cwd)

        Returns:
            Settings instance with detected configuration
        &quot;&quot;&quot;
        # Detect API keys
        openai_key = os.environ.get(&quot;OPENAI_API_KEY&quot;)
        anthropic_key = os.environ.get(&quot;ANTHROPIC_API_KEY&quot;)
        google_key = os.environ.get(&quot;GOOGLE_API_KEY&quot;)
        tavily_key = os.environ.get(&quot;TAVILY_API_KEY&quot;)

        # Detect LangSmith configuration
        # DEEPAGENTS_LANGSMITH_PROJECT: Project for deepagents agent tracing
        # user_langchain_project: User&#x27;s ORIGINAL LANGSMITH_PROJECT (before override)
        # Note: LANGSMITH_PROJECT was already overridden at module import time (above)
        # so we use the saved original value, not the current os.environ value
        deepagents_langchain_project = os.environ.get(&quot;DEEPAGENTS_LANGSMITH_PROJECT&quot;)
        user_langchain_project = _original_langsmith_project  # Use saved original!

        # Detect project
        project_root = _find_project_root(start_path)

        return cls(
            openai_api_key=openai_key,
            anthropic_api_key=anthropic_key,
            google_api_key=google_key,
            tavily_api_key=tavily_key,
            deepagents_langchain_project=deepagents_langchain_project,
            user_langchain_project=user_langchain_project,
            project_root=project_root,
        )

    @property
    def has_openai(self) -&gt; bool:
        &quot;&quot;&quot;Check if OpenAI API key is configured.&quot;&quot;&quot;
        return self.openai_api_key is not None

    @property
    def has_anthropic(self) -&gt; bool:
        &quot;&quot;&quot;Check if Anthropic API key is configured.&quot;&quot;&quot;
        return self.anthropic_api_key is not None

    @property
    def has_google(self) -&gt; bool:
        &quot;&quot;&quot;Check if Google API key is configured.&quot;&quot;&quot;
        return self.google_api_key is not None

    @property
    def has_tavily(self) -&gt; bool:
        &quot;&quot;&quot;Check if Tavily API key is configured.&quot;&quot;&quot;
        return self.tavily_api_key is not None

    @property
    def has_deepagents_langchain_project(self) -&gt; bool:
        &quot;&quot;&quot;Check if deepagents LangChain project name is configured.&quot;&quot;&quot;
        return self.deepagents_langchain_project is not None

    @property
    def has_project(self) -&gt; bool:
        &quot;&quot;&quot;Check if currently in a git project.&quot;&quot;&quot;
        return self.project_root is not None

    @property
    def user_deepagents_dir(self) -&gt; Path:
        &quot;&quot;&quot;Get the base user-level .deepagents directory.

        Returns:
            Path to ~/.deepagents
        &quot;&quot;&quot;
        return Path.home() / &quot;.deepagents&quot;

    def get_user_agent_md_path(self, agent_name: str) -&gt; Path:
        &quot;&quot;&quot;Get user-level AGENTS.md path for a specific agent.

        Returns path regardless of whether the file exists.

        Args:
            agent_name: Name of the agent

        Returns:
            Path to ~/.deepagents/{agent_name}/AGENTS.md
        &quot;&quot;&quot;
        return Path.home() / &quot;.deepagents&quot; / agent_name / &quot;AGENTS.md&quot;

    def get_project_agent_md_path(self) -&gt; Path | None:
        &quot;&quot;&quot;Get project-level AGENTS.md path.

        Returns path regardless of whether the file exists.

        Returns:
            Path to {project_root}/.deepagents/AGENTS.md, or None if not in a project
        &quot;&quot;&quot;
        if not self.project_root:
            return None
        return self.project_root / &quot;.deepagents&quot; / &quot;AGENTS.md&quot;

    @staticmethod
    def _is_valid_agent_name(agent_name: str) -&gt; bool:
        &quot;&quot;&quot;Validate prevent invalid filesystem paths and security issues.&quot;&quot;&quot;
        if not agent_name or not agent_name.strip():
            return False
        # Allow only alphanumeric, hyphens, underscores, and whitespace
        return bool(re.match(r&quot;^[a-zA-Z0-9_\-\s]+$&quot;, agent_name))

    def get_agent_dir(self, agent_name: str) -&gt; Path:
        &quot;&quot;&quot;Get the global agent directory path.

        Args:
            agent_name: Name of the agent

        Returns:
            Path to ~/.deepagents/{agent_name}
        &quot;&quot;&quot;
        if not self._is_valid_agent_name(agent_name):
            msg = (
                f&quot;Invalid agent name: {agent_name!r}. &quot;
                &quot;Agent names can only contain letters, numbers, hyphens, underscores, and spaces.&quot;
            )
            raise ValueError(msg)
        return Path.home() / &quot;.deepagents&quot; / agent_name

    def ensure_agent_dir(self, agent_name: str) -&gt; Path:
        &quot;&quot;&quot;Ensure the global agent directory exists and return its path.

        Args:
            agent_name: Name of the agent

        Returns:
            Path to ~/.deepagents/{agent_name}
        &quot;&quot;&quot;
        if not self._is_valid_agent_name(agent_name):
            msg = (
                f&quot;Invalid agent name: {agent_name!r}. &quot;
                &quot;Agent names can only contain letters, numbers, hyphens, underscores, and spaces.&quot;
            )
            raise ValueError(msg)
        agent_dir = self.get_agent_dir(agent_name)
        agent_dir.mkdir(parents=True, exist_ok=True)
        return agent_dir

    def ensure_project_deepagents_dir(self) -&gt; Path | None:
        &quot;&quot;&quot;Ensure the project .deepagents directory exists and return its path.

        Returns:
            Path to project .deepagents directory, or None if not in a project
        &quot;&quot;&quot;
        if not self.project_root:
            return None

        project_deepagents_dir = self.project_root / &quot;.deepagents&quot;
        project_deepagents_dir.mkdir(parents=True, exist_ok=True)
        return project_deepagents_dir

    def get_user_skills_dir(self, agent_name: str) -&gt; Path:
        &quot;&quot;&quot;Get user-level skills directory path for a specific agent.

        Args:
            agent_name: Name of the agent

        Returns:
            Path to ~/.deepagents/{agent_name}/skills/
        &quot;&quot;&quot;
        return self.get_agent_dir(agent_name) / &quot;skills&quot;

    def ensure_user_skills_dir(self, agent_name: str) -&gt; Path:
        &quot;&quot;&quot;Ensure user-level skills directory exists and return its path.

        Args:
            agent_name: Name of the agent

        Returns:
            Path to ~/.deepagents/{agent_name}/skills/
        &quot;&quot;&quot;
        skills_dir = self.get_user_skills_dir(agent_name)
        skills_dir.mkdir(parents=True, exist_ok=True)
        return skills_dir

    def get_project_skills_dir(self) -&gt; Path | None:
        &quot;&quot;&quot;Get project-level skills directory path.

        Returns:
            Path to {project_root}/.deepagents/skills/, or None if not in a project
        &quot;&quot;&quot;
        if not self.project_root:
            return None
        return self.project_root / &quot;.deepagents&quot; / &quot;skills&quot;

    def ensure_project_skills_dir(self) -&gt; Path | None:
        &quot;&quot;&quot;Ensure project-level skills directory exists and return its path.

        Returns:
            Path to {project_root}/.deepagents/skills/, or None if not in a project
        &quot;&quot;&quot;
        if not self.project_root:
            return None
        skills_dir = self.get_project_skills_dir()
        skills_dir.mkdir(parents=True, exist_ok=True)
        return skills_dir


# Global settings instance (initialized once)
settings = Settings.from_environment()


class SessionState:
    &quot;&quot;&quot;Holds mutable session state (auto-approve mode, etc).&quot;&quot;&quot;

    def __init__(self, auto_approve: bool = False, no_splash: bool = False) -&gt; None:
        self.auto_approve = auto_approve
        self.no_splash = no_splash
        self.exit_hint_until: float | None = None
        self.exit_hint_handle = None
        self.thread_id = str(uuid.uuid4())

    def toggle_auto_approve(self) -&gt; bool:
        &quot;&quot;&quot;Toggle auto-approve and return new state.&quot;&quot;&quot;
        self.auto_approve = not self.auto_approve
        return self.auto_approve


def get_default_coding_instructions() -&gt; str:
    &quot;&quot;&quot;Get the default coding agent instructions.

    These are the immutable base instructions that cannot be modified by the agent.
    Long-term memory (AGENTS.md) is handled separately by the middleware.
    &quot;&quot;&quot;
    default_prompt_path = Path(__file__).parent / &quot;default_agent_prompt.md&quot;
    return default_prompt_path.read_text()


def _detect_provider(model_name: str) -&gt; str | None:
    &quot;&quot;&quot;Auto-detect provider from model name.

    Args:
        model_name: Model name to detect provider from

    Returns:
        Provider name (openai, anthropic, google) or None if can&#x27;t detect
    &quot;&quot;&quot;
    model_lower = model_name.lower()
    if any(x in model_lower for x in [&quot;gpt&quot;, &quot;o1&quot;, &quot;o3&quot;]):
        return &quot;openai&quot;
    if &quot;claude&quot; in model_lower:
        return &quot;anthropic&quot;
    if &quot;gemini&quot; in model_lower:
        return &quot;google&quot;
    return None


def create_model(model_name_override: str | None = None) -&gt; BaseChatModel:
    &quot;&quot;&quot;Create the appropriate model based on available API keys.

    Uses the global settings instance to determine which model to create.

    Args:
        model_name_override: Optional model name to use instead of environment variable

    Returns:
        ChatModel instance (OpenAI, Anthropic, or Google)

    Raises:
        SystemExit if no API key is configured or model provider can&#x27;t be determined
    &quot;&quot;&quot;
    # Determine provider and model
    if model_name_override:
        # Use provided model, auto-detect provider
        provider = _detect_provider(model_name_override)
        if not provider:
            console.print(
                f&quot;[bold red]Error:[/bold red] Could not detect provider from model name: {model_name_override}&quot;
            )
            console.print(&quot;\nSupported model name patterns:&quot;)
            console.print(&quot;  - OpenAI: gpt-*, o1-*, o3-*&quot;)
            console.print(&quot;  - Anthropic: claude-*&quot;)
            console.print(&quot;  - Google: gemini-*&quot;)
            sys.exit(1)

        # Check if API key for detected provider is available
        if provider == &quot;openai&quot; and not settings.has_openai:
            console.print(
                f&quot;[bold red]Error:[/bold red] Model &#x27;{model_name_override}&#x27; requires OPENAI_API_KEY&quot;
            )
            sys.exit(1)
        elif provider == &quot;anthropic&quot; and not settings.has_anthropic:
            console.print(
                f&quot;[bold red]Error:[/bold red] Model &#x27;{model_name_override}&#x27; requires ANTHROPIC_API_KEY&quot;
            )
            sys.exit(1)
        elif provider == &quot;google&quot; and not settings.has_google:
            console.print(
                f&quot;[bold red]Error:[/bold red] Model &#x27;{model_name_override}&#x27; requires GOOGLE_API_KEY&quot;
            )
            sys.exit(1)

        model_name = model_name_override
    # Use environment variable defaults, detect provider by API key priority
    elif settings.has_openai:
        provider = &quot;openai&quot;
        model_name = os.environ.get(&quot;OPENAI_MODEL&quot;, &quot;gpt-5-mini&quot;)
    elif settings.has_anthropic:
        provider = &quot;anthropic&quot;
        model_name = os.environ.get(&quot;ANTHROPIC_MODEL&quot;, &quot;claude-sonnet-4-5-20250929&quot;)
    elif settings.has_google:
        provider = &quot;google&quot;
        model_name = os.environ.get(&quot;GOOGLE_MODEL&quot;, &quot;gemini-3-pro-preview&quot;)
    else:
        console.print(&quot;[bold red]Error:[/bold red] No API key configured.&quot;)
        console.print(&quot;\nPlease set one of the following environment variables:&quot;)
        console.print(&quot;  - OPENAI_API_KEY     (for OpenAI models like gpt-5-mini)&quot;)
        console.print(&quot;  - ANTHROPIC_API_KEY  (for Claude models)&quot;)
        console.print(&quot;  - GOOGLE_API_KEY     (for Google Gemini models)&quot;)
        console.print(&quot;\nExample:&quot;)
        console.print(&quot;  export OPENAI_API_KEY=your_api_key_here&quot;)
        console.print(&quot;\nOr add it to your .env file.&quot;)
        sys.exit(1)

    # Store model info in settings for display
    settings.model_name = model_name
    settings.model_provider = provider

    # Create and return the model
    if provider == &quot;openai&quot;:
        from langchain_openai import ChatOpenAI

        return ChatOpenAI(model=model_name)
    if provider == &quot;anthropic&quot;:
        from langchain_anthropic import ChatAnthropic

        return ChatAnthropic(
            model_name=model_name,
            max_tokens=20_000,  # type: ignore[arg-type]
        )
    if provider == &quot;google&quot;:
        from langchain_google_genai import ChatGoogleGenerativeAI

        return ChatGoogleGenerativeAI(
            model=model_name,
            temperature=0,
            max_tokens=None,
        )</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/config/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="content_writer Imported skill content_writer from langchain langchain /a0/tmp/skills_research/langchain/examples/content-builder-agent/content_writer.py Unknown LICENSE sources/langchain/content_writer/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">content_writer</div>
                <button class="copy-btn" onclick="copyToClipboard('content_writer')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill content_writer from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
import warnings
warnings.filterwarnings(&quot;ignore&quot;, message=&quot;Core Pydantic V1 functionality&quot;)

&quot;&quot;&quot;
Content Builder Agent

A content writer agent configured entirely through files on disk:
- AGENTS.md defines brand voice and style guide
- skills/ provides specialized workflows (blog posts, social media)
- skills/*/scripts/ provides tools bundled with each skill
- subagents handle research and other delegated tasks

Usage:
    uv run python content_writer.py &quot;Write a blog post about AI agents&quot;
    uv run python content_writer.py &quot;Create a LinkedIn post about prompt engineering&quot;
&quot;&quot;&quot;

import asyncio
import os
import sys
from pathlib import Path
from typing import Literal

import yaml

from langchain_core.messages import AIMessage, HumanMessage, ToolMessage
from langchain_core.tools import tool
from rich.console import Console
from rich.live import Live
from rich.markdown import Markdown
from rich.panel import Panel
from rich.spinner import Spinner
from rich.text import Text

from deepagents import create_deep_agent
from deepagents.backends import FilesystemBackend

EXAMPLE_DIR = Path(__file__).parent
console = Console()


# Web search tool for the researcher subagent
@tool
def web_search(
    query: str,
    max_results: int = 5,
    topic: Literal[&quot;general&quot;, &quot;news&quot;] = &quot;general&quot;,
) -&gt; dict:
    &quot;&quot;&quot;Search the web for current information.

    Args:
        query: The search query (be specific and detailed)
        max_results: Number of results to return (default: 5)
        topic: &quot;general&quot; for most queries, &quot;news&quot; for current events

    Returns:
        Search results with titles, URLs, and content excerpts.
    &quot;&quot;&quot;
    try:
        from tavily import TavilyClient

        api_key = os.environ.get(&quot;TAVILY_API_KEY&quot;)
        if not api_key:
            return {&quot;error&quot;: &quot;TAVILY_API_KEY not set&quot;}

        client = TavilyClient(api_key=api_key)
        return client.search(query, max_results=max_results, topic=topic)
    except Exception as e:
        return {&quot;error&quot;: f&quot;Search failed: {e}&quot;}


@tool
def generate_cover(prompt: str, slug: str) -&gt; str:
    &quot;&quot;&quot;Generate a cover image for a blog post.

    Args:
        prompt: Detailed description of the image to generate.
        slug: Blog post slug. Image saves to blogs/&lt;slug&gt;/hero.png
    &quot;&quot;&quot;
    try:
        from google import genai

        client = genai.Client()
        response = client.models.generate_content(
            model=&quot;gemini-2.5-flash-image&quot;,
            contents=[prompt],
        )

        for part in response.parts:
            if part.inline_data is not None:
                image = part.as_image()
                output_path = EXAMPLE_DIR / &quot;blogs&quot; / slug / &quot;hero.png&quot;
                output_path.parent.mkdir(parents=True, exist_ok=True)
                image.save(str(output_path))
                return f&quot;Image saved to {output_path}&quot;

        return &quot;No image generated&quot;
    except Exception as e:
        return f&quot;Error: {e}&quot;


@tool
def generate_social_image(prompt: str, platform: str, slug: str) -&gt; str:
    &quot;&quot;&quot;Generate an image for a social media post.

    Args:
        prompt: Detailed description of the image to generate.
        platform: Either &quot;linkedin&quot; or &quot;tweets&quot;
        slug: Post slug. Image saves to &lt;platform&gt;/&lt;slug&gt;/image.png
    &quot;&quot;&quot;
    try:
        from google import genai

        client = genai.Client()
        response = client.models.generate_content(
            model=&quot;gemini-2.5-flash-image&quot;,
            contents=[prompt],
        )

        for part in response.parts:
            if part.inline_data is not None:
                image = part.as_image()
                output_path = EXAMPLE_DIR / platform / slug / &quot;image.png&quot;
                output_path.parent.mkdir(parents=True, exist_ok=True)
                image.save(str(output_path))
                return f&quot;Image saved to {output_path}&quot;

        return &quot;No image generated&quot;
    except Exception as e:
        return f&quot;Error: {e}&quot;


def load_subagents(config_path: Path) -&gt; list:
    &quot;&quot;&quot;Load subagent definitions from YAML and wire up tools.

    NOTE: This is a custom utility for this example. Unlike `memory` and `skills`,
    deepagents doesn&#x27;t natively load subagents from files - they&#x27;re normally
    defined inline in the create_deep_agent() call. We externalize to YAML here
    to keep configuration separate from code.
    &quot;&quot;&quot;
    # Map tool names to actual tool objects
    available_tools = {
        &quot;web_search&quot;: web_search,
    }

    with open(config_path) as f:
        config = yaml.safe_load(f)

    subagents = []
    for name, spec in config.items():
        subagent = {
            &quot;name&quot;: name,
            &quot;description&quot;: spec[&quot;description&quot;],
            &quot;system_prompt&quot;: spec[&quot;system_prompt&quot;],
        }
        if &quot;model&quot; in spec:
            subagent[&quot;model&quot;] = spec[&quot;model&quot;]
        if &quot;tools&quot; in spec:
            subagent[&quot;tools&quot;] = [available_tools[t] for t in spec[&quot;tools&quot;]]
        subagents.append(subagent)

    return subagents


def create_content_writer():
    &quot;&quot;&quot;Create a content writer agent configured by filesystem files.&quot;&quot;&quot;
    return create_deep_agent(
        memory=[&quot;./AGENTS.md&quot;],           # Loaded by MemoryMiddleware
        skills=[&quot;./skills/&quot;],             # Loaded by SkillsMiddleware
        tools=[generate_cover, generate_social_image],  # Image generation
        subagents=load_subagents(EXAMPLE_DIR / &quot;subagents.yaml&quot;),  # Custom helper
        backend=FilesystemBackend(root_dir=EXAMPLE_DIR),
    )


class AgentDisplay:
    &quot;&quot;&quot;Manages the display of agent progress.&quot;&quot;&quot;

    def __init__(self):
        self.printed_count = 0
        self.current_status = &quot;&quot;
        self.spinner = Spinner(&quot;dots&quot;, text=&quot;Thinking...&quot;)

    def update_status(self, status: str):
        self.current_status = status
        self.spinner = Spinner(&quot;dots&quot;, text=status)

    def print_message(self, msg):
        &quot;&quot;&quot;Print a message with nice formatting.&quot;&quot;&quot;
        if isinstance(msg, HumanMessage):
            console.print(Panel(str(msg.content), title=&quot;You&quot;, border_style=&quot;blue&quot;))

        elif isinstance(msg, AIMessage):
            content = msg.content
            if isinstance(content, list):
                text_parts = [p.get(&quot;text&quot;, &quot;&quot;) for p in content if isinstance(p, dict) and p.get(&quot;type&quot;) == &quot;text&quot;]
                content = &quot;\n&quot;.join(text_parts)

            if content and content.strip():
                console.print(Panel(Markdown(content), title=&quot;Agent&quot;, border_style=&quot;green&quot;))

            if msg.tool_calls:
                for tc in msg.tool_calls:
                    name = tc.get(&quot;name&quot;, &quot;unknown&quot;)
                    args = tc.get(&quot;args&quot;, {})

                    if name == &quot;task&quot;:
                        desc = args.get(&quot;description&quot;, &quot;researching...&quot;)
                        console.print(f&quot;  [bold magenta]&gt;&gt; Researching:[/] {desc[:60]}...&quot;)
                        self.update_status(f&quot;Researching: {desc[:40]}...&quot;)
                    elif name in (&quot;generate_cover&quot;, &quot;generate_social_image&quot;):
                        console.print(f&quot;  [bold cyan]&gt;&gt; Generating image...[/]&quot;)
                        self.update_status(&quot;Generating image...&quot;)
                    elif name == &quot;write_file&quot;:
                        path = args.get(&quot;file_path&quot;, &quot;file&quot;)
                        console.print(f&quot;  [bold yellow]&gt;&gt; Writing:[/] {path}&quot;)
                    elif name == &quot;web_search&quot;:
                        query = args.get(&quot;query&quot;, &quot;&quot;)
                        console.print(f&quot;  [bold blue]&gt;&gt; Searching:[/] {query[:50]}...&quot;)
                        self.update_status(f&quot;Searching: {query[:30]}...&quot;)

        elif isinstance(msg, ToolMessage):
            name = getattr(msg, &quot;name&quot;, &quot;&quot;)
            if name in (&quot;generate_cover&quot;, &quot;generate_social_image&quot;):
                if &quot;saved&quot; in msg.content.lower():
                    console.print(f&quot;  [green] Image saved[/]&quot;)
                else:
                    console.print(f&quot;  [red] Image failed: {msg.content}[/]&quot;)
            elif name == &quot;write_file&quot;:
                console.print(f&quot;  [green] File written[/]&quot;)
            elif name == &quot;task&quot;:
                console.print(f&quot;  [green] Research complete[/]&quot;)
            elif name == &quot;web_search&quot;:
                if &quot;error&quot; not in msg.content.lower():
                    console.print(f&quot;  [green] Found results[/]&quot;)


async def main():
    &quot;&quot;&quot;Run the content writer agent with streaming output.&quot;&quot;&quot;
    if len(sys.argv) &gt; 1:
        task = &quot; &quot;.join(sys.argv[1:])
    else:
        task = &quot;Write a blog post about how AI agents are transforming software development&quot;

    console.print()
    console.print(&quot;[bold blue]Content Builder Agent[/]&quot;)
    console.print(f&quot;[dim]Task: {task}[/]&quot;)
    console.print()

    agent = create_content_writer()
    display = AgentDisplay()

    console.print()

    # Use Live display for spinner during waiting periods
    with Live(display.spinner, console=console, refresh_per_second=10, transient=True) as live:
        async for chunk in agent.astream(
            {&quot;messages&quot;: [(&quot;user&quot;, task)]},
            config={&quot;configurable&quot;: {&quot;thread_id&quot;: &quot;content-writer-demo&quot;}},
            stream_mode=&quot;values&quot;,
        ):
            if &quot;messages&quot; in chunk:
                messages = chunk[&quot;messages&quot;]
                if len(messages) &gt; display.printed_count:
                    # Temporarily stop spinner to print
                    live.stop()
                    for msg in messages[display.printed_count:]:
                        display.print_message(msg)
                    display.printed_count = len(messages)
                    # Resume spinner
                    live.start()
                    live.update(display.spinner)

    console.print()
    console.print(&quot;[bold green] Done![/]&quot;)


if __name__ == &quot;__main__&quot;:
    try:
        asyncio.run(main())
    except KeyboardInterrupt:
        console.print(&quot;\n[yellow]Interrupted[/]&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/content_writer/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="daytona Imported skill daytona from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/integrations/daytona.py Unknown LICENSE sources/langchain/daytona/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">daytona</div>
                <button class="copy-btn" onclick="copyToClipboard('daytona')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill daytona from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Daytona sandbox backend implementation.&quot;&quot;&quot;

from __future__ import annotations

from typing import TYPE_CHECKING

from deepagents.backends.protocol import (
    ExecuteResponse,
    FileDownloadResponse,
    FileUploadResponse,
)
from deepagents.backends.sandbox import BaseSandbox

if TYPE_CHECKING:
    from daytona import Sandbox


class DaytonaBackend(BaseSandbox):
    &quot;&quot;&quot;Daytona backend implementation conforming to SandboxBackendProtocol.

    This implementation inherits all file operation methods from BaseSandbox
    and only implements the execute() method using Daytona&#x27;s API.
    &quot;&quot;&quot;

    def __init__(self, sandbox: Sandbox) -&gt; None:
        &quot;&quot;&quot;Initialize the DaytonaBackend with a Daytona sandbox client.

        Args:
            sandbox: Daytona sandbox instance
        &quot;&quot;&quot;
        self._sandbox = sandbox
        self._timeout: int = 30 * 60  # 30 mins

    @property
    def id(self) -&gt; str:
        &quot;&quot;&quot;Unique identifier for the sandbox backend.&quot;&quot;&quot;
        return self._sandbox.id

    def execute(
        self,
        command: str,
    ) -&gt; ExecuteResponse:
        &quot;&quot;&quot;Execute a command in the sandbox and return ExecuteResponse.

        Args:
            command: Full shell command string to execute.

        Returns:
            ExecuteResponse with combined output, exit code, optional signal, and truncation flag.
        &quot;&quot;&quot;
        result = self._sandbox.process.exec(command, timeout=self._timeout)

        return ExecuteResponse(
            output=result.result,  # Daytona combines stdout/stderr
            exit_code=result.exit_code,
            truncated=False,
        )

    def download_files(self, paths: list[str]) -&gt; list[FileDownloadResponse]:
        &quot;&quot;&quot;Download multiple files from the Daytona sandbox.

        Leverages Daytona&#x27;s native batch download API for efficiency.
        Supports partial success - individual downloads may fail without
        affecting others.

        Args:
            paths: List of file paths to download.

        Returns:
            List of FileDownloadResponse objects, one per input path.
            Response order matches input order.

        TODO: Map Daytona API error strings to standardized FileOperationError codes.
        Currently only implements happy path.
        &quot;&quot;&quot;
        from daytona import FileDownloadRequest

        # Create batch download request using Daytona&#x27;s native batch API
        download_requests = [FileDownloadRequest(source=path) for path in paths]
        daytona_responses = self._sandbox.fs.download_files(download_requests)

        # Convert Daytona results to our response format
        # TODO: Map resp.error to standardized error codes when available
        return [
            FileDownloadResponse(
                path=resp.source,
                content=resp.result,
                error=None,  # TODO: map resp.error to FileOperationError
            )
            for resp in daytona_responses
        ]

    def upload_files(self, files: list[tuple[str, bytes]]) -&gt; list[FileUploadResponse]:
        &quot;&quot;&quot;Upload multiple files to the Daytona sandbox.

        Leverages Daytona&#x27;s native batch upload API for efficiency.
        Supports partial success - individual uploads may fail without
        affecting others.

        Args:
            files: List of (path, content) tuples to upload.

        Returns:
            List of FileUploadResponse objects, one per input file.
            Response order matches input order.

        TODO: Map Daytona API error strings to standardized FileOperationError codes.
        Currently only implements happy path.
        &quot;&quot;&quot;
        from daytona import FileUpload

        # Create batch upload request using Daytona&#x27;s native batch API
        upload_requests = [FileUpload(source=content, destination=path) for path, content in files]
        self._sandbox.fs.upload_files(upload_requests)

        # TODO: Check if Daytona returns error info and map to FileOperationError codes
        return [FileUploadResponse(path=path, error=None) for path, _ in files]</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/daytona/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="deepagents_wrapper Imported skill deepagents_wrapper from langchain langchain /a0/tmp/skills_research/langchain/libs/harbor/deepagents_harbor/deepagents_wrapper.py Unknown LICENSE sources/langchain/deepagents_wrapper/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">deepagents_wrapper</div>
                <button class="copy-btn" onclick="copyToClipboard('deepagents_wrapper')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill deepagents_wrapper from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;A wrapper for DeepAgents to run in Harbor environments.&quot;&quot;&quot;

import json
import os
import uuid
from datetime import datetime, timezone
from pathlib import Path

from deepagents import create_deep_agent
from deepagents_cli.agent import create_cli_agent
from dotenv import load_dotenv
from harbor.agents.base import BaseAgent
from harbor.environments.base import BaseEnvironment
from harbor.models.agent.context import AgentContext
from harbor.models.trajectories import (
    Agent,
    FinalMetrics,
    Observation,
    ObservationResult,
    Step,
    ToolCall,
    Trajectory,
)
from langchain.chat_models import init_chat_model
from langchain.messages import UsageMetadata
from langchain_core.messages import AIMessage, HumanMessage, ToolMessage
from langchain_core.runnables import RunnableConfig
from langsmith import trace

from deepagents_harbor.backend import HarborSandbox
from deepagents_harbor.tracing import create_example_id_from_instruction

# Load .env file if present
load_dotenv()

SYSTEM_MESSAGE = &quot;&quot;&quot;
You are an autonomous agent executing tasks in a sandboxed environment. Follow these instructions carefully.

## WORKING DIRECTORY &amp; ENVIRONMENT CONTEXT

Your current working directory is:
{current_directory}

{file_listing_header}
{file_listing}

**IMPORTANT**: This directory information is provided for your convenience at the start of the task. You should:
- Use this information to understand the initial environment state
- Avoid redundantly calling `ls` or similar commands just to list the same directory
- Only use file listing commands if you need updated information (after creating/deleting files) or need to explore subdirectories
- Work in the /app directory unless explicitly instructed otherwise
&quot;&quot;&quot;


class DeepAgentsWrapper(BaseAgent):
    &quot;&quot;&quot;Harbor agent implementation using LangChain DeepAgents.

    Wraps DeepAgents to execute tasks in Harbor environments.
    &quot;&quot;&quot;

    def __init__(
        self,
        logs_dir: Path,
        model_name: str | None = None,
        temperature: float = 0.0,
        verbose: bool = True,
        use_cli_agent: bool = True,
        *args,
        **kwargs,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize DeepAgentsWrapper.

        Args:
            logs_dir: Directory for storing logs
            model_name: Name of the LLM model to use
            temperature: Temperature setting for the model
            verbose: Enable verbose output
            use_cli_agent: If True, use create_cli_agent from deepagents-cli (default).
                          If False, use create_deep_agent from SDK.
        &quot;&quot;&quot;
        super().__init__(logs_dir, model_name, *args, **kwargs)

        if model_name is None:
            # Use DeepAgents default
            model_name = &quot;anthropic:claude-sonnet-4-5-20250929&quot;

        self._model_name = model_name
        self._temperature = temperature
        self._verbose = verbose
        self._use_cli_agent = use_cli_agent
        self._model = init_chat_model(model_name, temperature=temperature)

        # LangSmith run tracking for feedback
        self._langsmith_run_id: str | None = None
        self._task_name: str | None = None

    @staticmethod
    def name() -&gt; str:
        return &quot;deepagent-harbor&quot;

    async def setup(self, environment: BaseEnvironment) -&gt; None:
        &quot;&quot;&quot;Setup the agent with the given environment.

        Args:
            environment: Harbor environment (Docker, Modal, etc.)
        &quot;&quot;&quot;
        pass

    def version(self) -&gt; str | None:
        &quot;&quot;&quot;The version of the agent.&quot;&quot;&quot;
        return &quot;0.0.1&quot;

    async def _get_formatted_system_prompt(self, backend: HarborSandbox) -&gt; str:
        &quot;&quot;&quot;Format the system prompt with current directory and file listing context.

        Args:
            backend: Harbor sandbox backend to query for directory information

        Returns:
            Formatted system prompt with directory context
        &quot;&quot;&quot;
        # Get directory information from backend
        ls_info = await backend.als_info(&quot;.&quot;)
        current_dir = (await backend.aexecute(&quot;pwd&quot;)).output

        # Get first 10 files
        total_files = len(ls_info) if ls_info else 0
        first_10_files = ls_info[:10] if ls_info else []

        # Build file listing header based on actual count
        if total_files == 0:
            file_listing_header = &quot;Current directory is empty.&quot;
            file_listing = &quot;&quot;
        elif total_files &lt;= 10:
            # Show actual count when 10 or fewer
            file_count_text = &quot;1 file&quot; if total_files == 1 else f&quot;{total_files} files&quot;
            file_listing_header = f&quot;Files in current directory ({file_count_text}):&quot;
            file_listing = &quot;\n&quot;.join(f&quot;{i + 1}. {file}&quot; for i, file in enumerate(first_10_files))
        else:
            # Show &quot;First 10 of N&quot; when more than 10
            file_listing_header = f&quot;Files in current directory (showing first 10 of {total_files}):&quot;
            file_listing = &quot;\n&quot;.join(f&quot;{i + 1}. {file}&quot; for i, file in enumerate(first_10_files))

        # Format the system prompt with context
        formatted_prompt = SYSTEM_MESSAGE.format(
            current_directory=current_dir.strip() if current_dir else &quot;/app&quot;,
            file_listing_header=file_listing_header,
            file_listing=file_listing,
        )

        return formatted_prompt

    async def run(
        self,
        instruction: str,
        environment: BaseEnvironment,
        context: AgentContext,
    ) -&gt; None:
        &quot;&quot;&quot;Execute the DeepAgent on the given instruction.

        Args:
            instruction: The task to complete
            environment: Harbor environment (Docker, Modal, etc.)
            context: Context to populate with metrics
        &quot;&quot;&quot;
        configuration = json.loads(environment.trial_paths.config_path.read_text())
        if not isinstance(configuration, dict):
            raise AssertionError(
                f&quot;Unexpected configuration format. Expected a dict got {type(configuration)}.&quot;
            )

        backend = HarborSandbox(environment)

        # Create agent based on mode (CLI vs SDK)
        if self._use_cli_agent:
            # Get Harbor&#x27;s system prompt with directory context
            harbor_system_prompt = await self._get_formatted_system_prompt(backend)

            # Use CLI agent with auto-approve mode
            deep_agent, _ = create_cli_agent(
                model=self._model,
                assistant_id=environment.session_id,
                sandbox=backend,
                sandbox_type=None,
                system_prompt=harbor_system_prompt,  # Use Harbor&#x27;s custom prompt
                auto_approve=True,  # Skip HITL in Harbor
                enable_memory=False,
                enable_skills=False,  # Disable CLI skills for now
                enable_shell=False,  # Sandbox provides execution
            )
        else:
            # Use SDK agent
            # Get formatted system prompt with directory context
            system_prompt = await self._get_formatted_system_prompt(backend)

            deep_agent = create_deep_agent(
                model=self._model, backend=backend, system_prompt=system_prompt
            )

        # Build metadata with experiment tracking info
        metadata = {
            &quot;task_instruction&quot;: instruction,
            &quot;model&quot;: self._model_name,
            # This is a harbor-specific session ID for the entire task run
            # It&#x27;s different from the LangSmith experiment ID (called session_id)
            &quot;harbor_session_id&quot;: environment.session_id,
            # Tag to indicate which agent implementation is being used
            &quot;agent_mode&quot;: &quot;cli&quot; if self._use_cli_agent else &quot;sdk&quot;,
        }
        metadata.update(configuration)

        # Compute example_id from instruction for deterministic linking
        # This uses the same hashing as create_langsmith_dataset.py
        example_id = create_example_id_from_instruction(instruction)

        config: RunnableConfig = {
            &quot;run_name&quot;: f&quot;{environment.session_id}&quot;,
            &quot;tags&quot;: [
                self._model_name,
                environment.session_id,
                &quot;cli-agent&quot; if self._use_cli_agent else &quot;sdk-agent&quot;,
            ],
            &quot;configurable&quot;: {
                &quot;thread_id&quot;: str(uuid.uuid4()),
            },
        }

        # If LANGSMITH_EXPERIMENT is set, wrap in trace context.
        # This will link runs to the given experiment in LangSmith.
        langsmith_experiment_name = os.environ.get(&quot;LANGSMITH_EXPERIMENT&quot;, &quot;&quot;).strip() or None

        if langsmith_experiment_name:
            with trace(
                name=environment.session_id,
                reference_example_id=example_id,
                inputs={&quot;instruction&quot;: instruction},
                project_name=langsmith_experiment_name,
                metadata=metadata,
            ) as run_tree:
                # Invoke deep agent with LangSmith tracing
                result = await deep_agent.ainvoke(
                    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: instruction}]},  # type: ignore
                    config=config,
                )
                # Extract last AI message and add as output
                last_message = result[&quot;messages&quot;][-1]
                if isinstance(last_message, AIMessage):
                    run_tree.end(outputs={&quot;last_message&quot;: last_message.text})
        else:
            config[&quot;metadata&quot;] = metadata
            result = await deep_agent.ainvoke(
                {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: instruction}]},  # type: ignore
                config=config,
            )

        self._save_trajectory(environment, instruction, result)

    def _save_trajectory(
        self, environment: BaseEnvironment, instruction: str, result: dict
    ) -&gt; None:
        &quot;&quot;&quot;Save current trajectory to logs directory.&quot;&quot;&quot;
        # Track token usage and cost for this run
        total_prompt_tokens = 0
        total_completion_tokens = 0

        # Create trajectory
        steps = [
            Step(
                step_id=1,
                timestamp=datetime.now(timezone.utc).isoformat(),
                source=&quot;user&quot;,
                message=instruction,
            ),
        ]

        observations = []
        pending_step: Step | None = None

        for msg in result[&quot;messages&quot;]:
            if isinstance(msg, AIMessage):
                # Extract usage metadata from AIMessage
                usage: UsageMetadata = msg.usage_metadata
                if usage:
                    total_prompt_tokens += usage[&quot;input_tokens&quot;]
                    total_completion_tokens += usage[&quot;output_tokens&quot;]
                # If there&#x27;s a pending step with tool calls, add it now with observations
                if pending_step is not None:
                    if pending_step.tool_calls and observations:
                        # Add observations to the pending step
                        pending_step.observation = Observation(results=observations)
                        observations = []
                    steps.append(pending_step)
                    pending_step = None

                # Extract content and tool calls from current AIMessage
                atf_tool_calls = []
                message = &quot;&quot;
                for cb in msg.content_blocks:
                    if cb[&quot;type&quot;] == &quot;text&quot;:
                        message += cb[&quot;text&quot;]
                    elif cb[&quot;type&quot;] == &quot;reasoning&quot;:
                        message += cb[&quot;reasoning&quot;]
                    elif cb[&quot;type&quot;] == &quot;tool_call&quot;:
                        atf_tool_calls.append(
                            ToolCall(
                                tool_call_id=cb[&quot;id&quot;],
                                function_name=cb[&quot;name&quot;],
                                arguments=cb[&quot;args&quot;],
                            )
                        )
                    else:
                        # TODO: Add server side tool call results.
                        continue

                # Create new step
                new_step = Step(
                    step_id=steps[-1].step_id + 1 if steps else 0,
                    timestamp=datetime.now(timezone.utc).isoformat(),
                    source=&quot;agent&quot;,
                    message=message,
                    tool_calls=atf_tool_calls if atf_tool_calls else None,
                )

                # If this AIMessage has tool calls, make it pending (wait for observations)
                # Otherwise, add it immediately
                if atf_tool_calls:
                    pending_step = new_step
                else:
                    steps.append(new_step)

            elif isinstance(msg, ToolMessage):
                # Collect observations for the pending step
                observations.append(
                    ObservationResult(
                        source_call_id=msg.tool_call_id,
                        content=str(msg.content),
                    )
                )
            elif isinstance(msg, HumanMessage):
                pass
            else:
                raise NotImplementedError(
                    f&quot;Message type {type(msg)} not supported for step conversion&quot;
                )

        # Add any remaining pending step
        if pending_step is not None:
            if pending_step.tool_calls and observations:
                pending_step.observation = Observation(results=observations)
            steps.append(pending_step)

        # Build and save trajectory
        metrics = FinalMetrics(
            total_prompt_tokens=total_prompt_tokens or None,
            total_completion_tokens=total_completion_tokens or None,
            total_steps=len(steps),
        )
        trajectory = Trajectory(
            schema_version=&quot;ATIF-v1.2&quot;,
            session_id=environment.session_id,
            agent=Agent(
                name=self.name(),
                version=self.version() or &quot;unknown&quot;,
                model_name=self._model_name,
                extra={
                    &quot;framework&quot;: &quot;deepagents&quot;,
                    &quot;langchain_version&quot;: &quot;1.0+&quot;,
                },
            ),
            steps=steps,
            final_metrics=metrics,
        )
        trajectory_path = self.logs_dir / &quot;trajectory.json&quot;
        trajectory_path.write_text(json.dumps(trajectory.to_json_dict(), indent=2))</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/deepagents_wrapper/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="default_agent_prompt Imported skill default_agent_prompt from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/default_agent_prompt.md Unknown LICENSE sources/langchain/default_agent_prompt/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">default_agent_prompt</div>
                <button class="copy-btn" onclick="copyToClipboard('default_agent_prompt')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill default_agent_prompt from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">You are an AI assistant that helps users with various tasks including coding, research, and analysis.

# Core Behavior

Be concise and direct. Answer in fewer than 4 lines unless the user asks for detail.
After working on a file, just stop - don&#x27;t explain what you did unless asked.
Avoid unnecessary introductions or conclusions.

When you run non-trivial bash commands, briefly explain what they do.

## Proactiveness
Take action when asked, but don&#x27;t surprise users with unrequested actions.
If asked how to approach something, answer first before taking action.

## Following Conventions
- Check existing code for libraries and frameworks before assuming availability
- Mimic existing code style, naming conventions, and patterns
- Never add comments unless asked

## Task Management
Use write_todos for complex multi-step tasks (3+ steps). Mark tasks in_progress before starting, completed immediately after finishing.
For simple 1-2 step tasks, just do them directly without todos.

## File Reading Best Practices

When exploring codebases or reading multiple files, use pagination to prevent context overflow.

**Pattern for codebase exploration:**
1. First scan: `read_file(path, limit=100)` - See file structure and key sections
2. Targeted read: `read_file(path, offset=100, limit=200)` - Read specific sections if needed
3. Full read: Only use `read_file(path)` without limit when necessary for editing

**When to paginate:**
- Reading any file &gt;500 lines
- Exploring unfamiliar codebases (always start with limit=100)
- Reading multiple files in sequence

**When full read is OK:**
- Small files (&lt;500 lines)
- Files you need to edit immediately after reading

## Working with Subagents (task tool)
When delegating to subagents:
- **Use filesystem for large I/O**: If input/output is large (&gt;500 words), communicate via files
- **Parallelize independent work**: Spawn parallel subagents for independent tasks
- **Clear specifications**: Tell subagent exactly what format/structure you need
- **Main agent synthesizes**: Subagents gather/execute, main agent integrates results

## Tools

### shell
Execute shell commands. Always quote paths with spaces.
The bash command will be run from your current working directory.
Examples: `pytest /foo/bar/tests` (good), `cd /foo/bar &amp;&amp; pytest tests` (bad)

### File Tools
- read_file: Read file contents (use absolute paths)
- edit_file: Replace exact strings in files (must read first, provide unique old_string)
- write_file: Create or overwrite files
- ls: List directory contents
- glob: Find files by pattern (e.g., &quot;**/*.py&quot;)
- grep: Search file contents

Always use absolute paths starting with /.

### web_search
Search for documentation, error solutions, and code examples.

### http_request
Make HTTP requests to APIs (GET, POST, etc.).

## Code References
When referencing code, use format: `file_path:line_number`

## Documentation
- Do NOT create excessive markdown summary/documentation files after completing work
- Focus on the work itself, not documenting what you did
- Only create documentation when explicitly requested</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/default_agent_prompt/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="diff Imported skill diff from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/widgets/diff.py Unknown LICENSE sources/langchain/diff/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">diff</div>
                <button class="copy-btn" onclick="copyToClipboard('diff')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill diff from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Enhanced diff widget for displaying unified diffs.&quot;&quot;&quot;

from __future__ import annotations

import re
from typing import TYPE_CHECKING, Any

from textual.containers import Vertical
from textual.widgets import Static

if TYPE_CHECKING:
    from textual.app import ComposeResult


def _escape_markup(text: str) -&gt; str:
    &quot;&quot;&quot;Escape Rich markup characters in text.

    Args:
        text: Text that may contain Rich markup

    Returns:
        Escaped text safe for Rich rendering
    &quot;&quot;&quot;
    # Escape brackets that could be interpreted as markup
    return text.replace(&quot;[&quot;, r&quot;\[&quot;).replace(&quot;]&quot;, r&quot;\]&quot;)


def format_diff_textual(diff: str, max_lines: int | None = 100) -&gt; str:
    &quot;&quot;&quot;Format a unified diff with line numbers and colors.

    Args:
        diff: Unified diff string
        max_lines: Maximum number of diff lines to show (None for unlimited)

    Returns:
        Rich-formatted diff string with line numbers
    &quot;&quot;&quot;
    if not diff:
        return &quot;[dim]No changes detected[/dim]&quot;

    lines = diff.splitlines()

    # Compute stats first
    additions = sum(1 for ln in lines if ln.startswith(&quot;+&quot;) and not ln.startswith(&quot;+++&quot;))
    deletions = sum(1 for ln in lines if ln.startswith(&quot;-&quot;) and not ln.startswith(&quot;---&quot;))

    # Find max line number for width calculation
    max_line = 0
    for line in lines:
        if m := re.match(r&quot;@@ -(\d+)(?:,\d+)? \+(\d+)&quot;, line):
            max_line = max(max_line, int(m.group(1)), int(m.group(2)))
    width = max(3, len(str(max_line + len(lines))))

    formatted = []

    # Add stats header
    stats_parts = []
    if additions:
        stats_parts.append(f&quot;[green]+{additions}[/green]&quot;)
    if deletions:
        stats_parts.append(f&quot;[red]-{deletions}[/red]&quot;)
    if stats_parts:
        formatted.append(&quot; &quot;.join(stats_parts))
        formatted.append(&quot;&quot;)  # Blank line after stats

    old_num = new_num = 0
    line_count = 0

    for line in lines:
        if max_lines and line_count &gt;= max_lines:
            formatted.append(f&quot;\n[dim]... ({len(lines) - line_count} more lines)[/dim]&quot;)
            break

        # Skip file headers (--- and +++)
        if line.startswith((&quot;---&quot;, &quot;+++&quot;)):
            continue

        # Handle hunk headers - just update line numbers, don&#x27;t display
        if m := re.match(r&quot;@@ -(\d+)(?:,\d+)? \+(\d+)&quot;, line):
            old_num, new_num = int(m.group(1)), int(m.group(2))
            continue

        # Handle diff lines - use gutter bar instead of +/- prefix
        content = line[1:] if line else &quot;&quot;
        escaped_content = _escape_markup(content)

        if line.startswith(&quot;-&quot;):
            # Deletion - red gutter bar, subtle red background
            formatted.append(
                f&quot;[red bold][/red bold][dim]{old_num:&gt;{width}}[/dim] &quot;
                f&quot;[on #2d1515]{escaped_content}[/on #2d1515]&quot;
            )
            old_num += 1
            line_count += 1
        elif line.startswith(&quot;+&quot;):
            # Addition - green gutter bar, subtle green background
            formatted.append(
                f&quot;[green bold][/green bold][dim]{new_num:&gt;{width}}[/dim] &quot;
                f&quot;[on #152d15]{escaped_content}[/on #152d15]&quot;
            )
            new_num += 1
            line_count += 1
        elif line.startswith(&quot; &quot;):
            # Context line - dim gutter
            formatted.append(f&quot;[dim]{old_num:&gt;{width}}[/dim]  {escaped_content}&quot;)
            old_num += 1
            new_num += 1
            line_count += 1
        elif line.strip() == &quot;...&quot;:
            # Truncation marker
            formatted.append(&quot;[dim]...[/dim]&quot;)
            line_count += 1

    return &quot;\n&quot;.join(formatted)


class EnhancedDiff(Vertical):
    &quot;&quot;&quot;Widget for displaying a unified diff with syntax highlighting.&quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    EnhancedDiff {
        height: auto;
        padding: 1;
        background: $surface-darken-1;
        border: round $primary;
    }

    EnhancedDiff .diff-title {
        color: $primary;
        text-style: bold;
        margin-bottom: 1;
    }

    EnhancedDiff .diff-content {
        height: auto;
    }

    EnhancedDiff .diff-stats {
        color: $text-muted;
        margin-top: 1;
    }
    &quot;&quot;&quot;

    def __init__(
        self,
        diff: str,
        title: str = &quot;Diff&quot;,
        max_lines: int | None = 100,
        **kwargs: Any,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize the diff widget.

        Args:
            diff: Unified diff string
            title: Title to display above the diff
            max_lines: Maximum number of diff lines to show
            **kwargs: Additional arguments passed to parent
        &quot;&quot;&quot;
        super().__init__(**kwargs)
        self._diff = diff
        self._title = title
        self._max_lines = max_lines
        self._stats = self._compute_stats()

    def _compute_stats(self) -&gt; tuple[int, int]:
        &quot;&quot;&quot;Compute additions and deletions count.

        Returns:
            Tuple of (additions, deletions)
        &quot;&quot;&quot;
        additions = 0
        deletions = 0
        for line in self._diff.splitlines():
            if line.startswith(&quot;+&quot;) and not line.startswith(&quot;+++&quot;):
                additions += 1
            elif line.startswith(&quot;-&quot;) and not line.startswith(&quot;---&quot;):
                deletions += 1
        return additions, deletions

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the diff widget layout.&quot;&quot;&quot;
        yield Static(f&quot;[bold cyan] {self._title} [/bold cyan]&quot;, classes=&quot;diff-title&quot;)

        formatted = format_diff_textual(self._diff, self._max_lines)
        yield Static(formatted, classes=&quot;diff-content&quot;)

        additions, deletions = self._stats
        if additions or deletions:
            stats_parts = []
            if additions:
                stats_parts.append(f&quot;[green]+{additions}[/green]&quot;)
            if deletions:
                stats_parts.append(f&quot;[red]-{deletions}[/red]&quot;)
            yield Static(&quot; &quot;.join(stats_parts), classes=&quot;diff-stats&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/diff/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="file_ops Imported skill file_ops from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/file_ops.py Unknown LICENSE sources/langchain/file_ops/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">file_ops</div>
                <button class="copy-btn" onclick="copyToClipboard('file_ops')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill file_ops from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Helpers for tracking file operations and computing diffs for CLI display.&quot;&quot;&quot;

from __future__ import annotations

import difflib
from dataclasses import dataclass, field
from pathlib import Path
from typing import TYPE_CHECKING, Any, Literal

from deepagents.backends.utils import perform_string_replacement

from deepagents_cli.config import settings

if TYPE_CHECKING:
    from deepagents.backends.protocol import BACKEND_TYPES

FileOpStatus = Literal[&quot;pending&quot;, &quot;success&quot;, &quot;error&quot;]


@dataclass
class ApprovalPreview:
    &quot;&quot;&quot;Data used to render HITL previews.&quot;&quot;&quot;

    title: str
    details: list[str]
    diff: str | None = None
    diff_title: str | None = None
    error: str | None = None


def _safe_read(path: Path) -&gt; str | None:
    &quot;&quot;&quot;Read file content, returning None on failure.&quot;&quot;&quot;
    try:
        return path.read_text()
    except (OSError, UnicodeDecodeError):
        return None


def _count_lines(text: str) -&gt; int:
    &quot;&quot;&quot;Count lines in text, treating empty strings as zero lines.&quot;&quot;&quot;
    if not text:
        return 0
    return len(text.splitlines())


def compute_unified_diff(
    before: str,
    after: str,
    display_path: str,
    *,
    max_lines: int | None = 800,
    context_lines: int = 3,
) -&gt; str | None:
    &quot;&quot;&quot;Compute a unified diff between before and after content.

    Args:
        before: Original content
        after: New content
        display_path: Path for display in diff headers
        max_lines: Maximum number of diff lines (None for unlimited)
        context_lines: Number of context lines around changes (default 3)

    Returns:
        Unified diff string or None if no changes
    &quot;&quot;&quot;
    before_lines = before.splitlines()
    after_lines = after.splitlines()
    diff_lines = list(
        difflib.unified_diff(
            before_lines,
            after_lines,
            fromfile=f&quot;{display_path} (before)&quot;,
            tofile=f&quot;{display_path} (after)&quot;,
            lineterm=&quot;&quot;,
            n=context_lines,
        )
    )
    if not diff_lines:
        return None
    if max_lines is not None and len(diff_lines) &gt; max_lines:
        truncated = diff_lines[: max_lines - 1]
        truncated.append(&quot;...&quot;)
        return &quot;\n&quot;.join(truncated)
    return &quot;\n&quot;.join(diff_lines)


@dataclass
class FileOpMetrics:
    &quot;&quot;&quot;Line and byte level metrics for a file operation.&quot;&quot;&quot;

    lines_read: int = 0
    start_line: int | None = None
    end_line: int | None = None
    lines_written: int = 0
    lines_added: int = 0
    lines_removed: int = 0
    bytes_written: int = 0


@dataclass
class FileOperationRecord:
    &quot;&quot;&quot;Track a single filesystem tool call.&quot;&quot;&quot;

    tool_name: str
    display_path: str
    physical_path: Path | None
    tool_call_id: str | None
    args: dict[str, Any] = field(default_factory=dict)
    status: FileOpStatus = &quot;pending&quot;
    error: str | None = None
    metrics: FileOpMetrics = field(default_factory=FileOpMetrics)
    diff: str | None = None
    before_content: str | None = None
    after_content: str | None = None
    read_output: str | None = None
    hitl_approved: bool = False


def resolve_physical_path(path_str: str | None, assistant_id: str | None) -&gt; Path | None:
    &quot;&quot;&quot;Convert a virtual/relative path to a physical filesystem path.&quot;&quot;&quot;
    if not path_str:
        return None
    try:
        if assistant_id and path_str.startswith(&quot;/memories/&quot;):
            agent_dir = settings.get_agent_dir(assistant_id)
            suffix = path_str.removeprefix(&quot;/memories/&quot;).lstrip(&quot;/&quot;)
            return (agent_dir / suffix).resolve()
        path = Path(path_str)
        if path.is_absolute():
            return path
        return (Path.cwd() / path).resolve()
    except (OSError, ValueError):
        return None


def format_display_path(path_str: str | None) -&gt; str:
    &quot;&quot;&quot;Format a path for display.&quot;&quot;&quot;
    if not path_str:
        return &quot;(unknown)&quot;
    try:
        path = Path(path_str)
        if path.is_absolute():
            return path.name or str(path)
        return str(path)
    except (OSError, ValueError):
        return str(path_str)


def build_approval_preview(
    tool_name: str,
    args: dict[str, Any],
    assistant_id: str | None,
) -&gt; ApprovalPreview | None:
    &quot;&quot;&quot;Collect summary info and diff for HITL approvals.&quot;&quot;&quot;
    path_str = str(args.get(&quot;file_path&quot;) or args.get(&quot;path&quot;) or &quot;&quot;)
    display_path = format_display_path(path_str)
    physical_path = resolve_physical_path(path_str, assistant_id)

    if tool_name == &quot;write_file&quot;:
        content = str(args.get(&quot;content&quot;, &quot;&quot;))
        before = _safe_read(physical_path) if physical_path and physical_path.exists() else &quot;&quot;
        after = content
        diff = compute_unified_diff(before or &quot;&quot;, after, display_path, max_lines=100)
        additions = 0
        if diff:
            additions = sum(
                1
                for line in diff.splitlines()
                if line.startswith(&quot;+&quot;) and not line.startswith(&quot;+++&quot;)
            )
        total_lines = _count_lines(after)
        details = [
            f&quot;File: {path_str}&quot;,
            &quot;Action: Create new file&quot; + (&quot; (overwrites existing content)&quot; if before else &quot;&quot;),
            f&quot;Lines to write: {additions or total_lines}&quot;,
        ]
        return ApprovalPreview(
            title=f&quot;Write {display_path}&quot;,
            details=details,
            diff=diff,
            diff_title=f&quot;Diff {display_path}&quot;,
        )

    if tool_name == &quot;edit_file&quot;:
        if physical_path is None:
            return ApprovalPreview(
                title=f&quot;Update {display_path}&quot;,
                details=[f&quot;File: {path_str}&quot;, &quot;Action: Replace text&quot;],
                error=&quot;Unable to resolve file path.&quot;,
            )
        before = _safe_read(physical_path)
        if before is None:
            return ApprovalPreview(
                title=f&quot;Update {display_path}&quot;,
                details=[f&quot;File: {path_str}&quot;, &quot;Action: Replace text&quot;],
                error=&quot;Unable to read current file contents.&quot;,
            )
        old_string = str(args.get(&quot;old_string&quot;, &quot;&quot;))
        new_string = str(args.get(&quot;new_string&quot;, &quot;&quot;))
        replace_all = bool(args.get(&quot;replace_all&quot;, False))
        replacement = perform_string_replacement(before, old_string, new_string, replace_all)
        if isinstance(replacement, str):
            return ApprovalPreview(
                title=f&quot;Update {display_path}&quot;,
                details=[f&quot;File: {path_str}&quot;, &quot;Action: Replace text&quot;],
                error=replacement,
            )
        after, occurrences = replacement
        diff = compute_unified_diff(before, after, display_path, max_lines=None)
        additions = 0
        deletions = 0
        if diff:
            additions = sum(
                1
                for line in diff.splitlines()
                if line.startswith(&quot;+&quot;) and not line.startswith(&quot;+++&quot;)
            )
            deletions = sum(
                1
                for line in diff.splitlines()
                if line.startswith(&quot;-&quot;) and not line.startswith(&quot;---&quot;)
            )
        details = [
            f&quot;File: {path_str}&quot;,
            f&quot;Action: Replace text ({&#x27;all occurrences&#x27; if replace_all else &#x27;single occurrence&#x27;})&quot;,
            f&quot;Occurrences matched: {occurrences}&quot;,
            f&quot;Lines changed: +{additions} / -{deletions}&quot;,
        ]
        return ApprovalPreview(
            title=f&quot;Update {display_path}&quot;,
            details=details,
            diff=diff,
            diff_title=f&quot;Diff {display_path}&quot;,
        )

    return None


class FileOpTracker:
    &quot;&quot;&quot;Collect file operation metrics during a CLI interaction.&quot;&quot;&quot;

    def __init__(self, *, assistant_id: str | None, backend: BACKEND_TYPES | None = None) -&gt; None:
        &quot;&quot;&quot;Initialize the tracker.&quot;&quot;&quot;
        self.assistant_id = assistant_id
        self.backend = backend
        self.active: dict[str | None, FileOperationRecord] = {}
        self.completed: list[FileOperationRecord] = []

    def start_operation(
        self, tool_name: str, args: dict[str, Any], tool_call_id: str | None
    ) -&gt; None:
        if tool_name not in {&quot;read_file&quot;, &quot;write_file&quot;, &quot;edit_file&quot;}:
            return
        path_str = str(args.get(&quot;file_path&quot;) or args.get(&quot;path&quot;) or &quot;&quot;)
        display_path = format_display_path(path_str)
        record = FileOperationRecord(
            tool_name=tool_name,
            display_path=display_path,
            physical_path=resolve_physical_path(path_str, self.assistant_id),
            tool_call_id=tool_call_id,
            args=args,
        )
        if tool_name in {&quot;write_file&quot;, &quot;edit_file&quot;}:
            if self.backend and path_str:
                try:
                    responses = self.backend.download_files([path_str])
                    if (
                        responses
                        and responses[0].content is not None
                        and responses[0].error is None
                    ):
                        record.before_content = responses[0].content.decode(&quot;utf-8&quot;)
                    else:
                        record.before_content = &quot;&quot;
                except Exception:
                    record.before_content = &quot;&quot;
            elif record.physical_path:
                record.before_content = _safe_read(record.physical_path) or &quot;&quot;
        self.active[tool_call_id] = record

    def update_args(self, tool_call_id: str, args: dict[str, Any]) -&gt; None:
        &quot;&quot;&quot;Update arguments for an active operation and retry capturing before_content.&quot;&quot;&quot;
        record = self.active.get(tool_call_id)
        if not record:
            return

        record.args.update(args)

        # If we haven&#x27;t captured before_content yet, try again now that we might have the path
        if record.before_content is None and record.tool_name in {&quot;write_file&quot;, &quot;edit_file&quot;}:
            path_str = str(record.args.get(&quot;file_path&quot;) or record.args.get(&quot;path&quot;) or &quot;&quot;)
            if path_str:
                record.display_path = format_display_path(path_str)
                record.physical_path = resolve_physical_path(path_str, self.assistant_id)
                if self.backend:
                    try:
                        responses = self.backend.download_files([path_str])
                        if (
                            responses
                            and responses[0].content is not None
                            and responses[0].error is None
                        ):
                            record.before_content = responses[0].content.decode(&quot;utf-8&quot;)
                        else:
                            record.before_content = &quot;&quot;
                    except Exception:
                        record.before_content = &quot;&quot;
                elif record.physical_path:
                    record.before_content = _safe_read(record.physical_path) or &quot;&quot;

    def complete_with_message(self, tool_message: Any) -&gt; FileOperationRecord | None:
        tool_call_id = getattr(tool_message, &quot;tool_call_id&quot;, None)
        record = self.active.get(tool_call_id)
        if record is None:
            return None

        content = tool_message.content
        if isinstance(content, list):
            # Some tool messages may return list segments; join them for analysis.
            joined = []
            for item in content:
                if isinstance(item, str):
                    joined.append(item)
                else:
                    joined.append(str(item))
            content_text = &quot;\n&quot;.join(joined)
        else:
            content_text = str(content) if content is not None else &quot;&quot;

        if getattr(
            tool_message, &quot;status&quot;, &quot;success&quot;
        ) != &quot;success&quot; or content_text.lower().startswith(&quot;error&quot;):
            record.status = &quot;error&quot;
            record.error = content_text
            self._finalize(record)
            return record

        record.status = &quot;success&quot;

        if record.tool_name == &quot;read_file&quot;:
            record.read_output = content_text
            lines = _count_lines(content_text)
            record.metrics.lines_read = lines
            offset = record.args.get(&quot;offset&quot;)
            limit = record.args.get(&quot;limit&quot;)
            if isinstance(offset, int):
                if offset &gt; lines:
                    offset = 0
                record.metrics.start_line = offset + 1
                if lines:
                    record.metrics.end_line = offset + lines
            elif lines:
                record.metrics.start_line = 1
                record.metrics.end_line = lines
            if isinstance(limit, int) and lines &gt; limit:
                record.metrics.end_line = (record.metrics.start_line or 1) + limit - 1
        else:
            # For write/edit operations, read back from backend (or local filesystem)
            self._populate_after_content(record)
            if record.after_content is None:
                record.status = &quot;error&quot;
                record.error = &quot;Could not read updated file content.&quot;
                self._finalize(record)
                return record
            record.metrics.lines_written = _count_lines(record.after_content)
            before_lines = _count_lines(record.before_content or &quot;&quot;)
            diff = compute_unified_diff(
                record.before_content or &quot;&quot;,
                record.after_content,
                record.display_path,
                max_lines=100,
            )
            record.diff = diff
            if diff:
                additions = sum(
                    1
                    for line in diff.splitlines()
                    if line.startswith(&quot;+&quot;) and not line.startswith(&quot;+++&quot;)
                )
                deletions = sum(
                    1
                    for line in diff.splitlines()
                    if line.startswith(&quot;-&quot;) and not line.startswith(&quot;---&quot;)
                )
                record.metrics.lines_added = additions
                record.metrics.lines_removed = deletions
            elif record.tool_name == &quot;write_file&quot; and (record.before_content or &quot;&quot;) == &quot;&quot;:
                record.metrics.lines_added = record.metrics.lines_written
            record.metrics.bytes_written = len(record.after_content.encode(&quot;utf-8&quot;))
            if record.diff is None and (record.before_content or &quot;&quot;) != record.after_content:
                record.diff = compute_unified_diff(
                    record.before_content or &quot;&quot;,
                    record.after_content,
                    record.display_path,
                    max_lines=100,
                )
            if record.diff is None and before_lines != record.metrics.lines_written:
                record.metrics.lines_added = max(record.metrics.lines_written - before_lines, 0)

        self._finalize(record)
        return record

    def mark_hitl_approved(self, tool_name: str, args: dict[str, Any]) -&gt; None:
        &quot;&quot;&quot;Mark operations matching tool_name and file_path as HIL-approved.&quot;&quot;&quot;
        file_path = args.get(&quot;file_path&quot;) or args.get(&quot;path&quot;)
        if not file_path:
            return

        # Mark all active records that match
        for record in self.active.values():
            if record.tool_name == tool_name:
                record_path = record.args.get(&quot;file_path&quot;) or record.args.get(&quot;path&quot;)
                if record_path == file_path:
                    record.hitl_approved = True

    def _populate_after_content(self, record: FileOperationRecord) -&gt; None:
        # Use backend if available (works for any BackendProtocol implementation)
        if self.backend:
            try:
                file_path = record.args.get(&quot;file_path&quot;) or record.args.get(&quot;path&quot;)
                if file_path:
                    responses = self.backend.download_files([file_path])
                    if (
                        responses
                        and responses[0].content is not None
                        and responses[0].error is None
                    ):
                        record.after_content = responses[0].content.decode(&quot;utf-8&quot;)
                    else:
                        record.after_content = None
                else:
                    record.after_content = None
            except Exception:
                record.after_content = None
        else:
            # Fallback: direct filesystem read when no backend provided
            if record.physical_path is None:
                record.after_content = None
                return
            record.after_content = _safe_read(record.physical_path)

    def _finalize(self, record: FileOperationRecord) -&gt; None:
        self.completed.append(record)
        self.active.pop(record.tool_call_id, None)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/file_ops/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="filesystem Imported skill filesystem from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/middleware/filesystem.py Unknown LICENSE sources/langchain/filesystem/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">filesystem</div>
                <button class="copy-btn" onclick="copyToClipboard('filesystem')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill filesystem from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Middleware for providing filesystem tools to an agent.&quot;&quot;&quot;
# ruff: noqa: E501

import os
import re
from collections.abc import Awaitable, Callable, Sequence
from typing import Annotated, Literal, NotRequired

from langchain.agents.middleware.types import (
    AgentMiddleware,
    AgentState,
    ModelRequest,
    ModelResponse,
)
from langchain.tools import ToolRuntime
from langchain.tools.tool_node import ToolCallRequest
from langchain_core.messages import ToolMessage
from langchain_core.tools import BaseTool, StructuredTool
from langgraph.types import Command
from typing_extensions import TypedDict

from deepagents.backends import StateBackend
from deepagents.backends.protocol import (
    BACKEND_TYPES as BACKEND_TYPES,  # Re-export for backwards compatibility
    BackendProtocol,
    EditResult,
    SandboxBackendProtocol,
    WriteResult,
)
from deepagents.backends.utils import (
    format_content_with_line_numbers,
    format_grep_matches,
    sanitize_tool_call_id,
    truncate_if_too_long,
)
from deepagents.middleware._utils import append_to_system_message

EMPTY_CONTENT_WARNING = &quot;System reminder: File exists but has empty contents&quot;
LINE_NUMBER_WIDTH = 6
DEFAULT_READ_OFFSET = 0
DEFAULT_READ_LIMIT = 100


class FileData(TypedDict):
    &quot;&quot;&quot;Data structure for storing file contents with metadata.&quot;&quot;&quot;

    content: list[str]
    &quot;&quot;&quot;Lines of the file.&quot;&quot;&quot;

    created_at: str
    &quot;&quot;&quot;ISO 8601 timestamp of file creation.&quot;&quot;&quot;

    modified_at: str
    &quot;&quot;&quot;ISO 8601 timestamp of last modification.&quot;&quot;&quot;


def _file_data_reducer(left: dict[str, FileData] | None, right: dict[str, FileData | None]) -&gt; dict[str, FileData]:
    &quot;&quot;&quot;Merge file updates with support for deletions.

    This reducer enables file deletion by treating `None` values in the right
    dictionary as deletion markers. It&#x27;s designed to work with LangGraph&#x27;s
    state management where annotated reducers control how state updates merge.

    Args:
        left: Existing files dictionary. May be `None` during initialization.
        right: New files dictionary to merge. Files with `None` values are
            treated as deletion markers and removed from the result.

    Returns:
        Merged dictionary where right overwrites left for matching keys,
        and `None` values in right trigger deletions.

    Example:
        ```python
        existing = {&quot;/file1.txt&quot;: FileData(...), &quot;/file2.txt&quot;: FileData(...)}
        updates = {&quot;/file2.txt&quot;: None, &quot;/file3.txt&quot;: FileData(...)}
        result = file_data_reducer(existing, updates)
        # Result: {&quot;/file1.txt&quot;: FileData(...), &quot;/file3.txt&quot;: FileData(...)}
        ```
    &quot;&quot;&quot;
    if left is None:
        return {k: v for k, v in right.items() if v is not None}

    result = {**left}
    for key, value in right.items():
        if value is None:
            result.pop(key, None)
        else:
            result[key] = value
    return result


def _validate_path(path: str, *, allowed_prefixes: Sequence[str] | None = None) -&gt; str:
    r&quot;&quot;&quot;Validate and normalize file path for security.

    Ensures paths are safe to use by preventing directory traversal attacks
    and enforcing consistent formatting. All paths are normalized to use
    forward slashes and start with a leading slash.

    This function is designed for virtual filesystem paths and rejects
    Windows absolute paths (e.g., C:/..., F:/...) to maintain consistency
    and prevent path format ambiguity.

    Args:
        path: The path to validate and normalize.
        allowed_prefixes: Optional list of allowed path prefixes. If provided,
            the normalized path must start with one of these prefixes.

    Returns:
        Normalized canonical path starting with `/` and using forward slashes.

    Raises:
        ValueError: If path contains traversal sequences (`..` or `~`), is a
            Windows absolute path (e.g., C:/...), or does not start with an
            allowed prefix when `allowed_prefixes` is specified.

    Example:
        ```python
        validate_path(&quot;foo/bar&quot;)  # Returns: &quot;/foo/bar&quot;
        validate_path(&quot;/./foo//bar&quot;)  # Returns: &quot;/foo/bar&quot;
        validate_path(&quot;../etc/passwd&quot;)  # Raises ValueError
        validate_path(r&quot;C:\\Users\\file.txt&quot;)  # Raises ValueError
        validate_path(&quot;/data/file.txt&quot;, allowed_prefixes=[&quot;/data/&quot;])  # OK
        validate_path(&quot;/etc/file.txt&quot;, allowed_prefixes=[&quot;/data/&quot;])  # Raises ValueError
        ```
    &quot;&quot;&quot;
    if &quot;..&quot; in path or path.startswith(&quot;~&quot;):
        msg = f&quot;Path traversal not allowed: {path}&quot;
        raise ValueError(msg)

    # Reject Windows absolute paths (e.g., C:\..., D:/...)
    # This maintains consistency in virtual filesystem paths
    if re.match(r&quot;^[a-zA-Z]:&quot;, path):
        msg = f&quot;Windows absolute paths are not supported: {path}. Please use virtual paths starting with / (e.g., /workspace/file.txt)&quot;
        raise ValueError(msg)

    normalized = os.path.normpath(path)
    normalized = normalized.replace(&quot;\\&quot;, &quot;/&quot;)

    if not normalized.startswith(&quot;/&quot;):
        normalized = f&quot;/{normalized}&quot;

    if allowed_prefixes is not None and not any(normalized.startswith(prefix) for prefix in allowed_prefixes):
        msg = f&quot;Path must start with one of {allowed_prefixes}: {path}&quot;
        raise ValueError(msg)

    return normalized


class FilesystemState(AgentState):
    &quot;&quot;&quot;State for the filesystem middleware.&quot;&quot;&quot;

    files: Annotated[NotRequired[dict[str, FileData]], _file_data_reducer]
    &quot;&quot;&quot;Files in the filesystem.&quot;&quot;&quot;


LIST_FILES_TOOL_DESCRIPTION = &quot;&quot;&quot;Lists all files in the filesystem, filtering by directory.

Usage:
- The path parameter must be an absolute path, not a relative path
- The list_files tool will return a list of all files in the specified directory.
- This is very useful for exploring the file system and finding the right file to read or edit.
- You should almost ALWAYS use this tool before using the Read or Edit tools.&quot;&quot;&quot;

READ_FILE_TOOL_DESCRIPTION = &quot;&quot;&quot;Reads a file from the filesystem. You can access any file directly by using this tool.
Assume this tool is able to read all files on the machine. If the User provides a path to a file assume that path is valid. It is okay to read a file that does not exist; an error will be returned.

Usage:
- The file_path parameter must be an absolute path, not a relative path
- By default, it reads up to 100 lines starting from the beginning of the file
- **IMPORTANT for large files and codebase exploration**: Use pagination with offset and limit parameters to avoid context overflow
  - First scan: read_file(path, limit=100) to see file structure
  - Read more sections: read_file(path, offset=100, limit=200) for next 200 lines
  - Only omit limit (read full file) when necessary for editing
- Specify offset and limit: read_file(path, offset=0, limit=100) reads first 100 lines
- Results are returned using cat -n format, with line numbers starting at 1
- Lines longer than 5,000 characters will be split into multiple lines with continuation markers (e.g., 5.1, 5.2, etc.). When you specify a limit, these continuation lines count towards the limit.
- You have the capability to call multiple tools in a single response. It is always better to speculatively read multiple files as a batch that are potentially useful.
- If you read a file that exists but has empty contents you will receive a system reminder warning in place of file contents.
- You should ALWAYS make sure a file has been read before editing it.&quot;&quot;&quot;

EDIT_FILE_TOOL_DESCRIPTION = &quot;&quot;&quot;Performs exact string replacements in files.

Usage:
- You must use your `Read` tool at least once in the conversation before editing. This tool will error if you attempt an edit without reading the file.
- When editing text from Read tool output, ensure you preserve the exact indentation (tabs/spaces) as it appears AFTER the line number prefix. The line number prefix format is: spaces + line number + tab. Everything after that tab is the actual file content to match. Never include any part of the line number prefix in the old_string or new_string.
- ALWAYS prefer editing existing files. NEVER write new files unless explicitly required.
- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.
- The edit will FAIL if `old_string` is not unique in the file. Either provide a larger string with more surrounding context to make it unique or use `replace_all` to change every instance of `old_string`.
- Use `replace_all` for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.&quot;&quot;&quot;


WRITE_FILE_TOOL_DESCRIPTION = &quot;&quot;&quot;Writes to a new file in the filesystem.

Usage:
- The file_path parameter must be an absolute path, not a relative path
- The content parameter must be a string
- The write_file tool will create the a new file.
- Prefer to edit existing files over creating new ones when possible.&quot;&quot;&quot;


GLOB_TOOL_DESCRIPTION = &quot;&quot;&quot;Find files matching a glob pattern.

Usage:
- The glob tool finds files by matching patterns with wildcards
- Supports standard glob patterns: `*` (any characters), `**` (any directories), `?` (single character)
- Patterns can be absolute (starting with `/`) or relative
- Returns a list of absolute file paths that match the pattern

Examples:
- `**/*.py` - Find all Python files
- `*.txt` - Find all text files in root
- `/subdir/**/*.md` - Find all markdown files under /subdir&quot;&quot;&quot;

GREP_TOOL_DESCRIPTION = &quot;&quot;&quot;Search for a pattern in files.

Usage:
- The grep tool searches for text patterns across files
- The pattern parameter is the text to search for (literal string, not regex)
- The path parameter filters which directory to search in (default is the current working directory)
- The glob parameter accepts a glob pattern to filter which files to search (e.g., `*.py`)
- The output_mode parameter controls the output format:
  - `files_with_matches`: List only file paths containing matches (default)
  - `content`: Show matching lines with file path and line numbers
  - `count`: Show count of matches per file

Examples:
- Search all files: `grep(pattern=&quot;TODO&quot;)`
- Search Python files only: `grep(pattern=&quot;import&quot;, glob=&quot;*.py&quot;)`
- Show matching lines: `grep(pattern=&quot;error&quot;, output_mode=&quot;content&quot;)`&quot;&quot;&quot;

EXECUTE_TOOL_DESCRIPTION = &quot;&quot;&quot;Executes a given command in the sandbox environment with proper handling and security measures.

Before executing the command, please follow these steps:

1. Directory Verification:
   - If the command will create new directories or files, first use the ls tool to verify the parent directory exists and is the correct location
   - For example, before running &quot;mkdir foo/bar&quot;, first use ls to check that &quot;foo&quot; exists and is the intended parent directory

2. Command Execution:
   - Always quote file paths that contain spaces with double quotes (e.g., cd &quot;path with spaces/file.txt&quot;)
   - Examples of proper quoting:
     - cd &quot;/Users/name/My Documents&quot; (correct)
     - cd /Users/name/My Documents (incorrect - will fail)
     - python &quot;/path/with spaces/script.py&quot; (correct)
     - python /path/with spaces/script.py (incorrect - will fail)
   - After ensuring proper quoting, execute the command
   - Capture the output of the command

Usage notes:
  - The command parameter is required
  - Commands run in an isolated sandbox environment
  - Returns combined stdout/stderr output with exit code
  - If the output is very large, it may be truncated
  - VERY IMPORTANT: You MUST avoid using search commands like find and grep. Instead use the grep, glob tools to search. You MUST avoid read tools like cat, head, tail, and use read_file to read files.
  - When issuing multiple commands, use the &#x27;;&#x27; or &#x27;&amp;&amp;&#x27; operator to separate them. DO NOT use newlines (newlines are ok in quoted strings)
    - Use &#x27;&amp;&amp;&#x27; when commands depend on each other (e.g., &quot;mkdir dir &amp;&amp; cd dir&quot;)
    - Use &#x27;;&#x27; only when you need to run commands sequentially but don&#x27;t care if earlier commands fail
  - Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of cd

Examples:
  Good examples:
    - execute(command=&quot;pytest /foo/bar/tests&quot;)
    - execute(command=&quot;python /path/to/script.py&quot;)
    - execute(command=&quot;npm install &amp;&amp; npm test&quot;)

  Bad examples (avoid these):
    - execute(command=&quot;cd /foo/bar &amp;&amp; pytest tests&quot;)  # Use absolute path instead
    - execute(command=&quot;cat file.txt&quot;)  # Use read_file tool instead
    - execute(command=&quot;find . -name &#x27;*.py&#x27;&quot;)  # Use glob tool instead
    - execute(command=&quot;grep -r &#x27;pattern&#x27; .&quot;)  # Use grep tool instead

Note: This tool is only available if the backend supports execution (SandboxBackendProtocol).
If execution is not supported, the tool will return an error message.&quot;&quot;&quot;

FILESYSTEM_SYSTEM_PROMPT = &quot;&quot;&quot;## Filesystem Tools `ls`, `read_file`, `write_file`, `edit_file`, `glob`, `grep`

You have access to a filesystem which you can interact with using these tools.
All file paths must start with a /.

- ls: list files in a directory (requires absolute path)
- read_file: read a file from the filesystem
- write_file: write to a file in the filesystem
- edit_file: edit a file in the filesystem
- glob: find files matching a pattern (e.g., &quot;**/*.py&quot;)
- grep: search for text within files&quot;&quot;&quot;

EXECUTION_SYSTEM_PROMPT = &quot;&quot;&quot;## Execute Tool `execute`

You have access to an `execute` tool for running shell commands in a sandboxed environment.
Use this tool to run commands, scripts, tests, builds, and other shell operations.

- execute: run a shell command in the sandbox (returns output and exit code)&quot;&quot;&quot;


def _get_backend(backend: BACKEND_TYPES, runtime: ToolRuntime) -&gt; BackendProtocol:
    &quot;&quot;&quot;Get the resolved backend instance from backend or factory.

    Args:
        backend: Backend instance or factory function.
        runtime: The tool runtime context.

    Returns:
        Resolved backend instance.
    &quot;&quot;&quot;
    if callable(backend):
        return backend(runtime)
    return backend


def _ls_tool_generator(
    backend: BackendProtocol | Callable[[ToolRuntime], BackendProtocol],
    custom_description: str | None = None,
) -&gt; BaseTool:
    &quot;&quot;&quot;Generate the ls (list files) tool.

    Args:
        backend: Backend to use for file storage, or a factory function that takes runtime and returns a backend.
        custom_description: Optional custom description for the tool.

    Returns:
        Configured ls tool that lists files using the backend.
    &quot;&quot;&quot;
    tool_description = custom_description or LIST_FILES_TOOL_DESCRIPTION

    def sync_ls(runtime: ToolRuntime[None, FilesystemState], path: str) -&gt; str:
        &quot;&quot;&quot;Synchronous wrapper for ls tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)
        validated_path = _validate_path(path)
        infos = resolved_backend.ls_info(validated_path)
        paths = [fi.get(&quot;path&quot;, &quot;&quot;) for fi in infos]
        result = truncate_if_too_long(paths)
        return str(result)

    async def async_ls(runtime: ToolRuntime[None, FilesystemState], path: str) -&gt; str:
        &quot;&quot;&quot;Asynchronous wrapper for ls tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)
        validated_path = _validate_path(path)
        infos = await resolved_backend.als_info(validated_path)
        paths = [fi.get(&quot;path&quot;, &quot;&quot;) for fi in infos]
        result = truncate_if_too_long(paths)
        return str(result)

    return StructuredTool.from_function(
        name=&quot;ls&quot;,
        description=tool_description,
        func=sync_ls,
        coroutine=async_ls,
    )


def _read_file_tool_generator(
    backend: BackendProtocol | Callable[[ToolRuntime], BackendProtocol],
    custom_description: str | None = None,
) -&gt; BaseTool:
    &quot;&quot;&quot;Generate the read_file tool.

    Args:
        backend: Backend to use for file storage, or a factory function that takes runtime and returns a backend.
        custom_description: Optional custom description for the tool.

    Returns:
        Configured read_file tool that reads files using the backend.
    &quot;&quot;&quot;
    tool_description = custom_description or READ_FILE_TOOL_DESCRIPTION

    def sync_read_file(
        file_path: str,
        runtime: ToolRuntime[None, FilesystemState],
        offset: int = DEFAULT_READ_OFFSET,
        limit: int = DEFAULT_READ_LIMIT,
    ) -&gt; str:
        &quot;&quot;&quot;Synchronous wrapper for read_file tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)
        file_path = _validate_path(file_path)
        result = resolved_backend.read(file_path, offset=offset, limit=limit)

        lines = result.splitlines(keepends=True)
        if len(lines) &gt; limit:
            lines = lines[:limit]
            result = &quot;&quot;.join(lines)

        return result

    async def async_read_file(
        file_path: str,
        runtime: ToolRuntime[None, FilesystemState],
        offset: int = DEFAULT_READ_OFFSET,
        limit: int = DEFAULT_READ_LIMIT,
    ) -&gt; str:
        &quot;&quot;&quot;Asynchronous wrapper for read_file tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)
        file_path = _validate_path(file_path)
        result = await resolved_backend.aread(file_path, offset=offset, limit=limit)

        lines = result.splitlines(keepends=True)
        if len(lines) &gt; limit:
            lines = lines[:limit]
            result = &quot;&quot;.join(lines)

        return result

    return StructuredTool.from_function(
        name=&quot;read_file&quot;,
        description=tool_description,
        func=sync_read_file,
        coroutine=async_read_file,
    )


def _write_file_tool_generator(
    backend: BackendProtocol | Callable[[ToolRuntime], BackendProtocol],
    custom_description: str | None = None,
) -&gt; BaseTool:
    &quot;&quot;&quot;Generate the write_file tool.

    Args:
        backend: Backend to use for file storage, or a factory function that takes runtime and returns a backend.
        custom_description: Optional custom description for the tool.

    Returns:
        Configured write_file tool that creates new files using the backend.
    &quot;&quot;&quot;
    tool_description = custom_description or WRITE_FILE_TOOL_DESCRIPTION

    def sync_write_file(
        file_path: str,
        content: str,
        runtime: ToolRuntime[None, FilesystemState],
    ) -&gt; Command | str:
        &quot;&quot;&quot;Synchronous wrapper for write_file tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)
        file_path = _validate_path(file_path)
        res: WriteResult = resolved_backend.write(file_path, content)
        if res.error:
            return res.error
        # If backend returns state update, wrap into Command with ToolMessage
        if res.files_update is not None:
            return Command(
                update={
                    &quot;files&quot;: res.files_update,
                    &quot;messages&quot;: [
                        ToolMessage(
                            content=f&quot;Updated file {res.path}&quot;,
                            tool_call_id=runtime.tool_call_id,
                        )
                    ],
                }
            )
        return f&quot;Updated file {res.path}&quot;

    async def async_write_file(
        file_path: str,
        content: str,
        runtime: ToolRuntime[None, FilesystemState],
    ) -&gt; Command | str:
        &quot;&quot;&quot;Asynchronous wrapper for write_file tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)
        file_path = _validate_path(file_path)
        res: WriteResult = await resolved_backend.awrite(file_path, content)
        if res.error:
            return res.error
        # If backend returns state update, wrap into Command with ToolMessage
        if res.files_update is not None:
            return Command(
                update={
                    &quot;files&quot;: res.files_update,
                    &quot;messages&quot;: [
                        ToolMessage(
                            content=f&quot;Updated file {res.path}&quot;,
                            tool_call_id=runtime.tool_call_id,
                        )
                    ],
                }
            )
        return f&quot;Updated file {res.path}&quot;

    return StructuredTool.from_function(
        name=&quot;write_file&quot;,
        description=tool_description,
        func=sync_write_file,
        coroutine=async_write_file,
    )


def _edit_file_tool_generator(
    backend: BackendProtocol | Callable[[ToolRuntime], BackendProtocol],
    custom_description: str | None = None,
) -&gt; BaseTool:
    &quot;&quot;&quot;Generate the edit_file tool.

    Args:
        backend: Backend to use for file storage, or a factory function that takes runtime and returns a backend.
        custom_description: Optional custom description for the tool.

    Returns:
        Configured edit_file tool that performs string replacements in files using the backend.
    &quot;&quot;&quot;
    tool_description = custom_description or EDIT_FILE_TOOL_DESCRIPTION

    def sync_edit_file(
        file_path: str,
        old_string: str,
        new_string: str,
        runtime: ToolRuntime[None, FilesystemState],
        *,
        replace_all: bool = False,
    ) -&gt; Command | str:
        &quot;&quot;&quot;Synchronous wrapper for edit_file tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)
        file_path = _validate_path(file_path)
        res: EditResult = resolved_backend.edit(file_path, old_string, new_string, replace_all=replace_all)
        if res.error:
            return res.error
        if res.files_update is not None:
            return Command(
                update={
                    &quot;files&quot;: res.files_update,
                    &quot;messages&quot;: [
                        ToolMessage(
                            content=f&quot;Successfully replaced {res.occurrences} instance(s) of the string in &#x27;{res.path}&#x27;&quot;,
                            tool_call_id=runtime.tool_call_id,
                        )
                    ],
                }
            )
        return f&quot;Successfully replaced {res.occurrences} instance(s) of the string in &#x27;{res.path}&#x27;&quot;

    async def async_edit_file(
        file_path: str,
        old_string: str,
        new_string: str,
        runtime: ToolRuntime[None, FilesystemState],
        *,
        replace_all: bool = False,
    ) -&gt; Command | str:
        &quot;&quot;&quot;Asynchronous wrapper for edit_file tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)
        file_path = _validate_path(file_path)
        res: EditResult = await resolved_backend.aedit(file_path, old_string, new_string, replace_all=replace_all)
        if res.error:
            return res.error
        if res.files_update is not None:
            return Command(
                update={
                    &quot;files&quot;: res.files_update,
                    &quot;messages&quot;: [
                        ToolMessage(
                            content=f&quot;Successfully replaced {res.occurrences} instance(s) of the string in &#x27;{res.path}&#x27;&quot;,
                            tool_call_id=runtime.tool_call_id,
                        )
                    ],
                }
            )
        return f&quot;Successfully replaced {res.occurrences} instance(s) of the string in &#x27;{res.path}&#x27;&quot;

    return StructuredTool.from_function(
        name=&quot;edit_file&quot;,
        description=tool_description,
        func=sync_edit_file,
        coroutine=async_edit_file,
    )


def _glob_tool_generator(
    backend: BackendProtocol | Callable[[ToolRuntime], BackendProtocol],
    custom_description: str | None = None,
) -&gt; BaseTool:
    &quot;&quot;&quot;Generate the glob tool.

    Args:
        backend: Backend to use for file storage, or a factory function that takes runtime and returns a backend.
        custom_description: Optional custom description for the tool.

    Returns:
        Configured glob tool that finds files by pattern using the backend.
    &quot;&quot;&quot;
    tool_description = custom_description or GLOB_TOOL_DESCRIPTION

    def sync_glob(pattern: str, runtime: ToolRuntime[None, FilesystemState], path: str = &quot;/&quot;) -&gt; str:
        &quot;&quot;&quot;Synchronous wrapper for glob tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)
        infos = resolved_backend.glob_info(pattern, path=path)
        paths = [fi.get(&quot;path&quot;, &quot;&quot;) for fi in infos]
        result = truncate_if_too_long(paths)
        return str(result)

    async def async_glob(pattern: str, runtime: ToolRuntime[None, FilesystemState], path: str = &quot;/&quot;) -&gt; str:
        &quot;&quot;&quot;Asynchronous wrapper for glob tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)
        infos = await resolved_backend.aglob_info(pattern, path=path)
        paths = [fi.get(&quot;path&quot;, &quot;&quot;) for fi in infos]
        result = truncate_if_too_long(paths)
        return str(result)

    return StructuredTool.from_function(
        name=&quot;glob&quot;,
        description=tool_description,
        func=sync_glob,
        coroutine=async_glob,
    )


def _grep_tool_generator(
    backend: BackendProtocol | Callable[[ToolRuntime], BackendProtocol],
    custom_description: str | None = None,
) -&gt; BaseTool:
    &quot;&quot;&quot;Generate the grep tool.

    Args:
        backend: Backend to use for file storage, or a factory function that takes runtime and returns a backend.
        custom_description: Optional custom description for the tool.

    Returns:
        Configured grep tool that searches for patterns in files using the backend.
    &quot;&quot;&quot;
    tool_description = custom_description or GREP_TOOL_DESCRIPTION

    def sync_grep(
        pattern: str,
        runtime: ToolRuntime[None, FilesystemState],
        path: str | None = None,
        glob: str | None = None,
        output_mode: Literal[&quot;files_with_matches&quot;, &quot;content&quot;, &quot;count&quot;] = &quot;files_with_matches&quot;,
    ) -&gt; str:
        &quot;&quot;&quot;Synchronous wrapper for grep tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)
        raw = resolved_backend.grep_raw(pattern, path=path, glob=glob)
        if isinstance(raw, str):
            return raw
        formatted = format_grep_matches(raw, output_mode)
        return truncate_if_too_long(formatted)  # type: ignore[arg-type]

    async def async_grep(
        pattern: str,
        runtime: ToolRuntime[None, FilesystemState],
        path: str | None = None,
        glob: str | None = None,
        output_mode: Literal[&quot;files_with_matches&quot;, &quot;content&quot;, &quot;count&quot;] = &quot;files_with_matches&quot;,
    ) -&gt; str:
        &quot;&quot;&quot;Asynchronous wrapper for grep tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)
        raw = await resolved_backend.agrep_raw(pattern, path=path, glob=glob)
        if isinstance(raw, str):
            return raw
        formatted = format_grep_matches(raw, output_mode)
        return truncate_if_too_long(formatted)  # type: ignore[arg-type]

    return StructuredTool.from_function(
        name=&quot;grep&quot;,
        description=tool_description,
        func=sync_grep,
        coroutine=async_grep,
    )


def _supports_execution(backend: BackendProtocol) -&gt; bool:
    &quot;&quot;&quot;Check if a backend supports command execution.

    For CompositeBackend, checks if the default backend supports execution.
    For other backends, checks if they implement SandboxBackendProtocol.

    Args:
        backend: The backend to check.

    Returns:
        True if the backend supports execution, False otherwise.
    &quot;&quot;&quot;
    # Import here to avoid circular dependency
    from deepagents.backends.composite import CompositeBackend

    # For CompositeBackend, check the default backend
    if isinstance(backend, CompositeBackend):
        return isinstance(backend.default, SandboxBackendProtocol)

    # For other backends, use isinstance check
    return isinstance(backend, SandboxBackendProtocol)


def _execute_tool_generator(
    backend: BackendProtocol | Callable[[ToolRuntime], BackendProtocol],
    custom_description: str | None = None,
) -&gt; BaseTool:
    &quot;&quot;&quot;Generate the execute tool for sandbox command execution.

    Args:
        backend: Backend to use for execution, or a factory function that takes runtime and returns a backend.
        custom_description: Optional custom description for the tool.

    Returns:
        Configured execute tool that runs commands if backend supports SandboxBackendProtocol.
    &quot;&quot;&quot;
    tool_description = custom_description or EXECUTE_TOOL_DESCRIPTION

    def sync_execute(
        command: str,
        runtime: ToolRuntime[None, FilesystemState],
    ) -&gt; str:
        &quot;&quot;&quot;Synchronous wrapper for execute tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)

        # Runtime check - fail gracefully if not supported
        if not _supports_execution(resolved_backend):
            return (
                &quot;Error: Execution not available. This agent&#x27;s backend &quot;
                &quot;does not support command execution (SandboxBackendProtocol). &quot;
                &quot;To use the execute tool, provide a backend that implements SandboxBackendProtocol.&quot;
            )

        try:
            result = resolved_backend.execute(command)
        except NotImplementedError as e:
            # Handle case where execute() exists but raises NotImplementedError
            return f&quot;Error: Execution not available. {e}&quot;

        # Format output for LLM consumption
        parts = [result.output]

        if result.exit_code is not None:
            status = &quot;succeeded&quot; if result.exit_code == 0 else &quot;failed&quot;
            parts.append(f&quot;\n[Command {status} with exit code {result.exit_code}]&quot;)

        if result.truncated:
            parts.append(&quot;\n[Output was truncated due to size limits]&quot;)

        return &quot;&quot;.join(parts)

    async def async_execute(
        command: str,
        runtime: ToolRuntime[None, FilesystemState],
    ) -&gt; str:
        &quot;&quot;&quot;Asynchronous wrapper for execute tool.&quot;&quot;&quot;
        resolved_backend = _get_backend(backend, runtime)

        # Runtime check - fail gracefully if not supported
        if not _supports_execution(resolved_backend):
            return (
                &quot;Error: Execution not available. This agent&#x27;s backend &quot;
                &quot;does not support command execution (SandboxBackendProtocol). &quot;
                &quot;To use the execute tool, provide a backend that implements SandboxBackendProtocol.&quot;
            )

        try:
            result = await resolved_backend.aexecute(command)
        except NotImplementedError as e:
            # Handle case where execute() exists but raises NotImplementedError
            return f&quot;Error: Execution not available. {e}&quot;

        # Format output for LLM consumption
        parts = [result.output]

        if result.exit_code is not None:
            status = &quot;succeeded&quot; if result.exit_code == 0 else &quot;failed&quot;
            parts.append(f&quot;\n[Command {status} with exit code {result.exit_code}]&quot;)

        if result.truncated:
            parts.append(&quot;\n[Output was truncated due to size limits]&quot;)

        return &quot;&quot;.join(parts)

    return StructuredTool.from_function(
        name=&quot;execute&quot;,
        description=tool_description,
        func=sync_execute,
        coroutine=async_execute,
    )


TOOL_GENERATORS = {
    &quot;ls&quot;: _ls_tool_generator,
    &quot;read_file&quot;: _read_file_tool_generator,
    &quot;write_file&quot;: _write_file_tool_generator,
    &quot;edit_file&quot;: _edit_file_tool_generator,
    &quot;glob&quot;: _glob_tool_generator,
    &quot;grep&quot;: _grep_tool_generator,
    &quot;execute&quot;: _execute_tool_generator,
}


def _get_filesystem_tools(
    backend: BackendProtocol,
    custom_tool_descriptions: dict[str, str] | None = None,
) -&gt; list[BaseTool]:
    &quot;&quot;&quot;Get filesystem and execution tools.

    Args:
        backend: Backend to use for file storage and optional execution, or a factory function that takes runtime and returns a backend.
        custom_tool_descriptions: Optional custom descriptions for tools.

    Returns:
        List of configured tools: ls, read_file, write_file, edit_file, glob, grep, execute.
    &quot;&quot;&quot;
    if custom_tool_descriptions is None:
        custom_tool_descriptions = {}
    tools = []

    for tool_name, tool_generator in TOOL_GENERATORS.items():
        tool = tool_generator(backend, custom_tool_descriptions.get(tool_name))
        tools.append(tool)
    return tools


TOO_LARGE_TOOL_MSG = &quot;&quot;&quot;Tool result too large, the result of this tool call {tool_call_id} was saved in the filesystem at this path: {file_path}
You can read the result from the filesystem by using the read_file tool, but make sure to only read part of the result at a time.
You can do this by specifying an offset and limit in the read_file tool call.
For example, to read the first 100 lines, you can use the read_file tool with offset=0 and limit=100.

Here are the first 10 lines of the result:
{content_sample}
&quot;&quot;&quot;


class FilesystemMiddleware(AgentMiddleware):
    &quot;&quot;&quot;Middleware for providing filesystem and optional execution tools to an agent.

    This middleware adds filesystem tools to the agent: `ls`, `read_file`, `write_file`,
    `edit_file`, `glob`, and `grep`.

    Files can be stored using any backend that implements the `BackendProtocol`.

    If the backend implements `SandboxBackendProtocol`, an `execute` tool is also added
    for running shell commands.

    This middleware also automatically evicts large tool results to the file system when
    they exceed a token threshold, preventing context window saturation.

    Args:
        backend: Backend for file storage and optional execution.

            If not provided, defaults to `StateBackend` (ephemeral storage in agent state).

            For persistent storage or hybrid setups, use `CompositeBackend` with custom routes.

            For execution support, use a backend that implements `SandboxBackendProtocol`.
        system_prompt: Optional custom system prompt override.
        custom_tool_descriptions: Optional custom tool descriptions override.
        tool_token_limit_before_evict: Token limit before evicting a tool result to the
            filesystem.

            When exceeded, writes the result using the configured backend and replaces it
            with a truncated preview and file reference.

    Example:
        ```python
        from deepagents.middleware.filesystem import FilesystemMiddleware
        from deepagents.backends import StateBackend, StoreBackend, CompositeBackend
        from langchain.agents import create_agent

        # Ephemeral storage only (default, no execution)
        agent = create_agent(middleware=[FilesystemMiddleware()])

        # With hybrid storage (ephemeral + persistent /memories/)
        backend = CompositeBackend(default=StateBackend(), routes={&quot;/memories/&quot;: StoreBackend()})
        agent = create_agent(middleware=[FilesystemMiddleware(backend=backend)])

        # With sandbox backend (supports execution)
        from my_sandbox import DockerSandboxBackend

        sandbox = DockerSandboxBackend(container_id=&quot;my-container&quot;)
        agent = create_agent(middleware=[FilesystemMiddleware(backend=sandbox)])
        ```
    &quot;&quot;&quot;

    state_schema = FilesystemState

    def __init__(
        self,
        *,
        backend: BACKEND_TYPES | None = None,
        system_prompt: str | None = None,
        custom_tool_descriptions: dict[str, str] | None = None,
        tool_token_limit_before_evict: int | None = 20000,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize the filesystem middleware.

        Args:
            backend: Backend for file storage and optional execution, or a factory callable.
                Defaults to StateBackend if not provided.
            system_prompt: Optional custom system prompt override.
            custom_tool_descriptions: Optional custom tool descriptions override.
            tool_token_limit_before_evict: Optional token limit before evicting a tool result to the filesystem.
        &quot;&quot;&quot;
        self.tool_token_limit_before_evict = tool_token_limit_before_evict

        # Use provided backend or default to StateBackend factory
        self.backend = backend if backend is not None else (lambda rt: StateBackend(rt))

        # Set system prompt (allow full override or None to generate dynamically)
        self._custom_system_prompt = system_prompt

        self.tools = _get_filesystem_tools(self.backend, custom_tool_descriptions)

    def _get_backend(self, runtime: ToolRuntime) -&gt; BackendProtocol:
        &quot;&quot;&quot;Get the resolved backend instance from backend or factory.

        Args:
            runtime: The tool runtime context.

        Returns:
            Resolved backend instance.
        &quot;&quot;&quot;
        if callable(self.backend):
            return self.backend(runtime)
        return self.backend

    def wrap_model_call(
        self,
        request: ModelRequest,
        handler: Callable[[ModelRequest], ModelResponse],
    ) -&gt; ModelResponse:
        &quot;&quot;&quot;Update the system prompt and filter tools based on backend capabilities.

        Args:
            request: The model request being processed.
            handler: The handler function to call with the modified request.

        Returns:
            The model response from the handler.
        &quot;&quot;&quot;
        # Check if execute tool is present and if backend supports it
        has_execute_tool = any((tool.name if hasattr(tool, &quot;name&quot;) else tool.get(&quot;name&quot;)) == &quot;execute&quot; for tool in request.tools)

        backend_supports_execution = False
        if has_execute_tool:
            # Resolve backend to check execution support
            backend = self._get_backend(request.runtime)
            backend_supports_execution = _supports_execution(backend)

            # If execute tool exists but backend doesn&#x27;t support it, filter it out
            if not backend_supports_execution:
                filtered_tools = [tool for tool in request.tools if (tool.name if hasattr(tool, &quot;name&quot;) else tool.get(&quot;name&quot;)) != &quot;execute&quot;]
                request = request.override(tools=filtered_tools)
                has_execute_tool = False

        # Use custom system prompt if provided, otherwise generate dynamically
        if self._custom_system_prompt is not None:
            system_prompt = self._custom_system_prompt
        else:
            # Build dynamic system prompt based on available tools
            prompt_parts = [FILESYSTEM_SYSTEM_PROMPT]

            # Add execution instructions if execute tool is available
            if has_execute_tool and backend_supports_execution:
                prompt_parts.append(EXECUTION_SYSTEM_PROMPT)

            system_prompt = &quot;\n\n&quot;.join(prompt_parts)

        if system_prompt:
            new_system_message = append_to_system_message(request.system_message, system_prompt)
            request = request.override(system_message=new_system_message)

        return handler(request)

    async def awrap_model_call(
        self,
        request: ModelRequest,
        handler: Callable[[ModelRequest], Awaitable[ModelResponse]],
    ) -&gt; ModelResponse:
        &quot;&quot;&quot;(async) Update the system prompt and filter tools based on backend capabilities.

        Args:
            request: The model request being processed.
            handler: The handler function to call with the modified request.

        Returns:
            The model response from the handler.
        &quot;&quot;&quot;
        # Check if execute tool is present and if backend supports it
        has_execute_tool = any((tool.name if hasattr(tool, &quot;name&quot;) else tool.get(&quot;name&quot;)) == &quot;execute&quot; for tool in request.tools)

        backend_supports_execution = False
        if has_execute_tool:
            # Resolve backend to check execution support
            backend = self._get_backend(request.runtime)
            backend_supports_execution = _supports_execution(backend)

            # If execute tool exists but backend doesn&#x27;t support it, filter it out
            if not backend_supports_execution:
                filtered_tools = [tool for tool in request.tools if (tool.name if hasattr(tool, &quot;name&quot;) else tool.get(&quot;name&quot;)) != &quot;execute&quot;]
                request = request.override(tools=filtered_tools)
                has_execute_tool = False

        # Use custom system prompt if provided, otherwise generate dynamically
        if self._custom_system_prompt is not None:
            system_prompt = self._custom_system_prompt
        else:
            # Build dynamic system prompt based on available tools
            prompt_parts = [FILESYSTEM_SYSTEM_PROMPT]

            # Add execution instructions if execute tool is available
            if has_execute_tool and backend_supports_execution:
                prompt_parts.append(EXECUTION_SYSTEM_PROMPT)

            system_prompt = &quot;\n\n&quot;.join(prompt_parts)

        if system_prompt:
            new_system_message = append_to_system_message(request.system_message, system_prompt)
            request = request.override(system_message=new_system_message)

        return await handler(request)

    def _process_large_message(
        self,
        message: ToolMessage,
        resolved_backend: BackendProtocol,
    ) -&gt; tuple[ToolMessage, dict[str, FileData] | None]:
        &quot;&quot;&quot;Process a large ToolMessage by evicting its content to filesystem.

        Args:
            message: The ToolMessage with large content to evict.
            resolved_backend: The filesystem backend to write the content to.

        Returns:
            A tuple of (processed_message, files_update):
            - processed_message: New ToolMessage with truncated content and file reference
            - files_update: Dict of file updates to apply to state, or None if eviction failed

        Note:
            The entire content is converted to string, written to /large_tool_results/{tool_call_id},
            and replaced with a truncated preview plus file reference. The replacement is always
            returned as a plain string for consistency, regardless of original content type.

            ToolMessage supports multimodal content blocks (images, audio, etc.), but these are
            uncommon in tool results. For simplicity, all content is stringified and evicted.
            The model can recover by reading the offloaded file from the backend.
        &quot;&quot;&quot;
        # Early exit if eviction not configured
        if not self.tool_token_limit_before_evict:
            return message, None

        # Convert content to string once for both size check and eviction
        # Special case: single text block - extract text directly for readability
        if (
            isinstance(message.content, list)
            and len(message.content) == 1
            and isinstance(message.content[0], dict)
            and message.content[0].get(&quot;type&quot;) == &quot;text&quot;
            and &quot;text&quot; in message.content[0]
        ):
            content_str = str(message.content[0][&quot;text&quot;])
        elif isinstance(message.content, str):
            content_str = message.content
        else:
            # Multiple blocks or non-text content - stringify entire structure
            content_str = str(message.content)

        # Check if content exceeds eviction threshold
        # Using 4 chars per token as a conservative approximation (actual ratio varies by content)
        # This errs on the high side to avoid premature eviction of content that might fit
        if len(content_str) &lt;= 4 * self.tool_token_limit_before_evict:
            return message, None

        # Write content to filesystem
        sanitized_id = sanitize_tool_call_id(message.tool_call_id)
        file_path = f&quot;/large_tool_results/{sanitized_id}&quot;
        result = resolved_backend.write(file_path, content_str)
        if result.error:
            return message, None

        # Create truncated preview for the replacement message
        content_sample = format_content_with_line_numbers([line[:1000] for line in content_str.splitlines()[:10]], start_line=1)
        replacement_text = TOO_LARGE_TOOL_MSG.format(
            tool_call_id=message.tool_call_id,
            file_path=file_path,
            content_sample=content_sample,
        )

        # Always return as plain string after eviction
        processed_message = ToolMessage(
            content=replacement_text,
            tool_call_id=message.tool_call_id,
            name=message.name,
        )
        return processed_message, result.files_update

    async def _aprocess_large_message(
        self,
        message: ToolMessage,
        resolved_backend: BackendProtocol,
    ) -&gt; tuple[ToolMessage, dict[str, FileData] | None]:
        &quot;&quot;&quot;Async version of _process_large_message.

        Uses async backend methods to avoid sync calls in async context.
        See _process_large_message for full documentation.
        &quot;&quot;&quot;
        # Early exit if eviction not configured
        if not self.tool_token_limit_before_evict:
            return message, None

        # Convert content to string once for both size check and eviction
        # Special case: single text block - extract text directly for readability
        if (
            isinstance(message.content, list)
            and len(message.content) == 1
            and isinstance(message.content[0], dict)
            and message.content[0].get(&quot;type&quot;) == &quot;text&quot;
            and &quot;text&quot; in message.content[0]
        ):
            content_str = str(message.content[0][&quot;text&quot;])
        elif isinstance(message.content, str):
            content_str = message.content
        else:
            # Multiple blocks or non-text content - stringify entire structure
            content_str = str(message.content)

        # Check if content exceeds eviction threshold
        # Using 4 chars per token as a conservative approximation (actual ratio varies by content)
        # This errs on the high side to avoid premature eviction of content that might fit
        if len(content_str) &lt;= 4 * self.tool_token_limit_before_evict:
            return message, None

        # Write content to filesystem using async method
        sanitized_id = sanitize_tool_call_id(message.tool_call_id)
        file_path = f&quot;/large_tool_results/{sanitized_id}&quot;
        result = await resolved_backend.awrite(file_path, content_str)
        if result.error:
            return message, None

        # Create truncated preview for the replacement message
        content_sample = format_content_with_line_numbers([line[:1000] for line in content_str.splitlines()[:10]], start_line=1)
        replacement_text = TOO_LARGE_TOOL_MSG.format(
            tool_call_id=message.tool_call_id,
            file_path=file_path,
            content_sample=content_sample,
        )

        # Always return as plain string after eviction
        processed_message = ToolMessage(
            content=replacement_text,
            tool_call_id=message.tool_call_id,
            name=message.name,
        )
        return processed_message, result.files_update

    def _intercept_large_tool_result(self, tool_result: ToolMessage | Command, runtime: ToolRuntime) -&gt; ToolMessage | Command:
        &quot;&quot;&quot;Intercept and process large tool results before they&#x27;re added to state.

        Args:
            tool_result: The tool result to potentially evict (ToolMessage or Command).
            runtime: The tool runtime providing access to the filesystem backend.

        Returns:
            Either the original result (if small enough) or a Command with evicted
            content written to filesystem and truncated message.

        Note:
            Handles both single ToolMessage results and Command objects containing
            multiple messages. Large content is automatically offloaded to filesystem
            to prevent context window overflow.
        &quot;&quot;&quot;
        if isinstance(tool_result, ToolMessage):
            resolved_backend = self._get_backend(runtime)
            processed_message, files_update = self._process_large_message(
                tool_result,
                resolved_backend,
            )
            return (
                Command(
                    update={
                        &quot;files&quot;: files_update,
                        &quot;messages&quot;: [processed_message],
                    }
                )
                if files_update is not None
                else processed_message
            )

        if isinstance(tool_result, Command):
            update = tool_result.update
            if update is None:
                return tool_result
            command_messages = update.get(&quot;messages&quot;, [])
            accumulated_file_updates = dict(update.get(&quot;files&quot;, {}))
            resolved_backend = self._get_backend(runtime)
            processed_messages = []
            for message in command_messages:
                if not isinstance(message, ToolMessage):
                    processed_messages.append(message)
                    continue

                processed_message, files_update = self._process_large_message(
                    message,
                    resolved_backend,
                )
                processed_messages.append(processed_message)
                if files_update is not None:
                    accumulated_file_updates.update(files_update)
            return Command(update={**update, &quot;messages&quot;: processed_messages, &quot;files&quot;: accumulated_file_updates})
        raise AssertionError(f&quot;Unreachable code reached in _intercept_large_tool_result: for tool_result of type {type(tool_result)}&quot;)

    async def _aintercept_large_tool_result(self, tool_result: ToolMessage | Command, runtime: ToolRuntime) -&gt; ToolMessage | Command:
        &quot;&quot;&quot;Async version of _intercept_large_tool_result.

        Uses async backend methods to avoid sync calls in async context.
        See _intercept_large_tool_result for full documentation.
        &quot;&quot;&quot;
        if isinstance(tool_result, ToolMessage):
            resolved_backend = self._get_backend(runtime)
            processed_message, files_update = await self._aprocess_large_message(
                tool_result,
                resolved_backend,
            )
            return (
                Command(
                    update={
                        &quot;files&quot;: files_update,
                        &quot;messages&quot;: [processed_message],
                    }
                )
                if files_update is not None
                else processed_message
            )

        if isinstance(tool_result, Command):
            update = tool_result.update
            if update is None:
                return tool_result
            command_messages = update.get(&quot;messages&quot;, [])
            accumulated_file_updates = dict(update.get(&quot;files&quot;, {}))
            resolved_backend = self._get_backend(runtime)
            processed_messages = []
            for message in command_messages:
                if not isinstance(message, ToolMessage):
                    processed_messages.append(message)
                    continue

                processed_message, files_update = await self._aprocess_large_message(
                    message,
                    resolved_backend,
                )
                processed_messages.append(processed_message)
                if files_update is not None:
                    accumulated_file_updates.update(files_update)
            return Command(update={**update, &quot;messages&quot;: processed_messages, &quot;files&quot;: accumulated_file_updates})
        raise AssertionError(f&quot;Unreachable code reached in _aintercept_large_tool_result: for tool_result of type {type(tool_result)}&quot;)

    def wrap_tool_call(
        self,
        request: ToolCallRequest,
        handler: Callable[[ToolCallRequest], ToolMessage | Command],
    ) -&gt; ToolMessage | Command:
        &quot;&quot;&quot;Check the size of the tool call result and evict to filesystem if too large.

        Args:
            request: The tool call request being processed.
            handler: The handler function to call with the modified request.

        Returns:
            The raw ToolMessage, or a pseudo tool message with the ToolResult in state.
        &quot;&quot;&quot;
        if self.tool_token_limit_before_evict is None or request.tool_call[&quot;name&quot;] in TOOL_GENERATORS:
            return handler(request)

        tool_result = handler(request)
        return self._intercept_large_tool_result(tool_result, request.runtime)

    async def awrap_tool_call(
        self,
        request: ToolCallRequest,
        handler: Callable[[ToolCallRequest], Awaitable[ToolMessage | Command]],
    ) -&gt; ToolMessage | Command:
        &quot;&quot;&quot;(async)Check the size of the tool call result and evict to filesystem if too large.

        Args:
            request: The tool call request being processed.
            handler: The handler function to call with the modified request.

        Returns:
            The raw ToolMessage, or a pseudo tool message with the ToolResult in state.
        &quot;&quot;&quot;
        if self.tool_token_limit_before_evict is None or request.tool_call[&quot;name&quot;] in TOOL_GENERATORS:
            return await handler(request)

        tool_result = await handler(request)
        return await self._aintercept_large_tool_result(tool_result, request.runtime)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/filesystem/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/middleware/filesystem.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="graph Imported skill graph from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/graph.py Unknown LICENSE sources/langchain/graph/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">graph</div>
                <button class="copy-btn" onclick="copyToClipboard('graph')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill graph from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Deepagents come with planning, filesystem, and subagents.&quot;&quot;&quot;

from collections.abc import Callable, Sequence
from typing import Any

from langchain.agents import create_agent
from langchain.agents.middleware import HumanInTheLoopMiddleware, InterruptOnConfig, TodoListMiddleware
from langchain.agents.middleware.types import AgentMiddleware
from langchain.agents.structured_output import ResponseFormat
from langchain.chat_models import init_chat_model
from langchain_anthropic import ChatAnthropic
from langchain_anthropic.middleware import AnthropicPromptCachingMiddleware
from langchain_core.language_models import BaseChatModel
from langchain_core.messages import SystemMessage
from langchain_core.tools import BaseTool
from langgraph.cache.base import BaseCache
from langgraph.graph.state import CompiledStateGraph
from langgraph.store.base import BaseStore
from langgraph.types import Checkpointer

from deepagents.backends import StateBackend
from deepagents.backends.protocol import BackendFactory, BackendProtocol
from deepagents.middleware.filesystem import FilesystemMiddleware
from deepagents.middleware.memory import MemoryMiddleware
from deepagents.middleware.patch_tool_calls import PatchToolCallsMiddleware
from deepagents.middleware.skills import SkillsMiddleware
from deepagents.middleware.subagents import CompiledSubAgent, SubAgent, SubAgentMiddleware
from deepagents.middleware.summarization import SummarizationMiddleware

BASE_AGENT_PROMPT = &quot;In order to complete the objective that the user asks of you, you have access to a number of standard tools.&quot;


def get_default_model() -&gt; ChatAnthropic:
    &quot;&quot;&quot;Get the default model for deep agents.

    Returns:
        `ChatAnthropic` instance configured with Claude Sonnet 4.5.
    &quot;&quot;&quot;
    return ChatAnthropic(
        model_name=&quot;claude-sonnet-4-5-20250929&quot;,
        max_tokens=20000,  # type: ignore[call-arg]
    )


def create_deep_agent(
    model: str | BaseChatModel | None = None,
    tools: Sequence[BaseTool | Callable | dict[str, Any]] | None = None,
    *,
    system_prompt: str | SystemMessage | None = None,
    middleware: Sequence[AgentMiddleware] = (),
    subagents: list[SubAgent | CompiledSubAgent] | None = None,
    skills: list[str] | None = None,
    memory: list[str] | None = None,
    response_format: ResponseFormat | None = None,
    context_schema: type[Any] | None = None,
    checkpointer: Checkpointer | None = None,
    store: BaseStore | None = None,
    backend: BackendProtocol | BackendFactory | None = None,
    interrupt_on: dict[str, bool | InterruptOnConfig] | None = None,
    debug: bool = False,
    name: str | None = None,
    cache: BaseCache | None = None,
) -&gt; CompiledStateGraph:
    &quot;&quot;&quot;Create a deep agent.

    !!! warning &quot;Deep agents require a LLM that supports tool calling!&quot;

    By default, this agent has access to the following tools:

    - `write_todos`: manage a todo list
    - `ls`, `read_file`, `write_file`, `edit_file`, `glob`, `grep`: file operations
    - `execute`: run shell commands
    - `task`: call subagents

    The `execute` tool allows running shell commands if the backend implements `SandboxBackendProtocol`.
    For non-sandbox backends, the `execute` tool will return an error message.

    Args:
        model: The model to use.

            Defaults to `claude-sonnet-4-5-20250929`.

            Use the `provider:model` format (e.g., `openai:gpt-5`) to quickly switch between models.
        tools: The tools the agent should have access to.

            In addition to custom tools you provide, deep agents include built-in tools for planning,
            file management, and subagent spawning.
        system_prompt: Custom system instructions to prepend before the base deep agent
            prompt.

            If a string, it&#x27;s concatenated with the base prompt.
        middleware: Additional middleware to apply after the standard middleware stack
            (`TodoListMiddleware`, `FilesystemMiddleware`, `SubAgentMiddleware`,
            `SummarizationMiddleware`, `AnthropicPromptCachingMiddleware`,
            `PatchToolCallsMiddleware`).
        subagents: The subagents to use.

            Each subagent should be a `dict` with the following keys:

            - `name`
            - `description` (used by the main agent to decide whether to call the sub agent)
            - `prompt` (used as the system prompt in the subagent)
            - (optional) `tools`
            - (optional) `model` (either a `LanguageModelLike` instance or `dict` settings)
            - (optional) `middleware` (list of `AgentMiddleware`)
        skills: Optional list of skill source paths (e.g., `[&quot;/skills/user/&quot;, &quot;/skills/project/&quot;]`).

            Paths must be specified using POSIX conventions (forward slashes) and are relative
            to the backend&#x27;s root. When using `StateBackend` (default), provide skill files via
            `invoke(files={...})`. With `FilesystemBackend`, skills are loaded from disk relative
            to the backend&#x27;s `root_dir`. Later sources override earlier ones for skills with the
            same name (last one wins).
        memory: Optional list of memory file paths (`AGENTS.md` files) to load
            (e.g., `[&quot;/memory/AGENTS.md&quot;]`).

            Display names are automatically derived from paths.

            Memory is loaded at agent startup and added into the system prompt.
        response_format: A structured output response format to use for the agent.
        context_schema: The schema of the deep agent.
        checkpointer: Optional `Checkpointer` for persisting agent state between runs.
        store: Optional store for persistent storage (required if backend uses `StoreBackend`).
        backend: Optional backend for file storage and execution.

            Pass either a `Backend` instance or a callable factory like `lambda rt: StateBackend(rt)`.
            For execution support, use a backend that implements `SandboxBackendProtocol`.
        interrupt_on: Mapping of tool names to interrupt configs.

            Pass to pause agent execution at specified tool calls for human approval or modification.

            Example: `interrupt_on={&quot;edit_file&quot;: True}` pauses before every edit.
        debug: Whether to enable debug mode. Passed through to `create_agent`.
        name: The name of the agent. Passed through to `create_agent`.
        cache: The cache to use for the agent. Passed through to `create_agent`.

    Returns:
        A configured deep agent.
    &quot;&quot;&quot;
    if model is None:
        model = get_default_model()
    elif isinstance(model, str):
        model = init_chat_model(model)

    if (
        model.profile is not None
        and isinstance(model.profile, dict)
        and &quot;max_input_tokens&quot; in model.profile
        and isinstance(model.profile[&quot;max_input_tokens&quot;], int)
    ):
        trigger = (&quot;fraction&quot;, 0.85)
        keep = (&quot;fraction&quot;, 0.10)
    else:
        trigger = (&quot;tokens&quot;, 170000)
        keep = (&quot;messages&quot;, 6)

    # Build middleware stack for subagents (includes skills if provided)
    subagent_middleware: list[AgentMiddleware] = [
        TodoListMiddleware(),
    ]

    backend = backend if backend is not None else (lambda rt: StateBackend(rt))

    if skills is not None:
        subagent_middleware.append(SkillsMiddleware(backend=backend, sources=skills))
    subagent_middleware.extend(
        [
            FilesystemMiddleware(backend=backend),
            SummarizationMiddleware(
                model=model,
                backend=backend,
                trigger=trigger,
                keep=keep,
                trim_tokens_to_summarize=None,
            ),
            AnthropicPromptCachingMiddleware(unsupported_model_behavior=&quot;ignore&quot;),
            PatchToolCallsMiddleware(),
        ]
    )

    # Build main agent middleware stack
    deepagent_middleware: list[AgentMiddleware] = [
        TodoListMiddleware(),
    ]
    if memory is not None:
        deepagent_middleware.append(MemoryMiddleware(backend=backend, sources=memory))
    if skills is not None:
        deepagent_middleware.append(SkillsMiddleware(backend=backend, sources=skills))
    deepagent_middleware.extend(
        [
            FilesystemMiddleware(backend=backend),
            SubAgentMiddleware(
                default_model=model,
                default_tools=tools,
                subagents=subagents if subagents is not None else [],
                default_middleware=subagent_middleware,
                default_interrupt_on=interrupt_on,
                general_purpose_agent=True,
            ),
            SummarizationMiddleware(
                model=model,
                backend=backend,
                trigger=trigger,
                keep=keep,
                trim_tokens_to_summarize=None,
            ),
            AnthropicPromptCachingMiddleware(unsupported_model_behavior=&quot;ignore&quot;),
            PatchToolCallsMiddleware(),
        ]
    )
    if middleware:
        deepagent_middleware.extend(middleware)
    if interrupt_on is not None:
        deepagent_middleware.append(HumanInTheLoopMiddleware(interrupt_on=interrupt_on))

    # Combine system_prompt with BASE_AGENT_PROMPT
    if system_prompt is None:
        final_system_prompt: str | SystemMessage = BASE_AGENT_PROMPT
    elif isinstance(system_prompt, SystemMessage):
        # SystemMessage: append BASE_AGENT_PROMPT to content_blocks
        new_content = [
            *system_prompt.content_blocks,
            {&quot;type&quot;: &quot;text&quot;, &quot;text&quot;: f&quot;\n\n{BASE_AGENT_PROMPT}&quot;},
        ]
        final_system_prompt = SystemMessage(content=new_content)
    else:
        # String: simple concatenation
        final_system_prompt = system_prompt + &quot;\n\n&quot; + BASE_AGENT_PROMPT

    return create_agent(
        model,
        system_prompt=final_system_prompt,
        tools=tools,
        middleware=deepagent_middleware,
        response_format=response_format,
        context_schema=context_schema,
        checkpointer=checkpointer,
        store=store,
        debug=debug,
        name=name,
        cache=cache,
    ).with_config({&quot;recursion_limit&quot;: 1000})</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/graph/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/graph.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="harbor_langsmith Imported skill harbor_langsmith from langchain langchain /a0/tmp/skills_research/langchain/libs/harbor/scripts/harbor_langsmith.py Unknown LICENSE sources/langchain/harbor_langsmith/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">harbor_langsmith</div>
                <button class="copy-btn" onclick="copyToClipboard('harbor_langsmith')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill harbor_langsmith from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
CLI for LangSmith integration with Harbor.

Provides commands for:
- Creating LangSmith datasets from Harbor tasks
- Creating experiment sessions
- Adding feedback from Harbor job results to LangSmith traces
&quot;&quot;&quot;

import argparse
import asyncio
import datetime
import json
import os
import tempfile
from pathlib import Path

import aiohttp
import toml
from dotenv import load_dotenv
from harbor.models.dataset_item import DownloadedDatasetItem
from harbor.registry.client import RegistryClient
from langsmith import Client

from deepagents_harbor.tracing import create_example_id_from_instruction

load_dotenv()

LANGSMITH_API_URL = os.getenv(&quot;LANGSMITH_ENDPOINT&quot;, &quot;https://api.smith.langchain.com&quot;)
HEADERS = {
    &quot;x-api-key&quot;: os.getenv(&quot;LANGSMITH_API_KEY&quot;),
}


# ============================================================================
# CREATE DATASET
# ============================================================================


def _read_instruction(task_path: Path) -&gt; str:
    &quot;&quot;&quot;Read the instruction.md file from a task directory.&quot;&quot;&quot;
    instruction_file = task_path / &quot;instruction.md&quot;
    if instruction_file.exists():
        return instruction_file.read_text()
    return &quot;&quot;


def _read_task_metadata(task_path: Path) -&gt; dict:
    &quot;&quot;&quot;Read metadata from task.toml file.&quot;&quot;&quot;
    task_toml = task_path / &quot;task.toml&quot;
    if task_toml.exists():
        return toml.load(task_toml)
    return {}


def _read_solution(task_path: Path) -&gt; str | None:
    &quot;&quot;&quot;Read the solution script from a task directory.

    Args:
        task_path: Path to the task directory

    Returns:
        Solution script content if it exists, None otherwise
    &quot;&quot;&quot;
    solution_file = task_path / &quot;solution&quot; / &quot;solve.sh&quot;
    if solution_file.exists():
        return solution_file.read_text()
    return None


def _scan_downloaded_tasks(downloaded_tasks: list[DownloadedDatasetItem]) -&gt; list:
    &quot;&quot;&quot;Scan downloaded tasks and extract all task information.

    Args:
        downloaded_tasks: List of DownloadedDatasetItem objects from Harbor

    Returns:
        List of example dictionaries for LangSmith
    &quot;&quot;&quot;
    examples = []

    for downloaded_task in downloaded_tasks:
        task_path = downloaded_task.downloaded_path

        instruction = _read_instruction(task_path)
        metadata = _read_task_metadata(task_path)
        solution = _read_solution(task_path)
        task_name = downloaded_task.id.name
        task_id = str(downloaded_task.id)

        if instruction:
            # Create deterministic example_id from instruction content
            example_id = create_example_id_from_instruction(instruction)

            # Build outputs dict with reference solution if available
            outputs = {}
            if solution:
                outputs[&quot;reference_solution&quot;] = solution

            example = {
                &quot;id&quot;: example_id,  # Explicitly set the example ID
                &quot;inputs&quot;: {
                    &quot;task_id&quot;: task_id,
                    &quot;task_name&quot;: task_name,
                    &quot;instruction&quot;: instruction,
                    &quot;metadata&quot;: metadata.get(&quot;metadata&quot;, {}),
                },
                &quot;outputs&quot;: outputs,
            }
            examples.append(example)

            solution_status = &quot;with solution&quot; if solution else &quot;without solution&quot;
            print(f&quot;Added task: {task_name} (ID: {task_id}, Example ID: {example_id}) [{solution_status}]&quot;)

    return examples


def create_dataset(dataset_name: str, version: str = &quot;head&quot;, overwrite: bool = False) -&gt; None:
    &quot;&quot;&quot;Create a LangSmith dataset from Harbor tasks.

    Args:
        dataset_name: Dataset name (used for both Harbor download and LangSmith dataset)
        version: Harbor dataset version (default: &#x27;head&#x27;)
        overwrite: Whether to overwrite cached remote tasks
    &quot;&quot;&quot;
    langsmith_client = Client()
    output_dir = Path(tempfile.mkdtemp(prefix=&quot;harbor_tasks_&quot;))
    print(f&quot;Using temporary directory: {output_dir}&quot;)

    # Download from Harbor registry
    print(f&quot;Downloading dataset &#x27;{dataset_name}@{version}&#x27; from Harbor registry...&quot;)
    registry_client = RegistryClient()
    downloaded_tasks = registry_client.download_dataset(
        name=dataset_name,
        version=version,
        overwrite=overwrite,
        output_dir=output_dir,
    )

    print(f&quot;Downloaded {len(downloaded_tasks)} tasks&quot;)
    examples = _scan_downloaded_tasks(downloaded_tasks)

    print(f&quot;\nFound {len(examples)} tasks&quot;)

    # Create the dataset
    print(f&quot;\nCreating LangSmith dataset: {dataset_name}&quot;)
    dataset = langsmith_client.create_dataset(dataset_name=dataset_name)

    print(f&quot;Dataset created with ID: {dataset.id}&quot;)

    # Add examples to the dataset
    print(f&quot;\nAdding {len(examples)} examples to dataset...&quot;)
    langsmith_client.create_examples(dataset_id=dataset.id, examples=examples)

    print(f&quot;\nSuccessfully created dataset &#x27;{dataset_name}&#x27; with {len(examples)} examples&quot;)
    print(f&quot;Dataset ID: {dataset.id}&quot;)


# ============================================================================
# CREATE EXPERIMENT
# ============================================================================


async def _create_experiment_session(
    dataset_id: str, name: str, session: aiohttp.ClientSession
) -&gt; dict:
    &quot;&quot;&quot;Create a LangSmith experiment session.

    Args:
        dataset_id: LangSmith dataset ID to associate with
        name: Name for the experiment session
        session: aiohttp ClientSession for making requests

    Returns:
        Experiment session dictionary with &#x27;id&#x27; field
    &quot;&quot;&quot;
    async with session.post(
        f&quot;{LANGSMITH_API_URL}/sessions&quot;,
        headers=HEADERS,
        json={
            &quot;start_time&quot;: datetime.datetime.now(datetime.timezone.utc).isoformat(),
            &quot;reference_dataset_id&quot;: dataset_id,
            &quot;name&quot;: name,
        },
    ) as experiment_response:
        if experiment_response.status == 200:
            return await experiment_response.json()
        else:
            raise Exception(
                f&quot;Failed to create experiment: {experiment_response.status} {await experiment_response.text()}&quot;
            )


async def _get_dataset_by_name(dataset_name: str, session: aiohttp.ClientSession) -&gt; dict:
    &quot;&quot;&quot;Get a LangSmith dataset by name.

    Args:
        dataset_name: Name of the dataset to retrieve
        session: aiohttp ClientSession for making requests

    Returns:
        Dataset dictionary with &#x27;id&#x27; field
    &quot;&quot;&quot;
    async with session.get(
        f&quot;{LANGSMITH_API_URL}/datasets?name={dataset_name}&amp;limit=1&quot;,
        headers=HEADERS,
    ) as response:
        if response.status == 200:
            datasets = await response.json()
            if len(datasets) &gt; 0:
                return datasets[0]
            else:
                raise Exception(f&quot;Dataset &#x27;{dataset_name}&#x27; not found&quot;)
        else:
            raise Exception(f&quot;Failed to get dataset: {response.status} {await response.text()}&quot;)


async def create_experiment_async(dataset_name: str, experiment_name: str | None = None) -&gt; str:
    &quot;&quot;&quot;Create a LangSmith experiment session for the given dataset.

    Args:
        dataset_name: Name of the LangSmith dataset to create experiment for
        experiment_name: Optional name for the experiment (auto-generated if not provided)

    Returns:
        The experiment session ID
    &quot;&quot;&quot;
    async with aiohttp.ClientSession() as session:
        # Get the dataset
        dataset = await _get_dataset_by_name(dataset_name, session)
        dataset_id = dataset[&quot;id&quot;]
        print(f&quot;Found dataset &#x27;{dataset_name}&#x27; with ID: {dataset_id}&quot;)

        # Generate experiment name if not provided
        if experiment_name is None:
            timestamp = datetime.datetime.now(datetime.timezone.utc).strftime(&quot;%Y-%m-%d_%H-%M-%S&quot;)
            experiment_name = f&quot;harbor-experiment-{timestamp}&quot;

        # Create experiment session
        print(f&quot;Creating experiment session: {experiment_name}&quot;)
        experiment_session = await _create_experiment_session(dataset_id, experiment_name, session)
        session_id = experiment_session[&quot;id&quot;]
        tenant_id = experiment_session[&quot;tenant_id&quot;]

        print(&quot; Experiment created successfully!&quot;)
        print(f&quot;  Session ID: {session_id}&quot;)
        print(
            f&quot;  View at: https://smith.langchain.com/o/{tenant_id}/datasets/{dataset_id}/compare?selectedSessions={session_id}&quot;
        )
        print(&quot;\nTo run Harbor with this experiment, use:&quot;)
        print(f&quot;  LANGSMITH_EXPERIMENT={experiment_name} harbor run ...&quot;)

        return session_id


def create_experiment(dataset_name: str, experiment_name: str | None = None) -&gt; str:
    &quot;&quot;&quot;Synchronous wrapper for create_experiment_async.&quot;&quot;&quot;
    return asyncio.run(create_experiment_async(dataset_name, experiment_name))


# ============================================================================
# ADD FEEDBACK
# ============================================================================


def _extract_reward(trial_dir: Path) -&gt; float:
    &quot;&quot;&quot;Extract reward from trial&#x27;s result.json.&quot;&quot;&quot;
    result_path = trial_dir / &quot;result.json&quot;
    if not result_path.exists():
        # If task completed but no result.json, assume reward 0.0 as default
        # because it was likely due to an exception.
        return 0.0

    with open(result_path) as f:
        result = json.load(f)
        verifier_result = result.get(&quot;verifier_result&quot;) or {}
        rewards = verifier_result.get(&quot;rewards&quot;) or {}
        return rewards.get(&quot;reward&quot;)


def _process_trial(
    client: Client,
    trial_dir: Path,
    project_name: str,
    dry_run: bool = False,
) -&gt; dict:
    &quot;&quot;&quot;Process a single trial and update its trace.&quot;&quot;&quot;
    trial_name = trial_dir.name

    # Find the trace by trial_name metadata
    try:
        # Build filter to match trial_name in metadata
        filter_query = f&#x27;and(eq(metadata_key, &quot;trial_name&quot;), eq(metadata_value, &quot;{trial_name}&quot;))&#x27;

        # Fetch runs matching the filter
        runs = list(
            client.list_runs(
                project_name=project_name,
                filter=filter_query,
                is_root=True,
            )
        )
    except Exception as e:
        return {&quot;status&quot;: &quot;error&quot;, &quot;message&quot;: f&quot;Failed to fetch trace: {e}&quot;}

    if not runs:
        return {&quot;status&quot;: &quot;error&quot;, &quot;message&quot;: f&quot;No trace found for trial_name {trial_name}&quot;}

    if len(runs) &gt; 1:
        return {&quot;status&quot;: &quot;error&quot;, &quot;message&quot;: f&quot;Multiple traces found for trial_name {trial_name}&quot;}

    run = runs[0]
    run_id = str(run.id)

    # Check if feedback already exists
    try:
        feedback_list = list(client.list_feedback(run_ids=[run_id]))
        if any(fb.key == &quot;harbor_reward&quot; for fb in feedback_list):
            return {&quot;status&quot;: &quot;skipped&quot;, &quot;message&quot;: &quot;Feedback already exists&quot;}
    except Exception:
        pass  # Continue if feedback check fails

    # Extract reward
    reward = _extract_reward(trial_dir)

    if not dry_run:
        client.create_feedback(
            run_id=run_id,
            key=&quot;harbor_reward&quot;,
            score=reward,
        )
        return {
            &quot;status&quot;: &quot;success&quot;,
            &quot;message&quot;: f&quot;Added harbor_reward feedback: {reward}&quot;,
        }
    else:
        return {
            &quot;status&quot;: &quot;success&quot;,
            &quot;message&quot;: f&quot;Would add harbor_reward feedback: {reward}&quot;,
        }


def add_feedback(job_folder: Path, project_name: str, dry_run: bool = False) -&gt; None:
    &quot;&quot;&quot;Add Harbor reward feedback to LangSmith traces.

    Args:
        job_folder: Path to the Harbor job folder
        project_name: LangSmith project name to search for traces
        dry_run: If True, show what would be done without making changes
    &quot;&quot;&quot;
    print(f&quot;Processing job folder: {job_folder}&quot;)
    print(f&quot;LangSmith project: {project_name}&quot;)
    if dry_run:
        print(&quot;DRY RUN MODE - No changes will be made&quot;)
    print()

    # Find all trial directories
    trial_dirs = [d for d in job_folder.iterdir() if d.is_dir()]
    print(f&quot;Found {len(trial_dirs)} trial directories\n&quot;)

    results = {&quot;success&quot;: 0, &quot;skipped&quot;: 0, &quot;error&quot;: 0}
    client = Client()

    for i, trial_dir in enumerate(trial_dirs, 1):
        print(f&quot;[{i}/{len(trial_dirs)}] Processing {trial_dir.name}...&quot;)

        result = _process_trial(
            trial_dir=trial_dir,
            project_name=project_name,
            client=client,
            dry_run=dry_run,
        )

        status = result[&quot;status&quot;]
        message = result[&quot;message&quot;]

        if status == &quot;success&quot;:
            print(f&quot;   {message}&quot;)
            results[&quot;success&quot;] += 1
        elif status == &quot;skipped&quot;:
            print(f&quot;   {message}&quot;)
            results[&quot;skipped&quot;] += 1
        else:  # error
            print(f&quot;   {message}&quot;)
            results[&quot;error&quot;] += 1

    # Print summary
    print(f&quot;\n{&#x27;=&#x27; * 80}&quot;)
    print(&quot;SUMMARY&quot;)
    print(f&quot;{&#x27;=&#x27; * 80}&quot;)
    print(f&quot;Total trials: {len(trial_dirs)}&quot;)
    print(f&quot;Successfully updated: {results[&#x27;success&#x27;]}&quot;)
    print(f&quot;Skipped (already has feedback): {results[&#x27;skipped&#x27;]}&quot;)
    print(f&quot;Errors: {results[&#x27;error&#x27;]}&quot;)


def main() -&gt; None:
    &quot;&quot;&quot;Main CLI entrypoint with subcommands.&quot;&quot;&quot;
    parser = argparse.ArgumentParser(
        description=&quot;Harbor-LangSmith integration CLI for managing datasets, experiments, and feedback.&quot;,
        formatter_class=argparse.RawDescriptionHelpFormatter,
    )

    subparsers = parser.add_subparsers(dest=&quot;command&quot;, help=&quot;Available commands&quot;, required=True)

    # ========================================================================
    # create-dataset subcommand
    # ========================================================================
    dataset_parser = subparsers.add_parser(
        &quot;create-dataset&quot;,
        help=&quot;Create a LangSmith dataset from Harbor tasks&quot;,
    )
    dataset_parser.add_argument(
        &quot;dataset_name&quot;,
        type=str,
        help=&quot;Dataset name (e.g., &#x27;terminal-bench&#x27;)&quot;,
    )
    dataset_parser.add_argument(
        &quot;--version&quot;,
        type=str,
        default=&quot;head&quot;,
        help=&quot;Dataset version (default: &#x27;head&#x27;)&quot;,
    )
    dataset_parser.add_argument(
        &quot;--overwrite&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Overwrite cached remote tasks&quot;,
    )

    # ========================================================================
    # create-experiment subcommand
    # ========================================================================
    experiment_parser = subparsers.add_parser(
        &quot;create-experiment&quot;,
        help=&quot;Create an experiment session for a dataset&quot;,
    )
    experiment_parser.add_argument(
        &quot;dataset_name&quot;,
        type=str,
        help=&quot;Dataset name (must already exist in LangSmith)&quot;,
    )
    experiment_parser.add_argument(
        &quot;--name&quot;,
        type=str,
        help=&quot;Name for the experiment (auto-generated if not provided)&quot;,
    )

    # ========================================================================
    # add-feedback subcommand
    # ========================================================================
    feedback_parser = subparsers.add_parser(
        &quot;add-feedback&quot;,
        help=&quot;Add Harbor reward feedback to LangSmith traces&quot;,
    )
    feedback_parser.add_argument(
        &quot;job_folder&quot;,
        type=Path,
        help=&quot;Path to the job folder (e.g., jobs/terminal-bench/2025-12-02__16-25-40)&quot;,
    )
    feedback_parser.add_argument(
        &quot;--project-name&quot;,
        type=str,
        required=True,
        help=&quot;LangSmith project name to search for traces&quot;,
    )
    feedback_parser.add_argument(
        &quot;--dry-run&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Show what would be done without making changes&quot;,
    )

    args = parser.parse_args()

    # Route to appropriate command
    if args.command == &quot;create-dataset&quot;:
        create_dataset(
            dataset_name=args.dataset_name,
            version=args.version,
            overwrite=args.overwrite,
        )
    elif args.command == &quot;create-experiment&quot;:
        create_experiment(
            dataset_name=args.dataset_name,
            experiment_name=args.name,
        )
    elif args.command == &quot;add-feedback&quot;:
        if not args.job_folder.exists():
            print(f&quot;Error: Job folder does not exist: {args.job_folder}&quot;)
            return 1
        add_feedback(
            job_folder=args.job_folder,
            project_name=args.project_name,
            dry_run=args.dry_run,
        )

    return 0


if __name__ == &quot;__main__&quot;:
    exit(main())</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/harbor_langsmith/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="history Imported skill history from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/widgets/history.py Unknown LICENSE sources/langchain/history/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">history</div>
                <button class="copy-btn" onclick="copyToClipboard('history')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill history from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Command history manager for input persistence.&quot;&quot;&quot;

from __future__ import annotations

import json
from pathlib import Path  # noqa: TC003 - used at runtime in type hints


class HistoryManager:
    &quot;&quot;&quot;Manages command history with file persistence.

    Uses append-only writes for concurrent safety. Multiple agents can
    safely write to the same history file without corruption.
    &quot;&quot;&quot;

    def __init__(self, history_file: Path, max_entries: int = 100) -&gt; None:
        &quot;&quot;&quot;Initialize the history manager.

        Args:
            history_file: Path to the JSON-lines history file
            max_entries: Maximum number of entries to keep
        &quot;&quot;&quot;
        self.history_file = history_file
        self.max_entries = max_entries
        self._entries: list[str] = []
        self._current_index: int = -1
        self._temp_input: str = &quot;&quot;
        self._load_history()

    def _load_history(self) -&gt; None:
        &quot;&quot;&quot;Load history from file.&quot;&quot;&quot;
        if not self.history_file.exists():
            return

        try:
            with self.history_file.open(&quot;r&quot;, encoding=&quot;utf-8&quot;) as f:
                entries = []
                for raw_line in f:
                    line = raw_line.rstrip(&quot;\n\r&quot;)
                    if not line:
                        continue
                    try:
                        entry = json.loads(line)
                    except json.JSONDecodeError:
                        entry = line
                    entries.append(entry if isinstance(entry, str) else str(entry))
                self._entries = entries[-self.max_entries :]
        except (OSError, UnicodeDecodeError):
            self._entries = []

    def _append_to_file(self, text: str) -&gt; None:
        &quot;&quot;&quot;Append a single entry to history file (concurrent-safe).&quot;&quot;&quot;
        try:
            self.history_file.parent.mkdir(parents=True, exist_ok=True)
            with self.history_file.open(&quot;a&quot;, encoding=&quot;utf-8&quot;) as f:
                f.write(json.dumps(text) + &quot;\n&quot;)
        except OSError:
            pass

    def _compact_history(self) -&gt; None:
        &quot;&quot;&quot;Rewrite history file to remove old entries.

        Only called when entries exceed 2x max_entries to minimize rewrites.
        &quot;&quot;&quot;
        try:
            self.history_file.parent.mkdir(parents=True, exist_ok=True)
            with self.history_file.open(&quot;w&quot;, encoding=&quot;utf-8&quot;) as f:
                for entry in self._entries:
                    f.write(json.dumps(entry) + &quot;\n&quot;)
        except OSError:
            pass

    def add(self, text: str) -&gt; None:
        &quot;&quot;&quot;Add a command to history.

        Args:
            text: The command text to add
        &quot;&quot;&quot;
        text = text.strip()
        # Skip empty or slash commands
        if not text or text.startswith(&quot;/&quot;):
            return

        # Skip duplicates of the last entry
        if self._entries and self._entries[-1] == text:
            return

        self._entries.append(text)

        # Append to file (fast, concurrent-safe)
        self._append_to_file(text)

        # Compact only when we have 2x max entries (rare operation)
        if len(self._entries) &gt; self.max_entries * 2:
            self._entries = self._entries[-self.max_entries :]
            self._compact_history()

        self.reset_navigation()

    def get_previous(self, current_input: str, prefix: str = &quot;&quot;) -&gt; str | None:
        &quot;&quot;&quot;Get the previous history entry.

        Args:
            current_input: Current input text (saved on first navigation)
            prefix: Optional prefix to filter entries

        Returns:
            Previous matching entry or None
        &quot;&quot;&quot;
        if not self._entries:
            return None

        # Save current input on first navigation
        if self._current_index == -1:
            self._temp_input = current_input
            self._current_index = len(self._entries)

        # Search backwards for matching entry
        for i in range(self._current_index - 1, -1, -1):
            if self._entries[i].startswith(prefix):
                self._current_index = i
                return self._entries[i]

        return None

    def get_next(self, prefix: str = &quot;&quot;) -&gt; str | None:
        &quot;&quot;&quot;Get the next history entry.

        Args:
            prefix: Optional prefix to filter entries

        Returns:
            Next matching entry, original input at end, or None
        &quot;&quot;&quot;
        if self._current_index == -1:
            return None

        # Search forwards for matching entry
        for i in range(self._current_index + 1, len(self._entries)):
            if self._entries[i].startswith(prefix):
                self._current_index = i
                return self._entries[i]

        # Return to original input at the end
        result = self._temp_input
        self.reset_navigation()
        return result

    def reset_navigation(self) -&gt; None:
        &quot;&quot;&quot;Reset navigation state.&quot;&quot;&quot;
        self._current_index = -1
        self._temp_input = &quot;&quot;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/history/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="image_utils Imported skill image_utils from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/image_utils.py Unknown LICENSE sources/langchain/image_utils/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">image_utils</div>
                <button class="copy-btn" onclick="copyToClipboard('image_utils')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill image_utils from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Utilities for handling image paste from clipboard.&quot;&quot;&quot;

import base64
import io
import os
import subprocess
import sys
import tempfile
from dataclasses import dataclass

from PIL import Image


@dataclass
class ImageData:
    &quot;&quot;&quot;Represents a pasted image with its base64 encoding.&quot;&quot;&quot;

    base64_data: str
    format: str  # &quot;png&quot;, &quot;jpeg&quot;, etc.
    placeholder: str  # Display text like &quot;[image 1]&quot;

    def to_message_content(self) -&gt; dict:
        &quot;&quot;&quot;Convert to LangChain message content format.

        Returns:
            Dict with type and image_url for multimodal messages
        &quot;&quot;&quot;
        return {
            &quot;type&quot;: &quot;image_url&quot;,
            &quot;image_url&quot;: {&quot;url&quot;: f&quot;data:image/{self.format};base64,{self.base64_data}&quot;},
        }


def get_clipboard_image() -&gt; ImageData | None:
    &quot;&quot;&quot;Attempt to read an image from the system clipboard.

    Supports macOS via `pngpaste` or `osascript`.

    Returns:
        ImageData if an image is found, None otherwise
    &quot;&quot;&quot;
    if sys.platform == &quot;darwin&quot;:
        return _get_macos_clipboard_image()
    # Linux/Windows support could be added here
    return None


def _get_macos_clipboard_image() -&gt; ImageData | None:
    &quot;&quot;&quot;Get clipboard image on macOS using pngpaste or osascript.

    First tries pngpaste (faster if installed), then falls back to osascript.

    Returns:
        ImageData if an image is found, None otherwise
    &quot;&quot;&quot;
    # Try pngpaste first (fast if installed)
    try:
        result = subprocess.run(
            [&quot;pngpaste&quot;, &quot;-&quot;],
            capture_output=True,
            check=False,
            timeout=2,
        )
        if result.returncode == 0 and result.stdout:
            # Successfully got PNG data
            try:
                Image.open(io.BytesIO(result.stdout))  # Validate it&#x27;s a real image
                base64_data = base64.b64encode(result.stdout).decode(&quot;utf-8&quot;)
                return ImageData(
                    base64_data=base64_data,
                    format=&quot;png&quot;,  # &#x27;pngpaste -&#x27; always outputs PNG
                    placeholder=&quot;[image]&quot;,
                )
            except Exception:
                pass  # Invalid image data
    except (FileNotFoundError, subprocess.TimeoutExpired):
        pass  # pngpaste not installed or timed out

    # Fallback to osascript with temp file (built-in but slower)
    return _get_clipboard_via_osascript()


def _get_clipboard_via_osascript() -&gt; ImageData | None:
    &quot;&quot;&quot;Get clipboard image via osascript using a temp file.

    osascript outputs data in a special format that can&#x27;t be captured as raw binary,
    so we write to a temp file instead.

    Returns:
        ImageData if an image is found, None otherwise
    &quot;&quot;&quot;
    # Create a temp file for the image
    fd, temp_path = tempfile.mkstemp(suffix=&quot;.png&quot;)
    os.close(fd)

    try:
        # First check if clipboard has PNG data
        check_result = subprocess.run(
            [&quot;osascript&quot;, &quot;-e&quot;, &quot;clipboard info&quot;],
            capture_output=True,
            check=False,
            timeout=2,
            text=True,
        )

        if check_result.returncode != 0:
            return None

        # Check for PNG or TIFF in clipboard info
        clipboard_info = check_result.stdout.lower()
        if &quot;pngf&quot; not in clipboard_info and &quot;tiff&quot; not in clipboard_info:
            return None

        # Try to get PNG first, fall back to TIFF
        if &quot;pngf&quot; in clipboard_info:
            get_script = f&quot;&quot;&quot;
            set pngData to the clipboard as class PNGf
            set theFile to open for access POSIX file &quot;{temp_path}&quot; with write permission
            write pngData to theFile
            close access theFile
            return &quot;success&quot;
            &quot;&quot;&quot;
        else:
            get_script = f&quot;&quot;&quot;
            set tiffData to the clipboard as TIFF picture
            set theFile to open for access POSIX file &quot;{temp_path}&quot; with write permission
            write tiffData to theFile
            close access theFile
            return &quot;success&quot;
            &quot;&quot;&quot;

        result = subprocess.run(
            [&quot;osascript&quot;, &quot;-e&quot;, get_script],
            capture_output=True,
            check=False,
            timeout=3,
            text=True,
        )

        if result.returncode != 0 or &quot;success&quot; not in result.stdout:
            return None

        # Check if file was created and has content
        if not os.path.exists(temp_path) or os.path.getsize(temp_path) == 0:
            return None

        # Read and validate the image
        with open(temp_path, &quot;rb&quot;) as f:
            image_data = f.read()

        try:
            image = Image.open(io.BytesIO(image_data))
            # Convert to PNG if it&#x27;s not already (e.g., if we got TIFF)
            buffer = io.BytesIO()
            image.save(buffer, format=&quot;PNG&quot;)
            buffer.seek(0)
            base64_data = base64.b64encode(buffer.getvalue()).decode(&quot;utf-8&quot;)

            return ImageData(
                base64_data=base64_data,
                format=&quot;png&quot;,
                placeholder=&quot;[image]&quot;,
            )
        except Exception:
            return None

    except (subprocess.TimeoutExpired, OSError):
        return None
    finally:
        # Clean up temp file
        try:
            os.unlink(temp_path)
        except OSError:
            pass


def encode_image_to_base64(image_bytes: bytes) -&gt; str:
    &quot;&quot;&quot;Encode image bytes to base64 string.

    Args:
        image_bytes: Raw image bytes

    Returns:
        Base64-encoded string
    &quot;&quot;&quot;
    return base64.b64encode(image_bytes).decode(&quot;utf-8&quot;)


def create_multimodal_content(text: str, images: list[ImageData]) -&gt; list[dict]:
    &quot;&quot;&quot;Create multimodal message content with text and images.

    Args:
        text: Text content of the message
        images: List of ImageData objects

    Returns:
        List of content blocks in LangChain format
    &quot;&quot;&quot;
    content_blocks = []

    # Add text block
    if text.strip():
        content_blocks.append({&quot;type&quot;: &quot;text&quot;, &quot;text&quot;: text})

    # Add image blocks
    for image in images:
        content_blocks.append(image.to_message_content())

    return content_blocks</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/image_utils/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="init_skill Imported skill init_skill from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/examples/skills/skill-creator/scripts/init_skill.py Unknown LICENSE sources/langchain/init_skill/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">init_skill</div>
                <button class="copy-btn" onclick="copyToClipboard('init_skill')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill init_skill from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Skill Initializer - Creates a new skill from template

Usage:
 init_skill.py &lt;skill-name&gt; --path &lt;path&gt;

Examples:
 init_skill.py my-new-skill --path skills/public
 init_skill.py my-api-helper --path skills/private
 init_skill.py custom-skill --path /custom/location

For deepagents CLI:
 init_skill.py my-skill --path ~/.deepagents/agent/skills
&quot;&quot;&quot;

import sys
from pathlib import Path


SKILL_TEMPLATE = &quot;&quot;&quot;---
name: {skill_name}
description: [TODO: Complete and informative explanation of what the skill does and when to use it. Include WHEN to use this skill - specific scenarios, file types, or tasks that trigger it.]
---

# {skill_title}

## Overview

[TODO: 1-2 sentences explaining what this skill enables]

## Structuring This Skill

[TODO: Choose the structure that best fits this skill&#x27;s purpose. Common patterns:

**1. Workflow-Based** (best for sequential processes)
- Works well when there are clear step-by-step procedures
- Example: DOCX skill with &quot;Workflow Decision Tree&quot;  &quot;Reading&quot;  &quot;Creating&quot;  &quot;Editing&quot;
- Structure: ## Overview  ## Workflow Decision Tree  ## Step 1  ## Step 2...

**2. Task-Based** (best for tool collections)
- Works well when the skill offers different operations/capabilities
- Example: PDF skill with &quot;Quick Start&quot;  &quot;Merge PDFs&quot;  &quot;Split PDFs&quot;  &quot;Extract Text&quot;
- Structure: ## Overview  ## Quick Start  ## Task Category 1  ## Task Category 2...

**3. Reference/Guidelines** (best for standards or specifications)
- Works well for brand guidelines, coding standards, or requirements
- Example: Brand styling with &quot;Brand Guidelines&quot;  &quot;Colors&quot;  &quot;Typography&quot;  &quot;Features&quot;
- Structure: ## Overview  ## Guidelines  ## Specifications  ## Usage...

**4. Capabilities-Based** (best for integrated systems)
- Works well when the skill provides multiple interrelated features
- Example: Product Management with &quot;Core Capabilities&quot;  numbered capability list
- Structure: ## Overview  ## Core Capabilities  ### 1. Feature  ### 2. Feature...

Patterns can be mixed and matched as needed. Most skills combine patterns (e.g., start with task-based, add workflow for complex operations).

Delete this entire &quot;Structuring This Skill&quot; section when done - it&#x27;s just guidance.]

## [TODO: Replace with the first main section based on chosen structure]

[TODO: Add content here. See examples in existing skills:
- Code samples for technical skills
- Decision trees for complex workflows
- Concrete examples with realistic user requests
- References to scripts/templates/references as needed]

## Resources

This skill includes example resource directories that demonstrate how to organize different types of bundled resources:

### scripts/
Executable code (Python/Bash/etc.) that can be run directly to perform specific operations.

**Examples from other skills:**
- PDF skill: `fill_fillable_fields.py`, `extract_form_field_info.py` - utilities for PDF manipulation
- DOCX skill: `document.py`, `utilities.py` - Python modules for document processing

**Appropriate for:** Python scripts, shell scripts, or any executable code that performs automation, data processing, or specific operations.

**Note:** Scripts may be executed without loading into context, but can still be read by Claude for patching or environment adjustments.

### references/
Documentation and reference material intended to be loaded into context to inform Claude&#x27;s process and thinking.

**Examples from other skills:**
- Product management: `communication.md`, `context_building.md` - detailed workflow guides
- BigQuery: API reference documentation and query examples
- Finance: Schema documentation, company policies

**Appropriate for:** In-depth documentation, API references, database schemas, comprehensive guides, or any detailed information that Claude should reference while working.

### assets/
Files not intended to be loaded into context, but rather used within the output Claude produces.

**Examples from other skills:**
- Brand styling: PowerPoint template files (.pptx), logo files
- Frontend builder: HTML/React boilerplate project directories
- Typography: Font files (.ttf, .woff2)

**Appropriate for:** Templates, boilerplate code, document templates, images, icons, fonts, or any files meant to be copied or used in the final output.

---

**Any unneeded directories can be deleted.** Not every skill requires all three types of resources.
&quot;&quot;&quot;

EXAMPLE_SCRIPT = &#x27;&#x27;&#x27;#!/usr/bin/env python3
&quot;&quot;&quot;
Example helper script for {skill_name}

This is a placeholder script that can be executed directly.
Replace with actual implementation or delete if not needed.

Example real scripts from other skills:
- pdf/scripts/fill_fillable_fields.py - Fills PDF form fields
- pdf/scripts/convert_pdf_to_images.py - Converts PDF pages to images
&quot;&quot;&quot;

def main():
    print(&quot;This is an example script for {skill_name}&quot;)
    # TODO: Add actual script logic here
    # This could be data processing, file conversion, API calls, etc.

if __name__ == &quot;__main__&quot;:
    main()
&#x27;&#x27;&#x27;

EXAMPLE_REFERENCE = &quot;&quot;&quot;# Reference Documentation for {skill_title}

This is a placeholder for detailed reference documentation.
Replace with actual reference content or delete if not needed.

Example real reference docs from other skills:
- product-management/references/communication.md - Comprehensive guide for status updates
- product-management/references/context_building.md - Deep-dive on gathering context
- bigquery/references/ - API references and query examples

## When Reference Docs Are Useful

Reference docs are ideal for:
- Comprehensive API documentation
- Detailed workflow guides
- Complex multi-step processes
- Information too lengthy for main SKILL.md
- Content that&#x27;s only needed for specific use cases

## Structure Suggestions

### API Reference Example
- Overview
- Authentication
- Endpoints with examples
- Error codes
- Rate limits

### Workflow Guide Example
- Prerequisites
- Step-by-step instructions
- Common patterns
- Troubleshooting
- Best practices
&quot;&quot;&quot;

EXAMPLE_ASSET = &quot;&quot;&quot;# Example Asset File

This placeholder represents where asset files would be stored.
Replace with actual asset files (templates, images, fonts, etc.) or delete if not needed.

Asset files are NOT intended to be loaded into context, but rather used within
the output Claude produces.

Example asset files from other skills:
- Brand guidelines: logo.png, slides_template.pptx
- Frontend builder: hello-world/ directory with HTML/React boilerplate
- Typography: custom-font.ttf, font-family.woff2
- Data: sample_data.csv, test_dataset.json

## Common Asset Types

- Templates: .pptx, .docx, boilerplate directories
- Images: .png, .jpg, .svg, .gif
- Fonts: .ttf, .otf, .woff, .woff2
- Boilerplate code: Project directories, starter files
- Icons: .ico, .svg
- Data files: .csv, .json, .xml, .yaml

Note: This is a text placeholder. Actual assets can be any file type.
&quot;&quot;&quot;


def title_case_skill_name(skill_name):
    &quot;&quot;&quot;Convert hyphenated skill name to Title Case for display.&quot;&quot;&quot;
    return &#x27; &#x27;.join(word.capitalize() for word in skill_name.split(&#x27;-&#x27;))


def init_skill(skill_name, path):
    &quot;&quot;&quot;
    Initialize a new skill directory with template SKILL.md.

    Args:
        skill_name: Name of the skill
        path: Path where the skill directory should be created

    Returns:
        Path to created skill directory, or None if error
    &quot;&quot;&quot;
    # Determine skill directory path
    skill_dir = Path(path).resolve() / skill_name

    # Check if directory already exists
    if skill_dir.exists():
        print(f&quot; Error: Skill directory already exists: {skill_dir}&quot;)
        return None

    # Create skill directory
    try:
        skill_dir.mkdir(parents=True, exist_ok=False)
        print(f&quot; Created skill directory: {skill_dir}&quot;)
    except Exception as e:
        print(f&quot; Error creating directory: {e}&quot;)
        return None

    # Create SKILL.md from template
    skill_title = title_case_skill_name(skill_name)
    skill_content = SKILL_TEMPLATE.format(
        skill_name=skill_name,
        skill_title=skill_title
    )

    skill_md_path = skill_dir / &#x27;SKILL.md&#x27;
    try:
        skill_md_path.write_text(skill_content)
        print(&quot; Created SKILL.md&quot;)
    except Exception as e:
        print(f&quot; Error creating SKILL.md: {e}&quot;)
        return None

    # Create resource directories with example files
    try:
        # Create scripts/ directory with example script
        scripts_dir = skill_dir / &#x27;scripts&#x27;
        scripts_dir.mkdir(exist_ok=True)
        example_script = scripts_dir / &#x27;example.py&#x27;
        example_script.write_text(EXAMPLE_SCRIPT.format(skill_name=skill_name))
        example_script.chmod(0o755)
        print(&quot; Created scripts/example.py&quot;)

        # Create references/ directory with example reference doc
        references_dir = skill_dir / &#x27;references&#x27;
        references_dir.mkdir(exist_ok=True)
        example_reference = references_dir / &#x27;api_reference.md&#x27;
        example_reference.write_text(EXAMPLE_REFERENCE.format(skill_title=skill_title))
        print(&quot; Created references/api_reference.md&quot;)

        # Create assets/ directory with example asset placeholder
        assets_dir = skill_dir / &#x27;assets&#x27;
        assets_dir.mkdir(exist_ok=True)
        example_asset = assets_dir / &#x27;example_asset.txt&#x27;
        example_asset.write_text(EXAMPLE_ASSET)
        print(&quot; Created assets/example_asset.txt&quot;)
    except Exception as e:
        print(f&quot; Error creating resource directories: {e}&quot;)
        return None

    # Print next steps
    print(f&quot;\n Skill &#x27;{skill_name}&#x27; initialized successfully at {skill_dir}&quot;)
    print(&quot;\nNext steps:&quot;)
    print(&quot;1. Edit SKILL.md to complete the TODO items and update the description&quot;)
    print(&quot;2. Customize or delete the example files in scripts/, references/, and assets/&quot;)
    print(&quot;3. Run the validator when ready to check the skill structure&quot;)

    return skill_dir


def main():
    if len(sys.argv) &lt; 4 or sys.argv[2] != &#x27;--path&#x27;:
        print(&quot;Usage: init_skill.py &lt;skill-name&gt; --path &lt;path&gt;&quot;)
        print(&quot;\nSkill name requirements:&quot;)
        print(&quot; - Hyphen-case identifier (e.g., &#x27;data-analyzer&#x27;)&quot;)
        print(&quot; - Lowercase letters, digits, and hyphens only&quot;)
        print(&quot; - Max 40 characters&quot;)
        print(&quot; - Must match directory name exactly&quot;)
        print(&quot;\nExamples:&quot;)
        print(&quot; init_skill.py my-new-skill --path skills/public&quot;)
        print(&quot; init_skill.py my-api-helper --path skills/private&quot;)
        print(&quot; init_skill.py custom-skill --path /custom/location&quot;)
        print(&quot;\nFor deepagents CLI:&quot;)
        print(&quot; init_skill.py my-skill --path ~/.deepagents/agent/skills&quot;)
        sys.exit(1)

    skill_name = sys.argv[1]
    path = sys.argv[3]

    print(f&quot; Initializing skill: {skill_name}&quot;)
    print(f&quot;   Location: {path}&quot;)
    print()

    result = init_skill(skill_name, path)

    if result:
        sys.exit(0)
    else:
        sys.exit(1)


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/init_skill/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="input Imported skill input from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/input.py Unknown LICENSE sources/langchain/input/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">input</div>
                <button class="copy-btn" onclick="copyToClipboard('input')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill input from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Input handling, completers, and prompt session for the CLI.&quot;&quot;&quot;

import asyncio
import os
import re
import time
from collections.abc import Callable
from pathlib import Path

from prompt_toolkit import PromptSession
from prompt_toolkit.completion import (
    Completer,
    Completion,
    PathCompleter,
    merge_completers,
)
from prompt_toolkit.document import Document
from prompt_toolkit.enums import EditingMode
from prompt_toolkit.formatted_text import HTML
from prompt_toolkit.key_binding import KeyBindings

from .config import COLORS, COMMANDS, SessionState, console
from .image_utils import ImageData, get_clipboard_image

# Regex patterns for context-aware completion
AT_MENTION_RE = re.compile(r&quot;@(?P&lt;path&gt;(?:[^\s@]|(?&lt;=\\)\s)*)$&quot;)
SLASH_COMMAND_RE = re.compile(r&quot;^/(?P&lt;command&gt;[a-z]*)$&quot;)

EXIT_CONFIRM_WINDOW = 3.0


class ImageTracker:
    &quot;&quot;&quot;Track pasted images in the current conversation.&quot;&quot;&quot;

    def __init__(self) -&gt; None:
        self.images: list[ImageData] = []
        self.next_id = 1

    def add_image(self, image_data: ImageData) -&gt; str:
        &quot;&quot;&quot;Add an image and return its placeholder text.

        Args:
            image_data: The image data to track

        Returns:
            Placeholder string like &quot;[image 1]&quot;
        &quot;&quot;&quot;
        placeholder = f&quot;[image {self.next_id}]&quot;
        image_data.placeholder = placeholder
        self.images.append(image_data)
        self.next_id += 1
        return placeholder

    def get_images(self) -&gt; list[ImageData]:
        &quot;&quot;&quot;Get all tracked images.&quot;&quot;&quot;
        return self.images.copy()

    def clear(self) -&gt; None:
        &quot;&quot;&quot;Clear all tracked images and reset counter.&quot;&quot;&quot;
        self.images.clear()
        self.next_id = 1


class FilePathCompleter(Completer):
    &quot;&quot;&quot;Activate filesystem completion only when cursor is after &#x27;@&#x27;.&quot;&quot;&quot;

    def __init__(self) -&gt; None:
        self.path_completer = PathCompleter(
            expanduser=True,
            min_input_len=0,
            only_directories=False,
        )

    def get_completions(self, document, complete_event):
        &quot;&quot;&quot;Get file path completions when @ is detected.&quot;&quot;&quot;
        text = document.text_before_cursor

        # Use regex to detect @path pattern at end of line
        m = AT_MENTION_RE.search(text)
        if not m:
            return  # Not in an @path context

        path_fragment = m.group(&quot;path&quot;)

        # Unescape the path for PathCompleter (it doesn&#x27;t understand escape sequences)
        unescaped_fragment = path_fragment.replace(&quot;\\ &quot;, &quot; &quot;)

        # Strip trailing backslash if present (user is in the process of typing an escape)
        unescaped_fragment = unescaped_fragment.removesuffix(&quot;\\&quot;)

        # Create temporary document for the unescaped path fragment
        temp_doc = Document(text=unescaped_fragment, cursor_position=len(unescaped_fragment))

        # Get completions from PathCompleter and use its start_position
        # PathCompleter returns suffix text with start_position=0 (insert at cursor)
        for comp in self.path_completer.get_completions(temp_doc, complete_event):
            # Add trailing / for directories so users can continue navigating
            completed_path = Path(unescaped_fragment + comp.text).expanduser()
            # Re-escape spaces in the completion text for the command line
            completion_text = comp.text.replace(&quot; &quot;, &quot;\\ &quot;)
            if completed_path.is_dir() and not completion_text.endswith(&quot;/&quot;):
                completion_text += &quot;/&quot;

            yield Completion(
                text=completion_text,
                start_position=comp.start_position,  # Use PathCompleter&#x27;s position (usually 0)
                display=comp.display,
                display_meta=comp.display_meta,
            )


class CommandCompleter(Completer):
    &quot;&quot;&quot;Activate command completion only when line starts with &#x27;/&#x27;.&quot;&quot;&quot;

    def get_completions(self, document, _complete_event):
        &quot;&quot;&quot;Get command completions when / is at the start.&quot;&quot;&quot;
        text = document.text_before_cursor

        # Use regex to detect /command pattern at start of line
        m = SLASH_COMMAND_RE.match(text)
        if not m:
            return  # Not in a /command context

        command_fragment = m.group(&quot;command&quot;)

        # Match commands that start with the fragment (case-insensitive)
        for cmd_name, cmd_desc in COMMANDS.items():
            if cmd_name.startswith(command_fragment.lower()):
                yield Completion(
                    text=cmd_name,
                    start_position=-len(command_fragment),  # Fixed position for original document
                    display=cmd_name,
                    display_meta=cmd_desc,
                )


def parse_file_mentions(text: str) -&gt; tuple[str, list[Path]]:
    &quot;&quot;&quot;Extract @file mentions and return cleaned text with resolved file paths.&quot;&quot;&quot;
    pattern = r&quot;@((?:[^\s@]|(?&lt;=\\)\s)+)&quot;  # Match @filename, allowing escaped spaces
    matches = re.findall(pattern, text)

    files = []
    for match in matches:
        # Remove escape characters
        clean_path = match.replace(&quot;\\ &quot;, &quot; &quot;)
        path = Path(clean_path).expanduser()

        # Try to resolve relative to cwd
        if not path.is_absolute():
            path = Path.cwd() / path

        try:
            path = path.resolve()
            if path.exists() and path.is_file():
                files.append(path)
            else:
                console.print(f&quot;[yellow]Warning: File not found: {match}[/yellow]&quot;)
        except Exception as e:
            console.print(f&quot;[yellow]Warning: Invalid path {match}: {e}[/yellow]&quot;)

    return text, files


def parse_image_placeholders(text: str) -&gt; tuple[str, int]:
    &quot;&quot;&quot;Count image placeholders in text.

    Args:
        text: Input text potentially containing [image] or [image N] placeholders

    Returns:
        Tuple of (text, count) where count is the number of image placeholders found
    &quot;&quot;&quot;
    # Match [image] or [image N] patterns
    pattern = r&quot;\[image(?:\s+\d+)?\]&quot;
    matches = re.findall(pattern, text, re.IGNORECASE)
    return text, len(matches)


def get_bottom_toolbar(
    session_state: SessionState, session_ref: dict
) -&gt; Callable[[], list[tuple[str, str]]]:
    &quot;&quot;&quot;Return toolbar function that shows auto-approve status and BASH MODE.&quot;&quot;&quot;

    def toolbar() -&gt; list[tuple[str, str]]:
        parts = []

        # Check if we&#x27;re in BASH mode (input starts with !)
        try:
            session = session_ref.get(&quot;session&quot;)
            if session:
                current_text = session.default_buffer.text
                if current_text.startswith(&quot;!&quot;):
                    parts.append((&quot;bg:#ff1493 fg:#ffffff bold&quot;, &quot; BASH MODE &quot;))
                    parts.append((&quot;&quot;, &quot; | &quot;))
        except (AttributeError, TypeError):
            # Silently ignore - toolbar is non-critical and called frequently
            pass

        # Base status message
        if session_state.auto_approve:
            base_msg = &quot;auto-accept ON (CTRL+T to toggle)&quot;
            base_class = &quot;class:toolbar-green&quot;
        else:
            base_msg = &quot;manual accept (CTRL+T to toggle)&quot;
            base_class = &quot;class:toolbar-orange&quot;

        parts.append((base_class, base_msg))

        # Show exit confirmation hint if active
        hint_until = session_state.exit_hint_until
        if hint_until is not None:
            now = time.monotonic()
            if now &lt; hint_until:
                parts.append((&quot;&quot;, &quot; | &quot;))
                parts.append((&quot;class:toolbar-exit&quot;, &quot; Ctrl+C again to exit &quot;))
            else:
                session_state.exit_hint_until = None

        return parts

    return toolbar


def create_prompt_session(
    _assistant_id: str, session_state: SessionState, image_tracker: ImageTracker | None = None
) -&gt; PromptSession:
    &quot;&quot;&quot;Create a configured PromptSession with all features.&quot;&quot;&quot;
    # Set default editor if not already set
    if &quot;EDITOR&quot; not in os.environ:
        os.environ[&quot;EDITOR&quot;] = &quot;nano&quot;

    # Create key bindings
    kb = KeyBindings()

    @kb.add(&quot;c-c&quot;)
    def _(event) -&gt; None:
        &quot;&quot;&quot;Require double Ctrl+C within a short window to exit.&quot;&quot;&quot;
        app = event.app
        now = time.monotonic()

        if session_state.exit_hint_until is not None and now &lt; session_state.exit_hint_until:
            handle = session_state.exit_hint_handle
            if handle:
                handle.cancel()
                session_state.exit_hint_handle = None
            session_state.exit_hint_until = None
            app.invalidate()
            app.exit(exception=KeyboardInterrupt())
            return

        session_state.exit_hint_until = now + EXIT_CONFIRM_WINDOW

        handle = session_state.exit_hint_handle
        if handle:
            handle.cancel()

        loop = asyncio.get_running_loop()
        app_ref = app

        def clear_hint() -&gt; None:
            if (
                session_state.exit_hint_until is not None
                and time.monotonic() &gt;= session_state.exit_hint_until
            ):
                session_state.exit_hint_until = None
                session_state.exit_hint_handle = None
                app_ref.invalidate()

        session_state.exit_hint_handle = loop.call_later(EXIT_CONFIRM_WINDOW, clear_hint)

        app.invalidate()

    # Bind Ctrl+T to toggle auto-approve
    @kb.add(&quot;c-t&quot;)
    def _(event) -&gt; None:
        &quot;&quot;&quot;Toggle auto-approve mode.&quot;&quot;&quot;
        session_state.toggle_auto_approve()
        # Force UI refresh to update toolbar
        event.app.invalidate()

    # Custom paste handler to detect images
    if image_tracker:
        from prompt_toolkit.keys import Keys

        def _handle_paste_with_image_check(event, pasted_text: str = &quot;&quot;) -&gt; None:
            &quot;&quot;&quot;Check clipboard for image, otherwise insert pasted text.&quot;&quot;&quot;
            # Try to get an image from clipboard
            clipboard_image = get_clipboard_image()

            if clipboard_image:
                # Found an image! Add it to tracker and insert placeholder
                placeholder = image_tracker.add_image(clipboard_image)
                # Insert placeholder (no confirmation message)
                event.current_buffer.insert_text(placeholder)
            elif pasted_text:
                # No image, insert the pasted text
                event.current_buffer.insert_text(pasted_text)
            else:
                # Fallback: try to get text from prompt_toolkit clipboard
                clipboard_data = event.app.clipboard.get_data()
                if clipboard_data and clipboard_data.text:
                    event.current_buffer.insert_text(clipboard_data.text)

        @kb.add(Keys.BracketedPaste)
        def _(event) -&gt; None:
            &quot;&quot;&quot;Handle bracketed paste (Cmd+V on macOS) - check for images first.&quot;&quot;&quot;
            # Bracketed paste provides the pasted text in event.data
            pasted_text = event.data if hasattr(event, &quot;data&quot;) else &quot;&quot;
            _handle_paste_with_image_check(event, pasted_text)

        @kb.add(&quot;c-v&quot;)
        def _(event) -&gt; None:
            &quot;&quot;&quot;Handle Ctrl+V paste - check for images first.&quot;&quot;&quot;
            _handle_paste_with_image_check(event)

    # Bind regular Enter to submit (intuitive behavior)
    @kb.add(&quot;enter&quot;)
    def _(event) -&gt; None:
        &quot;&quot;&quot;Enter submits the input, unless completion menu is active.&quot;&quot;&quot;
        buffer = event.current_buffer

        # If completion menu is showing, apply the current completion
        if buffer.complete_state:
            # Get the current completion (the highlighted one)
            current_completion = buffer.complete_state.current_completion

            # If no completion is selected (user hasn&#x27;t navigated), select and apply the first one
            if not current_completion and buffer.complete_state.completions:
                # Move to the first completion
                buffer.complete_next()
                # Now apply it
                buffer.apply_completion(buffer.complete_state.current_completion)
            elif current_completion:
                # Apply the already-selected completion
                buffer.apply_completion(current_completion)
            else:
                # No completions available, close menu
                buffer.complete_state = None
        # Don&#x27;t submit if buffer is empty or only whitespace
        elif buffer.text.strip():
            # Normal submit
            buffer.validate_and_handle()
            # If empty, do nothing (don&#x27;t submit)

    # Alt+Enter for newlines (press ESC then Enter, or Option+Enter on Mac)
    @kb.add(&quot;escape&quot;, &quot;enter&quot;)
    def _(event) -&gt; None:
        &quot;&quot;&quot;Alt+Enter inserts a newline for multi-line input.&quot;&quot;&quot;
        event.current_buffer.insert_text(&quot;\n&quot;)

    # Ctrl+E to open in external editor
    @kb.add(&quot;c-e&quot;)
    def _(event) -&gt; None:
        &quot;&quot;&quot;Open the current input in an external editor (nano by default).&quot;&quot;&quot;
        event.current_buffer.open_in_editor()

    # Backspace handler to retrigger completions and delete image tags as units
    @kb.add(&quot;backspace&quot;)
    def _(event) -&gt; None:
        &quot;&quot;&quot;Handle backspace: delete image tags as single unit, retrigger completion.&quot;&quot;&quot;
        buffer = event.current_buffer
        text_before = buffer.document.text_before_cursor

        # Check if cursor is right after an image tag like [image 1] or [image 12]
        image_tag_pattern = r&quot;\[image \d+\]$&quot;
        match = re.search(image_tag_pattern, text_before)

        if match and image_tracker:
            # Delete the entire tag
            tag_length = len(match.group(0))
            buffer.delete_before_cursor(count=tag_length)

            # Remove the image from tracker and reset counter
            tag_text = match.group(0)
            image_num_match = re.search(r&quot;\d+&quot;, tag_text)
            if image_num_match:
                image_num = int(image_num_match.group(0))
                # Remove image at index (1-based to 0-based)
                if 0 &lt; image_num &lt;= len(image_tracker.images):
                    image_tracker.images.pop(image_num - 1)
                    # Reset counter to next available number
                    image_tracker.next_id = len(image_tracker.images) + 1
        else:
            # Normal backspace
            buffer.delete_before_cursor(count=1)

        # Check if we&#x27;re in a completion context (@ or /)
        text = buffer.document.text_before_cursor
        if AT_MENTION_RE.search(text) or SLASH_COMMAND_RE.match(text):
            # Retrigger completion
            buffer.start_completion(select_first=False)

    from prompt_toolkit.styles import Style

    # Define styles for the toolbar with full-width background colors
    toolbar_style = Style.from_dict(
        {
            &quot;bottom-toolbar&quot;: &quot;noreverse&quot;,  # Disable default reverse video
            &quot;toolbar-green&quot;: &quot;bg:#10b981 #000000&quot;,  # Green for auto-accept ON
            &quot;toolbar-orange&quot;: &quot;bg:#f59e0b #000000&quot;,  # Orange for manual accept
            &quot;toolbar-exit&quot;: &quot;bg:#2563eb #ffffff&quot;,  # Blue for exit hint
        }
    )

    # Create session reference dict for toolbar to access session
    session_ref = {}

    # Create the session
    session = PromptSession(
        message=HTML(f&#x27;&lt;style fg=&quot;{COLORS[&quot;user&quot;]}&quot;&gt;&gt;&lt;/style&gt; &#x27;),
        multiline=True,  # Keep multiline support but Enter submits
        key_bindings=kb,
        completer=merge_completers([CommandCompleter(), FilePathCompleter()]),
        editing_mode=EditingMode.EMACS,
        complete_while_typing=True,  # Show completions as you type
        complete_in_thread=True,  # Async completion prevents menu freezing
        mouse_support=False,
        enable_open_in_editor=True,  # Allow Ctrl+X Ctrl+E to open external editor
        bottom_toolbar=get_bottom_toolbar(
            session_state, session_ref
        ),  # Persistent status bar at bottom
        style=toolbar_style,  # Apply toolbar styling
        reserve_space_for_menu=7,  # Reserve space for completion menu to show 5-6 results
    )

    # Store session reference for toolbar to access
    session_ref[&quot;session&quot;] = session

    return session</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/input/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="load Imported skill load from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/skills/load.py Unknown LICENSE sources/langchain/load/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">load</div>
                <button class="copy-btn" onclick="copyToClipboard('load')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill load from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Skill loader for CLI commands.

This module provides filesystem-based skill loading for CLI operations (list, create, info).
It wraps the prebuilt middleware functionality from deepagents.middleware.skills and adapts
it for direct filesystem access needed by CLI commands.

For middleware usage within agents, use deepagents.middleware.skills.SkillsMiddleware directly.
&quot;&quot;&quot;

from __future__ import annotations

from pathlib import Path

from deepagents.backends.filesystem import FilesystemBackend
from deepagents.middleware.skills import SkillMetadata
from deepagents.middleware.skills import _list_skills as list_skills_from_backend


class ExtendedSkillMetadata(SkillMetadata):
    &quot;&quot;&quot;Extended skill metadata for CLI display, adds source tracking.&quot;&quot;&quot;

    source: str


# Re-export for CLI commands
__all__ = [&quot;SkillMetadata&quot;, &quot;list_skills&quot;]


def list_skills(
    *, user_skills_dir: Path | None = None, project_skills_dir: Path | None = None
) -&gt; list[ExtendedSkillMetadata]:
    &quot;&quot;&quot;List skills from user and/or project directories.

    This is a CLI-specific wrapper around the prebuilt middleware&#x27;s skill loading
    functionality. It uses FilesystemBackend to load skills from local directories.

    When both directories are provided, project skills with the same name as
    user skills will override them (project skills take precedence).

    Args:
        user_skills_dir: Path to the user-level skills directory.
        project_skills_dir: Path to the project-level skills directory.

    Returns:
        Merged list of skill metadata from both sources, with project skills
        taking precedence over user skills when names conflict.
    &quot;&quot;&quot;
    all_skills: dict[str, ExtendedSkillMetadata] = {}

    # Load user skills first (foundation)
    if user_skills_dir and user_skills_dir.exists():
        user_backend = FilesystemBackend(root_dir=str(user_skills_dir))
        user_skills = list_skills_from_backend(backend=user_backend, source_path=&quot;.&quot;)
        for skill in user_skills:
            # Add source field for CLI display
            extended_skill: ExtendedSkillMetadata = {**skill, &quot;source&quot;: &quot;user&quot;}
            all_skills[skill[&quot;name&quot;]] = extended_skill

    # Load project skills second (override/augment)
    if project_skills_dir and project_skills_dir.exists():
        project_backend = FilesystemBackend(root_dir=str(project_skills_dir))
        project_skills = list_skills_from_backend(backend=project_backend, source_path=&quot;.&quot;)
        for skill in project_skills:
            # Add source field for CLI display
            extended_skill: ExtendedSkillMetadata = {**skill, &quot;source&quot;: &quot;project&quot;}
            all_skills[skill[&quot;name&quot;]] = extended_skill

    return list(all_skills.values())</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/load/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="loading Imported skill loading from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/widgets/loading.py Unknown LICENSE sources/langchain/loading/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">loading</div>
                <button class="copy-btn" onclick="copyToClipboard('loading')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill loading from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Loading widget with animated spinner for agent activity.&quot;&quot;&quot;

from __future__ import annotations

from time import time
from typing import TYPE_CHECKING, ClassVar

from textual.containers import Horizontal
from textual.widgets import Static

if TYPE_CHECKING:
    from textual.app import ComposeResult


class BrailleSpinner:
    &quot;&quot;&quot;Animated braille spinner.&quot;&quot;&quot;

    FRAMES: ClassVar[tuple[str, ...]] = (
        &quot;&quot;,
        &quot;&quot;,
        &quot;&quot;,
        &quot;&quot;,
        &quot;&quot;,
        &quot;&quot;,
        &quot;&quot;,
        &quot;&quot;,
        &quot;&quot;,
        &quot;&quot;,
    )

    def __init__(self) -&gt; None:
        &quot;&quot;&quot;Initialize spinner.&quot;&quot;&quot;
        self._position = 0

    def next_frame(self) -&gt; str:
        &quot;&quot;&quot;Get next animation frame.&quot;&quot;&quot;
        frame = self.FRAMES[self._position]
        self._position = (self._position + 1) % len(self.FRAMES)
        return frame

    def current_frame(self) -&gt; str:
        &quot;&quot;&quot;Get current frame without advancing.&quot;&quot;&quot;
        return self.FRAMES[self._position]


class LoadingWidget(Static):
    &quot;&quot;&quot;Animated loading indicator with status text and elapsed time.

    Displays:  Thinking... (3s, esc to interrupt)
    &quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    LoadingWidget {
        height: auto;
        padding: 0 1;
    }

    LoadingWidget .loading-container {
        height: auto;
        width: 100%;
    }

    LoadingWidget .loading-spinner {
        width: auto;
        color: $warning;
    }

    LoadingWidget .loading-status {
        width: auto;
        color: $warning;
    }

    LoadingWidget .loading-hint {
        width: auto;
        color: $text-muted;
        margin-left: 1;
    }
    &quot;&quot;&quot;

    def __init__(self, status: str = &quot;Thinking&quot;) -&gt; None:
        &quot;&quot;&quot;Initialize loading widget.

        Args:
            status: Initial status text to display
        &quot;&quot;&quot;
        super().__init__()
        self._status = status
        self._spinner = BrailleSpinner()
        self._start_time: float | None = None
        self._spinner_widget: Static | None = None
        self._status_widget: Static | None = None
        self._hint_widget: Static | None = None
        self._paused = False
        self._paused_elapsed: int = 0

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the loading widget layout.&quot;&quot;&quot;
        with Horizontal(classes=&quot;loading-container&quot;):
            self._spinner_widget = Static(self._spinner.current_frame(), classes=&quot;loading-spinner&quot;)
            yield self._spinner_widget

            self._status_widget = Static(f&quot; {self._status}... &quot;, classes=&quot;loading-status&quot;)
            yield self._status_widget

            self._hint_widget = Static(&quot;(0s, esc to interrupt)&quot;, classes=&quot;loading-hint&quot;)
            yield self._hint_widget

    def on_mount(self) -&gt; None:
        &quot;&quot;&quot;Start animation on mount.&quot;&quot;&quot;
        self._start_time = time()
        self.set_interval(0.1, self._update_animation)

    def _update_animation(self) -&gt; None:
        &quot;&quot;&quot;Update spinner and elapsed time.&quot;&quot;&quot;
        if self._paused:
            return

        if self._spinner_widget:
            frame = self._spinner.next_frame()
            self._spinner_widget.update(f&quot;[#FFD800]{frame}[/]&quot;)

        if self._hint_widget and self._start_time is not None:
            elapsed = int(time() - self._start_time)
            self._hint_widget.update(f&quot;({elapsed}s, esc to interrupt)&quot;)

    def set_status(self, status: str) -&gt; None:
        &quot;&quot;&quot;Update the status text.

        Args:
            status: New status text
        &quot;&quot;&quot;
        self._status = status
        if self._status_widget:
            self._status_widget.update(f&quot; {self._status}... &quot;)

    def pause(self, status: str = &quot;Awaiting decision&quot;) -&gt; None:
        &quot;&quot;&quot;Pause the animation and update status.

        Args:
            status: Status to show while paused
        &quot;&quot;&quot;
        self._paused = True
        if self._start_time is not None:
            self._paused_elapsed = int(time() - self._start_time)
        self._status = status
        if self._status_widget:
            self._status_widget.update(f&quot; {status}... &quot;)
        if self._hint_widget:
            self._hint_widget.update(f&quot;(paused at {self._paused_elapsed}s)&quot;)
        if self._spinner_widget:
            self._spinner_widget.update(&quot;[dim][/dim]&quot;)

    def resume(self) -&gt; None:
        &quot;&quot;&quot;Resume the animation.&quot;&quot;&quot;
        self._paused = False
        self._status = &quot;Thinking&quot;
        if self._status_widget:
            self._status_widget.update(f&quot; {self._status}... &quot;)

    def stop(self) -&gt; None:
        &quot;&quot;&quot;Stop the animation (widget will be removed by caller).&quot;&quot;&quot;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/loading/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="local_context Imported skill local_context from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/local_context.py Unknown LICENSE sources/langchain/local_context/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">local_context</div>
                <button class="copy-btn" onclick="copyToClipboard('local_context')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill local_context from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Middleware for injecting local context into system prompt.&quot;&quot;&quot;

from __future__ import annotations

import subprocess
from collections.abc import Awaitable, Callable
from pathlib import Path
from typing import NotRequired, TypedDict, cast

from langchain.agents.middleware.types import (
    AgentMiddleware,
    AgentState,
    ModelRequest,
    ModelResponse,
)
from langgraph.runtime import Runtime

# Directories to ignore in file listings and tree views
IGNORE_PATTERNS = frozenset(
    {
        &quot;.git&quot;,
        &quot;node_modules&quot;,
        &quot;.venv&quot;,
        &quot;__pycache__&quot;,
        &quot;.pytest_cache&quot;,
        &quot;.mypy_cache&quot;,
        &quot;.ruff_cache&quot;,
        &quot;.tox&quot;,
        &quot;.coverage&quot;,
        &quot;.eggs&quot;,
        &quot;dist&quot;,
        &quot;build&quot;,
    }
)


class LocalContextState(AgentState):
    &quot;&quot;&quot;State for local context middleware.&quot;&quot;&quot;

    local_context: NotRequired[str]
    &quot;&quot;&quot;Formatted local context: git, cwd, files, tree.&quot;&quot;&quot;


class LocalContextStateUpdate(TypedDict):
    &quot;&quot;&quot;State update for local context middleware.&quot;&quot;&quot;

    local_context: str
    &quot;&quot;&quot;Formatted local context: git, cwd, files, tree.&quot;&quot;&quot;


class LocalContextMiddleware(AgentMiddleware):
    &quot;&quot;&quot;Middleware for injecting local context into system prompt.

    This middleware:
    1. Detects current git branch (if in a git repo)
    2. Checks if main/master branches exist locally
    3. Lists files in current directory (max 20)
    4. Shows directory tree structure (max 3 levels, 20 entries)
    5. Appends local context to system prompt
    &quot;&quot;&quot;

    state_schema = LocalContextState

    def _get_git_info(self) -&gt; dict[str, str | list[str]]:
        &quot;&quot;&quot;Gather git state information.

        Returns:
            Dict with &#x27;branch&#x27; (current branch) and &#x27;main_branches&#x27; (list of main/master if they exist).
            Returns empty dict if not in git repo.
        &quot;&quot;&quot;
        try:
            # Get current branch
            result = subprocess.run(
                [&quot;git&quot;, &quot;rev-parse&quot;, &quot;--abbrev-ref&quot;, &quot;HEAD&quot;],
                capture_output=True,
                text=True,
                timeout=2,
                cwd=Path.cwd(),
                check=False,
            )
            if result.returncode != 0:
                return {}

            current_branch = result.stdout.strip()

            # Get local branches to check for main/master
            main_branches = []
            result = subprocess.run(
                [&quot;git&quot;, &quot;branch&quot;],
                capture_output=True,
                text=True,
                timeout=2,
                cwd=Path.cwd(),
                check=False,
            )
            if result.returncode == 0:
                branches = set()
                for line in result.stdout.strip().split(&quot;\n&quot;):
                    branch = line.strip().lstrip(&quot;*&quot;).strip()
                    if branch:
                        branches.add(branch)

                if &quot;main&quot; in branches:
                    main_branches.append(&quot;main&quot;)
                if &quot;master&quot; in branches:
                    main_branches.append(&quot;master&quot;)

            return {&quot;branch&quot;: current_branch, &quot;main_branches&quot;: main_branches}

        except (subprocess.TimeoutExpired, FileNotFoundError, OSError):
            return {}

    def _get_file_list(self, max_files: int = 20) -&gt; list[str]:
        &quot;&quot;&quot;Get list of files in current directory (non-recursive).

        Args:
            max_files: Maximum number of files to show (default 20).

        Returns:
            List of file paths (sorted), truncated to max_files.
        &quot;&quot;&quot;
        cwd = Path.cwd()

        files = []
        try:
            for item in sorted(cwd.iterdir()):
                # Skip hidden files (except .deepagents)
                if item.name.startswith(&quot;.&quot;) and item.name != &quot;.deepagents&quot;:
                    continue

                # Skip ignored patterns
                if item.name in IGNORE_PATTERNS:
                    continue

                # Add files and dirs
                if item.is_file():
                    files.append(item.name)
                elif item.is_dir():
                    files.append(f&quot;{item.name}/&quot;)

                if len(files) &gt;= max_files:
                    break

        except (OSError, PermissionError):
            return []

        return files

    def _get_directory_tree(self, max_depth: int = 3, max_entries: int = 20) -&gt; str:
        &quot;&quot;&quot;Get directory tree structure.

        Args:
            max_depth: Maximum depth to traverse (default 3).
            max_entries: Maximum total entries to show (default 20).

        Returns:
            Formatted tree string or empty if error.
        &quot;&quot;&quot;
        cwd = Path.cwd()

        lines: list[str] = []
        entry_count = [0]  # Mutable for closure

        def _should_include(item: Path) -&gt; bool:
            &quot;&quot;&quot;Check if item should be included in tree.&quot;&quot;&quot;
            # Skip hidden files (except .deepagents)
            if item.name.startswith(&quot;.&quot;) and item.name != &quot;.deepagents&quot;:
                return False
            # Skip ignored patterns
            return item.name not in IGNORE_PATTERNS

        def _build_tree(path: Path, prefix: str = &quot;&quot;, depth: int = 0) -&gt; None:
            &quot;&quot;&quot;Recursive tree builder.&quot;&quot;&quot;
            if depth &gt;= max_depth or entry_count[0] &gt;= max_entries:
                return

            try:
                all_items = sorted(path.iterdir(), key=lambda p: (not p.is_dir(), p.name))
                # Pre-filter to get correct is_last determination
                items = [item for item in all_items if _should_include(item)]
            except (OSError, PermissionError):
                return

            for i, item in enumerate(items):
                if entry_count[0] &gt;= max_entries:
                    lines.append(f&quot;{prefix}... (truncated)&quot;)
                    return

                is_last = i == len(items) - 1
                connector = &quot; &quot; if is_last else &quot; &quot;

                display_name = f&quot;{item.name}/&quot; if item.is_dir() else item.name
                lines.append(f&quot;{prefix}{connector}{display_name}&quot;)
                entry_count[0] += 1

                # Recurse into directories
                if item.is_dir() and depth + 1 &lt; max_depth:
                    extension = &quot;    &quot; if is_last else &quot;   &quot;
                    _build_tree(item, prefix + extension, depth + 1)

        try:
            lines.append(f&quot;{cwd.name}/&quot;)
            _build_tree(cwd)
        except (OSError, PermissionError):
            return &quot;&quot;

        return &quot;\n&quot;.join(lines)

    def _detect_package_manager(self) -&gt; str | None:
        &quot;&quot;&quot;Detect Python package manager in use.

        Checks for lock files and config files to determine the package manager.

        Uses priority order: `uv &gt; poetry &gt; pipenv &gt; pip`. First match wins if multiple
        indicators are present.

        Returns:
            Package manager name (uv, poetry, pipenv, pip) or `None` if not detected.
        &quot;&quot;&quot;
        cwd = Path.cwd()

        # Check for uv (uv.lock or pyproject.toml with [tool.uv])
        if (cwd / &quot;uv.lock&quot;).exists():
            return &quot;uv&quot;

        # Check for poetry (poetry.lock or pyproject.toml with [tool.poetry])
        if (cwd / &quot;poetry.lock&quot;).exists():
            return &quot;poetry&quot;

        # Check for pipenv
        if (cwd / &quot;Pipfile.lock&quot;).exists() or (cwd / &quot;Pipfile&quot;).exists():
            return &quot;pipenv&quot;

        # Check pyproject.toml for tool sections
        pyproject = cwd / &quot;pyproject.toml&quot;
        if pyproject.exists():
            try:
                content = pyproject.read_text()
                if &quot;[tool.uv]&quot; in content:
                    return &quot;uv&quot;
                if &quot;[tool.poetry]&quot; in content:
                    return &quot;poetry&quot;
                # Has pyproject.toml but no specific tool - likely pip/setuptools
                return &quot;pip&quot;
            except (OSError, PermissionError, UnicodeDecodeError):
                pass

        # Check for requirements.txt
        if (cwd / &quot;requirements.txt&quot;).exists():
            return &quot;pip&quot;

        return None

    def _detect_node_package_manager(self) -&gt; str | None:
        &quot;&quot;&quot;Detect Node.js package manager in use.

        Uses priority order: `bun &gt; pnpm &gt; yarn &gt; npm`.

        First match wins if multiple lock files are present.

        Returns:
            Package manager name (bun, pnpm, yarn, npm) or `None` if not detected.
        &quot;&quot;&quot;
        cwd = Path.cwd()

        if (cwd / &quot;bun.lockb&quot;).exists() or (cwd / &quot;bun.lock&quot;).exists():
            return &quot;bun&quot;
        if (cwd / &quot;pnpm-lock.yaml&quot;).exists():
            return &quot;pnpm&quot;
        if (cwd / &quot;yarn.lock&quot;).exists():
            return &quot;yarn&quot;
        if (cwd / &quot;package-lock.json&quot;).exists() or (cwd / &quot;package.json&quot;).exists():
            return &quot;npm&quot;

        return None

    def _get_makefile_preview(self, max_lines: int = 20) -&gt; str | None:
        &quot;&quot;&quot;Get first N lines of `Makefile` if present.

        Args:
            max_lines: Maximum lines to show.

        Returns:
            `Makefile` preview or `None` if not found.
        &quot;&quot;&quot;
        cwd = Path.cwd()
        makefile = cwd / &quot;Makefile&quot;

        if not makefile.exists():
            return None

        try:
            content = makefile.read_text()
            lines = content.split(&quot;\n&quot;)[:max_lines]
            preview = &quot;\n&quot;.join(lines)
            if len(content.split(&quot;\n&quot;)) &gt; max_lines:
                preview += &quot;\n... (truncated)&quot;
            return preview
        except (OSError, PermissionError, UnicodeDecodeError):
            return None

    def _detect_project_info(self) -&gt; dict[str, str | bool | None]:
        &quot;&quot;&quot;Detect project type, language, and structure.

        Returns:
            Dict with `language`, `is_monorepo`, `project_root`, `has_venv`, `has_node_modules`.
        &quot;&quot;&quot;
        cwd = Path.cwd()
        info: dict[str, str | bool | None] = {
            &quot;language&quot;: None,
            &quot;is_monorepo&quot;: False,
            &quot;project_root&quot;: None,
            &quot;has_venv&quot;: False,
            &quot;has_node_modules&quot;: False,
        }

        # Check for virtual environments
        info[&quot;has_venv&quot;] = (cwd / &quot;.venv&quot;).exists() or (cwd / &quot;venv&quot;).exists()
        info[&quot;has_node_modules&quot;] = (cwd / &quot;node_modules&quot;).exists()

        # Detect primary language
        if (cwd / &quot;pyproject.toml&quot;).exists() or (cwd / &quot;setup.py&quot;).exists():
            info[&quot;language&quot;] = &quot;python&quot;
        elif (cwd / &quot;package.json&quot;).exists():
            info[&quot;language&quot;] = &quot;javascript/typescript&quot;
        elif (cwd / &quot;Cargo.toml&quot;).exists():
            info[&quot;language&quot;] = &quot;rust&quot;
        elif (cwd / &quot;go.mod&quot;).exists():
            info[&quot;language&quot;] = &quot;go&quot;
        elif (cwd / &quot;pom.xml&quot;).exists() or (cwd / &quot;build.gradle&quot;).exists():
            info[&quot;language&quot;] = &quot;java&quot;

        # Detect monorepo patterns
        # Check for common monorepo indicators
        monorepo_indicators = [
            (cwd / &quot;lerna.json&quot;).exists(),
            (cwd / &quot;pnpm-workspace.yaml&quot;).exists(),
            (cwd / &quot;packages&quot;).is_dir(),
            (cwd / &quot;libs&quot;).is_dir() and (cwd / &quot;apps&quot;).is_dir(),
            (cwd / &quot;workspaces&quot;).is_dir(),
        ]
        info[&quot;is_monorepo&quot;] = any(monorepo_indicators)

        # Try to find project root (look for .git or pyproject.toml up the tree)
        try:
            result = subprocess.run(
                [&quot;git&quot;, &quot;rev-parse&quot;, &quot;--show-toplevel&quot;],
                capture_output=True,
                text=True,
                timeout=2,
                cwd=cwd,
                check=False,
            )
            if result.returncode == 0:
                info[&quot;project_root&quot;] = result.stdout.strip()
        except (subprocess.TimeoutExpired, FileNotFoundError, OSError):
            pass

        return info

    def _detect_test_command(self) -&gt; str | None:
        &quot;&quot;&quot;Detect how to run tests based on project structure.

        Returns:
            Suggested test command or `None` if not detected.
        &quot;&quot;&quot;
        cwd = Path.cwd()

        # Check Makefile for test target
        makefile = cwd / &quot;Makefile&quot;
        if makefile.exists():
            try:
                content = makefile.read_text()
                if &quot;test:&quot; in content or &quot;tests:&quot; in content:
                    return &quot;make test&quot;
            except (OSError, PermissionError, UnicodeDecodeError):
                pass

        # Python projects
        if (cwd / &quot;pyproject.toml&quot;).exists():
            pyproject = cwd / &quot;pyproject.toml&quot;
            try:
                content = pyproject.read_text()
                if &quot;[tool.pytest&quot; in content or (cwd / &quot;pytest.ini&quot;).exists():
                    return &quot;pytest&quot;
            except (OSError, PermissionError, UnicodeDecodeError):
                pass
            if (cwd / &quot;tests&quot;).is_dir() or (cwd / &quot;test&quot;).is_dir():
                return &quot;pytest&quot;

        # Node projects
        if (cwd / &quot;package.json&quot;).exists():
            try:
                import json

                pkg = json.loads((cwd / &quot;package.json&quot;).read_text())
                if &quot;scripts&quot; in pkg and &quot;test&quot; in pkg[&quot;scripts&quot;]:
                    return &quot;npm test&quot;
            except (OSError, PermissionError, UnicodeDecodeError, json.JSONDecodeError):
                pass

        return None

    def before_agent(
        self,
        state: LocalContextState,
        runtime: Runtime,
    ) -&gt; LocalContextStateUpdate | None:
        &quot;&quot;&quot;Load local context before agent execution.

        Runs once at session start to preserve prompt caching.

        Args:
            state: Current agent state.
            runtime: Runtime context.

        Returns:
            Updated state with local_context populated, or None if already set.
        &quot;&quot;&quot;
        # Only compute context on first interaction to preserve prompt caching
        if state.get(&quot;local_context&quot;):
            return None

        cwd = Path.cwd()
        sections = [&quot;## Local Context&quot;, &quot;&quot;]

        # Current directory
        sections.append(f&quot;**Current Directory**: `{cwd}`&quot;)
        sections.append(&quot;&quot;)

        # Project info (language, monorepo, root, environments)
        project_info = self._detect_project_info()
        project_lines = []
        if project_info.get(&quot;language&quot;):
            project_lines.append(f&quot;Language: {project_info[&#x27;language&#x27;]}&quot;)
        if project_info.get(&quot;project_root&quot;) and str(project_info[&quot;project_root&quot;]) != str(cwd):
            project_lines.append(f&quot;Project root: `{project_info[&#x27;project_root&#x27;]}`&quot;)
        if project_info.get(&quot;is_monorepo&quot;):
            project_lines.append(&quot;Monorepo: yes&quot;)
        env_indicators = []
        if project_info.get(&quot;has_venv&quot;):
            env_indicators.append(&quot;.venv&quot;)
        if project_info.get(&quot;has_node_modules&quot;):
            env_indicators.append(&quot;node_modules&quot;)
        if env_indicators:
            project_lines.append(f&quot;Environments: {&#x27;, &#x27;.join(env_indicators)}&quot;)
        if project_lines:
            sections.append(&quot;**Project**:&quot;)
            sections.extend(f&quot;- {line}&quot; for line in project_lines)
            sections.append(&quot;&quot;)

        # Package managers
        pkg_managers = []
        python_pkg = self._detect_package_manager()
        if python_pkg:
            pkg_managers.append(f&quot;Python: {python_pkg}&quot;)
        node_pkg = self._detect_node_package_manager()
        if node_pkg:
            pkg_managers.append(f&quot;Node: {node_pkg}&quot;)
        if pkg_managers:
            sections.append(f&quot;**Package Manager**: {&#x27;, &#x27;.join(pkg_managers)}&quot;)
            sections.append(&quot;&quot;)

        # Git info
        git_info = self._get_git_info()
        if git_info:
            git_text = f&quot;**Git**: Current branch `{git_info[&#x27;branch&#x27;]}`&quot;
            if git_info.get(&quot;main_branches&quot;):
                main_branches = &quot;, &quot;.join(f&quot;`{b}`&quot; for b in git_info[&quot;main_branches&quot;])
                git_text += f&quot;, main branch available: {main_branches}&quot;
            sections.append(git_text)
            sections.append(&quot;&quot;)

        # Test command
        test_cmd = self._detect_test_command()
        if test_cmd:
            sections.append(f&quot;**Run Tests**: `{test_cmd}`&quot;)
            sections.append(&quot;&quot;)

        # File list
        files = self._get_file_list()
        if files:
            total_items = len(list(Path.cwd().iterdir()))
            sections.append(f&quot;**Files** ({len(files)} shown):&quot;)
            for file in files:
                sections.append(f&quot;- {file}&quot;)
            if len(files) &lt; total_items:
                remaining = total_items - len(files)
                sections.append(f&quot;... ({remaining} more files)&quot;)
            sections.append(&quot;&quot;)

        # Directory tree
        tree = self._get_directory_tree()
        if tree:
            sections.append(&quot;**Tree** (3 levels):&quot;)
            sections.append(&quot;```text&quot;)
            sections.append(tree)
            sections.append(&quot;```&quot;)
            sections.append(&quot;&quot;)

        # Makefile preview
        makefile_preview = self._get_makefile_preview()
        if makefile_preview:
            sections.append(&quot;**Makefile** (first 20 lines):&quot;)
            sections.append(&quot;```makefile&quot;)
            sections.append(makefile_preview)
            sections.append(&quot;```&quot;)

        local_context = &quot;\n&quot;.join(sections)
        return LocalContextStateUpdate(local_context=local_context)

    def _get_modified_request(self, request: ModelRequest) -&gt; ModelRequest | None:
        &quot;&quot;&quot;Get modified request with local context injected, or None if no context.

        Args:
            request: The original model request.

        Returns:
            Modified request with local context appended, or None if no local context.
        &quot;&quot;&quot;
        state = cast(&quot;LocalContextState&quot;, request.state)
        local_context = state.get(&quot;local_context&quot;, &quot;&quot;)

        if not local_context:
            return None

        # Append local context to system prompt
        system_prompt = request.system_prompt or &quot;&quot;
        new_prompt = system_prompt + &quot;\n\n&quot; + local_context

        return request.override(system_prompt=new_prompt)

    def wrap_model_call(
        self,
        request: ModelRequest,
        handler: Callable[[ModelRequest], ModelResponse],
    ) -&gt; ModelResponse:
        &quot;&quot;&quot;Inject local context into system prompt.

        Args:
            request: The model request being processed.
            handler: The handler function to call with the modified request.

        Returns:
            The model response from the handler.
        &quot;&quot;&quot;
        modified_request = self._get_modified_request(request)
        return handler(modified_request if modified_request else request)

    async def awrap_model_call(
        self,
        request: ModelRequest,
        handler: Callable[[ModelRequest], Awaitable[ModelResponse]],
    ) -&gt; ModelResponse:
        &quot;&quot;&quot;(async) Inject local context into system prompt.

        Args:
            request: The model request being processed.
            handler: The handler function to call with the modified request.

        Returns:
            The model response from the handler.
        &quot;&quot;&quot;
        modified_request = self._get_modified_request(request)
        return await handler(modified_request if modified_request else request)


__all__ = [&quot;LocalContextMiddleware&quot;]</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/local_context/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="main Imported skill main from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/main.py Unknown LICENSE sources/langchain/main/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">main</div>
                <button class="copy-btn" onclick="copyToClipboard('main')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill main from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Main entry point and CLI loop for deepagents.&quot;&quot;&quot;
# ruff: noqa: T201, E402, BLE001, PLR0912, PLR0915

# Suppress deprecation warnings from langchain_core (e.g., Pydantic V1 on Python 3.14+)
# ruff: noqa: E402
import warnings

warnings.filterwarnings(&quot;ignore&quot;, module=&quot;langchain_core._api.deprecation&quot;)

import argparse
import asyncio
import contextlib
import os
import sys
import warnings
from pathlib import Path

# Suppress Pydantic v1 compatibility warnings from langchain on Python 3.14+
warnings.filterwarnings(&quot;ignore&quot;, message=&quot;.*Pydantic V1.*&quot;, category=UserWarning)

from rich.text import Text

from deepagents_cli._version import __version__

# Now safe to import agent (which imports LangChain modules)
from deepagents_cli.agent import create_cli_agent, list_agents, reset_agent

# CRITICAL: Import config FIRST to set LANGSMITH_PROJECT before LangChain loads
from deepagents_cli.config import (
    console,
    create_model,
    settings,
)
from deepagents_cli.integrations.sandbox_factory import create_sandbox
from deepagents_cli.sessions import (
    delete_thread_command,
    generate_thread_id,
    get_checkpointer,
    get_most_recent,
    get_thread_agent,
    list_threads_command,
    thread_exists,
)
from deepagents_cli.skills import execute_skills_command, setup_skills_parser
from deepagents_cli.tools import fetch_url, http_request, web_search
from deepagents_cli.ui import show_help


def check_cli_dependencies() -&gt; None:
    &quot;&quot;&quot;Check if CLI optional dependencies are installed.&quot;&quot;&quot;
    missing = []

    try:
        import requests  # noqa: F401
    except ImportError:
        missing.append(&quot;requests&quot;)

    try:
        import dotenv  # noqa: F401
    except ImportError:
        missing.append(&quot;python-dotenv&quot;)

    try:
        import tavily  # noqa: F401
    except ImportError:
        missing.append(&quot;tavily-python&quot;)

    try:
        import textual  # noqa: F401
    except ImportError:
        missing.append(&quot;textual&quot;)

    if missing:
        print(&quot;\n Missing required CLI dependencies!&quot;)
        print(&quot;\nThe following packages are required to use the deepagents CLI:&quot;)
        for pkg in missing:
            print(f&quot;  - {pkg}&quot;)
        print(&quot;\nPlease install them with:&quot;)
        print(&quot;  pip install deepagents[cli]&quot;)
        print(&quot;\nOr install all dependencies:&quot;)
        print(&quot;  pip install &#x27;deepagents[cli]&#x27;&quot;)
        sys.exit(1)


def parse_args() -&gt; argparse.Namespace:
    &quot;&quot;&quot;Parse command line arguments.&quot;&quot;&quot;
    parser = argparse.ArgumentParser(
        description=&quot;DeepAgents - AI Coding Assistant&quot;,
        formatter_class=argparse.RawDescriptionHelpFormatter,
        add_help=False,
    )
    parser.add_argument(
        &quot;--version&quot;,
        action=&quot;version&quot;,
        version=f&quot;deepagents {__version__}&quot;,
    )

    subparsers = parser.add_subparsers(dest=&quot;command&quot;, help=&quot;Command to run&quot;)

    # List command
    subparsers.add_parser(&quot;list&quot;, help=&quot;List all available agents&quot;)

    # Help command
    subparsers.add_parser(&quot;help&quot;, help=&quot;Show help information&quot;)

    # Reset command
    reset_parser = subparsers.add_parser(&quot;reset&quot;, help=&quot;Reset an agent&quot;)
    reset_parser.add_argument(&quot;--agent&quot;, required=True, help=&quot;Name of agent to reset&quot;)
    reset_parser.add_argument(
        &quot;--target&quot;, dest=&quot;source_agent&quot;, help=&quot;Copy prompt from another agent&quot;
    )

    # Skills command - setup delegated to skills module
    setup_skills_parser(subparsers)

    # Threads command
    threads_parser = subparsers.add_parser(&quot;threads&quot;, help=&quot;Manage conversation threads&quot;)
    threads_sub = threads_parser.add_subparsers(dest=&quot;threads_command&quot;)

    # threads list
    threads_list = threads_sub.add_parser(&quot;list&quot;, help=&quot;List threads&quot;)
    threads_list.add_argument(
        &quot;--agent&quot;, default=None, help=&quot;Filter by agent name (default: show all)&quot;
    )
    threads_list.add_argument(&quot;--limit&quot;, type=int, default=20, help=&quot;Max threads (default: 20)&quot;)

    # threads delete
    threads_delete = threads_sub.add_parser(&quot;delete&quot;, help=&quot;Delete a thread&quot;)
    threads_delete.add_argument(&quot;thread_id&quot;, help=&quot;Thread ID to delete&quot;)

    # Default interactive mode
    parser.add_argument(
        &quot;--agent&quot;,
        default=&quot;agent&quot;,
        help=&quot;Agent identifier for separate memory stores (default: agent).&quot;,
    )

    # Thread resume argument - matches PR #638: -r for most recent, -r &lt;ID&gt; for specific
    parser.add_argument(
        &quot;-r&quot;,
        &quot;--resume&quot;,
        dest=&quot;resume_thread&quot;,
        nargs=&quot;?&quot;,
        const=&quot;__MOST_RECENT__&quot;,
        default=None,
        help=&quot;Resume thread: -r for most recent, -r &lt;ID&gt; for specific thread&quot;,
    )

    # Initial prompt - auto-submit when session starts
    parser.add_argument(
        &quot;-m&quot;,
        &quot;--message&quot;,
        dest=&quot;initial_prompt&quot;,
        help=&quot;Initial prompt to auto-submit when session starts&quot;,
    )

    parser.add_argument(
        &quot;--model&quot;,
        help=&quot;Model to use (e.g., claude-sonnet-4-5-20250929, gpt-5-mini). &quot;
        &quot;Provider is auto-detected from model name.&quot;,
    )
    parser.add_argument(
        &quot;--auto-approve&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Auto-approve tool usage without prompting (disables human-in-the-loop)&quot;,
    )
    parser.add_argument(
        &quot;--sandbox&quot;,
        choices=[&quot;none&quot;, &quot;modal&quot;, &quot;daytona&quot;, &quot;runloop&quot;],
        default=&quot;none&quot;,
        help=&quot;Remote sandbox for code execution (default: none - local only)&quot;,
    )
    parser.add_argument(
        &quot;--sandbox-id&quot;,
        help=&quot;Existing sandbox ID to reuse (skips creation and cleanup)&quot;,
    )
    parser.add_argument(
        &quot;--sandbox-setup&quot;,
        help=&quot;Path to setup script to run in sandbox after creation&quot;,
    )
    return parser.parse_args()


async def run_textual_cli_async(
    assistant_id: str,
    *,
    auto_approve: bool = False,
    sandbox_type: str = &quot;none&quot;,
    sandbox_id: str | None = None,
    model_name: str | None = None,
    thread_id: str | None = None,
    is_resumed: bool = False,
    initial_prompt: str | None = None,
) -&gt; None:
    &quot;&quot;&quot;Run the Textual CLI interface (async version).

    Args:
        assistant_id: Agent identifier for memory storage
        auto_approve: Whether to auto-approve tool usage
        sandbox_type: Type of sandbox (&quot;none&quot;, &quot;modal&quot;, &quot;runloop&quot;, &quot;daytona&quot;)
        sandbox_id: Optional existing sandbox ID to reuse
        model_name: Optional model name to use
        thread_id: Thread ID to use (new or resumed)
        is_resumed: Whether this is a resumed session
        initial_prompt: Optional prompt to auto-submit when session starts
    &quot;&quot;&quot;
    from deepagents_cli.app import run_textual_app

    model = create_model(model_name)

    # Show thread info
    if is_resumed:
        console.print(f&quot;[green]Resuming thread:[/green] {thread_id}&quot;)
    else:
        console.print(f&quot;[dim]Thread: {thread_id}[/dim]&quot;)

    # Use async context manager for checkpointer
    async with get_checkpointer() as checkpointer:
        # Create agent with conditional tools
        tools = [http_request, fetch_url]
        if settings.has_tavily:
            tools.append(web_search)

        # Handle sandbox mode
        sandbox_backend = None
        sandbox_cm = None

        if sandbox_type != &quot;none&quot;:
            try:
                # Create sandbox context manager but keep it open
                sandbox_cm = create_sandbox(sandbox_type, sandbox_id=sandbox_id)
                sandbox_backend = sandbox_cm.__enter__()
            except (ImportError, ValueError, RuntimeError, NotImplementedError) as e:
                console.print()
                console.print(&quot;[red] Sandbox creation failed[/red]&quot;)
                console.print(Text(str(e), style=&quot;dim&quot;))
                sys.exit(1)

        try:
            agent, composite_backend = create_cli_agent(
                model=model,
                assistant_id=assistant_id,
                tools=tools,
                sandbox=sandbox_backend,
                sandbox_type=sandbox_type if sandbox_type != &quot;none&quot; else None,
                auto_approve=auto_approve,
                checkpointer=checkpointer,
            )

            # Run Textual app
            await run_textual_app(
                agent=agent,
                assistant_id=assistant_id,
                backend=composite_backend,
                auto_approve=auto_approve,
                cwd=Path.cwd(),
                thread_id=thread_id,
                initial_prompt=initial_prompt,
            )
        except Exception as e:
            error_text = Text(&quot; Failed to create agent: &quot;, style=&quot;red&quot;)
            error_text.append(str(e))
            console.print(error_text)
            sys.exit(1)
        finally:
            # Clean up sandbox if we created one
            if sandbox_cm is not None:
                with contextlib.suppress(Exception):
                    sandbox_cm.__exit__(None, None, None)


def cli_main() -&gt; None:
    &quot;&quot;&quot;Entry point for console script.&quot;&quot;&quot;
    # Fix for gRPC fork issue on macOS
    # https://github.com/grpc/grpc/issues/37642
    if sys.platform == &quot;darwin&quot;:
        os.environ[&quot;GRPC_ENABLE_FORK_SUPPORT&quot;] = &quot;0&quot;

    # Note: LANGSMITH_PROJECT is already overridden in config.py (before LangChain imports)
    # This ensures agent traces  DEEPAGENTS_LANGSMITH_PROJECT
    # Shell commands  user&#x27;s original LANGSMITH_PROJECT (via ShellMiddleware env)

    # Check dependencies first
    check_cli_dependencies()

    try:
        args = parse_args()

        if args.command == &quot;help&quot;:
            show_help()
        elif args.command == &quot;list&quot;:
            list_agents()
        elif args.command == &quot;reset&quot;:
            reset_agent(args.agent, args.source_agent)
        elif args.command == &quot;skills&quot;:
            execute_skills_command(args)
        elif args.command == &quot;threads&quot;:
            if args.threads_command == &quot;list&quot;:
                asyncio.run(
                    list_threads_command(
                        agent_name=getattr(args, &quot;agent&quot;, None),
                        limit=getattr(args, &quot;limit&quot;, 20),
                    )
                )
            elif args.threads_command == &quot;delete&quot;:
                asyncio.run(delete_thread_command(args.thread_id))
            else:
                console.print(&quot;[yellow]Usage: deepagents threads &lt;list|delete&gt;[/yellow]&quot;)
        else:
            # Interactive mode - handle thread resume
            thread_id = None
            is_resumed = False

            if args.resume_thread == &quot;__MOST_RECENT__&quot;:
                # -r (no ID): Get most recent thread
                # If --agent specified, filter by that agent; otherwise get most recent overall
                agent_filter = args.agent if args.agent != &quot;agent&quot; else None
                thread_id = asyncio.run(get_most_recent(agent_filter))
                if thread_id:
                    is_resumed = True
                    agent_name = asyncio.run(get_thread_agent(thread_id))
                    if agent_name:
                        args.agent = agent_name
                else:
                    if agent_filter:
                        msg = Text(&quot;No previous thread for &#x27;&quot;, style=&quot;yellow&quot;)
                        msg.append(args.agent)
                        msg.append(&quot;&#x27;, starting new.&quot;, style=&quot;yellow&quot;)
                    else:
                        msg = Text(&quot;No previous threads, starting new.&quot;, style=&quot;yellow&quot;)
                    console.print(msg)

            elif args.resume_thread:
                # -r &lt;ID&gt;: Resume specific thread
                if asyncio.run(thread_exists(args.resume_thread)):
                    thread_id = args.resume_thread
                    is_resumed = True
                    if args.agent == &quot;agent&quot;:
                        agent_name = asyncio.run(get_thread_agent(thread_id))
                        if agent_name:
                            args.agent = agent_name
                else:
                    error_msg = Text(&quot;Thread &#x27;&quot;, style=&quot;red&quot;)
                    error_msg.append(args.resume_thread)
                    error_msg.append(&quot;&#x27; not found.&quot;, style=&quot;red&quot;)
                    console.print(error_msg)
                    console.print(
                        &quot;[dim]Use &#x27;deepagents threads list&#x27; to see available threads.[/dim]&quot;
                    )
                    sys.exit(1)

            # Generate new thread ID if not resuming
            if thread_id is None:
                thread_id = generate_thread_id()

            # Run Textual CLI
            asyncio.run(
                run_textual_cli_async(
                    assistant_id=args.agent,
                    auto_approve=args.auto_approve,
                    sandbox_type=args.sandbox,
                    sandbox_id=args.sandbox_id,
                    model_name=getattr(args, &quot;model&quot;, None),
                    thread_id=thread_id,
                    is_resumed=is_resumed,
                    initial_prompt=getattr(args, &quot;initial_prompt&quot;, None),
                )
            )
    except KeyboardInterrupt:
        # Clean exit on Ctrl+C - suppress ugly traceback
        console.print(&quot;\n\n[yellow]Interrupted[/yellow]&quot;)
        sys.exit(0)


if __name__ == &quot;__main__&quot;:
    cli_main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/main/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="memory Imported skill memory from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/middleware/memory.py Unknown LICENSE sources/langchain/memory/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">memory</div>
                <button class="copy-btn" onclick="copyToClipboard('memory')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill memory from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Middleware for loading agent memory/context from AGENTS.md files.

This module implements support for the AGENTS.md specification (https://agents.md/),
loading memory/context from configurable sources and injecting into the system prompt.

## Overview

AGENTS.md files provide project-specific context and instructions to help AI agents
work effectively. Unlike skills (which are on-demand workflows), memory is always
loaded and provides persistent context.

## Usage

```python
from deepagents import MemoryMiddleware
from deepagents.backends.filesystem import FilesystemBackend

# Security: FilesystemBackend allows reading/writing from the entire filesystem.
# Either ensure the agent is running within a sandbox OR add human-in-the-loop (HIL)
# approval to file operations.
backend = FilesystemBackend(root_dir=&quot;/&quot;)

middleware = MemoryMiddleware(
    backend=backend,
    sources=[
        &quot;~/.deepagents/AGENTS.md&quot;,
        &quot;./.deepagents/AGENTS.md&quot;,
    ],
)

agent = create_deep_agent(middleware=[middleware])
```

## Memory Sources

Sources are simply paths to AGENTS.md files that are loaded in order and combined.
Multiple sources are concatenated in order, with all content included.
Later sources appear after earlier ones in the combined prompt.

## File Format

AGENTS.md files are standard Markdown with no required structure.
Common sections include:
- Project overview
- Build/test commands
- Code style guidelines
- Architecture notes
&quot;&quot;&quot;

from __future__ import annotations

import logging
from collections.abc import Awaitable, Callable
from typing import TYPE_CHECKING, Annotated, NotRequired, TypedDict

from langchain_core.runnables import RunnableConfig

if TYPE_CHECKING:
    from deepagents.backends.protocol import BACKEND_TYPES, BackendProtocol

from langchain.agents.middleware.types import (
    AgentMiddleware,
    AgentState,
    ModelRequest,
    ModelResponse,
    PrivateStateAttr,
)
from langchain.tools import ToolRuntime
from langgraph.runtime import Runtime

from deepagents.middleware._utils import append_to_system_message

logger = logging.getLogger(__name__)


class MemoryState(AgentState):
    &quot;&quot;&quot;State schema for `MemoryMiddleware`.

    Attributes:
        memory_contents: Dict mapping source paths to their loaded content.
            Marked as private so it&#x27;s not included in the final agent state.
    &quot;&quot;&quot;

    memory_contents: NotRequired[Annotated[dict[str, str], PrivateStateAttr]]


class MemoryStateUpdate(TypedDict):
    &quot;&quot;&quot;State update for `MemoryMiddleware`.&quot;&quot;&quot;

    memory_contents: dict[str, str]


MEMORY_SYSTEM_PROMPT = &quot;&quot;&quot;&lt;agent_memory&gt;
{agent_memory}
&lt;/agent_memory&gt;

&lt;memory_guidelines&gt;
    The above &lt;agent_memory&gt; was loaded in from files in your filesystem. As you learn from your interactions with the user, you can save new knowledge by calling the `edit_file` tool.

    **Learning from feedback:**
    - One of your MAIN PRIORITIES is to learn from your interactions with the user. These learnings can be implicit or explicit. This means that in the future, you will remember this important information.
    - When you need to remember something, updating memory must be your FIRST, IMMEDIATE action - before responding to the user, before calling other tools, before doing anything else. Just update memory immediately.
    - When user says something is better/worse, capture WHY and encode it as a pattern.
    - Each correction is a chance to improve permanently - don&#x27;t just fix the immediate issue, update your instructions.
    - A great opportunity to update your memories is when the user interrupts a tool call and provides feedback. You should update your memories immediately before revising the tool call.
    - Look for the underlying principle behind corrections, not just the specific mistake.
    - The user might not explicitly ask you to remember something, but if they provide information that is useful for future use, you should update your memories immediately.

    **Asking for information:**
    - If you lack context to perform an action (e.g. send a Slack DM, requires a user ID/email) you should explicitly ask the user for this information.
    - It is preferred for you to ask for information, don&#x27;t assume anything that you do not know!
    - When the user provides information that is useful for future use, you should update your memories immediately.

    **When to update memories:**
    - When the user explicitly asks you to remember something (e.g., &quot;remember my email&quot;, &quot;save this preference&quot;)
    - When the user describes your role or how you should behave (e.g., &quot;you are a web researcher&quot;, &quot;always do X&quot;)
    - When the user gives feedback on your work - capture what was wrong and how to improve
    - When the user provides information required for tool use (e.g., slack channel ID, email addresses)
    - When the user provides context useful for future tasks, such as how to use tools, or which actions to take in a particular situation
    - When you discover new patterns or preferences (coding styles, conventions, workflows)

    **When to NOT update memories:**
    - When the information is temporary or transient (e.g., &quot;I&#x27;m running late&quot;, &quot;I&#x27;m on my phone right now&quot;)
    - When the information is a one-time task request (e.g., &quot;Find me a recipe&quot;, &quot;What&#x27;s 25 * 4?&quot;)
    - When the information is a simple question that doesn&#x27;t reveal lasting preferences (e.g., &quot;What day is it?&quot;, &quot;Can you explain X?&quot;)
    - When the information is an acknowledgment or small talk (e.g., &quot;Sounds good!&quot;, &quot;Hello&quot;, &quot;Thanks for that&quot;)
    - When the information is stale or irrelevant in future conversations
    - Never store API keys, access tokens, passwords, or any other credentials in any file, memory, or system prompt.
    - If the user asks where to put API keys or provides an API key, do NOT echo or save it.

    **Examples:**
    Example 1 (remembering user information):
    User: Can you connect to my google account?
    Agent: Sure, I&#x27;ll connect to your google account, what&#x27;s your google account email?
    User: john@example.com
    Agent: Let me save this to my memory.
    Tool Call: edit_file(...) -&gt; remembers that the user&#x27;s google account email is john@example.com

    Example 2 (remembering implicit user preferences):
    User: Can you write me an example for creating a deep agent in LangChain?
    Agent: Sure, I&#x27;ll write you an example for creating a deep agent in LangChain &lt;example code in Python&gt;
    User: Can you do this in JavaScript
    Agent: Let me save this to my memory.
    Tool Call: edit_file(...) -&gt; remembers that the user prefers to get LangChaincode examples in JavaScript
    Agent: Sure, here is the JavaScript example&lt;example code in JavaScript&gt;

    Example 3 (do not remember transient information):
    User: I&#x27;m going to play basketball tonight so I will be offline for a few hours.
    Agent: Okay I&#x27;ll add a black to your calendar.
    Tool Call: create_calendar_event(...) -&gt; just calls a tool, does not commit anything to memory, as it is transient information
&lt;/memory_guidelines&gt;
&quot;&quot;&quot;


class MemoryMiddleware(AgentMiddleware):
    &quot;&quot;&quot;Middleware for loading agent memory from `AGENTS.md` files.

    Loads memory content from configured sources and injects into the system prompt.

    Supports multiple sources that are combined together.

    Args:
        backend: Backend instance or factory function for file operations.
        sources: List of `MemorySource` configurations specifying paths and names.
    &quot;&quot;&quot;

    state_schema = MemoryState

    def __init__(
        self,
        *,
        backend: BACKEND_TYPES,
        sources: list[str],
    ) -&gt; None:
        &quot;&quot;&quot;Initialize the memory middleware.

        Args:
            backend: Backend instance or factory function that takes runtime
                     and returns a backend. Use a factory for StateBackend.
            sources: List of memory file paths to load (e.g., `[&quot;~/.deepagents/AGENTS.md&quot;,
                     &quot;./.deepagents/AGENTS.md&quot;]`).

                     Display names are automatically derived from the paths.

                     Sources are loaded in order.
        &quot;&quot;&quot;
        self._backend = backend
        self.sources = sources

    def _get_backend(self, state: MemoryState, runtime: Runtime, config: RunnableConfig) -&gt; BackendProtocol:
        &quot;&quot;&quot;Resolve backend from instance or factory.

        Args:
            state: Current agent state.
            runtime: Runtime context for factory functions.
            config: Runnable config to pass to backend factory.

        Returns:
            Resolved backend instance.
        &quot;&quot;&quot;
        if callable(self._backend):
            # Construct an artificial tool runtime to resolve backend factory
            tool_runtime = ToolRuntime(
                state=state,
                context=runtime.context,
                stream_writer=runtime.stream_writer,
                store=runtime.store,
                config=config,
                tool_call_id=None,
            )
            return self._backend(tool_runtime)
        return self._backend

    def _format_agent_memory(self, contents: dict[str, str]) -&gt; str:
        &quot;&quot;&quot;Format memory with locations and contents paired together.

        Args:
            contents: Dict mapping source paths to content.

        Returns:
            Formatted string with location+content pairs wrapped in &lt;agent_memory&gt; tags.
        &quot;&quot;&quot;
        if not contents:
            return MEMORY_SYSTEM_PROMPT.format(agent_memory=&quot;(No memory loaded)&quot;)

        sections = []
        for path in self.sources:
            if contents.get(path):
                sections.append(f&quot;{path}\n{contents[path]}&quot;)

        if not sections:
            return MEMORY_SYSTEM_PROMPT.format(agent_memory=&quot;(No memory loaded)&quot;)

        memory_body = &quot;\n\n&quot;.join(sections)
        return MEMORY_SYSTEM_PROMPT.format(agent_memory=memory_body)

    async def _load_memory_from_backend(
        self,
        backend: BackendProtocol,
        path: str,
    ) -&gt; str | None:
        &quot;&quot;&quot;Load memory content from a backend path.

        Args:
            backend: Backend to load from.
            path: Path to the AGENTS.md file.

        Returns:
            File content if found, None otherwise.
        &quot;&quot;&quot;
        results = await backend.adownload_files([path])
        # Should get exactly one response for one path
        if len(results) != 1:
            raise AssertionError(f&quot;Expected 1 response for path {path}, got {len(results)}&quot;)
        response = results[0]

        if response.error is not None:
            # For now, memory files are treated as optional. file_not_found is expected
            # and we skip silently to allow graceful degradation.
            if response.error == &quot;file_not_found&quot;:
                return None
            # Other errors should be raised
            raise ValueError(f&quot;Failed to download {path}: {response.error}&quot;)

        if response.content is not None:
            return response.content.decode(&quot;utf-8&quot;)

        return None

    def _load_memory_from_backend_sync(
        self,
        backend: BackendProtocol,
        path: str,
    ) -&gt; str | None:
        &quot;&quot;&quot;Load memory content from a backend path synchronously.

        Args:
            backend: Backend to load from.
            path: Path to the AGENTS.md file.

        Returns:
            File content if found, None otherwise.
        &quot;&quot;&quot;
        results = backend.download_files([path])
        # Should get exactly one response for one path
        if len(results) != 1:
            raise AssertionError(f&quot;Expected 1 response for path {path}, got {len(results)}&quot;)
        response = results[0]

        if response.error is not None:
            # For now, memory files are treated as optional. file_not_found is expected
            # and we skip silently to allow graceful degradation.
            if response.error == &quot;file_not_found&quot;:
                return None
            # Other errors should be raised
            raise ValueError(f&quot;Failed to download {path}: {response.error}&quot;)

        if response.content is not None:
            return response.content.decode(&quot;utf-8&quot;)

        return None

    def before_agent(self, state: MemoryState, runtime: Runtime, config: RunnableConfig) -&gt; MemoryStateUpdate | None:
        &quot;&quot;&quot;Load memory content before agent execution (synchronous).

        Loads memory from all configured sources and stores in state.
        Only loads if not already present in state.

        Args:
            state: Current agent state.
            runtime: Runtime context.
            config: Runnable config.

        Returns:
            State update with memory_contents populated.
        &quot;&quot;&quot;
        # Skip if already loaded
        if &quot;memory_contents&quot; in state:
            return None

        backend = self._get_backend(state, runtime, config)
        contents: dict[str, str] = {}

        for path in self.sources:
            content = self._load_memory_from_backend_sync(backend, path)
            if content:
                contents[path] = content
                logger.debug(f&quot;Loaded memory from: {path}&quot;)

        return MemoryStateUpdate(memory_contents=contents)

    async def abefore_agent(self, state: MemoryState, runtime: Runtime, config: RunnableConfig) -&gt; MemoryStateUpdate | None:
        &quot;&quot;&quot;Load memory content before agent execution.

        Loads memory from all configured sources and stores in state.
        Only loads if not already present in state.

        Args:
            state: Current agent state.
            runtime: Runtime context.
            config: Runnable config.

        Returns:
            State update with memory_contents populated.
        &quot;&quot;&quot;
        # Skip if already loaded
        if &quot;memory_contents&quot; in state:
            return None

        backend = self._get_backend(state, runtime, config)
        contents: dict[str, str] = {}

        for path in self.sources:
            content = await self._load_memory_from_backend(backend, path)
            if content:
                contents[path] = content
                logger.debug(f&quot;Loaded memory from: {path}&quot;)

        return MemoryStateUpdate(memory_contents=contents)

    def modify_request(self, request: ModelRequest) -&gt; ModelRequest:
        &quot;&quot;&quot;Inject memory content into the system message.

        Args:
            request: Model request to modify.

        Returns:
            Modified request with memory injected into system message.
        &quot;&quot;&quot;
        contents = request.state.get(&quot;memory_contents&quot;, {})
        agent_memory = self._format_agent_memory(contents)

        new_system_message = append_to_system_message(request.system_message, agent_memory)

        return request.override(system_message=new_system_message)

    def wrap_model_call(
        self,
        request: ModelRequest,
        handler: Callable[[ModelRequest], ModelResponse],
    ) -&gt; ModelResponse:
        &quot;&quot;&quot;Wrap model call to inject memory into system prompt.

        Args:
            request: Model request being processed.
            handler: Handler function to call with modified request.

        Returns:
            Model response from handler.
        &quot;&quot;&quot;
        modified_request = self.modify_request(request)
        return handler(modified_request)

    async def awrap_model_call(
        self,
        request: ModelRequest,
        handler: Callable[[ModelRequest], Awaitable[ModelResponse]],
    ) -&gt; ModelResponse:
        &quot;&quot;&quot;Async wrap model call to inject memory into system prompt.

        Args:
            request: Model request being processed.
            handler: Async handler function to call with modified request.

        Returns:
            Model response from handler.
        &quot;&quot;&quot;
        modified_request = self.modify_request(request)
        return await handler(modified_request)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/memory/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/middleware/memory.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="messages Imported skill messages from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/widgets/messages.py Unknown LICENSE sources/langchain/messages/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">messages</div>
                <button class="copy-btn" onclick="copyToClipboard('messages')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill messages from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Message widgets for deepagents-cli.&quot;&quot;&quot;

from __future__ import annotations

from typing import TYPE_CHECKING, Any

from rich.text import Text
from textual.containers import Vertical
from textual.css.query import NoMatches
from textual.widgets import Markdown, Static
from textual.widgets._markdown import MarkdownStream

from deepagents_cli.ui import format_tool_display
from deepagents_cli.widgets.diff import format_diff_textual

if TYPE_CHECKING:
    from textual.app import ComposeResult

# Maximum number of tool arguments to display inline
_MAX_INLINE_ARGS = 3


class UserMessage(Static):
    &quot;&quot;&quot;Widget displaying a user message.&quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    UserMessage {
        height: auto;
        padding: 0 1;
        margin: 1 0;
        background: $surface;
        border-left: thick $primary;
    }

    UserMessage .user-prefix {
        color: $primary;
        text-style: bold;
    }

    UserMessage .user-content {
        margin-left: 1;
    }
    &quot;&quot;&quot;

    def __init__(self, content: str, **kwargs: Any) -&gt; None:
        &quot;&quot;&quot;Initialize a user message.

        Args:
            content: The message content
            **kwargs: Additional arguments passed to parent
        &quot;&quot;&quot;
        super().__init__(**kwargs)
        self._content = content

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the user message layout.&quot;&quot;&quot;
        # Use Text object to combine styled prefix with unstyled user content
        text = Text()
        text.append(&quot;&gt; &quot;, style=&quot;bold #10b981&quot;)
        text.append(self._content)
        yield Static(text)


class AssistantMessage(Vertical):
    &quot;&quot;&quot;Widget displaying an assistant message with markdown support.

    Uses MarkdownStream for smoother streaming instead of re-rendering
    the full content on each update.
    &quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    AssistantMessage {
        height: auto;
        padding: 0 1;
        margin: 1 0;
    }

    AssistantMessage Markdown {
        padding: 0;
        margin: 0;
    }
    &quot;&quot;&quot;

    def __init__(self, content: str = &quot;&quot;, **kwargs: Any) -&gt; None:
        &quot;&quot;&quot;Initialize an assistant message.

        Args:
            content: Initial markdown content
            **kwargs: Additional arguments passed to parent
        &quot;&quot;&quot;
        super().__init__(**kwargs)
        self._content = content
        self._markdown: Markdown | None = None
        self._stream: MarkdownStream | None = None

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the assistant message layout.&quot;&quot;&quot;
        yield Markdown(&quot;&quot;, id=&quot;assistant-content&quot;)

    def on_mount(self) -&gt; None:
        &quot;&quot;&quot;Store reference to markdown widget.&quot;&quot;&quot;
        self._markdown = self.query_one(&quot;#assistant-content&quot;, Markdown)

    def _get_markdown(self) -&gt; Markdown:
        &quot;&quot;&quot;Get the markdown widget, querying if not cached.&quot;&quot;&quot;
        if self._markdown is None:
            self._markdown = self.query_one(&quot;#assistant-content&quot;, Markdown)
        return self._markdown

    def _ensure_stream(self) -&gt; MarkdownStream:
        &quot;&quot;&quot;Ensure the markdown stream is initialized.&quot;&quot;&quot;
        if self._stream is None:
            self._stream = Markdown.get_stream(self._get_markdown())
        return self._stream

    async def append_content(self, text: str) -&gt; None:
        &quot;&quot;&quot;Append content to the message (for streaming).

        Uses MarkdownStream for smoother rendering instead of re-rendering
        the full content on each chunk.

        Args:
            text: Text to append
        &quot;&quot;&quot;
        if not text:
            return
        self._content += text
        stream = self._ensure_stream()
        await stream.write(text)

    async def write_initial_content(self) -&gt; None:
        &quot;&quot;&quot;Write initial content if provided at construction time.&quot;&quot;&quot;
        if self._content:
            stream = self._ensure_stream()
            await stream.write(self._content)

    async def stop_stream(self) -&gt; None:
        &quot;&quot;&quot;Stop the streaming and finalize the content.&quot;&quot;&quot;
        if self._stream is not None:
            await self._stream.stop()
            self._stream = None

    async def set_content(self, content: str) -&gt; None:
        &quot;&quot;&quot;Set the full message content.

        This stops any active stream and sets content directly.

        Args:
            content: The markdown content to display
        &quot;&quot;&quot;
        await self.stop_stream()
        self._content = content
        if self._markdown:
            await self._markdown.update(content)


class ToolCallMessage(Vertical):
    &quot;&quot;&quot;Widget displaying a tool call with collapsible output.

    Tool outputs are shown as a 3-line preview by default.
    Press Ctrl+O to expand/collapse the full output.
    &quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    ToolCallMessage {
        height: auto;
        padding: 0 1;
        margin: 1 0;
        background: $surface;
        border-left: thick $secondary;
    }

    ToolCallMessage .tool-header {
        color: $secondary;
        text-style: bold;
    }

    ToolCallMessage .tool-args {
        color: $text-muted;
        margin-left: 2;
    }

    ToolCallMessage .tool-status {
        margin-left: 2;
    }

    ToolCallMessage .tool-status.pending {
        color: $warning;
    }

    ToolCallMessage .tool-status.success {
        color: $success;
    }

    ToolCallMessage .tool-status.error {
        color: $error;
    }

    ToolCallMessage .tool-status.rejected {
        color: $warning;
    }

    ToolCallMessage .tool-output {
        margin-left: 2;
        margin-top: 1;
        padding: 1;
        background: $surface-darken-1;
        color: $text-muted;
        max-height: 20;
        overflow-y: auto;
    }

    ToolCallMessage .tool-output-preview {
        margin-left: 2;
        color: $text-muted;
    }

    ToolCallMessage .tool-output-hint {
        margin-left: 2;
        color: $primary;
        text-style: italic;
    }
    &quot;&quot;&quot;

    # Max lines/chars to show in preview mode
    _PREVIEW_LINES = 3
    _PREVIEW_CHARS = 200

    def __init__(
        self,
        tool_name: str,
        args: dict[str, Any] | None = None,
        **kwargs: Any,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize a tool call message.

        Args:
            tool_name: Name of the tool being called
            args: Tool arguments (optional)
            **kwargs: Additional arguments passed to parent
        &quot;&quot;&quot;
        super().__init__(**kwargs)
        self._tool_name = tool_name
        self._args = args or {}
        self._status = &quot;pending&quot;
        self._output: str = &quot;&quot;
        self._expanded: bool = False

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the tool call message layout.&quot;&quot;&quot;
        tool_label = format_tool_display(self._tool_name, self._args)
        yield Static(
            f&quot;[bold yellow]Tool:[/bold yellow] {tool_label}&quot;,
            classes=&quot;tool-header&quot;,
        )
        args = self._filtered_args()
        if args:
            args_str = &quot;, &quot;.join(f&quot;{k}={v!r}&quot; for k, v in list(args.items())[:_MAX_INLINE_ARGS])
            if len(args) &gt; _MAX_INLINE_ARGS:
                args_str += &quot;, ...&quot;
            yield Static(f&quot;({args_str})&quot;, classes=&quot;tool-args&quot;)
        yield Static(
            &quot;[yellow]Pending...[/yellow]&quot;,
            classes=&quot;tool-status pending&quot;,
            id=&quot;status&quot;,
        )
        # Output area - hidden initially, shown when output is set
        # Use markup=False for output content to prevent Rich markup injection
        yield Static(&quot;&quot;, classes=&quot;tool-output-preview&quot;, id=&quot;output-preview&quot;, markup=False)
        yield Static(&quot;&quot;, classes=&quot;tool-output-hint&quot;, id=&quot;output-hint&quot;)  # hint uses our markup
        yield Static(&quot;&quot;, classes=&quot;tool-output&quot;, id=&quot;output-full&quot;, markup=False)

    def on_mount(self) -&gt; None:
        &quot;&quot;&quot;Hide output areas initially.&quot;&quot;&quot;
        try:
            self.query_one(&quot;#output-preview&quot;).display = False
            self.query_one(&quot;#output-hint&quot;).display = False
            self.query_one(&quot;#output-full&quot;).display = False
        except NoMatches:
            pass

    def set_success(self, result: str = &quot;&quot;) -&gt; None:
        &quot;&quot;&quot;Mark the tool call as successful.

        Args:
            result: Tool output/result to display
        &quot;&quot;&quot;
        self._status = &quot;success&quot;
        self._output = result
        try:
            status = self.query_one(&quot;#status&quot;, Static)
            status.remove_class(&quot;pending&quot;, &quot;error&quot;)
            status.add_class(&quot;success&quot;)
            status.update(&quot;[green] Success[/green]&quot;)
        except NoMatches:
            pass
        self._update_output_display()

    def set_error(self, error: str) -&gt; None:
        &quot;&quot;&quot;Mark the tool call as failed.

        Args:
            error: Error message
        &quot;&quot;&quot;
        self._status = &quot;error&quot;
        self._output = error
        try:
            status = self.query_one(&quot;#status&quot;, Static)
            status.remove_class(&quot;pending&quot;, &quot;success&quot;)
            status.add_class(&quot;error&quot;)
            status.update(&quot;[red] Error[/red]&quot;)
        except NoMatches:
            pass
        # Always show full error - errors should be visible
        self._expanded = True
        self._update_output_display()

    def set_rejected(self) -&gt; None:
        &quot;&quot;&quot;Mark the tool call as rejected by user.&quot;&quot;&quot;
        self._status = &quot;rejected&quot;
        try:
            status = self.query_one(&quot;#status&quot;, Static)
            status.remove_class(&quot;pending&quot;, &quot;success&quot;, &quot;error&quot;)
            status.add_class(&quot;rejected&quot;)
            status.update(&quot;[yellow] Rejected[/yellow]&quot;)
        except NoMatches:
            pass

    def toggle_output(self) -&gt; None:
        &quot;&quot;&quot;Toggle between preview and full output display.&quot;&quot;&quot;
        if not self._output:
            return
        self._expanded = not self._expanded
        self._update_output_display()

    def _update_output_display(self) -&gt; None:
        &quot;&quot;&quot;Update the output display based on expanded state.&quot;&quot;&quot;
        if not self._output:
            return

        try:
            preview = self.query_one(&quot;#output-preview&quot;, Static)
            hint = self.query_one(&quot;#output-hint&quot;, Static)
            full = self.query_one(&quot;#output-full&quot;, Static)

            output_stripped = self._output.strip()
            lines = output_stripped.split(&quot;\n&quot;)
            total_lines = len(lines)
            total_chars = len(output_stripped)

            # Truncate if too many lines OR too many characters
            needs_truncation = (
                total_lines &gt; self._PREVIEW_LINES or total_chars &gt; self._PREVIEW_CHARS
            )

            if self._expanded:
                # Show full output
                preview.display = False
                hint.display = False
                full.update(self._output)
                full.display = True
            else:
                # Show preview
                full.display = False
                if needs_truncation:
                    # Truncate by lines first, then by chars
                    if total_lines &gt; self._PREVIEW_LINES:
                        preview_text = &quot;\n&quot;.join(lines[: self._PREVIEW_LINES])
                    else:
                        preview_text = output_stripped

                    # Also truncate by chars if still too long
                    if len(preview_text) &gt; self._PREVIEW_CHARS:
                        preview_text = preview_text[: self._PREVIEW_CHARS] + &quot;...&quot;

                    preview.update(preview_text)
                    preview.display = True

                    # Show expand hint
                    hint.update(&quot;[dim]... (Ctrl+O to expand)[/dim]&quot;)
                    hint.display = True
                elif output_stripped:
                    # Output fits in preview, just show it
                    preview.update(output_stripped)
                    preview.display = True
                    hint.display = False
                else:
                    preview.display = False
                    hint.display = False
        except NoMatches:
            pass

    @property
    def has_output(self) -&gt; bool:
        &quot;&quot;&quot;Check if this tool message has output to display.&quot;&quot;&quot;
        return bool(self._output)

    def _filtered_args(self) -&gt; dict[str, Any]:
        &quot;&quot;&quot;Filter large tool args for display.&quot;&quot;&quot;
        if self._tool_name not in {&quot;write_file&quot;, &quot;edit_file&quot;}:
            return self._args

        filtered: dict[str, Any] = {}
        for key in (&quot;file_path&quot;, &quot;path&quot;, &quot;replace_all&quot;):
            if key in self._args:
                filtered[key] = self._args[key]
        return filtered


class DiffMessage(Static):
    &quot;&quot;&quot;Widget displaying a diff with syntax highlighting.&quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    DiffMessage {
        height: auto;
        padding: 1;
        margin: 1 0;
        background: $surface;
        border: solid $primary;
    }

    DiffMessage .diff-header {
        text-style: bold;
        margin-bottom: 1;
    }

    DiffMessage .diff-add {
        color: #10b981;
        background: #10b98120;
    }

    DiffMessage .diff-remove {
        color: #ef4444;
        background: #ef444420;
    }

    DiffMessage .diff-context {
        color: $text-muted;
    }

    DiffMessage .diff-hunk {
        color: $secondary;
        text-style: bold;
    }
    &quot;&quot;&quot;

    def __init__(self, diff_content: str, file_path: str = &quot;&quot;, **kwargs: Any) -&gt; None:
        &quot;&quot;&quot;Initialize a diff message.

        Args:
            diff_content: The unified diff content
            file_path: Path to the file being modified
            **kwargs: Additional arguments passed to parent
        &quot;&quot;&quot;
        super().__init__(**kwargs)
        self._diff_content = diff_content
        self._file_path = file_path

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the diff message layout.&quot;&quot;&quot;
        if self._file_path:
            yield Static(f&quot;[bold]File: {self._file_path}[/bold]&quot;, classes=&quot;diff-header&quot;)

        # Render the diff with enhanced formatting
        rendered = format_diff_textual(self._diff_content, max_lines=100)
        yield Static(rendered)


class ErrorMessage(Static):
    &quot;&quot;&quot;Widget displaying an error message.&quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    ErrorMessage {
        height: auto;
        padding: 1;
        margin: 1 0;
        background: #7f1d1d;
        color: white;
        border-left: thick $error;
    }
    &quot;&quot;&quot;

    def __init__(self, error: str, **kwargs: Any) -&gt; None:
        &quot;&quot;&quot;Initialize an error message.

        Args:
            error: The error message
            **kwargs: Additional arguments passed to parent
        &quot;&quot;&quot;
        # Use Text object to combine styled prefix with unstyled error content
        text = Text(&quot;Error: &quot;, style=&quot;bold red&quot;)
        text.append(error)
        super().__init__(text, **kwargs)


class SystemMessage(Static):
    &quot;&quot;&quot;Widget displaying a system message.&quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    SystemMessage {
        height: auto;
        padding: 0 1;
        margin: 1 0;
        color: $text-muted;
        text-style: italic;
    }
    &quot;&quot;&quot;

    def __init__(self, message: str, **kwargs: Any) -&gt; None:
        &quot;&quot;&quot;Initialize a system message.

        Args:
            message: The system message
            **kwargs: Additional arguments passed to parent
        &quot;&quot;&quot;
        # Use Text object to safely render message without markup parsing
        super().__init__(Text(message, style=&quot;dim italic&quot;), **kwargs)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/messages/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="modal Imported skill modal from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/integrations/modal.py Unknown LICENSE sources/langchain/modal/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">modal</div>
                <button class="copy-btn" onclick="copyToClipboard('modal')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill modal from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Modal sandbox backend implementation.&quot;&quot;&quot;

from __future__ import annotations

from typing import TYPE_CHECKING

from deepagents.backends.protocol import (
    ExecuteResponse,
    FileDownloadResponse,
    FileUploadResponse,
)
from deepagents.backends.sandbox import BaseSandbox

if TYPE_CHECKING:
    import modal


class ModalBackend(BaseSandbox):
    &quot;&quot;&quot;Modal backend implementation conforming to SandboxBackendProtocol.

    This implementation inherits all file operation methods from BaseSandbox
    and only implements the execute() method using Modal&#x27;s API.
    &quot;&quot;&quot;

    def __init__(self, sandbox: modal.Sandbox) -&gt; None:
        &quot;&quot;&quot;Initialize the ModalBackend with a Modal sandbox instance.

        Args:
            sandbox: Active Modal Sandbox instance
        &quot;&quot;&quot;
        self._sandbox = sandbox
        self._timeout = 30 * 60

    @property
    def id(self) -&gt; str:
        &quot;&quot;&quot;Unique identifier for the sandbox backend.&quot;&quot;&quot;
        return self._sandbox.object_id

    def execute(
        self,
        command: str,
    ) -&gt; ExecuteResponse:
        &quot;&quot;&quot;Execute a command in the sandbox and return ExecuteResponse.

        Args:
            command: Full shell command string to execute.

        Returns:
            ExecuteResponse with combined output, exit code, and truncation flag.
        &quot;&quot;&quot;
        # Execute command using Modal&#x27;s exec API
        process = self._sandbox.exec(&quot;bash&quot;, &quot;-c&quot;, command, timeout=self._timeout)

        # Wait for process to complete
        process.wait()

        # Read stdout and stderr
        stdout = process.stdout.read()
        stderr = process.stderr.read()

        # Combine stdout and stderr (matching Runloop&#x27;s approach)
        output = stdout or &quot;&quot;
        if stderr:
            output += &quot;\n&quot; + stderr if output else stderr

        return ExecuteResponse(
            output=output,
            exit_code=process.returncode,
            truncated=False,  # Modal doesn&#x27;t provide truncation info
        )

    def download_files(self, paths: list[str]) -&gt; list[FileDownloadResponse]:
        &quot;&quot;&quot;Download multiple files from the Modal sandbox.

        Supports partial success - individual downloads may fail without
        affecting others.

        Args:
            paths: List of file paths to download.

        Returns:
            List of FileDownloadResponse objects, one per input path.
            Response order matches input order.

        TODO: Implement proper error handling with standardized FileOperationError codes.
        Need to determine what exceptions Modal&#x27;s sandbox.open() actually raises.
        Currently only implements happy path.
        &quot;&quot;&quot;
        # This implementation relies on the Modal sandbox file API.
        # https://modal.com/doc/guide/sandbox-files
        # The API is currently in alpha and is not recommended for production use.
        # We&#x27;re OK using it here as it&#x27;s targeting the CLI application.
        responses = []
        for path in paths:
            with self._sandbox.open(path, &quot;rb&quot;) as f:
                content = f.read()
            responses.append(FileDownloadResponse(path=path, content=content, error=None))
        return responses

    def upload_files(self, files: list[tuple[str, bytes]]) -&gt; list[FileUploadResponse]:
        &quot;&quot;&quot;Upload multiple files to the Modal sandbox.

        Supports partial success - individual uploads may fail without
        affecting others.

        Args:
            files: List of (path, content) tuples to upload.

        Returns:
            List of FileUploadResponse objects, one per input file.
            Response order matches input order.

        TODO: Implement proper error handling with standardized FileOperationError codes.
        Need to determine what exceptions Modal&#x27;s sandbox.open() actually raises.
        Currently only implements happy path.
        &quot;&quot;&quot;
        # This implementation relies on the Modal sandbox file API.
        # https://modal.com/doc/guide/sandbox-files
        # The API is currently in alpha and is not recommended for production use.
        # We&#x27;re OK using it here as it&#x27;s targeting the CLI application.
        responses = []
        for path, content in files:
            with self._sandbox.open(path, &quot;wb&quot;) as f:
                f.write(content)
            responses.append(FileUploadResponse(path=path, error=None))
        return responses</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/modal/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="patch_tool_calls Imported skill patch_tool_calls from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/middleware/patch_tool_calls.py Unknown LICENSE sources/langchain/patch_tool_calls/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">patch_tool_calls</div>
                <button class="copy-btn" onclick="copyToClipboard('patch_tool_calls')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill patch_tool_calls from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Middleware to patch dangling tool calls in the messages history.&quot;&quot;&quot;

from typing import Any

from langchain.agents.middleware import AgentMiddleware, AgentState
from langchain_core.messages import ToolMessage
from langgraph.runtime import Runtime
from langgraph.types import Overwrite


class PatchToolCallsMiddleware(AgentMiddleware):
    &quot;&quot;&quot;Middleware to patch dangling tool calls in the messages history.&quot;&quot;&quot;

    def before_agent(self, state: AgentState, runtime: Runtime[Any]) -&gt; dict[str, Any] | None:  # noqa: ARG002
        &quot;&quot;&quot;Before the agent runs, handle dangling tool calls from any AIMessage.&quot;&quot;&quot;
        messages = state[&quot;messages&quot;]
        if not messages or len(messages) == 0:
            return None

        patched_messages = []
        # Iterate over the messages and add any dangling tool calls
        for i, msg in enumerate(messages):
            patched_messages.append(msg)
            if msg.type == &quot;ai&quot; and msg.tool_calls:
                for tool_call in msg.tool_calls:
                    corresponding_tool_msg = next(
                        (msg for msg in messages[i:] if msg.type == &quot;tool&quot; and msg.tool_call_id == tool_call[&quot;id&quot;]),
                        None,
                    )
                    if corresponding_tool_msg is None:
                        # We have a dangling tool call which needs a ToolMessage
                        tool_msg = (
                            f&quot;Tool call {tool_call[&#x27;name&#x27;]} with id {tool_call[&#x27;id&#x27;]} was &quot;
                            &quot;cancelled - another message came in before it could be completed.&quot;
                        )
                        patched_messages.append(
                            ToolMessage(
                                content=tool_msg,
                                name=tool_call[&quot;name&quot;],
                                tool_call_id=tool_call[&quot;id&quot;],
                            )
                        )

        return {&quot;messages&quot;: Overwrite(patched_messages)}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/patch_tool_calls/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/middleware/patch_tool_calls.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="project_utils Imported skill project_utils from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/project_utils.py Unknown LICENSE sources/langchain/project_utils/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">project_utils</div>
                <button class="copy-btn" onclick="copyToClipboard('project_utils')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill project_utils from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Utilities for project root detection and project-specific configuration.&quot;&quot;&quot;

from pathlib import Path


def find_project_root(start_path: Path | None = None) -&gt; Path | None:
    &quot;&quot;&quot;Find the project root by looking for .git directory.

    Walks up the directory tree from start_path (or cwd) looking for a .git
    directory, which indicates the project root.

    Args:
        start_path: Directory to start searching from. Defaults to current working directory.

    Returns:
        Path to the project root if found, None otherwise.
    &quot;&quot;&quot;
    current = Path(start_path or Path.cwd()).resolve()

    # Walk up the directory tree
    for parent in [current, *list(current.parents)]:
        git_dir = parent / &quot;.git&quot;
        if git_dir.exists():
            return parent

    return None


def find_project_agent_md(project_root: Path) -&gt; list[Path]:
    &quot;&quot;&quot;Find project-specific agent.md file(s).

    Checks two locations and returns ALL that exist:
    1. project_root/.deepagents/agent.md
    2. project_root/agent.md

    Both files will be loaded and combined if both exist.

    Args:
        project_root: Path to the project root directory.

    Returns:
        List of paths to project agent.md files (may contain 0, 1, or 2 paths).
    &quot;&quot;&quot;
    paths = []

    # Check .deepagents/agent.md (preferred)
    deepagents_md = project_root / &quot;.deepagents&quot; / &quot;agent.md&quot;
    if deepagents_md.exists():
        paths.append(deepagents_md)

    # Check root agent.md (fallback, but also include if both exist)
    root_md = project_root / &quot;agent.md&quot;
    if root_md.exists():
        paths.append(root_md)

    return paths</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/project_utils/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="protocol Imported skill protocol from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/backends/protocol.py Unknown LICENSE sources/langchain/protocol/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">protocol</div>
                <button class="copy-btn" onclick="copyToClipboard('protocol')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill protocol from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Protocol definition for pluggable memory backends.

This module defines the BackendProtocol that all backend implementations
must follow. Backends can store files in different locations (state, filesystem,
database, etc.) and provide a uniform interface for file operations.
&quot;&quot;&quot;

import abc
import asyncio
from collections.abc import Callable
from dataclasses import dataclass
from typing import Any, Literal, NotRequired, TypeAlias

from langchain.tools import ToolRuntime
from typing_extensions import TypedDict

FileOperationError = Literal[
    &quot;file_not_found&quot;,  # Download: file doesn&#x27;t exist
    &quot;permission_denied&quot;,  # Both: access denied
    &quot;is_directory&quot;,  # Download: tried to download directory as file
    &quot;invalid_path&quot;,  # Both: path syntax malformed (parent dir missing, invalid chars)
]
&quot;&quot;&quot;Standardized error codes for file upload/download operations.

These represent common, recoverable errors that an LLM can understand and potentially fix:
- file_not_found: The requested file doesn&#x27;t exist (download)
- parent_not_found: The parent directory doesn&#x27;t exist (upload)
- permission_denied: Access denied for the operation
- is_directory: Attempted to download a directory as a file
- invalid_path: Path syntax is malformed or contains invalid characters
&quot;&quot;&quot;


@dataclass
class FileDownloadResponse:
    &quot;&quot;&quot;Result of a single file download operation.

    The response is designed to allow partial success in batch operations.
    The errors are standardized using FileOperationError literals
    for certain recoverable conditions for use cases that involve
    LLMs performing file operations.

    Attributes:
        path: The file path that was requested. Included for easy correlation
            when processing batch results, especially useful for error messages.
        content: File contents as bytes on success, None on failure.
        error: Standardized error code on failure, None on success.
            Uses FileOperationError literal for structured, LLM-actionable error reporting.

    Examples:
        &gt;&gt;&gt; # Success
        &gt;&gt;&gt; FileDownloadResponse(path=&quot;/app/config.json&quot;, content=b&quot;{...}&quot;, error=None)
        &gt;&gt;&gt; # Failure
        &gt;&gt;&gt; FileDownloadResponse(path=&quot;/wrong/path.txt&quot;, content=None, error=&quot;file_not_found&quot;)
    &quot;&quot;&quot;

    path: str
    content: bytes | None = None
    error: FileOperationError | None = None


@dataclass
class FileUploadResponse:
    &quot;&quot;&quot;Result of a single file upload operation.

    The response is designed to allow partial success in batch operations.
    The errors are standardized using FileOperationError literals
    for certain recoverable conditions for use cases that involve
    LLMs performing file operations.

    Attributes:
        path: The file path that was requested. Included for easy correlation
            when processing batch results and for clear error messages.
        error: Standardized error code on failure, None on success.
            Uses FileOperationError literal for structured, LLM-actionable error reporting.

    Examples:
        &gt;&gt;&gt; # Success
        &gt;&gt;&gt; FileUploadResponse(path=&quot;/app/data.txt&quot;, error=None)
        &gt;&gt;&gt; # Failure
        &gt;&gt;&gt; FileUploadResponse(path=&quot;/readonly/file.txt&quot;, error=&quot;permission_denied&quot;)
    &quot;&quot;&quot;

    path: str
    error: FileOperationError | None = None


class FileInfo(TypedDict):
    &quot;&quot;&quot;Structured file listing info.

    Minimal contract used across backends. Only &quot;path&quot; is required.
    Other fields are best-effort and may be absent depending on backend.
    &quot;&quot;&quot;

    path: str
    is_dir: NotRequired[bool]
    size: NotRequired[int]  # bytes (approx)
    modified_at: NotRequired[str]  # ISO timestamp if known


class GrepMatch(TypedDict):
    &quot;&quot;&quot;Structured grep match entry.&quot;&quot;&quot;

    path: str
    line: int
    text: str


@dataclass
class WriteResult:
    &quot;&quot;&quot;Result from backend write operations.

    Attributes:
        error: Error message on failure, None on success.
        path: Absolute path of written file, None on failure.
        files_update: State update dict for checkpoint backends, None for external storage.
            Checkpoint backends populate this with {file_path: file_data} for LangGraph state.
            External backends set None (already persisted to disk/S3/database/etc).

    Examples:
        &gt;&gt;&gt; # Checkpoint storage
        &gt;&gt;&gt; WriteResult(path=&quot;/f.txt&quot;, files_update={&quot;/f.txt&quot;: {...}})
        &gt;&gt;&gt; # External storage
        &gt;&gt;&gt; WriteResult(path=&quot;/f.txt&quot;, files_update=None)
        &gt;&gt;&gt; # Error
        &gt;&gt;&gt; WriteResult(error=&quot;File exists&quot;)
    &quot;&quot;&quot;

    error: str | None = None
    path: str | None = None
    files_update: dict[str, Any] | None = None


@dataclass
class EditResult:
    &quot;&quot;&quot;Result from backend edit operations.

    Attributes:
        error: Error message on failure, None on success.
        path: Absolute path of edited file, None on failure.
        files_update: State update dict for checkpoint backends, None for external storage.
            Checkpoint backends populate this with {file_path: file_data} for LangGraph state.
            External backends set None (already persisted to disk/S3/database/etc).
        occurrences: Number of replacements made, None on failure.

    Examples:
        &gt;&gt;&gt; # Checkpoint storage
        &gt;&gt;&gt; EditResult(path=&quot;/f.txt&quot;, files_update={&quot;/f.txt&quot;: {...}}, occurrences=1)
        &gt;&gt;&gt; # External storage
        &gt;&gt;&gt; EditResult(path=&quot;/f.txt&quot;, files_update=None, occurrences=2)
        &gt;&gt;&gt; # Error
        &gt;&gt;&gt; EditResult(error=&quot;File not found&quot;)
    &quot;&quot;&quot;

    error: str | None = None
    path: str | None = None
    files_update: dict[str, Any] | None = None
    occurrences: int | None = None


class BackendProtocol(abc.ABC):
    &quot;&quot;&quot;Protocol for pluggable memory backends (single, unified).

    Backends can store files in different locations (state, filesystem, database, etc.)
    and provide a uniform interface for file operations.

    All file data is represented as dicts with the following structure:
    {
        &quot;content&quot;: list[str], # Lines of text content
        &quot;created_at&quot;: str, # ISO format timestamp
        &quot;modified_at&quot;: str, # ISO format timestamp
    }
    &quot;&quot;&quot;

    def ls_info(self, path: str) -&gt; list[&quot;FileInfo&quot;]:
        &quot;&quot;&quot;List all files in a directory with metadata.

        Args:
            path: Absolute path to the directory to list. Must start with &#x27;/&#x27;.

        Returns:
            List of FileInfo dicts containing file metadata:

            - `path` (required): Absolute file path
            - `is_dir` (optional): True if directory
            - `size` (optional): File size in bytes
            - `modified_at` (optional): ISO 8601 timestamp
        &quot;&quot;&quot;

    async def als_info(self, path: str) -&gt; list[&quot;FileInfo&quot;]:
        &quot;&quot;&quot;Async version of ls_info.&quot;&quot;&quot;
        return await asyncio.to_thread(self.ls_info, path)

    def read(
        self,
        file_path: str,
        offset: int = 0,
        limit: int = 2000,
    ) -&gt; str:
        &quot;&quot;&quot;Read file content with line numbers.

        Args:
            file_path: Absolute path to the file to read. Must start with &#x27;/&#x27;.
            offset: Line number to start reading from (0-indexed). Default: 0.
            limit: Maximum number of lines to read. Default: 2000.

        Returns:
            String containing file content formatted with line numbers (cat -n format),
            starting at line 1. Lines longer than 2000 characters are truncated.

            Returns an error string if the file doesn&#x27;t exist or can&#x27;t be read.

        !!! note
            - Use pagination (offset/limit) for large files to avoid context overflow
            - First scan: `read(path, limit=100)` to see file structure
            - Read more: `read(path, offset=100, limit=200)` for next section
            - ALWAYS read a file before editing it
            - If file exists but is empty, you&#x27;ll receive a system reminder warning
        &quot;&quot;&quot;

    async def aread(
        self,
        file_path: str,
        offset: int = 0,
        limit: int = 2000,
    ) -&gt; str:
        &quot;&quot;&quot;Async version of read.&quot;&quot;&quot;
        return await asyncio.to_thread(self.read, file_path, offset, limit)

    def grep_raw(
        self,
        pattern: str,
        path: str | None = None,
        glob: str | None = None,
    ) -&gt; list[&quot;GrepMatch&quot;] | str:
        &quot;&quot;&quot;Search for a literal text pattern in files.

        Args:
            pattern: Literal string to search for (NOT regex).
                     Performs exact substring matching within file content.
                     Example: &quot;TODO&quot; matches any line containing &quot;TODO&quot;

            path: Optional directory path to search in.
                  If None, searches in current working directory.
                  Example: &quot;/workspace/src&quot;

            glob: Optional glob pattern to filter which FILES to search.
                  Filters by filename/path, not content.
                  Supports standard glob wildcards:
                  - `*` matches any characters in filename
                  - `**` matches any directories recursively
                  - `?` matches single character
                  - `[abc]` matches one character from set

        Examples:
                  - &quot;*.py&quot; - only search Python files
                  - &quot;**/*.txt&quot; - search all .txt files recursively
                  - &quot;src/**/*.js&quot; - search JS files under src/
                  - &quot;test[0-9].txt&quot; - search test0.txt, test1.txt, etc.

        Returns:
            On success: list[GrepMatch] with structured results containing:
                - path: Absolute file path
                - line: Line number (1-indexed)
                - text: Full line content containing the match

            On error: str with error message (e.g., invalid path, permission denied)
        &quot;&quot;&quot;

    async def agrep_raw(
        self,
        pattern: str,
        path: str | None = None,
        glob: str | None = None,
    ) -&gt; list[&quot;GrepMatch&quot;] | str:
        &quot;&quot;&quot;Async version of grep_raw.&quot;&quot;&quot;
        return await asyncio.to_thread(self.grep_raw, pattern, path, glob)

    def glob_info(self, pattern: str, path: str = &quot;/&quot;) -&gt; list[&quot;FileInfo&quot;]:
        &quot;&quot;&quot;Find files matching a glob pattern.

        Args:
            pattern: Glob pattern with wildcards to match file paths.
                     Supports standard glob syntax:
                     - `*` matches any characters within a filename/directory
                     - `**` matches any directories recursively
                     - `?` matches a single character
                     - `[abc]` matches one character from set

            path: Base directory to search from. Default: &quot;/&quot; (root).
                  The pattern is applied relative to this path.

        Returns:
            list of FileInfo
        &quot;&quot;&quot;

    async def aglob_info(self, pattern: str, path: str = &quot;/&quot;) -&gt; list[&quot;FileInfo&quot;]:
        &quot;&quot;&quot;Async version of glob_info.&quot;&quot;&quot;
        return await asyncio.to_thread(self.glob_info, pattern, path)

    def write(
        self,
        file_path: str,
        content: str,
    ) -&gt; WriteResult:
        &quot;&quot;&quot;Write content to a new file in the filesystem, error if file exists.

        Args:
            file_path: Absolute path where the file should be created.
                       Must start with &#x27;/&#x27;.
            content: String content to write to the file.

        Returns:
            WriteResult
        &quot;&quot;&quot;

    async def awrite(
        self,
        file_path: str,
        content: str,
    ) -&gt; WriteResult:
        &quot;&quot;&quot;Async version of write.&quot;&quot;&quot;
        return await asyncio.to_thread(self.write, file_path, content)

    def edit(
        self,
        file_path: str,
        old_string: str,
        new_string: str,
        replace_all: bool = False,
    ) -&gt; EditResult:
        &quot;&quot;&quot;Perform exact string replacements in an existing file.

        Args:
            file_path: Absolute path to the file to edit. Must start with &#x27;/&#x27;.
            old_string: Exact string to search for and replace.
                       Must match exactly including whitespace and indentation.
            new_string: String to replace old_string with.
                       Must be different from old_string.
            replace_all: If True, replace all occurrences. If False (default),
                        old_string must be unique in the file or the edit fails.

        Returns:
            EditResult
        &quot;&quot;&quot;

    async def aedit(
        self,
        file_path: str,
        old_string: str,
        new_string: str,
        replace_all: bool = False,
    ) -&gt; EditResult:
        &quot;&quot;&quot;Async version of edit.&quot;&quot;&quot;
        return await asyncio.to_thread(self.edit, file_path, old_string, new_string, replace_all)

    def upload_files(self, files: list[tuple[str, bytes]]) -&gt; list[FileUploadResponse]:
        &quot;&quot;&quot;Upload multiple files to the sandbox.

        This API is designed to allow developers to use it either directly or
        by exposing it to LLMs via custom tools.

        Args:
            files: List of (path, content) tuples to upload.

        Returns:
            List of FileUploadResponse objects, one per input file.
            Response order matches input order (response[i] for files[i]).
            Check the error field to determine success/failure per file.

        Examples:
            ```python
            responses = sandbox.upload_files(
                [
                    (&quot;/app/config.json&quot;, b&quot;{...}&quot;),
                    (&quot;/app/data.txt&quot;, b&quot;content&quot;),
                ]
            )
            ```
        &quot;&quot;&quot;

    async def aupload_files(self, files: list[tuple[str, bytes]]) -&gt; list[FileUploadResponse]:
        &quot;&quot;&quot;Async version of upload_files.&quot;&quot;&quot;
        return await asyncio.to_thread(self.upload_files, files)

    def download_files(self, paths: list[str]) -&gt; list[FileDownloadResponse]:
        &quot;&quot;&quot;Download multiple files from the sandbox.

        This API is designed to allow developers to use it either directly or
        by exposing it to LLMs via custom tools.

        Args:
            paths: List of file paths to download.

        Returns:
            List of FileDownloadResponse objects, one per input path.
            Response order matches input order (response[i] for paths[i]).
            Check the error field to determine success/failure per file.
        &quot;&quot;&quot;

    async def adownload_files(self, paths: list[str]) -&gt; list[FileDownloadResponse]:
        &quot;&quot;&quot;Async version of download_files.&quot;&quot;&quot;
        return await asyncio.to_thread(self.download_files, paths)


@dataclass
class ExecuteResponse:
    &quot;&quot;&quot;Result of code execution.

    Simplified schema optimized for LLM consumption.
    &quot;&quot;&quot;

    output: str
    &quot;&quot;&quot;Combined stdout and stderr output of the executed command.&quot;&quot;&quot;

    exit_code: int | None = None
    &quot;&quot;&quot;The process exit code. 0 indicates success, non-zero indicates failure.&quot;&quot;&quot;

    truncated: bool = False
    &quot;&quot;&quot;Whether the output was truncated due to backend limitations.&quot;&quot;&quot;


class SandboxBackendProtocol(BackendProtocol):
    &quot;&quot;&quot;Protocol for sandboxed backends with isolated runtime.

    Sandboxed backends run in isolated environments (e.g., separate processes,
    containers) and communicate via defined interfaces.
    &quot;&quot;&quot;

    def execute(
        self,
        command: str,
    ) -&gt; ExecuteResponse:
        &quot;&quot;&quot;Execute a command in the process.

        Simplified interface optimized for LLM consumption.

        Args:
            command: Full shell command string to execute.

        Returns:
            ExecuteResponse with combined output, exit code, optional signal, and truncation flag.
        &quot;&quot;&quot;

    async def aexecute(
        self,
        command: str,
    ) -&gt; ExecuteResponse:
        &quot;&quot;&quot;Async version of execute.&quot;&quot;&quot;
        return await asyncio.to_thread(self.execute, command)

    @property
    def id(self) -&gt; str:
        &quot;&quot;&quot;Unique identifier for the sandbox backend instance.&quot;&quot;&quot;


BackendFactory: TypeAlias = Callable[[ToolRuntime], BackendProtocol]
BACKEND_TYPES = BackendProtocol | BackendFactory</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/protocol/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/backends/protocol.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="quick_validate Imported skill quick_validate from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/examples/skills/skill-creator/scripts/quick_validate.py Unknown LICENSE sources/langchain/quick_validate/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">quick_validate</div>
                <button class="copy-btn" onclick="copyToClipboard('quick_validate')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill quick_validate from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Quick validation script for skills - minimal version

For deepagents CLI, skills are located at:
~/.deepagents/&lt;agent&gt;/skills/&lt;skill-name&gt;/

Example:
 python quick_validate.py ~/.deepagents/agent/skills/my-skill
&quot;&quot;&quot;

import sys
import os
import re
import yaml
from pathlib import Path

def validate_skill(skill_path):
    &quot;&quot;&quot;Basic validation of a skill&quot;&quot;&quot;
    skill_path = Path(skill_path)

    # Check SKILL.md exists
    skill_md = skill_path / &#x27;SKILL.md&#x27;
    if not skill_md.exists():
        return False, &quot;SKILL.md not found&quot;

    # Read and validate frontmatter
    content = skill_md.read_text()
    if not content.startswith(&#x27;---&#x27;):
        return False, &quot;No YAML frontmatter found&quot;

    # Extract frontmatter
    match = re.match(r&#x27;^---\n(.*?)\n---&#x27;, content, re.DOTALL)
    if not match:
        return False, &quot;Invalid frontmatter format&quot;

    frontmatter_text = match.group(1)

    # Parse YAML frontmatter
    try:
        frontmatter = yaml.safe_load(frontmatter_text)
        if not isinstance(frontmatter, dict):
            return False, &quot;Frontmatter must be a YAML dictionary&quot;
    except yaml.YAMLError as e:
        return False, f&quot;Invalid YAML in frontmatter: {e}&quot;

    # Define allowed properties
    ALLOWED_PROPERTIES = {&#x27;name&#x27;, &#x27;description&#x27;, &#x27;license&#x27;, &#x27;allowed-tools&#x27;, &#x27;metadata&#x27;}

    # Check for unexpected properties (excluding nested keys under metadata)
    unexpected_keys = set(frontmatter.keys()) - ALLOWED_PROPERTIES
    if unexpected_keys:
        return False, (
            f&quot;Unexpected key(s) in SKILL.md frontmatter: {&#x27;, &#x27;.join(sorted(unexpected_keys))}. &quot;
            f&quot;Allowed properties are: {&#x27;, &#x27;.join(sorted(ALLOWED_PROPERTIES))}&quot;
        )

    # Check required fields
    if &#x27;name&#x27; not in frontmatter:
        return False, &quot;Missing &#x27;name&#x27; in frontmatter&quot;
    if &#x27;description&#x27; not in frontmatter:
        return False, &quot;Missing &#x27;description&#x27; in frontmatter&quot;

    # Extract name for validation
    name = frontmatter.get(&#x27;name&#x27;, &#x27;&#x27;)
    if not isinstance(name, str):
        return False, f&quot;Name must be a string, got {type(name).__name__}&quot;
    name = name.strip()
    if name:
        # Check naming convention (hyphen-case: lowercase with hyphens)
        if not re.match(r&#x27;^[a-z0-9-]+$&#x27;, name):
            return False, f&quot;Name &#x27;{name}&#x27; should be hyphen-case (lowercase letters, digits, and hyphens only)&quot;
        if name.startswith(&#x27;-&#x27;) or name.endswith(&#x27;-&#x27;) or &#x27;--&#x27; in name:
            return False, f&quot;Name &#x27;{name}&#x27; cannot start/end with hyphen or contain consecutive hyphens&quot;
        # Check name length (max 64 characters per spec)
        if len(name) &gt; 64:
            return False, f&quot;Name is too long ({len(name)} characters). Maximum is 64 characters.&quot;

    # Extract and validate description
    description = frontmatter.get(&#x27;description&#x27;, &#x27;&#x27;)
    if not isinstance(description, str):
        return False, f&quot;Description must be a string, got {type(description).__name__}&quot;
    description = description.strip()
    if description:
        # Check for angle brackets
        if &#x27;&lt;&#x27; in description or &#x27;&gt;&#x27; in description:
            return False, &quot;Description cannot contain angle brackets (&lt; or &gt;)&quot;
        # Check description length (max 1024 characters per spec)
        if len(description) &gt; 1024:
            return False, f&quot;Description is too long ({len(description)} characters). Maximum is 1024 characters.&quot;

    return True, &quot;Skill is valid!&quot;

if __name__ == &quot;__main__&quot;:
    if len(sys.argv) != 2:
        print(&quot;Usage: python quick_validate.py &lt;skill_directory&gt;&quot;)
        sys.exit(1)

    valid, message = validate_skill(sys.argv[1])
    print(message)
    sys.exit(0 if valid else 1)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/quick_validate/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="ralph_mode Imported skill ralph_mode from langchain langchain /a0/tmp/skills_research/langchain/examples/ralph_mode/ralph_mode.py Unknown LICENSE sources/langchain/ralph_mode/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">ralph_mode</div>
                <button class="copy-btn" onclick="copyToClipboard('ralph_mode')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill ralph_mode from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Ralph Mode - Autonomous looping for DeepAgents

Ralph is an autonomous looping pattern created by Geoff Huntley.
Each loop starts with fresh context. The filesystem and git serve as memory.

Usage:
    uv pip install deepagents-cli
    python ralph_mode.py &quot;Build a Python course. Use git.&quot;
    python ralph_mode.py &quot;Build a REST API&quot; --iterations 5
&quot;&quot;&quot;
import warnings
warnings.filterwarnings(&quot;ignore&quot;, message=&quot;Core Pydantic V1 functionality&quot;)

import argparse
import asyncio
import tempfile
from pathlib import Path

from deepagents_cli.agent import create_cli_agent
from deepagents_cli.config import console, COLORS, SessionState, create_model
from deepagents_cli.execution import execute_task
from deepagents_cli.ui import TokenTracker


async def ralph(task: str, max_iterations: int = 0, model_name: str = None):
    &quot;&quot;&quot;Run agent in Ralph loop with beautiful CLI output.&quot;&quot;&quot;
    work_dir = tempfile.mkdtemp(prefix=&quot;ralph-&quot;)
    
    model = create_model(model_name)
    agent, backend = create_cli_agent(
        model=model,
        assistant_id=&quot;ralph&quot;,
        tools=[],
        auto_approve=True,
    )
    session_state = SessionState(auto_approve=True)
    token_tracker = TokenTracker()
    
    console.print(f&quot;\n[bold {COLORS[&#x27;primary&#x27;]}]Ralph Mode[/bold {COLORS[&#x27;primary&#x27;]}]&quot;)
    console.print(f&quot;[dim]Task: {task}[/dim]&quot;)
    console.print(f&quot;[dim]Iterations: {&#x27;unlimited (Ctrl+C to stop)&#x27; if max_iterations == 0 else max_iterations}[/dim]&quot;)
    console.print(f&quot;[dim]Working directory: {work_dir}[/dim]\n&quot;)
    
    iteration = 1
    try:
        while max_iterations == 0 or iteration &lt;= max_iterations:
            console.print(f&quot;\n[bold cyan]{&#x27;=&#x27;*60}[/bold cyan]&quot;)
            console.print(f&quot;[bold cyan]RALPH ITERATION {iteration}[/bold cyan]&quot;)
            console.print(f&quot;[bold cyan]{&#x27;=&#x27;*60}[/bold cyan]\n&quot;)
            
            iter_display = f&quot;{iteration}/{max_iterations}&quot; if max_iterations &gt; 0 else str(iteration)
            prompt = f&quot;&quot;&quot;## Iteration {iter_display}

Your previous work is in the filesystem. Check what exists and keep building.

TASK:
{task}

Make progress. You&#x27;ll be called again.&quot;&quot;&quot;

            await execute_task(
                prompt,
                agent,
                &quot;ralph&quot;,
                session_state,
                token_tracker,
                backend=backend,
            )
            
            console.print(f&quot;\n[dim]...continuing to iteration {iteration + 1}[/dim]&quot;)
            iteration += 1
            
    except KeyboardInterrupt:
        console.print(f&quot;\n[bold yellow]Stopped after {iteration} iterations[/bold yellow]&quot;)
    
    # Show created files
    console.print(f&quot;\n[bold]Files created in {work_dir}:[/bold]&quot;)
    for f in sorted(Path(work_dir).rglob(&quot;*&quot;)):
        if f.is_file() and &quot;.git&quot; not in str(f):
            console.print(f&quot;  {f.relative_to(work_dir)}&quot;, style=&quot;dim&quot;)


def main():
    parser = argparse.ArgumentParser(
        description=&quot;Ralph Mode - Autonomous looping for DeepAgents&quot;,
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog=&quot;&quot;&quot;
Examples:
  python ralph_mode.py &quot;Build a Python course. Use git.&quot;
  python ralph_mode.py &quot;Build a REST API&quot; --iterations 5
  python ralph_mode.py &quot;Create a CLI tool&quot; --model claude-haiku-4-5-20251001
        &quot;&quot;&quot;
    )
    parser.add_argument(&quot;task&quot;, help=&quot;Task to work on (declarative, what you want)&quot;)
    parser.add_argument(&quot;--iterations&quot;, type=int, default=0, help=&quot;Max iterations (0 = unlimited, default: unlimited)&quot;)
    parser.add_argument(&quot;--model&quot;, help=&quot;Model to use (e.g., claude-haiku-4-5-20251001)&quot;)
    args = parser.parse_args()

    try:
        asyncio.run(ralph(args.task, args.iterations, args.model))
    except KeyboardInterrupt:
        pass  # Clean exit on Ctrl+C


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/ralph_mode/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="readme Imported skill readme from langchain langchain /a0/tmp/skills_research/langchain/examples/content-builder-agent/README.md Unknown LICENSE sources/langchain/readme/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">readme</div>
                <button class="copy-btn" onclick="copyToClipboard('readme')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill readme from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Content Builder Agent

&lt;img width=&quot;1255&quot; height=&quot;756&quot; alt=&quot;content-cover-image&quot; src=&quot;https://github.com/user-attachments/assets/4ebe0aba-2780-4644-8a00-ed4b96680dc9&quot; /&gt;

A content writing agent for writing blog posts, LinkedIn posts, and tweets with cover images included.

**This example demonstrates how to define an agent through three filesystem primitives:**
- **Memory** (`AGENTS.md`)  persistent context like brand voice and style guidelines
- **Skills** (`skills/*/SKILL.md`)  workflows for specific tasks, loaded on demand
- **Subagents** (`subagents.yaml`)  specialized agents for delegated tasks like research

The `content_writer.py` script shows how to combine these into a working agent.

## Quick Start

```bash
# Set API keys
export ANTHROPIC_API_KEY=&quot;...&quot;
export GOOGLE_API_KEY=&quot;...&quot;      # For image generation
export TAVILY_API_KEY=&quot;...&quot;      # For web search (optional)

# Run (uv automatically installs dependencies on first run)
cd examples/content-builder-agent
uv run python content_writer.py &quot;Write a blog post about prompt engineering&quot;
```

**More examples:**
```bash
uv run python content_writer.py &quot;Create a LinkedIn post about AI agents&quot;
uv run python content_writer.py &quot;Write a Twitter thread about the future of coding&quot;
```

## How It Works

The agent is configured by files on disk, not code:

```
content-builder-agent/
 AGENTS.md                    # Brand voice &amp; style guide
 subagents.yaml               # Subagent definitions
 skills/
    blog-post/
       SKILL.md             # Blog writing workflow
    social-media/
        SKILL.md             # Social media workflow
 content_writer.py            # Wires it together (includes tools)
```

| File | Purpose | When Loaded |
|------|---------|-------------|
| `AGENTS.md` | Brand voice, tone, writing standards | Always (system prompt) |
| `subagents.yaml` | Research and other delegated tasks | Always (defines `task` tool) |
| `skills/*/SKILL.md` | Content-specific workflows | On demand |

**What&#x27;s in the skills?** Each skill teaches the agent a specific workflow:
- **Blog posts:** Structure (hook  context  main content  CTA), SEO best practices, research-first approach
- **Social media:** Platform-specific formats (LinkedIn character limits, Twitter thread structure), hashtag usage
- **Image generation:** Detailed prompt engineering guides with examples for different content types (technical posts, announcements, thought leadership)

## Architecture

```python
agent = create_deep_agent(
    memory=[&quot;./AGENTS.md&quot;],                        #  Middleware loads into system prompt
    skills=[&quot;./skills/&quot;],                          #  Middleware loads on demand
    tools=[generate_cover, generate_social_image], #  Image generation tools
    subagents=load_subagents(&quot;./subagents.yaml&quot;),  #  See note below
    backend=FilesystemBackend(root_dir=&quot;./&quot;),
)
```

The `memory` and `skills` parameters are handled natively by deepagents middleware. Tools are defined in the script and passed directly.

**Note on subagents:** Unlike `memory` and `skills`, subagents must be defined in code. We use a small `load_subagents()` helper to externalize config to YAML. You can also define them inline:

```python
subagents=[
    {
        &quot;name&quot;: &quot;researcher&quot;,
        &quot;description&quot;: &quot;Research topics before writing...&quot;,
        &quot;model&quot;: &quot;anthropic:claude-haiku-4-5-20251001&quot;,
        &quot;system_prompt&quot;: &quot;You are a research assistant...&quot;,
        &quot;tools&quot;: [web_search],
    }
],
```

**Flow:**
1. Agent receives task  loads relevant skill (blog-post or social-media)
2. Delegates research to `researcher` subagent  saves to `research/`
3. Writes content following skill workflow  saves to `blogs/` or `linkedin/`
4. Generates cover image with Gemini  saves alongside content

## Output

```
blogs/
 prompt-engineering/
     post.md       # Blog content
     hero.png      # Generated cover image

linkedin/
 ai-agents/
     post.md       # Post content
     image.png     # Generated image

research/
 prompt-engineering.md   # Research notes
```

## Customizing

**Change the voice:** Edit `AGENTS.md` to modify brand tone and style.

**Add a content type:** Create `skills/&lt;name&gt;/SKILL.md` with YAML frontmatter:
```yaml
---
name: newsletter
description: Use this skill when writing email newsletters
---
# Newsletter Skill
...
```

**Add a subagent:** Add to `subagents.yaml`:
```yaml
editor:
  description: Review and improve drafted content
  model: anthropic:claude-haiku-4-5-20251001
  system_prompt: |
    You are an editor. Review the content and suggest improvements...
  tools: []
```

**Add a tool:** Define it in `content_writer.py` with the `@tool` decorator and add to `tools=[]`.

## Security Note

This agent has filesystem access and can read, write, and delete files on your machine. Review generated content before publishing and avoid running in directories with sensitive data.

## Requirements

- Python 3.11+
- `ANTHROPIC_API_KEY` - For the main agent
- `GOOGLE_API_KEY` - For image generation (uses Gemini&#x27;s [Imagen / &quot;nano banana&quot;](https://ai.google.dev/gemini-api/docs/image-generation) via `gemini-2.5-flash-image`)
- `TAVILY_API_KEY` - For web search (optional, research still works without it)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/readme/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="runloop Imported skill runloop from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/integrations/runloop.py Unknown LICENSE sources/langchain/runloop/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">runloop</div>
                <button class="copy-btn" onclick="copyToClipboard('runloop')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill runloop from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;BackendProtocol implementation for Runloop.&quot;&quot;&quot;

try:
    import runloop_api_client
except ImportError:
    msg = (
        &quot;runloop_api_client package is required for RunloopBackend. &quot;
        &quot;Install with `pip install runloop_api_client`.&quot;
    )
    raise ImportError(msg)

import os

from deepagents.backends.protocol import ExecuteResponse, FileDownloadResponse, FileUploadResponse
from deepagents.backends.sandbox import BaseSandbox
from runloop_api_client import Runloop


class RunloopBackend(BaseSandbox):
    &quot;&quot;&quot;Backend that operates on files in a Runloop devbox.

    This implementation uses the Runloop API client to execute commands
    and manipulate files within a remote devbox environment.
    &quot;&quot;&quot;

    def __init__(
        self,
        devbox_id: str,
        client: Runloop | None = None,
        api_key: str | None = None,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize Runloop protocol.

        Args:
            devbox_id: ID of the Runloop devbox to operate on.
            client: Optional existing Runloop client instance
            api_key: Optional API key for creating a new client
                         (defaults to RUNLOOP_API_KEY environment variable)
        &quot;&quot;&quot;
        if client and api_key:
            msg = &quot;Provide either client or bearer_token, not both.&quot;
            raise ValueError(msg)

        if client is None:
            api_key = api_key or os.environ.get(&quot;RUNLOOP_API_KEY&quot;, None)
            if api_key is None:
                msg = &quot;Either client or bearer_token must be provided.&quot;
                raise ValueError(msg)
            client = Runloop(bearer_token=api_key)

        self._client = client
        self._devbox_id = devbox_id
        self._timeout = 30 * 60

    @property
    def id(self) -&gt; str:
        &quot;&quot;&quot;Unique identifier for the sandbox backend.&quot;&quot;&quot;
        return self._devbox_id

    def execute(
        self,
        command: str,
    ) -&gt; ExecuteResponse:
        &quot;&quot;&quot;Execute a command in the devbox and return ExecuteResponse.

        Args:
            command: Full shell command string to execute.
            timeout: Maximum execution time in seconds (default: 30 minutes).

        Returns:
            ExecuteResponse with combined output, exit code, optional signal, and truncation flag.
        &quot;&quot;&quot;
        result = self._client.devboxes.execute_and_await_completion(
            devbox_id=self._devbox_id,
            command=command,
            timeout=self._timeout,
        )
        # Combine stdout and stderr
        output = result.stdout or &quot;&quot;
        if result.stderr:
            output += &quot;\n&quot; + result.stderr if output else result.stderr

        return ExecuteResponse(
            output=output,
            exit_code=result.exit_status,
            truncated=False,  # Runloop doesn&#x27;t provide truncation info
        )

    def download_files(self, paths: list[str]) -&gt; list[FileDownloadResponse]:
        &quot;&quot;&quot;Download multiple files from the Runloop devbox.

        Downloads files individually using the Runloop API. Returns a list of
        FileDownloadResponse objects preserving order and reporting per-file
        errors rather than raising exceptions.

        TODO: Implement proper error handling with standardized FileOperationError codes.
        Currently only implements happy path.
        &quot;&quot;&quot;
        responses: list[FileDownloadResponse] = []
        for path in paths:
            # devboxes.download_file returns a BinaryAPIResponse which exposes .read()
            resp = self._client.devboxes.download_file(self._devbox_id, path=path)
            content = resp.read()
            responses.append(FileDownloadResponse(path=path, content=content, error=None))

        return responses

    def upload_files(self, files: list[tuple[str, bytes]]) -&gt; list[FileUploadResponse]:
        &quot;&quot;&quot;Upload multiple files to the Runloop devbox.

        Uploads files individually using the Runloop API. Returns a list of
        FileUploadResponse objects preserving order and reporting per-file
        errors rather than raising exceptions.

        TODO: Implement proper error handling with standardized FileOperationError codes.
        Currently only implements happy path.
        &quot;&quot;&quot;
        responses: list[FileUploadResponse] = []
        for path, content in files:
            # The Runloop client expects &#x27;file&#x27; as bytes or a file-like object
            self._client.devboxes.upload_file(self._devbox_id, path=path, file=content)
            responses.append(FileUploadResponse(path=path, error=None))

        return responses</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/runloop/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="sandbox Imported skill sandbox from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/backends/sandbox.py Unknown LICENSE sources/langchain/sandbox/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">sandbox</div>
                <button class="copy-btn" onclick="copyToClipboard('sandbox')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill sandbox from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Base sandbox implementation with execute() as the only abstract method.

This module provides a base class that implements all SandboxBackendProtocol
methods using shell commands executed via execute(). Concrete implementations
only need to implement the execute() method.
&quot;&quot;&quot;

from __future__ import annotations

import base64
import json
import shlex
from abc import ABC, abstractmethod

from deepagents.backends.protocol import (
    EditResult,
    ExecuteResponse,
    FileDownloadResponse,
    FileInfo,
    FileUploadResponse,
    GrepMatch,
    SandboxBackendProtocol,
    WriteResult,
)

_GLOB_COMMAND_TEMPLATE = &quot;&quot;&quot;python3 -c &quot;
import glob
import os
import json
import base64

# Decode base64-encoded parameters
path = base64.b64decode(&#x27;{path_b64}&#x27;).decode(&#x27;utf-8&#x27;)
pattern = base64.b64decode(&#x27;{pattern_b64}&#x27;).decode(&#x27;utf-8&#x27;)

os.chdir(path)
matches = sorted(glob.glob(pattern, recursive=True))
for m in matches:
    stat = os.stat(m)
    result = {{
        &#x27;path&#x27;: m,
        &#x27;size&#x27;: stat.st_size,
        &#x27;mtime&#x27;: stat.st_mtime,
        &#x27;is_dir&#x27;: os.path.isdir(m)
    }}
    print(json.dumps(result))
&quot; 2&gt;/dev/null&quot;&quot;&quot;

_WRITE_COMMAND_TEMPLATE = &quot;&quot;&quot;python3 -c &quot;
import os
import sys
import base64

file_path = &#x27;{file_path}&#x27;

# Check if file already exists (atomic with write)
if os.path.exists(file_path):
    print(f&#x27;Error: File \\&#x27;{file_path}\\&#x27; already exists&#x27;, file=sys.stderr)
    sys.exit(1)

# Create parent directory if needed
parent_dir = os.path.dirname(file_path) or &#x27;.&#x27;
os.makedirs(parent_dir, exist_ok=True)

# Decode and write content
content = base64.b64decode(&#x27;{content_b64}&#x27;).decode(&#x27;utf-8&#x27;)
with open(file_path, &#x27;w&#x27;) as f:
    f.write(content)
&quot; 2&gt;&amp;1&quot;&quot;&quot;

_EDIT_COMMAND_TEMPLATE = &quot;&quot;&quot;python3 -c &quot;
import sys
import base64

# Read file content
with open(&#x27;{file_path}&#x27;, &#x27;r&#x27;) as f:
    text = f.read()

# Decode base64-encoded strings
old = base64.b64decode(&#x27;{old_b64}&#x27;).decode(&#x27;utf-8&#x27;)
new = base64.b64decode(&#x27;{new_b64}&#x27;).decode(&#x27;utf-8&#x27;)

# Count occurrences
count = text.count(old)

# Exit with error codes if issues found
if count == 0:
    sys.exit(1)  # String not found
elif count &gt; 1 and not {replace_all}:
    sys.exit(2)  # Multiple occurrences without replace_all

# Perform replacement
if {replace_all}:
    result = text.replace(old, new)
else:
    result = text.replace(old, new, 1)

# Write back to file
with open(&#x27;{file_path}&#x27;, &#x27;w&#x27;) as f:
    f.write(result)

print(count)
&quot; 2&gt;&amp;1&quot;&quot;&quot;

_READ_COMMAND_TEMPLATE = &quot;&quot;&quot;python3 -c &quot;
import os
import sys

file_path = &#x27;{file_path}&#x27;
offset = {offset}
limit = {limit}

# Check if file exists
if not os.path.isfile(file_path):
    print(&#x27;Error: File not found&#x27;)
    sys.exit(1)

# Check if file is empty
if os.path.getsize(file_path) == 0:
    print(&#x27;System reminder: File exists but has empty contents&#x27;)
    sys.exit(0)

# Read file with offset and limit
with open(file_path, &#x27;r&#x27;) as f:
    lines = f.readlines()

# Apply offset and limit
start_idx = offset
end_idx = offset + limit
selected_lines = lines[start_idx:end_idx]

# Format with line numbers (1-indexed, starting from offset + 1)
for i, line in enumerate(selected_lines):
    line_num = offset + i + 1
    # Remove trailing newline for formatting, then add it back
    line_content = line.rstrip(&#x27;\\n&#x27;)
    print(f&#x27;{{line_num:6d}}\\t{{line_content}}&#x27;)
&quot; 2&gt;&amp;1&quot;&quot;&quot;


class BaseSandbox(SandboxBackendProtocol, ABC):
    &quot;&quot;&quot;Base sandbox implementation with execute() as abstract method.

    This class provides default implementations for all protocol methods
    using shell commands. Subclasses only need to implement execute().
    &quot;&quot;&quot;

    @abstractmethod
    def execute(
        self,
        command: str,
    ) -&gt; ExecuteResponse:
        &quot;&quot;&quot;Execute a command in the sandbox and return ExecuteResponse.

        Args:
            command: Full shell command string to execute.

        Returns:
            ExecuteResponse with combined output, exit code, optional signal, and truncation flag.
        &quot;&quot;&quot;
        ...

    def ls_info(self, path: str) -&gt; list[FileInfo]:
        &quot;&quot;&quot;Structured listing with file metadata using os.scandir.&quot;&quot;&quot;
        cmd = f&quot;&quot;&quot;python3 -c &quot;
import os
import json

path = &#x27;{path}&#x27;

try:
    with os.scandir(path) as it:
        for entry in it:
            result = {{
                &#x27;path&#x27;: os.path.join(path, entry.name),
                &#x27;is_dir&#x27;: entry.is_dir(follow_symlinks=False)
            }}
            print(json.dumps(result))
except FileNotFoundError:
    pass
except PermissionError:
    pass
&quot; 2&gt;/dev/null&quot;&quot;&quot;

        result = self.execute(cmd)

        file_infos: list[FileInfo] = []
        for line in result.output.strip().split(&quot;\n&quot;):
            if not line:
                continue
            try:
                data = json.loads(line)
                file_infos.append({&quot;path&quot;: data[&quot;path&quot;], &quot;is_dir&quot;: data[&quot;is_dir&quot;]})
            except json.JSONDecodeError:
                continue

        return file_infos

    def read(
        self,
        file_path: str,
        offset: int = 0,
        limit: int = 2000,
    ) -&gt; str:
        &quot;&quot;&quot;Read file content with line numbers using a single shell command.&quot;&quot;&quot;
        # Use template for reading file with offset and limit
        cmd = _READ_COMMAND_TEMPLATE.format(file_path=file_path, offset=offset, limit=limit)
        result = self.execute(cmd)

        output = result.output.rstrip()
        exit_code = result.exit_code

        if exit_code != 0 or &quot;Error: File not found&quot; in output:
            return f&quot;Error: File &#x27;{file_path}&#x27; not found&quot;

        return output

    def write(
        self,
        file_path: str,
        content: str,
    ) -&gt; WriteResult:
        &quot;&quot;&quot;Create a new file. Returns WriteResult; error populated on failure.&quot;&quot;&quot;
        # Encode content as base64 to avoid any escaping issues
        content_b64 = base64.b64encode(content.encode(&quot;utf-8&quot;)).decode(&quot;ascii&quot;)

        # Single atomic check + write command
        cmd = _WRITE_COMMAND_TEMPLATE.format(file_path=file_path, content_b64=content_b64)
        result = self.execute(cmd)

        # Check for errors (exit code or error message in output)
        if result.exit_code != 0 or &quot;Error:&quot; in result.output:
            error_msg = result.output.strip() or f&quot;Failed to write file &#x27;{file_path}&#x27;&quot;
            return WriteResult(error=error_msg)

        # External storage - no files_update needed
        return WriteResult(path=file_path, files_update=None)

    def edit(
        self,
        file_path: str,
        old_string: str,
        new_string: str,
        replace_all: bool = False,
    ) -&gt; EditResult:
        &quot;&quot;&quot;Edit a file by replacing string occurrences. Returns EditResult.&quot;&quot;&quot;
        # Encode strings as base64 to avoid any escaping issues
        old_b64 = base64.b64encode(old_string.encode(&quot;utf-8&quot;)).decode(&quot;ascii&quot;)
        new_b64 = base64.b64encode(new_string.encode(&quot;utf-8&quot;)).decode(&quot;ascii&quot;)

        # Use template for string replacement
        cmd = _EDIT_COMMAND_TEMPLATE.format(file_path=file_path, old_b64=old_b64, new_b64=new_b64, replace_all=replace_all)
        result = self.execute(cmd)

        exit_code = result.exit_code
        output = result.output.strip()

        if exit_code == 1:
            return EditResult(error=f&quot;Error: String not found in file: &#x27;{old_string}&#x27;&quot;)
        if exit_code == 2:
            return EditResult(error=f&quot;Error: String &#x27;{old_string}&#x27; appears multiple times. Use replace_all=True to replace all occurrences.&quot;)
        if exit_code != 0:
            return EditResult(error=f&quot;Error: File &#x27;{file_path}&#x27; not found&quot;)

        count = int(output)
        # External storage - no files_update needed
        return EditResult(path=file_path, files_update=None, occurrences=count)

    def grep_raw(
        self,
        pattern: str,
        path: str | None = None,
        glob: str | None = None,
    ) -&gt; list[GrepMatch] | str:
        &quot;&quot;&quot;Structured search results or error string for invalid input.&quot;&quot;&quot;
        search_path = shlex.quote(path or &quot;.&quot;)

        # Build grep command to get structured output
        grep_opts = &quot;-rHnF&quot;  # recursive, with filename, with line number, fixed-strings (literal)

        # Add glob pattern if specified
        glob_pattern = &quot;&quot;
        if glob:
            glob_pattern = f&quot;--include=&#x27;{glob}&#x27;&quot;

        # Escape pattern for shell
        pattern_escaped = shlex.quote(pattern)

        cmd = f&quot;grep {grep_opts} {glob_pattern} -e {pattern_escaped} {search_path} 2&gt;/dev/null || true&quot;
        result = self.execute(cmd)

        output = result.output.rstrip()
        if not output:
            return []

        # Parse grep output into GrepMatch objects
        matches: list[GrepMatch] = []
        for line in output.split(&quot;\n&quot;):
            # Format is: path:line_number:text
            parts = line.split(&quot;:&quot;, 2)
            if len(parts) &gt;= 3:
                matches.append(
                    {
                        &quot;path&quot;: parts[0],
                        &quot;line&quot;: int(parts[1]),
                        &quot;text&quot;: parts[2],
                    }
                )

        return matches

    def glob_info(self, pattern: str, path: str = &quot;/&quot;) -&gt; list[FileInfo]:
        &quot;&quot;&quot;Structured glob matching returning FileInfo dicts.&quot;&quot;&quot;
        # Encode pattern and path as base64 to avoid escaping issues
        pattern_b64 = base64.b64encode(pattern.encode(&quot;utf-8&quot;)).decode(&quot;ascii&quot;)
        path_b64 = base64.b64encode(path.encode(&quot;utf-8&quot;)).decode(&quot;ascii&quot;)

        cmd = _GLOB_COMMAND_TEMPLATE.format(path_b64=path_b64, pattern_b64=pattern_b64)
        result = self.execute(cmd)

        output = result.output.strip()
        if not output:
            return []

        # Parse JSON output into FileInfo dicts
        file_infos: list[FileInfo] = []
        for line in output.split(&quot;\n&quot;):
            try:
                data = json.loads(line)
                file_infos.append(
                    {
                        &quot;path&quot;: data[&quot;path&quot;],
                        &quot;is_dir&quot;: data[&quot;is_dir&quot;],
                    }
                )
            except json.JSONDecodeError:
                continue

        return file_infos

    @property
    @abstractmethod
    def id(self) -&gt; str:
        &quot;&quot;&quot;Unique identifier for the sandbox backend.&quot;&quot;&quot;

    @abstractmethod
    def upload_files(self, files: list[tuple[str, bytes]]) -&gt; list[FileUploadResponse]:
        &quot;&quot;&quot;Upload multiple files to the sandbox.

        Implementations must support partial success - catch exceptions per-file
        and return errors in FileUploadResponse objects rather than raising.
        &quot;&quot;&quot;

    @abstractmethod
    def download_files(self, paths: list[str]) -&gt; list[FileDownloadResponse]:
        &quot;&quot;&quot;Download multiple files from the sandbox.

        Implementations must support partial success - catch exceptions per-file
        and return errors in FileDownloadResponse objects rather than raising.
        &quot;&quot;&quot;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/sandbox/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/backends/sandbox.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="sandbox_factory Imported skill sandbox_factory from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/integrations/sandbox_factory.py Unknown LICENSE sources/langchain/sandbox_factory/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">sandbox_factory</div>
                <button class="copy-btn" onclick="copyToClipboard('sandbox_factory')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill sandbox_factory from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Sandbox lifecycle management with context managers.&quot;&quot;&quot;

import os
import shlex
import string
import time
from collections.abc import Generator
from contextlib import contextmanager
from pathlib import Path

from deepagents.backends.protocol import SandboxBackendProtocol

from deepagents_cli.config import console


def _run_sandbox_setup(backend: SandboxBackendProtocol, setup_script_path: str) -&gt; None:
    &quot;&quot;&quot;Run users setup script in sandbox with env var expansion.

    Args:
        backend: Sandbox backend instance
        setup_script_path: Path to setup script file
    &quot;&quot;&quot;
    script_path = Path(setup_script_path)
    if not script_path.exists():
        msg = f&quot;Setup script not found: {setup_script_path}&quot;
        raise FileNotFoundError(msg)

    console.print(f&quot;[dim]Running setup script: {setup_script_path}...[/dim]&quot;)

    # Read script content
    script_content = script_path.read_text()

    # Expand ${VAR} syntax using local environment
    template = string.Template(script_content)
    expanded_script = template.safe_substitute(os.environ)

    # Execute in sandbox with 5-minute timeout
    result = backend.execute(f&quot;bash -c {shlex.quote(expanded_script)}&quot;)

    if result.exit_code != 0:
        console.print(f&quot;[red] Setup script failed (exit {result.exit_code}):[/red]&quot;)
        console.print(f&quot;[dim]{result.output}[/dim]&quot;)
        msg = &quot;Setup failed - aborting&quot;
        raise RuntimeError(msg)

    console.print(&quot;[green] Setup complete[/green]&quot;)


@contextmanager
def create_modal_sandbox(
    *, sandbox_id: str | None = None, setup_script_path: str | None = None
) -&gt; Generator[SandboxBackendProtocol, None, None]:
    &quot;&quot;&quot;Create or connect to Modal sandbox.

    Args:
        sandbox_id: Optional existing sandbox ID to reuse
        setup_script_path: Optional path to setup script to run after sandbox starts

    Yields:
        (ModalBackend, sandbox_id)

    Raises:
        ImportError: Modal SDK not installed
        Exception: Sandbox creation/connection failed
        FileNotFoundError: Setup script not found
        RuntimeError: Setup script failed
    &quot;&quot;&quot;
    import modal

    from deepagents_cli.integrations.modal import ModalBackend

    console.print(&quot;[yellow]Starting Modal sandbox...[/yellow]&quot;)

    # Create ephemeral app (auto-cleans up on exit)
    app = modal.App(&quot;deepagents-sandbox&quot;)

    with app.run():
        if sandbox_id:
            sandbox = modal.Sandbox.from_id(sandbox_id=sandbox_id, app=app)
            should_cleanup = False
        else:
            sandbox = modal.Sandbox.create(app=app, workdir=&quot;/workspace&quot;)
            should_cleanup = True

            # Poll until running (Modal requires this)
            for _ in range(90):  # 180s timeout (90 * 2s)
                if sandbox.poll() is not None:  # Sandbox terminated unexpectedly
                    msg = &quot;Modal sandbox terminated unexpectedly during startup&quot;
                    raise RuntimeError(msg)
                # Check if sandbox is ready by attempting a simple command
                try:
                    process = sandbox.exec(&quot;echo&quot;, &quot;ready&quot;, timeout=5)
                    process.wait()
                    if process.returncode == 0:
                        break
                except Exception:
                    pass
                time.sleep(2)
            else:
                # Timeout - cleanup and fail
                sandbox.terminate()
                msg = &quot;Modal sandbox failed to start within 180 seconds&quot;
                raise RuntimeError(msg)

        backend = ModalBackend(sandbox)
        console.print(f&quot;[green] Modal sandbox ready: {backend.id}[/green]&quot;)

        # Run setup script if provided
        if setup_script_path:
            _run_sandbox_setup(backend, setup_script_path)
        try:
            yield backend
        finally:
            if should_cleanup:
                try:
                    console.print(f&quot;[dim]Terminating Modal sandbox {sandbox_id}...[/dim]&quot;)
                    sandbox.terminate()
                    console.print(f&quot;[dim] Modal sandbox {sandbox_id} terminated[/dim]&quot;)
                except Exception as e:
                    console.print(f&quot;[yellow] Cleanup failed: {e}[/yellow]&quot;)


@contextmanager
def create_runloop_sandbox(
    *, sandbox_id: str | None = None, setup_script_path: str | None = None
) -&gt; Generator[SandboxBackendProtocol, None, None]:
    &quot;&quot;&quot;Create or connect to Runloop devbox.

    Args:
        sandbox_id: Optional existing devbox ID to reuse
        setup_script_path: Optional path to setup script to run after sandbox starts

    Yields:
        (RunloopBackend, devbox_id)

    Raises:
        ImportError: Runloop SDK not installed
        ValueError: RUNLOOP_API_KEY not set
        RuntimeError: Devbox failed to start within timeout
        FileNotFoundError: Setup script not found
        RuntimeError: Setup script failed
    &quot;&quot;&quot;
    from runloop_api_client import Runloop

    from deepagents_cli.integrations.runloop import RunloopBackend

    bearer_token = os.environ.get(&quot;RUNLOOP_API_KEY&quot;)
    if not bearer_token:
        msg = &quot;RUNLOOP_API_KEY environment variable not set&quot;
        raise ValueError(msg)

    client = Runloop(bearer_token=bearer_token)

    console.print(&quot;[yellow]Starting Runloop devbox...[/yellow]&quot;)

    if sandbox_id:
        devbox = client.devboxes.retrieve(id=sandbox_id)
        should_cleanup = False
    else:
        devbox = client.devboxes.create()
        sandbox_id = devbox.id
        should_cleanup = True

        # Poll until running (Runloop requires this)
        for _ in range(90):  # 180s timeout (90 * 2s)
            status = client.devboxes.retrieve(id=devbox.id)
            if status.status == &quot;running&quot;:
                break
            time.sleep(2)
        else:
            # Timeout - cleanup and fail
            client.devboxes.shutdown(id=devbox.id)
            msg = &quot;Devbox failed to start within 180 seconds&quot;
            raise RuntimeError(msg)

    console.print(f&quot;[green] Runloop devbox ready: {sandbox_id}[/green]&quot;)

    backend = RunloopBackend(devbox_id=devbox.id, client=client)

    # Run setup script if provided
    if setup_script_path:
        _run_sandbox_setup(backend, setup_script_path)
    try:
        yield backend
    finally:
        if should_cleanup:
            try:
                console.print(f&quot;[dim]Shutting down Runloop devbox {sandbox_id}...[/dim]&quot;)
                client.devboxes.shutdown(id=devbox.id)
                console.print(f&quot;[dim] Runloop devbox {sandbox_id} terminated[/dim]&quot;)
            except Exception as e:
                console.print(f&quot;[yellow] Cleanup failed: {e}[/yellow]&quot;)


@contextmanager
def create_daytona_sandbox(
    *, sandbox_id: str | None = None, setup_script_path: str | None = None
) -&gt; Generator[SandboxBackendProtocol, None, None]:
    &quot;&quot;&quot;Create Daytona sandbox.

    Args:
        sandbox_id: Optional existing sandbox ID to reuse
        setup_script_path: Optional path to setup script to run after sandbox starts

    Yields:
        (DaytonaBackend, sandbox_id)

    Note:
        Connecting to existing Daytona sandbox by ID may not be supported yet.
        If sandbox_id is provided, this will raise NotImplementedError.
    &quot;&quot;&quot;
    from daytona import Daytona, DaytonaConfig

    from deepagents_cli.integrations.daytona import DaytonaBackend

    api_key = os.environ.get(&quot;DAYTONA_API_KEY&quot;)
    if not api_key:
        msg = &quot;DAYTONA_API_KEY environment variable not set&quot;
        raise ValueError(msg)

    if sandbox_id:
        msg = (
            &quot;Connecting to existing Daytona sandbox by ID not yet supported. &quot;
            &quot;Create a new sandbox by omitting --sandbox-id.&quot;
        )
        raise NotImplementedError(msg)

    console.print(&quot;[yellow]Starting Daytona sandbox...[/yellow]&quot;)

    daytona = Daytona(DaytonaConfig(api_key=api_key))
    sandbox = daytona.create()
    sandbox_id = sandbox.id

    # Poll until running (Daytona requires this)
    for _ in range(90):  # 180s timeout (90 * 2s)
        # Check if sandbox is ready by attempting a simple command
        try:
            result = sandbox.process.exec(&quot;echo ready&quot;, timeout=5)
            if result.exit_code == 0:
                break
        except Exception:
            pass
        time.sleep(2)
    else:
        try:
            # Clean up if possible
            sandbox.delete()
        finally:
            msg = &quot;Daytona sandbox failed to start within 180 seconds&quot;
            raise RuntimeError(msg)

    backend = DaytonaBackend(sandbox)
    console.print(f&quot;[green] Daytona sandbox ready: {backend.id}[/green]&quot;)

    # Run setup script if provided
    if setup_script_path:
        _run_sandbox_setup(backend, setup_script_path)
    try:
        yield backend
    finally:
        console.print(f&quot;[dim]Deleting Daytona sandbox {sandbox_id}...[/dim]&quot;)
        try:
            sandbox.delete()
            console.print(f&quot;[dim] Daytona sandbox {sandbox_id} terminated[/dim]&quot;)
        except Exception as e:
            console.print(f&quot;[yellow] Cleanup failed: {e}[/yellow]&quot;)


_PROVIDER_TO_WORKING_DIR = {
    &quot;modal&quot;: &quot;/workspace&quot;,
    &quot;runloop&quot;: &quot;/home/user&quot;,
    &quot;daytona&quot;: &quot;/home/daytona&quot;,
}


# Mapping of sandbox types to their context manager factories
_SANDBOX_PROVIDERS = {
    &quot;modal&quot;: create_modal_sandbox,
    &quot;runloop&quot;: create_runloop_sandbox,
    &quot;daytona&quot;: create_daytona_sandbox,
}


@contextmanager
def create_sandbox(
    provider: str,
    *,
    sandbox_id: str | None = None,
    setup_script_path: str | None = None,
) -&gt; Generator[SandboxBackendProtocol, None, None]:
    &quot;&quot;&quot;Create or connect to a sandbox of the specified provider.

    This is the unified interface for sandbox creation that delegates to
    the appropriate provider-specific context manager.

    Args:
        provider: Sandbox provider (&quot;modal&quot;, &quot;runloop&quot;, &quot;daytona&quot;)
        sandbox_id: Optional existing sandbox ID to reuse
        setup_script_path: Optional path to setup script to run after sandbox starts

    Yields:
        (SandboxBackend, sandbox_id)
    &quot;&quot;&quot;
    if provider not in _SANDBOX_PROVIDERS:
        msg = (
            f&quot;Unknown sandbox provider: {provider}. &quot;
            f&quot;Available providers: {&#x27;, &#x27;.join(get_available_sandbox_types())}&quot;
        )
        raise ValueError(msg)

    sandbox_provider = _SANDBOX_PROVIDERS[provider]

    with sandbox_provider(sandbox_id=sandbox_id, setup_script_path=setup_script_path) as backend:
        yield backend


def get_available_sandbox_types() -&gt; list[str]:
    &quot;&quot;&quot;Get list of available sandbox provider types.

    Returns:
        List of sandbox type names (e.g., [&quot;modal&quot;, &quot;runloop&quot;, &quot;daytona&quot;])
    &quot;&quot;&quot;
    return list(_SANDBOX_PROVIDERS.keys())


def get_default_working_dir(provider: str) -&gt; str:
    &quot;&quot;&quot;Get the default working directory for a given sandbox provider.

    Args:
        provider: Sandbox provider name (&quot;modal&quot;, &quot;runloop&quot;, &quot;daytona&quot;)

    Returns:
        Default working directory path as string

    Raises:
        ValueError: If provider is unknown
    &quot;&quot;&quot;
    if provider in _PROVIDER_TO_WORKING_DIR:
        return _PROVIDER_TO_WORKING_DIR[provider]
    msg = f&quot;Unknown sandbox provider: {provider}&quot;
    raise ValueError(msg)


__all__ = [
    &quot;create_sandbox&quot;,
    &quot;get_available_sandbox_types&quot;,
    &quot;get_default_working_dir&quot;,
]</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/sandbox_factory/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="server Imported skill server from langchain langchain /a0/tmp/skills_research/langchain/libs/acp/deepagents_acp/server.py Unknown LICENSE sources/langchain/server/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">server</div>
                <button class="copy-btn" onclick="copyToClipboard('server')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill server from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;DeepAgents ACP server implementation.&quot;&quot;&quot;

from __future__ import annotations

import asyncio
import uuid
from typing import Any, Literal

from acp import (
    Agent,
    AgentSideConnection,
    PROTOCOL_VERSION,
    stdio_streams,
)
from acp.schema import (
    AgentMessageChunk,
    InitializeRequest,
    InitializeResponse,
    NewSessionRequest,
    NewSessionResponse,
    PromptRequest,
    PromptResponse,
    SessionNotification,
    TextContentBlock,
    Implementation,
    AgentThoughtChunk,
    ToolCallProgress,
    ContentToolCallContent,
    LoadSessionResponse,
    SetSessionModeResponse,
    SetSessionModelResponse,
    CancelNotification,
    LoadSessionRequest,
    SetSessionModeRequest,
    SetSessionModelRequest,
    AgentPlanUpdate,
    PlanEntry,
    PermissionOption,
    RequestPermissionRequest,
    AllowedOutcome,
    DeniedOutcome,
    ToolCall as ACPToolCall,
)
from deepagents import create_deep_agent
from langchain_anthropic import ChatAnthropic
from langchain_core.messages import AIMessage, AIMessageChunk, ToolMessage
from langchain_core.messages.content import ToolCall
from langchain_core.tools import tool
from langgraph.checkpoint.memory import InMemorySaver
from langgraph.graph.state import CompiledStateGraph
from langgraph.types import Command, Interrupt


class DeepagentsACP(Agent):
    &quot;&quot;&quot;ACP Agent implementation wrapping deepagents.&quot;&quot;&quot;

    def __init__(
        self,
        connection: AgentSideConnection,
        agent_graph: CompiledStateGraph,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize the DeepAgents agent.

        Args:
            connection: The ACP connection for communicating with the client
            agent_graph: A compiled LangGraph StateGraph (output of create_deep_agent)
        &quot;&quot;&quot;
        self._connection = connection
        self._agent_graph = agent_graph
        self._sessions: dict[str, dict[str, Any]] = {}
        # Track tool calls by ID for matching with ToolMessages
        # Maps tool_call_id -&gt; ToolCall TypedDict
        self._tool_calls: dict[str, ToolCall] = {}

    async def initialize(
        self,
        params: InitializeRequest,
    ) -&gt; InitializeResponse:
        &quot;&quot;&quot;Initialize the agent and return capabilities.&quot;&quot;&quot;
        return InitializeResponse(
            protocolVersion=PROTOCOL_VERSION,
            agentInfo=Implementation(
                name=&quot;DeepAgents ACP Server&quot;,
                version=&quot;0.1.0&quot;,
                title=&quot;DeepAgents ACP Server&quot;,
            ),
        )

    async def newSession(
        self,
        params: NewSessionRequest,
    ) -&gt; NewSessionResponse:
        &quot;&quot;&quot;Create a new session with a deepagents instance.&quot;&quot;&quot;
        session_id = str(uuid.uuid4())
        # Store session state with the shared agent graph
        self._sessions[session_id] = {
            &quot;agent&quot;: self._agent_graph,
            &quot;thread_id&quot;: str(uuid.uuid4()),
        }

        return NewSessionResponse(sessionId=session_id)

    async def _handle_ai_message_chunk(
        self,
        params: PromptRequest,
        message: AIMessageChunk,
    ) -&gt; None:
        &quot;&quot;&quot;Handle an AIMessageChunk and send appropriate notifications.

        Args:
            params: The prompt request parameters
            message: An AIMessageChunk from the streaming response

        Note:
            According to LangChain&#x27;s content block types, message.content_blocks
            returns a list of ContentBlock unions. Each block is a TypedDict with
            a &quot;type&quot; field that discriminates the block type:
            - TextContentBlock: type=&quot;text&quot;, has &quot;text&quot; field
            - ReasoningContentBlock: type=&quot;reasoning&quot;, has &quot;reasoning&quot; field
            - ToolCallChunk: type=&quot;tool_call_chunk&quot;
            - And many others (image, audio, video, etc.)
        &quot;&quot;&quot;
        for block in message.content_blocks:
            # All content blocks have a &quot;type&quot; field for discrimination
            block_type = block.get(&quot;type&quot;)

            if block_type == &quot;text&quot;:
                # TextContentBlock has a required &quot;text&quot; field
                text = block.get(&quot;text&quot;, &quot;&quot;)
                if not text:  # Only yield non-empty text
                    continue
                await self._connection.sessionUpdate(
                    SessionNotification(
                        update=AgentMessageChunk(
                            content=TextContentBlock(text=text, type=&quot;text&quot;),
                            sessionUpdate=&quot;agent_message_chunk&quot;,
                        ),
                        sessionId=params.sessionId,
                    )
                )
            elif block_type == &quot;reasoning&quot;:
                # ReasoningContentBlock has a &quot;reasoning&quot; field (NotRequired)
                reasoning = block.get(&quot;reasoning&quot;, &quot;&quot;)
                if not reasoning:
                    continue

                await self._connection.sessionUpdate(
                    SessionNotification(
                        update=AgentThoughtChunk(
                            content=TextContentBlock(text=reasoning, type=&quot;text&quot;),
                            sessionUpdate=&quot;agent_thought_chunk&quot;,
                        ),
                        sessionId=params.sessionId,
                    )
                )

    async def _handle_completed_tool_calls(
        self,
        params: PromptRequest,
        message: AIMessage,
    ) -&gt; None:
        &quot;&quot;&quot;Handle completed tool calls from an AIMessage and send notifications.

        Args:
            params: The prompt request parameters
            message: An AIMessage containing tool_calls

        Note:
            According to LangChain&#x27;s AIMessage type:
            - message.tool_calls: list[ToolCall] where ToolCall is a TypedDict with:
              - name: str (required)
              - args: dict[str, Any] (required)
              - id: str | None (required field, but can be None)
              - type: Literal[&quot;tool_call&quot;] (optional, NotRequired)
        &quot;&quot;&quot;
        # Use direct attribute access - tool_calls is a defined field on AIMessage
        if not message.tool_calls:
            return

        for tool_call in message.tool_calls:
            # Access TypedDict fields directly (they&#x27;re required fields)
            tool_call_id = tool_call[&quot;id&quot;]  # str | None
            tool_name = tool_call[&quot;name&quot;]  # str
            tool_args = tool_call[&quot;args&quot;]  # dict[str, Any]

            # Skip tool calls without an ID (shouldn&#x27;t happen in practice)
            if tool_call_id is None:
                continue

            # Skip todo tool calls as they&#x27;re handled separately
            if tool_name == &quot;todo&quot;:
                raise NotImplementedError(&quot;TODO tool call handling not implemented yet&quot;)

            # Send tool call progress update showing the tool is running
            await self._connection.sessionUpdate(
                SessionNotification(
                    update=ToolCallProgress(
                        sessionUpdate=&quot;tool_call_update&quot;,
                        toolCallId=tool_call_id,
                        title=tool_name,
                        rawInput=tool_args,
                        status=&quot;pending&quot;,
                    ),
                    sessionId=params.sessionId,
                )
            )

            # Store the tool call for later matching with ToolMessage
            self._tool_calls[tool_call_id] = tool_call

    async def _handle_tool_message(
        self,
        params: PromptRequest,
        tool_call: ToolCall,
        message: ToolMessage,
    ) -&gt; None:
        &quot;&quot;&quot;Handle a ToolMessage and send appropriate notifications.

        Args:
            params: The prompt request parameters
            tool_call: The original ToolCall that this message is responding to
            message: A ToolMessage containing the tool execution result

        Note:
            According to LangChain&#x27;s ToolMessage type (inherits from BaseMessage):
            - message.content: str | list[str | dict] (from BaseMessage)
            - message.tool_call_id: str (specific to ToolMessage)
            - message.status: str | None (e.g., &quot;error&quot; for failed tool calls)
        &quot;&quot;&quot;
        # Determine status based on message status or content
        status: Literal[&quot;completed&quot;, &quot;failed&quot;] = &quot;completed&quot;
        if hasattr(message, &quot;status&quot;) and message.status == &quot;error&quot;:
            status = &quot;failed&quot;

        # Build content blocks if message has content
        content_blocks = []
        for content_block in message.content_blocks:
            if content_block.get(&quot;type&quot;) == &quot;text&quot;:
                text = content_block.get(&quot;text&quot;, &quot;&quot;)
                if text:
                    content_blocks.append(
                        ContentToolCallContent(
                            type=&quot;content&quot;,
                            content=TextContentBlock(text=text, type=&quot;text&quot;),
                        )
                    )
        # Send tool call progress update with the result
        await self._connection.sessionUpdate(
            SessionNotification(
                update=ToolCallProgress(
                    sessionUpdate=&quot;tool_call_update&quot;,
                    toolCallId=message.tool_call_id,
                    title=tool_call[&quot;name&quot;],
                    content=content_blocks,
                    rawOutput=message.content,
                    status=status,
                ),
                sessionId=params.sessionId,
            )
        )

    async def _handle_todo_update(
        self,
        params: PromptRequest,
        todos: list[dict[str, Any]],
    ) -&gt; None:
        &quot;&quot;&quot;Handle todo list updates from the tools node.

        Args:
            params: The prompt request parameters
            todos: List of todo dictionaries with &#x27;content&#x27; and &#x27;status&#x27; fields

        Note:
            Todos come from the deepagents graph&#x27;s write_todos tool and have the structure:
            [{&#x27;content&#x27;: &#x27;Task description&#x27;, &#x27;status&#x27;: &#x27;pending&#x27;|&#x27;in_progress&#x27;|&#x27;completed&#x27;}, ...]
        &quot;&quot;&quot;
        # Convert todos to PlanEntry objects
        entries = []
        for todo in todos:
            # Extract fields from todo dict
            content = todo.get(&quot;content&quot;, &quot;&quot;)
            status = todo.get(&quot;status&quot;, &quot;pending&quot;)

            # Validate and cast status to PlanEntryStatus
            if status not in (&quot;pending&quot;, &quot;in_progress&quot;, &quot;completed&quot;):
                status = &quot;pending&quot;

            # Create PlanEntry with default priority of &quot;medium&quot;
            entry = PlanEntry(
                content=content,
                status=status,  # type: ignore
                priority=&quot;medium&quot;,
            )
            entries.append(entry)

        # Send plan update notification
        await self._connection.sessionUpdate(
            SessionNotification(
                update=AgentPlanUpdate(
                    sessionUpdate=&quot;plan&quot;,
                    entries=entries,
                ),
                sessionId=params.sessionId,
            )
        )

    async def _handle_interrupt(
        self,
        params: PromptRequest,
        interrupt: Interrupt,
    ) -&gt; list[dict[str, Any]]:
        &quot;&quot;&quot;Handle a LangGraph interrupt and request permission from the client.

        Args:
            params: The prompt request parameters
            interrupt: The interrupt from LangGraph containing action_requests and review_configs

        Returns:
            List of decisions to pass to Command(resume={...})

        Note:
            The interrupt.value contains:
            - action_requests: [{&#x27;name&#x27;: str, &#x27;args&#x27;: dict, &#x27;description&#x27;: str}, ...]
            - review_configs: [{&#x27;action_name&#x27;: str, &#x27;allowed_decisions&#x27;: list[str]}, ...]
        &quot;&quot;&quot;
        interrupt_data = interrupt.value
        action_requests = interrupt_data.get(&quot;action_requests&quot;, [])
        review_configs = interrupt_data.get(&quot;review_configs&quot;, [])

        # Create a mapping of action names to their allowed decisions
        allowed_decisions_map = {}
        for review_config in review_configs:
            action_name = review_config.get(&quot;action_name&quot;)
            allowed_decisions = review_config.get(&quot;allowed_decisions&quot;, [])
            allowed_decisions_map[action_name] = allowed_decisions

        # Collect decisions for all action requests
        decisions = []

        for action_request in action_requests:
            tool_name = action_request.get(&quot;name&quot;)
            tool_args = action_request.get(&quot;args&quot;, {})

            # Get allowed decisions for this action
            allowed_decisions = allowed_decisions_map.get(
                tool_name, [&quot;approve&quot;, &quot;reject&quot;]
            )

            # Build permission options based on allowed decisions
            options = []
            if &quot;approve&quot; in allowed_decisions:
                options.append(
                    PermissionOption(
                        optionId=&quot;allow-once&quot;,
                        name=&quot;Allow once&quot;,
                        kind=&quot;allow_once&quot;,
                    )
                )
            if &quot;reject&quot; in allowed_decisions:
                options.append(
                    PermissionOption(
                        optionId=&quot;reject-once&quot;,
                        name=&quot;Reject&quot;,
                        kind=&quot;reject_once&quot;,
                    )
                )
            # Generate a tool call ID for this permission request
            # We need to find the corresponding tool call from the stored calls
            # For now, use a generated ID
            tool_call_id = f&quot;perm_{uuid.uuid4().hex[:8]}&quot;

            # Create ACP ToolCall object for the permission request
            acp_tool_call = ACPToolCall(
                toolCallId=tool_call_id,
                title=tool_name,
                rawInput=tool_args,
                status=&quot;pending&quot;,
            )

            # Send permission request to client
            response = await self._connection.requestPermission(
                RequestPermissionRequest(
                    sessionId=params.sessionId,
                    toolCall=acp_tool_call,
                    options=options,
                )
            )

            # Convert ACP response to LangGraph decision
            outcome = response.outcome

            if isinstance(outcome, AllowedOutcome):
                option_id = outcome.optionId
                if option_id == &quot;allow-once&quot;:
                    # Check if this was actually an edit option
                    selected_option = next(
                        (opt for opt in options if opt.optionId == option_id), None
                    )
                    if selected_option and selected_option.field_meta:
                        # This is an edit - for now, just approve
                        # TODO: Implement actual edit functionality
                        decisions.append({&quot;type&quot;: &quot;approve&quot;})
                    else:
                        decisions.append({&quot;type&quot;: &quot;approve&quot;})
                elif option_id == &quot;edit&quot;:
                    # Edit option - for now, just approve
                    # TODO: Implement actual edit functionality to collect edited args
                    decisions.append({&quot;type&quot;: &quot;approve&quot;})
            elif isinstance(outcome, DeniedOutcome):
                decisions.append(
                    {
                        &quot;type&quot;: &quot;reject&quot;,
                        &quot;message&quot;: &quot;Action rejected by user&quot;,
                    }
                )

        return decisions

    async def _stream_and_handle_updates(
        self,
        params: PromptRequest,
        agent: Any,
        stream_input: dict[str, Any] | Command,
        config: dict[str, Any],
    ) -&gt; list[Interrupt]:
        &quot;&quot;&quot;Stream agent execution and handle updates, returning any interrupts.

        Args:
            params: The prompt request parameters
            agent: The agent to stream from
            stream_input: Input to pass to agent.astream (initial message or Command)
            config: Configuration with thread_id

        Returns:
            List of interrupts that occurred during streaming
        &quot;&quot;&quot;
        interrupts = []

        async for stream_mode, data in agent.astream(
            stream_input,
            config=config,
            stream_mode=[&quot;messages&quot;, &quot;updates&quot;],
        ):
            if stream_mode == &quot;messages&quot;:
                # Handle streaming message chunks (AIMessageChunk)
                message, metadata = data
                if isinstance(message, AIMessageChunk):
                    await self._handle_ai_message_chunk(params, message)
            elif stream_mode == &quot;updates&quot;:
                # Handle completed node updates
                for node_name, update in data.items():
                    # Check for interrupts
                    if node_name == &quot;__interrupt__&quot;:
                        # Extract interrupts from the update
                        interrupts.extend(update)
                        continue

                    # Only process model and tools nodes
                    if node_name not in (&quot;model&quot;, &quot;tools&quot;):
                        continue

                    # Handle todos from tools node
                    if node_name == &quot;tools&quot; and &quot;todos&quot; in update:
                        todos = update.get(&quot;todos&quot;, [])
                        if todos:
                            await self._handle_todo_update(params, todos)

                    # Get messages from the update
                    messages = update.get(&quot;messages&quot;, [])
                    if not messages:
                        continue

                    # Process the last message from this node
                    last_message = messages[-1]

                    # Handle completed AI messages from model node
                    if node_name == &quot;model&quot; and isinstance(last_message, AIMessage):
                        # Check if this AIMessage has tool calls
                        if last_message.tool_calls:
                            await self._handle_completed_tool_calls(
                                params, last_message
                            )

                    # Handle tool execution results from tools node
                    elif node_name == &quot;tools&quot; and isinstance(last_message, ToolMessage):
                        # Look up the original tool call by ID
                        tool_call = self._tool_calls.get(last_message.tool_call_id)
                        if tool_call:
                            await self._handle_tool_message(
                                params, tool_call, last_message
                            )

        return interrupts

    async def prompt(
        self,
        params: PromptRequest,
    ) -&gt; PromptResponse:
        &quot;&quot;&quot;Handle a user prompt and stream responses.&quot;&quot;&quot;
        session_id = params.sessionId
        session = self._sessions.get(session_id)

        # Extract text from prompt content blocks
        prompt_text = &quot;&quot;
        for block in params.prompt:
            if hasattr(block, &quot;text&quot;):
                prompt_text += block.text
            elif isinstance(block, dict) and &quot;text&quot; in block:
                prompt_text += block[&quot;text&quot;]

        # Stream the agent&#x27;s response
        agent = session[&quot;agent&quot;]
        thread_id = session[&quot;thread_id&quot;]
        config = {&quot;configurable&quot;: {&quot;thread_id&quot;: thread_id}}

        # Start with the initial user message
        stream_input: dict[str, Any] | Command = {
            &quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: prompt_text}]
        }

        # Loop until there are no more interrupts
        while True:
            # Stream and collect any interrupts
            interrupts = await self._stream_and_handle_updates(
                params, agent, stream_input, config
            )

            # If no interrupts, we&#x27;re done
            if not interrupts:
                break

            # Process each interrupt and collect decisions
            all_decisions = []
            for interrupt in interrupts:
                decisions = await self._handle_interrupt(params, interrupt)
                all_decisions.extend(decisions)

            # Prepare to resume with the collected decisions
            stream_input = Command(resume={&quot;decisions&quot;: all_decisions})

        return PromptResponse(stopReason=&quot;end_turn&quot;)

    async def authenticate(self, params: Any) -&gt; Any | None:
        &quot;&quot;&quot;Authenticate (optional).&quot;&quot;&quot;
        # Authentication not required for now
        return None

    async def extMethod(self, method: str, params: dict[str, Any]) -&gt; dict[str, Any]:
        &quot;&quot;&quot;Handle extension methods (optional).&quot;&quot;&quot;
        raise NotImplementedError(f&quot;Extension method {method} not supported&quot;)

    async def extNotification(self, method: str, params: dict[str, Any]) -&gt; None:
        &quot;&quot;&quot;Handle extension notifications (optional).&quot;&quot;&quot;
        pass

    async def cancel(self, params: CancelNotification) -&gt; None:
        &quot;&quot;&quot;Cancel a running session.&quot;&quot;&quot;
        # TODO: Implement cancellation logic
        pass

    async def loadSession(
        self,
        params: LoadSessionRequest,
    ) -&gt; LoadSessionResponse | None:
        &quot;&quot;&quot;Load an existing session (optional).&quot;&quot;&quot;
        # Not implemented yet - would need to serialize/deserialize session state
        return None

    async def setSessionMode(
        self,
        params: SetSessionModeRequest,
    ) -&gt; SetSessionModeResponse | None:
        &quot;&quot;&quot;Set session mode (optional).&quot;&quot;&quot;
        # Could be used to switch between different agent modes
        return None

    async def setSessionModel(
        self,
        params: SetSessionModelRequest,
    ) -&gt; SetSessionModelResponse | None:
        &quot;&quot;&quot;Set session model (optional).&quot;&quot;&quot;
        # Not supported - model is configured at agent graph creation time
        return None


async def main() -&gt; None:
    &quot;&quot;&quot;Main entry point for running the ACP server.&quot;&quot;&quot;
    # from deepagents_cli.agent import create_agent_with_config
    # from deepagents_cli.config import create_model
    # from deepagents_cli.tools import fetch_url, http_request, web_search
    #
    # # Create model using CLI configuration
    # model = create_model()
    #
    # # Setup tools - conditionally include web_search if Tavily is available
    # tools = [http_request, fetch_url]
    # if os.environ.get(&quot;TAVILY_API_KEY&quot;):
    #     tools.append(web_search)
    #
    # # Create CLI agent with shell access and other CLI features
    # # Using default assistant_id &quot;agent&quot; for ACP server
    # agent_graph, composite_backend = create_agent_with_config(
    #     model=model,
    #     assistant_id=&quot;agent&quot;,
    #     tools=tools,
    #     sandbox=None,  # Local mode
    #     sandbox_type=None,
    #     system_prompt=None,  # Use default CLI system prompt
    #     auto_approve=False,  # Require user approval for destructive operations
    #     enable_memory=True,  # Enable persistent memory
    #     enable_skills=True,  # Enable custom skills
    #     enable_shell=True,  # Enable shell access
    # )
    #
    # Define default tools

    from langchain.agents.middleware import HumanInTheLoopMiddleware

    @tool()
    def get_weather(location: str) -&gt; str:
        &quot;&quot;&quot;Get the weather for a given location.&quot;&quot;&quot;
        return f&quot;The weather in {location} is sunny with a high of 75F.&quot;

    # Create the agent graph with default configuration
    model = ChatAnthropic(
        model_name=&quot;claude-sonnet-4-5-20250929&quot;,
        max_tokens=20000,
    )

    agent_graph = create_deep_agent(
        model=model,
        tools=[get_weather],
        checkpointer=InMemorySaver(),
        middleware=[
            HumanInTheLoopMiddleware(
                interrupt_on={
                    &quot;get_weather&quot;: True,
                }
            )
        ],
    )

    # Start the ACP server
    reader, writer = await stdio_streams()
    AgentSideConnection(lambda conn: DeepagentsACP(conn, agent_graph), writer, reader)
    await asyncio.Event().wait()


def cli_main() -&gt; None:
    &quot;&quot;&quot;Synchronous CLI entry point for the ACP server.&quot;&quot;&quot;
    asyncio.run(main())


if __name__ == &quot;__main__&quot;:
    cli_main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/server/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="sessions Imported skill sessions from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/sessions.py Unknown LICENSE sources/langchain/sessions/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">sessions</div>
                <button class="copy-btn" onclick="copyToClipboard('sessions')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill sessions from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Thread management using LangGraph&#x27;s built-in checkpoint persistence.&quot;&quot;&quot;

import uuid
from collections.abc import AsyncIterator
from contextlib import asynccontextmanager
from datetime import datetime
from pathlib import Path

import aiosqlite
from langgraph.checkpoint.sqlite.aio import AsyncSqliteSaver
from rich.table import Table

from deepagents_cli.config import COLORS, console

# Patch aiosqlite.Connection to add is_alive() method required by langgraph-checkpoint&gt;=2.1.0
# See: https://github.com/langchain-ai/langgraph/issues/6583
if not hasattr(aiosqlite.Connection, &quot;is_alive&quot;):

    def _is_alive(self: aiosqlite.Connection) -&gt; bool:
        &quot;&quot;&quot;Check if the connection is still alive.&quot;&quot;&quot;
        return self._connection is not None

    aiosqlite.Connection.is_alive = _is_alive


def _format_timestamp(iso_timestamp: str | None) -&gt; str:
    &quot;&quot;&quot;Format ISO timestamp for display (e.g., &#x27;Dec 30, 6:10pm&#x27;).&quot;&quot;&quot;
    if not iso_timestamp:
        return &quot;&quot;
    try:
        dt = datetime.fromisoformat(iso_timestamp).astimezone()
        return dt.strftime(&quot;%b %d, %-I:%M%p&quot;).lower().replace(&quot;am&quot;, &quot;am&quot;).replace(&quot;pm&quot;, &quot;pm&quot;)
    except (ValueError, TypeError):
        return &quot;&quot;


def get_db_path() -&gt; Path:
    &quot;&quot;&quot;Get path to global database.&quot;&quot;&quot;
    db_dir = Path.home() / &quot;.deepagents&quot;
    db_dir.mkdir(parents=True, exist_ok=True)
    return db_dir / &quot;sessions.db&quot;


def generate_thread_id() -&gt; str:
    &quot;&quot;&quot;Generate a new 8-char hex thread ID.&quot;&quot;&quot;
    return uuid.uuid4().hex[:8]


async def _table_exists(conn: aiosqlite.Connection, table: str) -&gt; bool:
    &quot;&quot;&quot;Check if a table exists in the database.&quot;&quot;&quot;
    query = &quot;SELECT 1 FROM sqlite_master WHERE type=&#x27;table&#x27; AND name=?&quot;
    async with conn.execute(query, (table,)) as cursor:
        return await cursor.fetchone() is not None


async def list_threads(
    agent_name: str | None = None,
    limit: int = 20,
) -&gt; list[dict]:
    &quot;&quot;&quot;List threads from checkpoints table.&quot;&quot;&quot;
    db_path = str(get_db_path())
    async with aiosqlite.connect(db_path, timeout=30.0) as conn:
        # Return empty if table doesn&#x27;t exist yet (fresh install)
        if not await _table_exists(conn, &quot;checkpoints&quot;):
            return []

        if agent_name:
            query = &quot;&quot;&quot;
                SELECT thread_id,
                       json_extract(metadata, &#x27;$.agent_name&#x27;) as agent_name,
                       MAX(json_extract(metadata, &#x27;$.updated_at&#x27;)) as updated_at
                FROM checkpoints
                WHERE json_extract(metadata, &#x27;$.agent_name&#x27;) = ?
                GROUP BY thread_id
                ORDER BY updated_at DESC
                LIMIT ?
            &quot;&quot;&quot;
            params: tuple = (agent_name, limit)
        else:
            query = &quot;&quot;&quot;
                SELECT thread_id,
                       json_extract(metadata, &#x27;$.agent_name&#x27;) as agent_name,
                       MAX(json_extract(metadata, &#x27;$.updated_at&#x27;)) as updated_at
                FROM checkpoints
                GROUP BY thread_id
                ORDER BY updated_at DESC
                LIMIT ?
            &quot;&quot;&quot;
            params = (limit,)

        async with conn.execute(query, params) as cursor:
            rows = await cursor.fetchall()
            return [{&quot;thread_id&quot;: r[0], &quot;agent_name&quot;: r[1], &quot;updated_at&quot;: r[2]} for r in rows]


async def get_most_recent(agent_name: str | None = None) -&gt; str | None:
    &quot;&quot;&quot;Get most recent thread_id, optionally filtered by agent.&quot;&quot;&quot;
    db_path = str(get_db_path())
    async with aiosqlite.connect(db_path, timeout=30.0) as conn:
        if not await _table_exists(conn, &quot;checkpoints&quot;):
            return None

        if agent_name:
            query = &quot;&quot;&quot;
                SELECT thread_id FROM checkpoints
                WHERE json_extract(metadata, &#x27;$.agent_name&#x27;) = ?
                ORDER BY checkpoint_id DESC
                LIMIT 1
            &quot;&quot;&quot;
            params: tuple = (agent_name,)
        else:
            query = &quot;SELECT thread_id FROM checkpoints ORDER BY checkpoint_id DESC LIMIT 1&quot;
            params = ()

        async with conn.execute(query, params) as cursor:
            row = await cursor.fetchone()
            return row[0] if row else None


async def get_thread_agent(thread_id: str) -&gt; str | None:
    &quot;&quot;&quot;Get agent_name for a thread.&quot;&quot;&quot;
    db_path = str(get_db_path())
    async with aiosqlite.connect(db_path, timeout=30.0) as conn:
        if not await _table_exists(conn, &quot;checkpoints&quot;):
            return None

        query = &quot;&quot;&quot;
            SELECT json_extract(metadata, &#x27;$.agent_name&#x27;)
            FROM checkpoints
            WHERE thread_id = ?
            LIMIT 1
        &quot;&quot;&quot;
        async with conn.execute(query, (thread_id,)) as cursor:
            row = await cursor.fetchone()
            return row[0] if row else None


async def thread_exists(thread_id: str) -&gt; bool:
    &quot;&quot;&quot;Check if a thread exists in checkpoints.&quot;&quot;&quot;
    db_path = str(get_db_path())
    async with aiosqlite.connect(db_path, timeout=30.0) as conn:
        if not await _table_exists(conn, &quot;checkpoints&quot;):
            return False

        query = &quot;SELECT 1 FROM checkpoints WHERE thread_id = ? LIMIT 1&quot;
        async with conn.execute(query, (thread_id,)) as cursor:
            row = await cursor.fetchone()
            return row is not None


async def delete_thread(thread_id: str) -&gt; bool:
    &quot;&quot;&quot;Delete thread checkpoints. Returns True if deleted.&quot;&quot;&quot;
    db_path = str(get_db_path())
    async with aiosqlite.connect(db_path, timeout=30.0) as conn:
        if not await _table_exists(conn, &quot;checkpoints&quot;):
            return False

        cursor = await conn.execute(&quot;DELETE FROM checkpoints WHERE thread_id = ?&quot;, (thread_id,))
        deleted = cursor.rowcount &gt; 0
        if await _table_exists(conn, &quot;writes&quot;):
            await conn.execute(&quot;DELETE FROM writes WHERE thread_id = ?&quot;, (thread_id,))
        await conn.commit()
        return deleted


@asynccontextmanager
async def get_checkpointer() -&gt; AsyncIterator[AsyncSqliteSaver]:
    &quot;&quot;&quot;Get AsyncSqliteSaver for the global database.&quot;&quot;&quot;
    async with AsyncSqliteSaver.from_conn_string(str(get_db_path())) as checkpointer:
        yield checkpointer


async def list_threads_command(
    agent_name: str | None = None,
    limit: int = 20,
) -&gt; None:
    &quot;&quot;&quot;CLI handler for: deepagents threads list.&quot;&quot;&quot;
    threads = await list_threads(agent_name, limit=limit)

    if not threads:
        if agent_name:
            console.print(f&quot;[yellow]No threads found for agent &#x27;{agent_name}&#x27;.[/yellow]&quot;)
        else:
            console.print(&quot;[yellow]No threads found.[/yellow]&quot;)
        console.print(&quot;[dim]Start a conversation with: deepagents[/dim]&quot;)
        return

    title = f&quot;Threads for &#x27;{agent_name}&#x27;&quot; if agent_name else &quot;All Threads&quot;

    table = Table(title=title, show_header=True, header_style=f&quot;bold {COLORS[&#x27;primary&#x27;]}&quot;)
    table.add_column(&quot;Thread ID&quot;, style=&quot;bold&quot;)
    table.add_column(&quot;Agent&quot;)
    table.add_column(&quot;Last Used&quot;, style=&quot;dim&quot;)

    for t in threads:
        table.add_row(
            t[&quot;thread_id&quot;],
            t[&quot;agent_name&quot;] or &quot;unknown&quot;,
            _format_timestamp(t.get(&quot;updated_at&quot;)),
        )

    console.print()
    console.print(table)
    console.print()


async def delete_thread_command(thread_id: str) -&gt; None:
    &quot;&quot;&quot;CLI handler for: deepagents threads delete.&quot;&quot;&quot;
    deleted = await delete_thread(thread_id)

    if deleted:
        console.print(f&quot;[green]Thread &#x27;{thread_id}&#x27; deleted.[/green]&quot;)
    else:
        console.print(f&quot;[red]Thread &#x27;{thread_id}&#x27; not found.[/red]&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/sessions/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="shell Imported skill shell from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/shell.py Unknown LICENSE sources/langchain/shell/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">shell</div>
                <button class="copy-btn" onclick="copyToClipboard('shell')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill shell from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Simplified middleware that exposes a basic shell tool to agents.&quot;&quot;&quot;

from __future__ import annotations

import os
import subprocess
from typing import Any

from langchain.agents.middleware.types import AgentMiddleware, AgentState
from langchain.tools import ToolRuntime, tool
from langchain_core.messages import ToolMessage
from langchain_core.tools.base import ToolException


class ShellMiddleware(AgentMiddleware[AgentState, Any]):
    &quot;&quot;&quot;Give basic shell access to agents via the shell.

    This shell will execute on the local machine and has NO safeguards except
    for the human in the loop safeguard provided by the CLI itself.
    &quot;&quot;&quot;

    def __init__(
        self,
        *,
        workspace_root: str,
        timeout: float = 120.0,
        max_output_bytes: int = 100_000,
        env: dict[str, str] | None = None,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize an instance of `ShellMiddleware`.

        Args:
            workspace_root: Working directory for shell commands.
            timeout: Maximum time in seconds to wait for command completion.
                Defaults to 120 seconds.
            max_output_bytes: Maximum number of bytes to capture from command output.
                Defaults to 100,000 bytes.
            env: Environment variables to pass to the subprocess. If None,
                uses the current process&#x27;s environment. Defaults to None.
        &quot;&quot;&quot;
        super().__init__()
        self._timeout = timeout
        self._max_output_bytes = max_output_bytes
        self._tool_name = &quot;shell&quot;
        self._env = env if env is not None else os.environ.copy()
        self._workspace_root = workspace_root

        # Build description with working directory information
        description = (
            f&quot;Execute a shell command directly on the host. Commands will run in &quot;
            f&quot;the working directory: {workspace_root}. Each command runs in a fresh shell &quot;
            f&quot;environment with the current process&#x27;s environment variables. Commands may &quot;
            f&quot;be truncated if they exceed the configured timeout or output limits.&quot;
        )

        @tool(self._tool_name, description=description)
        def shell_tool(
            command: str,
            runtime: ToolRuntime[None, AgentState],
        ) -&gt; ToolMessage | str:
            &quot;&quot;&quot;Execute a shell command.

            Args:
                command: The shell command to execute.
                runtime: The tool runtime context.
            &quot;&quot;&quot;
            return self._run_shell_command(command, tool_call_id=runtime.tool_call_id)

        self._shell_tool = shell_tool
        self.tools = [self._shell_tool]

    def _run_shell_command(
        self,
        command: str,
        *,
        tool_call_id: str | None,
    ) -&gt; ToolMessage | str:
        &quot;&quot;&quot;Execute a shell command and return the result.

        Args:
            command: The shell command to execute.
            tool_call_id: The tool call ID for creating a ToolMessage.

        Returns:
            A ToolMessage with the command output or an error message.
        &quot;&quot;&quot;
        if not command or not isinstance(command, str):
            msg = &quot;Shell tool expects a non-empty command string.&quot;
            raise ToolException(msg)

        try:
            result = subprocess.run(
                command,
                check=False,
                shell=True,
                capture_output=True,
                text=True,
                timeout=self._timeout,
                env=self._env,
                cwd=self._workspace_root,
            )

            # Combine stdout and stderr
            output_parts = []
            if result.stdout:
                output_parts.append(result.stdout)
            if result.stderr:
                stderr_lines = result.stderr.strip().split(&quot;\n&quot;)
                for line in stderr_lines:
                    output_parts.append(f&quot;[stderr] {line}&quot;)

            output = &quot;\n&quot;.join(output_parts) if output_parts else &quot;&lt;no output&gt;&quot;

            # Truncate output if needed
            if len(output) &gt; self._max_output_bytes:
                output = output[: self._max_output_bytes]
                output += f&quot;\n\n... Output truncated at {self._max_output_bytes} bytes.&quot;

            # Add exit code info if non-zero
            if result.returncode != 0:
                output = f&quot;{output.rstrip()}\n\nExit code: {result.returncode}&quot;
                status = &quot;error&quot;
            else:
                status = &quot;success&quot;

        except subprocess.TimeoutExpired:
            output = f&quot;Error: Command timed out after {self._timeout:.1f} seconds.&quot;
            status = &quot;error&quot;

        return ToolMessage(
            content=output,
            tool_call_id=tool_call_id,
            name=self._tool_name,
            status=status,
        )


__all__ = [&quot;ShellMiddleware&quot;]</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/shell/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="skill Imported skill skill from langchain langchain /a0/tmp/skills_research/langchain/examples/content-builder-agent/skills/blog-post/SKILL.md Unknown LICENSE sources/langchain/skill/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">skill</div>
                <button class="copy-btn" onclick="copyToClipboard('skill')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill skill from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
name: blog-post
description: Use this skill when writing long-form blog posts, tutorials, or educational articles that require structure, depth, and SEO considerations
---

# Blog Post Writing Skill

This skill provides a structured workflow for creating high-quality blog posts that educate and engage readers.

## When to Use This Skill

Use this skill when asked to:
- Write a blog post or article
- Create a tutorial or how-to guide
- Develop educational long-form content
- Write thought leadership pieces

## Research First (Required)

**Before writing any blog post, you MUST delegate research:**

1. Use the `task` tool with `subagent_type: &quot;researcher&quot;`
2. In the description, specify BOTH the topic AND where to save:

```
task(
    subagent_type=&quot;researcher&quot;,
    description=&quot;Research [TOPIC]. Save findings to research/[slug].md&quot;
)
```

Example:
```
task(
    subagent_type=&quot;researcher&quot;,
    description=&quot;Research the current state of AI agents in 2025. Save findings to research/ai-agents-2025.md&quot;
)
```

3. After research completes, read the findings file before writing

## Output Structure (Required)

**Every blog post MUST have both a post AND a cover image:**

```
blogs/
 &lt;slug&gt;/
     post.md        # The blog post content
     hero.png       # REQUIRED: Generated cover image
```

Example: A post about &quot;AI Agents in 2025&quot;  `blogs/ai-agents-2025/`

**You MUST complete both steps:**
1. Write the post to `blogs/&lt;slug&gt;/post.md`
2. Generate a cover image using `generate_image` and save to `blogs/&lt;slug&gt;/hero.png`

**A blog post is NOT complete without its cover image.**

## Blog Post Structure

Every blog post should follow this structure:

### 1. Hook (Opening)
- Start with a compelling question, statistic, or statement
- Make the reader want to continue
- Keep it to 2-3 sentences

### 2. Context (The Problem)
- Explain why this topic matters
- Describe the problem or opportunity
- Connect to the reader&#x27;s experience

### 3. Main Content (The Solution)
- Break into 3-5 main sections with H2 headers
- Each section covers one key point
- Include code examples, diagrams, or screenshots where helpful
- Use bullet points for lists

### 4. Practical Application
- Show how to apply the concepts
- Include step-by-step instructions if applicable
- Provide code snippets or templates

### 5. Conclusion &amp; CTA
- Summarize key takeaways (3 bullets max)
- End with a clear call-to-action
- Link to related resources

## Cover Image Generation

After writing the post, generate a cover image using the `generate_cover` tool:

```
generate_cover(prompt=&quot;A detailed description of the image...&quot;, slug=&quot;your-blog-slug&quot;)
```

The tool saves the image to `blogs/&lt;slug&gt;/hero.png`.

### Writing Effective Image Prompts

Structure your prompt with these elements:

1. **Subject**: What is the main focus? Be specific and concrete.
2. **Style**: Art direction (minimalist, isometric, flat design, 3D render, watercolor, etc.)
3. **Composition**: How elements are arranged (centered, rule of thirds, symmetrical)
4. **Color palette**: Specific colors or mood (warm earth tones, cool blues and purples, high contrast)
5. **Lighting/Atmosphere**: Soft diffused light, dramatic shadows, golden hour, neon glow
6. **Technical details**: Aspect ratio considerations, negative space for text overlay

### Example Prompts

**For a technical blog post:**
```
Isometric 3D illustration of interconnected glowing cubes representing AI agents, each cube has subtle circuit patterns. Cubes connected by luminous data streams. Deep navy background (#0a192f) with electric blue (#64ffda) and soft purple (#c792ea) accents. Clean minimal style, lots of negative space at top for title. Professional tech aesthetic.
```

**For a tutorial/how-to:**
```
Clean flat illustration of hands typing on a keyboard with abstract code symbols floating upward, transforming into lightbulbs and gears. Warm gradient background from soft coral to light peach. Friendly, approachable style. Centered composition with space for text overlay.
```

**For thought leadership:**
```
Abstract visualization of a human silhouette profile merging with geometric neural network patterns. Split composition - organic watercolor texture on left transitioning to clean vector lines on right. Muted sage green and warm terracotta color scheme. Contemplative, forward-thinking mood.
```

## SEO Considerations

- Include the main keyword in the title and first paragraph
- Use the keyword naturally 3-5 times throughout
- Keep the title under 60 characters
- Write a meta description (150-160 characters)

## Quality Checklist

Before finishing:
- [ ] Post saved to `blogs/&lt;slug&gt;/post.md`
- [ ] Hero image generated at `blogs/&lt;slug&gt;/hero.png`
- [ ] Hook grabs attention in first 2 sentences
- [ ] Each section has a clear purpose
- [ ] Conclusion summarizes key points
- [ ] CTA tells reader what to do next</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/skill/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="skills Imported skill skills from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/middleware/skills.py Unknown LICENSE sources/langchain/skills/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">skills</div>
                <button class="copy-btn" onclick="copyToClipboard('skills')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill skills from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Skills middleware for loading and exposing agent skills to the system prompt.

This module implements Anthropic&#x27;s agent skills pattern with progressive disclosure,
loading skills from backend storage via configurable sources.

## Architecture

Skills are loaded from one or more **sources** - paths in a backend where skills are
organized. Sources are loaded in order, with later sources overriding earlier ones
when skills have the same name (last one wins). This enables layering: base -&gt; user
-&gt; project -&gt; team skills.

The middleware uses backend APIs exclusively (no direct filesystem access), making it
portable across different storage backends (filesystem, state, remote storage, etc.).

For StateBackend (ephemeral/in-memory), use a factory function:
```python
SkillsMiddleware(backend=lambda rt: StateBackend(rt), ...)
```

## Skill Structure

Each skill is a directory containing a SKILL.md file with YAML frontmatter:

```
/skills/user/web-research/
 SKILL.md          # Required: YAML frontmatter + markdown instructions
 helper.py         # Optional: supporting files
```

SKILL.md format:
```markdown
---
name: web-research
description: Structured approach to conducting thorough web research
license: MIT
---

# Web Research Skill

## When to Use
- User asks you to research a topic
...
```

## Skill Metadata (SkillMetadata)

Parsed from YAML frontmatter per Agent Skills specification:
- `name`: Skill identifier (max 64 chars, lowercase alphanumeric and hyphens)
- `description`: What the skill does (max 1024 chars)
- `path`: Backend path to the SKILL.md file
- Optional: `license`, `compatibility`, `metadata`, `allowed_tools`

## Sources

Sources are simply paths to skill directories in the backend. The source name is
derived from the last component of the path (e.g., &quot;/skills/user/&quot; -&gt; &quot;user&quot;).

Example sources:
```python
[
    &quot;/skills/user/&quot;,
    &quot;/skills/project/&quot;
]
```

## Path Conventions

All paths use POSIX conventions (forward slashes) via `PurePosixPath`:
- Backend paths: &quot;/skills/user/web-research/SKILL.md&quot;
- Virtual, platform-independent
- Backends handle platform-specific conversions as needed

## Usage

```python
from deepagents.backends.state import StateBackend
from deepagents.middleware.skills import SkillsMiddleware

middleware = SkillsMiddleware(
    backend=my_backend,
    sources=[
        &quot;/skills/base/&quot;,
        &quot;/skills/user/&quot;,
        &quot;/skills/project/&quot;,
    ],
)
```
&quot;&quot;&quot;

from __future__ import annotations

import logging
import re
from pathlib import PurePosixPath
from typing import TYPE_CHECKING, Annotated

import yaml
from langchain.agents.middleware.types import PrivateStateAttr

if TYPE_CHECKING:
    from deepagents.backends.protocol import BACKEND_TYPES, BackendProtocol

from collections.abc import Awaitable, Callable
from typing import NotRequired, TypedDict

from langchain.agents.middleware.types import (
    AgentMiddleware,
    AgentState,
    ModelRequest,
    ModelResponse,
)
from langchain_core.runnables import RunnableConfig
from langgraph.prebuilt import ToolRuntime
from langgraph.runtime import Runtime

from deepagents.middleware._utils import append_to_system_message

logger = logging.getLogger(__name__)

# Security: Maximum size for SKILL.md files to prevent DoS attacks (10MB)
MAX_SKILL_FILE_SIZE = 10 * 1024 * 1024

# Agent Skills specification constraints (https://agentskills.io/specification)
MAX_SKILL_NAME_LENGTH = 64
MAX_SKILL_DESCRIPTION_LENGTH = 1024


class SkillMetadata(TypedDict):
    &quot;&quot;&quot;Metadata for a skill per Agent Skills specification (https://agentskills.io/specification).&quot;&quot;&quot;

    name: str
    &quot;&quot;&quot;Skill identifier (max 64 chars, lowercase alphanumeric and hyphens).&quot;&quot;&quot;

    description: str
    &quot;&quot;&quot;What the skill does (max 1024 chars).&quot;&quot;&quot;

    path: str
    &quot;&quot;&quot;Path to the SKILL.md file.&quot;&quot;&quot;

    license: str | None
    &quot;&quot;&quot;License name or reference to bundled license file.&quot;&quot;&quot;

    compatibility: str | None
    &quot;&quot;&quot;Environment requirements (max 500 chars).&quot;&quot;&quot;

    metadata: dict[str, str]
    &quot;&quot;&quot;Arbitrary key-value mapping for additional metadata.&quot;&quot;&quot;

    allowed_tools: list[str]
    &quot;&quot;&quot;Space-delimited list of pre-approved tools. (Experimental)&quot;&quot;&quot;


class SkillsState(AgentState):
    &quot;&quot;&quot;State for the skills middleware.&quot;&quot;&quot;

    skills_metadata: NotRequired[Annotated[list[SkillMetadata], PrivateStateAttr]]
    &quot;&quot;&quot;List of loaded skill metadata from all configured sources.&quot;&quot;&quot;


class SkillsStateUpdate(TypedDict):
    &quot;&quot;&quot;State update for the skills middleware.&quot;&quot;&quot;

    skills_metadata: list[SkillMetadata]
    &quot;&quot;&quot;List of loaded skill metadata to merge into state.&quot;&quot;&quot;


def _validate_skill_name(name: str, directory_name: str) -&gt; tuple[bool, str]:
    &quot;&quot;&quot;Validate skill name per Agent Skills specification.

    Requirements per spec:
    - Max 64 characters
    - Lowercase alphanumeric and hyphens only (a-z, 0-9, -)
    - Cannot start or end with hyphen
    - No consecutive hyphens
    - Must match parent directory name

    Args:
        name: Skill name from YAML frontmatter
        directory_name: Parent directory name

    Returns:
        (is_valid, error_message) tuple. Error message is empty if valid.
    &quot;&quot;&quot;
    if not name:
        return False, &quot;name is required&quot;
    if len(name) &gt; MAX_SKILL_NAME_LENGTH:
        return False, &quot;name exceeds 64 characters&quot;
    # Pattern: lowercase alphanumeric, single hyphens between segments, no start/end hyphen
    if not re.match(r&quot;^[a-z0-9]+(-[a-z0-9]+)*$&quot;, name):
        return False, &quot;name must be lowercase alphanumeric with single hyphens only&quot;
    if name != directory_name:
        return False, f&quot;name &#x27;{name}&#x27; must match directory name &#x27;{directory_name}&#x27;&quot;
    return True, &quot;&quot;


def _parse_skill_metadata(
    content: str,
    skill_path: str,
    directory_name: str,
) -&gt; SkillMetadata | None:
    &quot;&quot;&quot;Parse YAML frontmatter from SKILL.md content.

    Extracts metadata per Agent Skills specification from YAML frontmatter delimited
    by --- markers at the start of the content.

    Args:
        content: Content of the SKILL.md file
        skill_path: Path to the SKILL.md file (for error messages and metadata)
        directory_name: Name of the parent directory containing the skill

    Returns:
        SkillMetadata if parsing succeeds, None if parsing fails or validation errors occur
    &quot;&quot;&quot;
    if len(content) &gt; MAX_SKILL_FILE_SIZE:
        logger.warning(&quot;Skipping %s: content too large (%d bytes)&quot;, skill_path, len(content))
        return None

    # Match YAML frontmatter between --- delimiters
    frontmatter_pattern = r&quot;^---\s*\n(.*?)\n---\s*\n&quot;
    match = re.match(frontmatter_pattern, content, re.DOTALL)

    if not match:
        logger.warning(&quot;Skipping %s: no valid YAML frontmatter found&quot;, skill_path)
        return None

    frontmatter_str = match.group(1)

    # Parse YAML using safe_load for proper nested structure support
    try:
        frontmatter_data = yaml.safe_load(frontmatter_str)
    except yaml.YAMLError as e:
        logger.warning(&quot;Invalid YAML in %s: %s&quot;, skill_path, e)
        return None

    if not isinstance(frontmatter_data, dict):
        logger.warning(&quot;Skipping %s: frontmatter is not a mapping&quot;, skill_path)
        return None

    # Validate required fields
    name = frontmatter_data.get(&quot;name&quot;)
    description = frontmatter_data.get(&quot;description&quot;)

    if not name or not description:
        logger.warning(&quot;Skipping %s: missing required &#x27;name&#x27; or &#x27;description&#x27;&quot;, skill_path)
        return None

    # Validate name format per spec (warn but continue loading for backwards compatibility)
    is_valid, error = _validate_skill_name(str(name), directory_name)
    if not is_valid:
        logger.warning(
            &quot;Skill &#x27;%s&#x27; in %s does not follow Agent Skills specification: %s. Consider renaming for spec compliance.&quot;,
            name,
            skill_path,
            error,
        )

    # Validate description length per spec (max 1024 chars)
    description_str = str(description).strip()
    if len(description_str) &gt; MAX_SKILL_DESCRIPTION_LENGTH:
        logger.warning(
            &quot;Description exceeds %d characters in %s, truncating&quot;,
            MAX_SKILL_DESCRIPTION_LENGTH,
            skill_path,
        )
        description_str = description_str[:MAX_SKILL_DESCRIPTION_LENGTH]

    if frontmatter_data.get(&quot;allowed-tools&quot;):
        allowed_tools = frontmatter_data.get(&quot;allowed-tools&quot;).split(&quot; &quot;)
    else:
        allowed_tools = []

    return SkillMetadata(
        name=str(name),
        description=description_str,
        path=skill_path,
        metadata=frontmatter_data.get(&quot;metadata&quot;, {}),
        license=frontmatter_data.get(&quot;license&quot;, &quot;&quot;).strip() or None,
        compatibility=frontmatter_data.get(&quot;compatibility&quot;, &quot;&quot;).strip() or None,
        allowed_tools=allowed_tools,
    )


def _list_skills(backend: BackendProtocol, source_path: str) -&gt; list[SkillMetadata]:
    &quot;&quot;&quot;List all skills from a backend source.

    Scans backend for subdirectories containing SKILL.md files, downloads their content,
    parses YAML frontmatter, and returns skill metadata.

    Expected structure:
        source_path/
         skill-name/
            SKILL.md        # Required
            helper.py       # Optional

    Args:
        backend: Backend instance to use for file operations
        source_path: Path to the skills directory in the backend

    Returns:
        List of skill metadata from successfully parsed SKILL.md files
    &quot;&quot;&quot;
    base_path = source_path

    skills: list[SkillMetadata] = []
    items = backend.ls_info(base_path)
    # Find all skill directories (directories containing SKILL.md)
    skill_dirs = []
    for item in items:
        if not item.get(&quot;is_dir&quot;):
            continue
        skill_dirs.append(item[&quot;path&quot;])

    if not skill_dirs:
        return []

    # For each skill directory, check if SKILL.md exists and download it
    skill_md_paths = []
    for skill_dir_path in skill_dirs:
        # Construct SKILL.md path using PurePosixPath for safe, standardized path operations
        skill_dir = PurePosixPath(skill_dir_path)
        skill_md_path = str(skill_dir / &quot;SKILL.md&quot;)
        skill_md_paths.append((skill_dir_path, skill_md_path))

    paths_to_download = [skill_md_path for _, skill_md_path in skill_md_paths]
    responses = backend.download_files(paths_to_download)

    # Parse each downloaded SKILL.md
    for (skill_dir_path, skill_md_path), response in zip(skill_md_paths, responses, strict=True):
        if response.error:
            # Skill doesn&#x27;t have a SKILL.md, skip it
            continue

        if response.content is None:
            logger.warning(&quot;Downloaded skill file %s has no content&quot;, skill_md_path)
            continue

        try:
            content = response.content.decode(&quot;utf-8&quot;)
        except UnicodeDecodeError as e:
            logger.warning(&quot;Error decoding %s: %s&quot;, skill_md_path, e)
            continue

        # Extract directory name from path using PurePosixPath
        directory_name = PurePosixPath(skill_dir_path).name

        # Parse metadata
        skill_metadata = _parse_skill_metadata(
            content=content,
            skill_path=skill_md_path,
            directory_name=directory_name,
        )
        if skill_metadata:
            skills.append(skill_metadata)

    return skills


async def _alist_skills(backend: BackendProtocol, source_path: str) -&gt; list[SkillMetadata]:
    &quot;&quot;&quot;List all skills from a backend source (async version).

    Scans backend for subdirectories containing SKILL.md files, downloads their content,
    parses YAML frontmatter, and returns skill metadata.

    Expected structure:
        source_path/
         skill-name/
            SKILL.md        # Required
            helper.py       # Optional

    Args:
        backend: Backend instance to use for file operations
        source_path: Path to the skills directory in the backend

    Returns:
        List of skill metadata from successfully parsed SKILL.md files
    &quot;&quot;&quot;
    base_path = source_path

    skills: list[SkillMetadata] = []
    items = await backend.als_info(base_path)
    # Find all skill directories (directories containing SKILL.md)
    skill_dirs = []
    for item in items:
        if not item.get(&quot;is_dir&quot;):
            continue
        skill_dirs.append(item[&quot;path&quot;])

    if not skill_dirs:
        return []

    # For each skill directory, check if SKILL.md exists and download it
    skill_md_paths = []
    for skill_dir_path in skill_dirs:
        # Construct SKILL.md path using PurePosixPath for safe, standardized path operations
        skill_dir = PurePosixPath(skill_dir_path)
        skill_md_path = str(skill_dir / &quot;SKILL.md&quot;)
        skill_md_paths.append((skill_dir_path, skill_md_path))

    paths_to_download = [skill_md_path for _, skill_md_path in skill_md_paths]
    responses = await backend.adownload_files(paths_to_download)

    # Parse each downloaded SKILL.md
    for (skill_dir_path, skill_md_path), response in zip(skill_md_paths, responses, strict=True):
        if response.error:
            # Skill doesn&#x27;t have a SKILL.md, skip it
            continue

        if response.content is None:
            logger.warning(&quot;Downloaded skill file %s has no content&quot;, skill_md_path)
            continue

        try:
            content = response.content.decode(&quot;utf-8&quot;)
        except UnicodeDecodeError as e:
            logger.warning(&quot;Error decoding %s: %s&quot;, skill_md_path, e)
            continue

        # Extract directory name from path using PurePosixPath
        directory_name = PurePosixPath(skill_dir_path).name

        # Parse metadata
        skill_metadata = _parse_skill_metadata(
            content=content,
            skill_path=skill_md_path,
            directory_name=directory_name,
        )
        if skill_metadata:
            skills.append(skill_metadata)

    return skills


SKILLS_SYSTEM_PROMPT = &quot;&quot;&quot;

## Skills System

You have access to a skills library that provides specialized capabilities and domain knowledge.

{skills_locations}

**Available Skills:**

{skills_list}

**How to Use Skills (Progressive Disclosure):**

Skills follow a **progressive disclosure** pattern - you see their name and description above, but only read full instructions when needed:

1. **Recognize when a skill applies**: Check if the user&#x27;s task matches a skill&#x27;s description
2. **Read the skill&#x27;s full instructions**: Use the path shown in the skill list above
3. **Follow the skill&#x27;s instructions**: SKILL.md contains step-by-step workflows, best practices, and examples
4. **Access supporting files**: Skills may include helper scripts, configs, or reference docs - use absolute paths

**When to Use Skills:**
- User&#x27;s request matches a skill&#x27;s domain (e.g., &quot;research X&quot; -&gt; web-research skill)
- You need specialized knowledge or structured workflows
- A skill provides proven patterns for complex tasks

**Executing Skill Scripts:**
Skills may contain Python scripts or other executable files. Always use absolute paths from the skill list.

**Example Workflow:**

User: &quot;Can you research the latest developments in quantum computing?&quot;

1. Check available skills -&gt; See &quot;web-research&quot; skill with its path
2. Read the skill using the path shown
3. Follow the skill&#x27;s research workflow (search -&gt; organize -&gt; synthesize)
4. Use any helper scripts with absolute paths

Remember: Skills make you more capable and consistent. When in doubt, check if a skill exists for the task!
&quot;&quot;&quot;


class SkillsMiddleware(AgentMiddleware):
    &quot;&quot;&quot;Middleware for loading and exposing agent skills to the system prompt.

    Loads skills from backend sources and injects them into the system prompt
    using progressive disclosure (metadata first, full content on demand).

    Skills are loaded in source order with later sources overriding earlier ones.

    Example:
        ```python
        from deepagents.backends.filesystem import FilesystemBackend

        backend = FilesystemBackend(root_dir=&quot;/path/to/skills&quot;)
        middleware = SkillsMiddleware(
            backend=backend,
            sources=[
                &quot;/path/to/skills/user/&quot;,
                &quot;/path/to/skills/project/&quot;,
            ],
        )
        ```

    Args:
        backend: Backend instance for file operations
        sources: List of skill source paths. Source names are derived from the last path component.
    &quot;&quot;&quot;

    state_schema = SkillsState

    def __init__(self, *, backend: BACKEND_TYPES, sources: list[str]) -&gt; None:
        &quot;&quot;&quot;Initialize the skills middleware.

        Args:
            backend: Backend instance or factory function that takes runtime and returns a backend.
                     Use a factory for StateBackend: `lambda rt: StateBackend(rt)`
            sources: List of skill source paths (e.g., [&quot;/skills/user/&quot;, &quot;/skills/project/&quot;]).
        &quot;&quot;&quot;
        self._backend = backend
        self.sources = sources
        self.system_prompt_template = SKILLS_SYSTEM_PROMPT

    def _get_backend(self, state: SkillsState, runtime: Runtime, config: RunnableConfig) -&gt; BackendProtocol:
        &quot;&quot;&quot;Resolve backend from instance or factory.

        Args:
            state: Current agent state.
            runtime: Runtime context for factory functions.
            config: Runnable config to pass to backend factory.

        Returns:
            Resolved backend instance
        &quot;&quot;&quot;
        if callable(self._backend):
            # Construct an artificial tool runtime to resolve backend factory
            tool_runtime = ToolRuntime(
                state=state,
                context=runtime.context,
                stream_writer=runtime.stream_writer,
                store=runtime.store,
                config=config,
                tool_call_id=None,
            )
            backend = self._backend(tool_runtime)
            if backend is None:
                raise AssertionError(&quot;SkillsMiddleware requires a valid backend instance&quot;)
            return backend

        return self._backend

    def _format_skills_locations(self) -&gt; str:
        &quot;&quot;&quot;Format skills locations for display in system prompt.&quot;&quot;&quot;
        locations = []
        for i, source_path in enumerate(self.sources):
            name = PurePosixPath(source_path.rstrip(&quot;/&quot;)).name.capitalize()
            suffix = &quot; (higher priority)&quot; if i == len(self.sources) - 1 else &quot;&quot;
            locations.append(f&quot;**{name} Skills**: `{source_path}`{suffix}&quot;)
        return &quot;\n&quot;.join(locations)

    def _format_skills_list(self, skills: list[SkillMetadata]) -&gt; str:
        &quot;&quot;&quot;Format skills metadata for display in system prompt.&quot;&quot;&quot;
        if not skills:
            paths = [f&quot;{source_path}&quot; for source_path in self.sources]
            return f&quot;(No skills available yet. You can create skills in {&#x27; or &#x27;.join(paths)})&quot;

        lines = []
        for skill in skills:
            lines.append(f&quot;- **{skill[&#x27;name&#x27;]}**: {skill[&#x27;description&#x27;]}&quot;)
            lines.append(f&quot;  -&gt; Read `{skill[&#x27;path&#x27;]}` for full instructions&quot;)

        return &quot;\n&quot;.join(lines)

    def modify_request(self, request: ModelRequest) -&gt; ModelRequest:
        &quot;&quot;&quot;Inject skills documentation into a model request&#x27;s system message.

        Args:
            request: Model request to modify

        Returns:
            New model request with skills documentation injected into system message
        &quot;&quot;&quot;
        skills_metadata = request.state.get(&quot;skills_metadata&quot;, [])
        skills_locations = self._format_skills_locations()
        skills_list = self._format_skills_list(skills_metadata)

        skills_section = self.system_prompt_template.format(
            skills_locations=skills_locations,
            skills_list=skills_list,
        )

        new_system_message = append_to_system_message(request.system_message, skills_section)

        return request.override(system_message=new_system_message)

    def before_agent(self, state: SkillsState, runtime: Runtime, config: RunnableConfig) -&gt; SkillsStateUpdate | None:
        &quot;&quot;&quot;Load skills metadata before agent execution (synchronous).

        Runs before each agent interaction to discover available skills from all
        configured sources. Re-loads on every call to capture any changes.

        Skills are loaded in source order with later sources overriding
        earlier ones if they contain skills with the same name (last one wins).

        Args:
            state: Current agent state.
            runtime: Runtime context.
            config: Runnable config.

        Returns:
            State update with `skills_metadata` populated, or `None` if already present
        &quot;&quot;&quot;
        # Skip if skills_metadata is already present in state (even if empty)
        if &quot;skills_metadata&quot; in state:
            return None

        # Resolve backend (supports both direct instances and factory functions)
        backend = self._get_backend(state, runtime, config)
        all_skills: dict[str, SkillMetadata] = {}

        # Load skills from each source in order
        # Later sources override earlier ones (last one wins)
        for source_path in self.sources:
            source_skills = _list_skills(backend, source_path)
            for skill in source_skills:
                all_skills[skill[&quot;name&quot;]] = skill

        skills = list(all_skills.values())
        return SkillsStateUpdate(skills_metadata=skills)

    async def abefore_agent(self, state: SkillsState, runtime: Runtime, config: RunnableConfig) -&gt; SkillsStateUpdate | None:
        &quot;&quot;&quot;Load skills metadata before agent execution (async).

        Runs before each agent interaction to discover available skills from all
        configured sources. Re-loads on every call to capture any changes.

        Skills are loaded in source order with later sources overriding
        earlier ones if they contain skills with the same name (last one wins).

        Args:
            state: Current agent state.
            runtime: Runtime context.
            config: Runnable config.

        Returns:
            State update with `skills_metadata` populated, or `None` if already present
        &quot;&quot;&quot;
        # Skip if skills_metadata is already present in state (even if empty)
        if &quot;skills_metadata&quot; in state:
            return None

        # Resolve backend (supports both direct instances and factory functions)
        backend = self._get_backend(state, runtime, config)
        all_skills: dict[str, SkillMetadata] = {}

        # Load skills from each source in order
        # Later sources override earlier ones (last one wins)
        for source_path in self.sources:
            source_skills = await _alist_skills(backend, source_path)
            for skill in source_skills:
                all_skills[skill[&quot;name&quot;]] = skill

        skills = list(all_skills.values())
        return SkillsStateUpdate(skills_metadata=skills)

    def wrap_model_call(
        self,
        request: ModelRequest,
        handler: Callable[[ModelRequest], ModelResponse],
    ) -&gt; ModelResponse:
        &quot;&quot;&quot;Inject skills documentation into the system prompt.

        Args:
            request: Model request being processed
            handler: Handler function to call with modified request

        Returns:
            Model response from handler
        &quot;&quot;&quot;
        modified_request = self.modify_request(request)
        return handler(modified_request)

    async def awrap_model_call(
        self,
        request: ModelRequest,
        handler: Callable[[ModelRequest], Awaitable[ModelResponse]],
    ) -&gt; ModelResponse:
        &quot;&quot;&quot;Inject skills documentation into the system prompt (async version).

        Args:
            request: Model request being processed
            handler: Async handler function to call with modified request

        Returns:
            Model response from handler
        &quot;&quot;&quot;
        modified_request = self.modify_request(request)
        return await handler(modified_request)


__all__ = [&quot;SkillMetadata&quot;, &quot;SkillsMiddleware&quot;]</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/skills/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/middleware/skills.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="state Imported skill state from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/backends/state.py Unknown LICENSE sources/langchain/state/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">state</div>
                <button class="copy-btn" onclick="copyToClipboard('state')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill state from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;StateBackend: Store files in LangGraph agent state (ephemeral).&quot;&quot;&quot;

from typing import TYPE_CHECKING

from deepagents.backends.protocol import (
    BackendProtocol,
    EditResult,
    FileDownloadResponse,
    FileInfo,
    FileUploadResponse,
    GrepMatch,
    WriteResult,
)
from deepagents.backends.utils import (
    _glob_search_files,
    create_file_data,
    file_data_to_string,
    format_read_response,
    grep_matches_from_files,
    perform_string_replacement,
    update_file_data,
)

if TYPE_CHECKING:
    from langchain.tools import ToolRuntime


class StateBackend(BackendProtocol):
    &quot;&quot;&quot;Backend that stores files in agent state (ephemeral).

    Uses LangGraph&#x27;s state management and checkpointing. Files persist within
    a conversation thread but not across threads. State is automatically
    checkpointed after each agent step.

    Special handling: Since LangGraph state must be updated via Command objects
    (not direct mutation), operations return Command objects instead of None.
    This is indicated by the uses_state=True flag.
    &quot;&quot;&quot;

    def __init__(self, runtime: &quot;ToolRuntime&quot;):
        &quot;&quot;&quot;Initialize StateBackend with runtime.&quot;&quot;&quot;
        self.runtime = runtime

    def ls_info(self, path: str) -&gt; list[FileInfo]:
        &quot;&quot;&quot;List files and directories in the specified directory (non-recursive).

        Args:
            path: Absolute path to directory.

        Returns:
            List of FileInfo-like dicts for files and directories directly in the directory.
            Directories have a trailing / in their path and is_dir=True.
        &quot;&quot;&quot;
        files = self.runtime.state.get(&quot;files&quot;, {})
        infos: list[FileInfo] = []
        subdirs: set[str] = set()

        # Normalize path to have trailing slash for proper prefix matching
        normalized_path = path if path.endswith(&quot;/&quot;) else path + &quot;/&quot;

        for k, fd in files.items():
            # Check if file is in the specified directory or a subdirectory
            if not k.startswith(normalized_path):
                continue

            # Get the relative path after the directory
            relative = k[len(normalized_path) :]

            # If relative path contains &#x27;/&#x27;, it&#x27;s in a subdirectory
            if &quot;/&quot; in relative:
                # Extract the immediate subdirectory name
                subdir_name = relative.split(&quot;/&quot;)[0]
                subdirs.add(normalized_path + subdir_name + &quot;/&quot;)
                continue

            # This is a file directly in the current directory
            size = len(&quot;\n&quot;.join(fd.get(&quot;content&quot;, [])))
            infos.append(
                {
                    &quot;path&quot;: k,
                    &quot;is_dir&quot;: False,
                    &quot;size&quot;: int(size),
                    &quot;modified_at&quot;: fd.get(&quot;modified_at&quot;, &quot;&quot;),
                }
            )

        # Add directories to the results
        for subdir in sorted(subdirs):
            infos.append(
                {
                    &quot;path&quot;: subdir,
                    &quot;is_dir&quot;: True,
                    &quot;size&quot;: 0,
                    &quot;modified_at&quot;: &quot;&quot;,
                }
            )

        infos.sort(key=lambda x: x.get(&quot;path&quot;, &quot;&quot;))
        return infos

    def read(
        self,
        file_path: str,
        offset: int = 0,
        limit: int = 2000,
    ) -&gt; str:
        &quot;&quot;&quot;Read file content with line numbers.

        Args:
            file_path: Absolute file path.
            offset: Line offset to start reading from (0-indexed).
            limit: Maximum number of lines to read.

        Returns:
            Formatted file content with line numbers, or error message.
        &quot;&quot;&quot;
        files = self.runtime.state.get(&quot;files&quot;, {})
        file_data = files.get(file_path)

        if file_data is None:
            return f&quot;Error: File &#x27;{file_path}&#x27; not found&quot;

        return format_read_response(file_data, offset, limit)

    def write(
        self,
        file_path: str,
        content: str,
    ) -&gt; WriteResult:
        &quot;&quot;&quot;Create a new file with content.
        Returns WriteResult with files_update to update LangGraph state.
        &quot;&quot;&quot;
        files = self.runtime.state.get(&quot;files&quot;, {})

        if file_path in files:
            return WriteResult(error=f&quot;Cannot write to {file_path} because it already exists. Read and then make an edit, or write to a new path.&quot;)

        new_file_data = create_file_data(content)
        return WriteResult(path=file_path, files_update={file_path: new_file_data})

    def edit(
        self,
        file_path: str,
        old_string: str,
        new_string: str,
        replace_all: bool = False,
    ) -&gt; EditResult:
        &quot;&quot;&quot;Edit a file by replacing string occurrences.
        Returns EditResult with files_update and occurrences.
        &quot;&quot;&quot;
        files = self.runtime.state.get(&quot;files&quot;, {})
        file_data = files.get(file_path)

        if file_data is None:
            return EditResult(error=f&quot;Error: File &#x27;{file_path}&#x27; not found&quot;)

        content = file_data_to_string(file_data)
        result = perform_string_replacement(content, old_string, new_string, replace_all)

        if isinstance(result, str):
            return EditResult(error=result)

        new_content, occurrences = result
        new_file_data = update_file_data(file_data, new_content)
        return EditResult(path=file_path, files_update={file_path: new_file_data}, occurrences=int(occurrences))

    def grep_raw(
        self,
        pattern: str,
        path: str = &quot;/&quot;,
        glob: str | None = None,
    ) -&gt; list[GrepMatch] | str:
        files = self.runtime.state.get(&quot;files&quot;, {})
        return grep_matches_from_files(files, pattern, path, glob)

    def glob_info(self, pattern: str, path: str = &quot;/&quot;) -&gt; list[FileInfo]:
        &quot;&quot;&quot;Get FileInfo for files matching glob pattern.&quot;&quot;&quot;
        files = self.runtime.state.get(&quot;files&quot;, {})
        result = _glob_search_files(files, pattern, path)
        if result == &quot;No files found&quot;:
            return []
        paths = result.split(&quot;\n&quot;)
        infos: list[FileInfo] = []
        for p in paths:
            fd = files.get(p)
            size = len(&quot;\n&quot;.join(fd.get(&quot;content&quot;, []))) if fd else 0
            infos.append(
                {
                    &quot;path&quot;: p,
                    &quot;is_dir&quot;: False,
                    &quot;size&quot;: int(size),
                    &quot;modified_at&quot;: fd.get(&quot;modified_at&quot;, &quot;&quot;) if fd else &quot;&quot;,
                }
            )
        return infos

    def upload_files(self, files: list[tuple[str, bytes]]) -&gt; list[FileUploadResponse]:
        &quot;&quot;&quot;Upload multiple files to state.

        Args:
            files: List of (path, content) tuples to upload

        Returns:
            List of FileUploadResponse objects, one per input file
        &quot;&quot;&quot;
        raise NotImplementedError(
            &quot;StateBackend does not support upload_files yet. You can upload files &quot;
            &quot;directly by passing them in invoke if you&#x27;re storing files in the memory.&quot;
        )

    def download_files(self, paths: list[str]) -&gt; list[FileDownloadResponse]:
        &quot;&quot;&quot;Download multiple files from state.

        Args:
            paths: List of file paths to download

        Returns:
            List of FileDownloadResponse objects, one per input path
        &quot;&quot;&quot;
        state_files = self.runtime.state.get(&quot;files&quot;, {})
        responses: list[FileDownloadResponse] = []

        for path in paths:
            file_data = state_files.get(path)

            if file_data is None:
                responses.append(FileDownloadResponse(path=path, content=None, error=&quot;file_not_found&quot;))
                continue

            # Convert file data to bytes
            content_str = file_data_to_string(file_data)
            content_bytes = content_str.encode(&quot;utf-8&quot;)

            responses.append(FileDownloadResponse(path=path, content=content_bytes, error=None))

        return responses</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/state/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/backends/state.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="status Imported skill status from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/widgets/status.py Unknown LICENSE sources/langchain/status/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">status</div>
                <button class="copy-btn" onclick="copyToClipboard('status')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill status from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Status bar widget for deepagents-cli.&quot;&quot;&quot;

from __future__ import annotations

from pathlib import Path
from typing import TYPE_CHECKING, Any

from textual.containers import Horizontal
from textual.css.query import NoMatches
from textual.reactive import reactive
from textual.widgets import Static

if TYPE_CHECKING:
    from textual.app import ComposeResult


class StatusBar(Horizontal):
    &quot;&quot;&quot;Status bar showing mode, auto-approve status, and working directory.&quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    StatusBar {
        height: 1;
        dock: bottom;
        background: $surface;
        padding: 0 1;
    }

    StatusBar .status-mode {
        width: auto;
        padding: 0 1;
    }

    StatusBar .status-mode.normal {
        display: none;
    }

    StatusBar .status-mode.bash {
        background: #ff1493;
        color: white;
        text-style: bold;
    }

    StatusBar .status-mode.command {
        background: #8b5cf6;
        color: white;
    }

    StatusBar .status-auto-approve {
        width: auto;
        padding: 0 1;
    }

    StatusBar .status-auto-approve.on {
        background: #10b981;
        color: black;
    }

    StatusBar .status-auto-approve.off {
        background: #f59e0b;
        color: black;
    }

    StatusBar .status-message {
        width: auto;
        padding: 0 1;
        color: $text-muted;
    }

    StatusBar .status-message.thinking {
        color: $warning;
    }

    StatusBar .status-cwd {
        width: 1fr;
        text-align: right;
        color: $text-muted;
    }

    StatusBar .status-tokens {
        width: auto;
        padding: 0 1;
        color: $text-muted;
    }
    &quot;&quot;&quot;

    mode: reactive[str] = reactive(&quot;normal&quot;, init=False)
    status_message: reactive[str] = reactive(&quot;&quot;, init=False)
    auto_approve: reactive[bool] = reactive(default=False, init=False)
    cwd: reactive[str] = reactive(&quot;&quot;, init=False)
    tokens: reactive[int] = reactive(0, init=False)

    def __init__(self, cwd: str | Path | None = None, **kwargs: Any) -&gt; None:
        &quot;&quot;&quot;Initialize the status bar.

        Args:
            cwd: Current working directory to display
            **kwargs: Additional arguments passed to parent
        &quot;&quot;&quot;
        super().__init__(**kwargs)
        # Store initial cwd - will be used in compose()
        self._initial_cwd = str(cwd) if cwd else str(Path.cwd())

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the status bar layout.&quot;&quot;&quot;
        yield Static(&quot;&quot;, classes=&quot;status-mode normal&quot;, id=&quot;mode-indicator&quot;)
        yield Static(
            &quot;manual | shift+tab to cycle&quot;,
            classes=&quot;status-auto-approve off&quot;,
            id=&quot;auto-approve-indicator&quot;,
        )
        yield Static(&quot;&quot;, classes=&quot;status-message&quot;, id=&quot;status-message&quot;)
        yield Static(&quot;&quot;, classes=&quot;status-tokens&quot;, id=&quot;tokens-display&quot;)
        # CWD shown in welcome banner, not pinned in status bar

    def on_mount(self) -&gt; None:
        &quot;&quot;&quot;Set reactive values after mount to trigger watchers safely.&quot;&quot;&quot;
        self.cwd = self._initial_cwd

    def watch_mode(self, mode: str) -&gt; None:
        &quot;&quot;&quot;Update mode indicator when mode changes.&quot;&quot;&quot;
        try:
            indicator = self.query_one(&quot;#mode-indicator&quot;, Static)
        except NoMatches:
            return
        indicator.remove_class(&quot;normal&quot;, &quot;bash&quot;, &quot;command&quot;)

        if mode == &quot;bash&quot;:
            indicator.update(&quot;BASH&quot;)
            indicator.add_class(&quot;bash&quot;)
        elif mode == &quot;command&quot;:
            indicator.update(&quot;CMD&quot;)
            indicator.add_class(&quot;command&quot;)
        else:
            indicator.update(&quot;&quot;)
            indicator.add_class(&quot;normal&quot;)

    def watch_auto_approve(self, new_value: bool) -&gt; None:  # noqa: FBT001
        &quot;&quot;&quot;Update auto-approve indicator when state changes.&quot;&quot;&quot;
        try:
            indicator = self.query_one(&quot;#auto-approve-indicator&quot;, Static)
        except NoMatches:
            return
        indicator.remove_class(&quot;on&quot;, &quot;off&quot;)

        if new_value:
            indicator.update(&quot;auto | shift+tab to cycle&quot;)
            indicator.add_class(&quot;on&quot;)
        else:
            indicator.update(&quot;manual | shift+tab to cycle&quot;)
            indicator.add_class(&quot;off&quot;)

    def watch_cwd(self, new_value: str) -&gt; None:
        &quot;&quot;&quot;Update cwd display when it changes.&quot;&quot;&quot;
        try:
            display = self.query_one(&quot;#cwd-display&quot;, Static)
        except NoMatches:
            return
        display.update(self._format_cwd(new_value))

    def watch_status_message(self, new_value: str) -&gt; None:
        &quot;&quot;&quot;Update status message display.&quot;&quot;&quot;
        try:
            msg_widget = self.query_one(&quot;#status-message&quot;, Static)
        except NoMatches:
            return

        msg_widget.remove_class(&quot;thinking&quot;)
        if new_value:
            msg_widget.update(new_value)
            if &quot;thinking&quot; in new_value.lower() or &quot;executing&quot; in new_value.lower():
                msg_widget.add_class(&quot;thinking&quot;)
        else:
            msg_widget.update(&quot;&quot;)

    def _format_cwd(self, cwd_path: str = &quot;&quot;) -&gt; str:
        &quot;&quot;&quot;Format the current working directory for display.&quot;&quot;&quot;
        path = Path(cwd_path or self.cwd or self._initial_cwd)
        try:
            # Try to use ~ for home directory
            home = Path.home()
            if path.is_relative_to(home):
                return &quot;~/&quot; + str(path.relative_to(home))
        except (ValueError, RuntimeError):
            pass
        return str(path)

    def set_mode(self, mode: str) -&gt; None:
        &quot;&quot;&quot;Set the current input mode.

        Args:
            mode: One of &quot;normal&quot;, &quot;bash&quot;, or &quot;command&quot;
        &quot;&quot;&quot;
        self.mode = mode

    def set_auto_approve(self, *, enabled: bool) -&gt; None:
        &quot;&quot;&quot;Set the auto-approve state.

        Args:
            enabled: Whether auto-approve is enabled
        &quot;&quot;&quot;
        self.auto_approve = enabled

    def set_status_message(self, message: str) -&gt; None:
        &quot;&quot;&quot;Set the status message.

        Args:
            message: Status message to display (empty string to clear)
        &quot;&quot;&quot;
        self.status_message = message

    def watch_tokens(self, new_value: int) -&gt; None:
        &quot;&quot;&quot;Update token display when count changes.&quot;&quot;&quot;
        try:
            display = self.query_one(&quot;#tokens-display&quot;, Static)
        except NoMatches:
            return

        if new_value &gt; 0:
            # Format with K suffix for thousands
            if new_value &gt;= 1000:
                display.update(f&quot;{new_value / 1000:.1f}K tokens&quot;)
            else:
                display.update(f&quot;{new_value} tokens&quot;)
        else:
            display.update(&quot;&quot;)

    def set_tokens(self, count: int) -&gt; None:
        &quot;&quot;&quot;Set the token count.

        Args:
            count: Current context token count
        &quot;&quot;&quot;
        self.tokens = count

    def hide_tokens(self) -&gt; None:
        &quot;&quot;&quot;Hide the token display (e.g., during streaming).&quot;&quot;&quot;
        self.query_one(&quot;#tokens-display&quot;, Static).update(&quot;&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/status/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="store Imported skill store from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/backends/store.py Unknown LICENSE sources/langchain/store/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">store</div>
                <button class="copy-btn" onclick="copyToClipboard('store')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill store from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;StoreBackend: Adapter for LangGraph&#x27;s BaseStore (persistent, cross-thread).&quot;&quot;&quot;

from typing import Any

from langgraph.config import get_config
from langgraph.store.base import BaseStore, Item

from deepagents.backends.protocol import (
    BackendProtocol,
    EditResult,
    FileDownloadResponse,
    FileInfo,
    FileUploadResponse,
    GrepMatch,
    WriteResult,
)
from deepagents.backends.utils import (
    _glob_search_files,
    create_file_data,
    file_data_to_string,
    format_read_response,
    grep_matches_from_files,
    perform_string_replacement,
    update_file_data,
)


class StoreBackend(BackendProtocol):
    &quot;&quot;&quot;Backend that stores files in LangGraph&#x27;s BaseStore (persistent).

    Uses LangGraph&#x27;s Store for persistent, cross-conversation storage.
    Files are organized via namespaces and persist across all threads.

    The namespace can include an optional assistant_id for multi-agent isolation.
    &quot;&quot;&quot;

    def __init__(self, runtime: &quot;ToolRuntime&quot;):
        &quot;&quot;&quot;Initialize StoreBackend with runtime.

        Args:
            runtime: The ToolRuntime instance providing store access and configuration.
        &quot;&quot;&quot;
        self.runtime = runtime

    def _get_store(self) -&gt; BaseStore:
        &quot;&quot;&quot;Get the store instance.

        Returns:
            BaseStore instance from the runtime.

        Raises:
            ValueError: If no store is available in the runtime.
        &quot;&quot;&quot;
        store = self.runtime.store
        if store is None:
            msg = &quot;Store is required but not available in runtime&quot;
            raise ValueError(msg)
        return store

    def _get_namespace(self) -&gt; tuple[str, ...]:
        &quot;&quot;&quot;Get the namespace for store operations.

        Preference order:
        1) Use `self.runtime.config` if present (tests pass this explicitly).
        2) Fallback to `langgraph.config.get_config()` if available.
        3) Default to (&quot;filesystem&quot;,).

        If an assistant_id is available in the config metadata, return
        (assistant_id, &quot;filesystem&quot;) to provide per-assistant isolation.
        &quot;&quot;&quot;
        namespace = &quot;filesystem&quot;

        # Prefer the runtime-provided config when present
        runtime_cfg = getattr(self.runtime, &quot;config&quot;, None)
        if isinstance(runtime_cfg, dict):
            assistant_id = runtime_cfg.get(&quot;metadata&quot;, {}).get(&quot;assistant_id&quot;)
            if assistant_id:
                return (assistant_id, namespace)
            return (namespace,)

        # Fallback to langgraph&#x27;s context, but guard against errors when
        # called outside of a runnable context
        try:
            cfg = get_config()
        except Exception:
            return (namespace,)

        try:
            assistant_id = cfg.get(&quot;metadata&quot;, {}).get(&quot;assistant_id&quot;)  # type: ignore[assignment]
        except Exception:
            assistant_id = None

        if assistant_id:
            return (assistant_id, namespace)
        return (namespace,)

    def _convert_store_item_to_file_data(self, store_item: Item) -&gt; dict[str, Any]:
        &quot;&quot;&quot;Convert a store Item to FileData format.

        Args:
            store_item: The store Item containing file data.

        Returns:
            FileData dict with content, created_at, and modified_at fields.

        Raises:
            ValueError: If required fields are missing or have incorrect types.
        &quot;&quot;&quot;
        if &quot;content&quot; not in store_item.value or not isinstance(store_item.value[&quot;content&quot;], list):
            msg = f&quot;Store item does not contain valid content field. Got: {store_item.value.keys()}&quot;
            raise ValueError(msg)
        if &quot;created_at&quot; not in store_item.value or not isinstance(store_item.value[&quot;created_at&quot;], str):
            msg = f&quot;Store item does not contain valid created_at field. Got: {store_item.value.keys()}&quot;
            raise ValueError(msg)
        if &quot;modified_at&quot; not in store_item.value or not isinstance(store_item.value[&quot;modified_at&quot;], str):
            msg = f&quot;Store item does not contain valid modified_at field. Got: {store_item.value.keys()}&quot;
            raise ValueError(msg)
        return {
            &quot;content&quot;: store_item.value[&quot;content&quot;],
            &quot;created_at&quot;: store_item.value[&quot;created_at&quot;],
            &quot;modified_at&quot;: store_item.value[&quot;modified_at&quot;],
        }

    def _convert_file_data_to_store_value(self, file_data: dict[str, Any]) -&gt; dict[str, Any]:
        &quot;&quot;&quot;Convert FileData to a dict suitable for store.put().

        Args:
            file_data: The FileData to convert.

        Returns:
            Dictionary with content, created_at, and modified_at fields.
        &quot;&quot;&quot;
        return {
            &quot;content&quot;: file_data[&quot;content&quot;],
            &quot;created_at&quot;: file_data[&quot;created_at&quot;],
            &quot;modified_at&quot;: file_data[&quot;modified_at&quot;],
        }

    def _search_store_paginated(
        self,
        store: BaseStore,
        namespace: tuple[str, ...],
        *,
        query: str | None = None,
        filter: dict[str, Any] | None = None,
        page_size: int = 100,
    ) -&gt; list[Item]:
        &quot;&quot;&quot;Search store with automatic pagination to retrieve all results.

        Args:
            store: The store to search.
            namespace: Hierarchical path prefix to search within.
            query: Optional query for natural language search.
            filter: Key-value pairs to filter results.
            page_size: Number of items to fetch per page (default: 100).

        Returns:
            List of all items matching the search criteria.

        Example:
            ```python
            store = _get_store(runtime)
            namespace = _get_namespace()
            all_items = _search_store_paginated(store, namespace)
            ```
        &quot;&quot;&quot;
        all_items: list[Item] = []
        offset = 0
        while True:
            page_items = store.search(
                namespace,
                query=query,
                filter=filter,
                limit=page_size,
                offset=offset,
            )
            if not page_items:
                break
            all_items.extend(page_items)
            if len(page_items) &lt; page_size:
                break
            offset += page_size

        return all_items

    def ls_info(self, path: str) -&gt; list[FileInfo]:
        &quot;&quot;&quot;List files and directories in the specified directory (non-recursive).

        Args:
            path: Absolute path to directory.

        Returns:
            List of FileInfo-like dicts for files and directories directly in the directory.
            Directories have a trailing / in their path and is_dir=True.
        &quot;&quot;&quot;
        store = self._get_store()
        namespace = self._get_namespace()

        # Retrieve all items and filter by path prefix locally to avoid
        # coupling to store-specific filter semantics
        items = self._search_store_paginated(store, namespace)
        infos: list[FileInfo] = []
        subdirs: set[str] = set()

        # Normalize path to have trailing slash for proper prefix matching
        normalized_path = path if path.endswith(&quot;/&quot;) else path + &quot;/&quot;

        for item in items:
            # Check if file is in the specified directory or a subdirectory
            if not str(item.key).startswith(normalized_path):
                continue

            # Get the relative path after the directory
            relative = str(item.key)[len(normalized_path) :]

            # If relative path contains &#x27;/&#x27;, it&#x27;s in a subdirectory
            if &quot;/&quot; in relative:
                # Extract the immediate subdirectory name
                subdir_name = relative.split(&quot;/&quot;)[0]
                subdirs.add(normalized_path + subdir_name + &quot;/&quot;)
                continue

            # This is a file directly in the current directory
            try:
                fd = self._convert_store_item_to_file_data(item)
            except ValueError:
                continue
            size = len(&quot;\n&quot;.join(fd.get(&quot;content&quot;, [])))
            infos.append(
                {
                    &quot;path&quot;: item.key,
                    &quot;is_dir&quot;: False,
                    &quot;size&quot;: int(size),
                    &quot;modified_at&quot;: fd.get(&quot;modified_at&quot;, &quot;&quot;),
                }
            )

        # Add directories to the results
        for subdir in sorted(subdirs):
            infos.append(
                {
                    &quot;path&quot;: subdir,
                    &quot;is_dir&quot;: True,
                    &quot;size&quot;: 0,
                    &quot;modified_at&quot;: &quot;&quot;,
                }
            )

        infos.sort(key=lambda x: x.get(&quot;path&quot;, &quot;&quot;))
        return infos

    def read(
        self,
        file_path: str,
        offset: int = 0,
        limit: int = 2000,
    ) -&gt; str:
        &quot;&quot;&quot;Read file content with line numbers.

        Args:
            file_path: Absolute file path.
            offset: Line offset to start reading from (0-indexed).
            limit: Maximum number of lines to read.

        Returns:
            Formatted file content with line numbers, or error message.
        &quot;&quot;&quot;
        store = self._get_store()
        namespace = self._get_namespace()
        item: Item | None = store.get(namespace, file_path)

        if item is None:
            return f&quot;Error: File &#x27;{file_path}&#x27; not found&quot;

        try:
            file_data = self._convert_store_item_to_file_data(item)
        except ValueError as e:
            return f&quot;Error: {e}&quot;

        return format_read_response(file_data, offset, limit)

    async def aread(
        self,
        file_path: str,
        offset: int = 0,
        limit: int = 2000,
    ) -&gt; str:
        &quot;&quot;&quot;Async version of read using native store async methods.

        This avoids sync calls in async context by using store.aget directly.
        &quot;&quot;&quot;
        store = self._get_store()
        namespace = self._get_namespace()
        item: Item | None = await store.aget(namespace, file_path)

        if item is None:
            return f&quot;Error: File &#x27;{file_path}&#x27; not found&quot;

        try:
            file_data = self._convert_store_item_to_file_data(item)
        except ValueError as e:
            return f&quot;Error: {e}&quot;

        return format_read_response(file_data, offset, limit)

    def write(
        self,
        file_path: str,
        content: str,
    ) -&gt; WriteResult:
        &quot;&quot;&quot;Create a new file with content.
        Returns WriteResult. External storage sets files_update=None.
        &quot;&quot;&quot;
        store = self._get_store()
        namespace = self._get_namespace()

        # Check if file exists
        existing = store.get(namespace, file_path)
        if existing is not None:
            return WriteResult(error=f&quot;Cannot write to {file_path} because it already exists. Read and then make an edit, or write to a new path.&quot;)

        # Create new file
        file_data = create_file_data(content)
        store_value = self._convert_file_data_to_store_value(file_data)
        store.put(namespace, file_path, store_value)
        return WriteResult(path=file_path, files_update=None)

    async def awrite(
        self,
        file_path: str,
        content: str,
    ) -&gt; WriteResult:
        &quot;&quot;&quot;Async version of write using native store async methods.

        This avoids sync calls in async context by using store.aget/aput directly.
        &quot;&quot;&quot;
        store = self._get_store()
        namespace = self._get_namespace()

        # Check if file exists using async method
        existing = await store.aget(namespace, file_path)
        if existing is not None:
            return WriteResult(error=f&quot;Cannot write to {file_path} because it already exists. Read and then make an edit, or write to a new path.&quot;)

        # Create new file using async method
        file_data = create_file_data(content)
        store_value = self._convert_file_data_to_store_value(file_data)
        await store.aput(namespace, file_path, store_value)
        return WriteResult(path=file_path, files_update=None)

    def edit(
        self,
        file_path: str,
        old_string: str,
        new_string: str,
        replace_all: bool = False,
    ) -&gt; EditResult:
        &quot;&quot;&quot;Edit a file by replacing string occurrences.
        Returns EditResult. External storage sets files_update=None.
        &quot;&quot;&quot;
        store = self._get_store()
        namespace = self._get_namespace()

        # Get existing file
        item = store.get(namespace, file_path)
        if item is None:
            return EditResult(error=f&quot;Error: File &#x27;{file_path}&#x27; not found&quot;)

        try:
            file_data = self._convert_store_item_to_file_data(item)
        except ValueError as e:
            return EditResult(error=f&quot;Error: {e}&quot;)

        content = file_data_to_string(file_data)
        result = perform_string_replacement(content, old_string, new_string, replace_all)

        if isinstance(result, str):
            return EditResult(error=result)

        new_content, occurrences = result
        new_file_data = update_file_data(file_data, new_content)

        # Update file in store
        store_value = self._convert_file_data_to_store_value(new_file_data)
        store.put(namespace, file_path, store_value)
        return EditResult(path=file_path, files_update=None, occurrences=int(occurrences))

    async def aedit(
        self,
        file_path: str,
        old_string: str,
        new_string: str,
        replace_all: bool = False,
    ) -&gt; EditResult:
        &quot;&quot;&quot;Async version of edit using native store async methods.

        This avoids sync calls in async context by using store.aget/aput directly.
        &quot;&quot;&quot;
        store = self._get_store()
        namespace = self._get_namespace()

        # Get existing file using async method
        item = await store.aget(namespace, file_path)
        if item is None:
            return EditResult(error=f&quot;Error: File &#x27;{file_path}&#x27; not found&quot;)

        try:
            file_data = self._convert_store_item_to_file_data(item)
        except ValueError as e:
            return EditResult(error=f&quot;Error: {e}&quot;)

        content = file_data_to_string(file_data)
        result = perform_string_replacement(content, old_string, new_string, replace_all)

        if isinstance(result, str):
            return EditResult(error=result)

        new_content, occurrences = result
        new_file_data = update_file_data(file_data, new_content)

        # Update file in store using async method
        store_value = self._convert_file_data_to_store_value(new_file_data)
        await store.aput(namespace, file_path, store_value)
        return EditResult(path=file_path, files_update=None, occurrences=int(occurrences))

    # Removed legacy grep() convenience to keep lean surface

    def grep_raw(
        self,
        pattern: str,
        path: str = &quot;/&quot;,
        glob: str | None = None,
    ) -&gt; list[GrepMatch] | str:
        store = self._get_store()
        namespace = self._get_namespace()
        items = self._search_store_paginated(store, namespace)
        files: dict[str, Any] = {}
        for item in items:
            try:
                files[item.key] = self._convert_store_item_to_file_data(item)
            except ValueError:
                continue
        return grep_matches_from_files(files, pattern, path, glob)

    def glob_info(self, pattern: str, path: str = &quot;/&quot;) -&gt; list[FileInfo]:
        store = self._get_store()
        namespace = self._get_namespace()
        items = self._search_store_paginated(store, namespace)
        files: dict[str, Any] = {}
        for item in items:
            try:
                files[item.key] = self._convert_store_item_to_file_data(item)
            except ValueError:
                continue
        result = _glob_search_files(files, pattern, path)
        if result == &quot;No files found&quot;:
            return []
        paths = result.split(&quot;\n&quot;)
        infos: list[FileInfo] = []
        for p in paths:
            fd = files.get(p)
            size = len(&quot;\n&quot;.join(fd.get(&quot;content&quot;, []))) if fd else 0
            infos.append(
                {
                    &quot;path&quot;: p,
                    &quot;is_dir&quot;: False,
                    &quot;size&quot;: int(size),
                    &quot;modified_at&quot;: fd.get(&quot;modified_at&quot;, &quot;&quot;) if fd else &quot;&quot;,
                }
            )
        return infos

    def upload_files(self, files: list[tuple[str, bytes]]) -&gt; list[FileUploadResponse]:
        &quot;&quot;&quot;Upload multiple files to the store.

        Args:
            files: List of (path, content) tuples where content is bytes.

        Returns:
            List of FileUploadResponse objects, one per input file.
            Response order matches input order.
        &quot;&quot;&quot;
        store = self._get_store()
        namespace = self._get_namespace()
        responses: list[FileUploadResponse] = []

        for path, content in files:
            content_str = content.decode(&quot;utf-8&quot;)
            # Create file data
            file_data = create_file_data(content_str)
            store_value = self._convert_file_data_to_store_value(file_data)

            # Store the file
            store.put(namespace, path, store_value)
            responses.append(FileUploadResponse(path=path, error=None))

        return responses

    def download_files(self, paths: list[str]) -&gt; list[FileDownloadResponse]:
        &quot;&quot;&quot;Download multiple files from the store.

        Args:
            paths: List of file paths to download.

        Returns:
            List of FileDownloadResponse objects, one per input path.
            Response order matches input order.
        &quot;&quot;&quot;
        store = self._get_store()
        namespace = self._get_namespace()
        responses: list[FileDownloadResponse] = []

        for path in paths:
            item = store.get(namespace, path)

            if item is None:
                responses.append(FileDownloadResponse(path=path, content=None, error=&quot;file_not_found&quot;))
                continue

            file_data = self._convert_store_item_to_file_data(item)
            # Convert file data to bytes
            content_str = file_data_to_string(file_data)
            content_bytes = content_str.encode(&quot;utf-8&quot;)

            responses.append(FileDownloadResponse(path=path, content=content_bytes, error=None))

        return responses</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/store/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/backends/store.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="subagents Imported skill subagents from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/middleware/subagents.py Unknown LICENSE sources/langchain/subagents/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">subagents</div>
                <button class="copy-btn" onclick="copyToClipboard('subagents')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill subagents from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Middleware for providing subagents to an agent via a `task` tool.&quot;&quot;&quot;

from collections.abc import Awaitable, Callable, Sequence
from typing import Any, NotRequired, TypedDict, cast

from langchain.agents import create_agent
from langchain.agents.middleware import HumanInTheLoopMiddleware, InterruptOnConfig
from langchain.agents.middleware.types import AgentMiddleware, ModelRequest, ModelResponse
from langchain.tools import BaseTool, ToolRuntime
from langchain_core.language_models import BaseChatModel
from langchain_core.messages import HumanMessage, ToolMessage
from langchain_core.runnables import Runnable
from langchain_core.tools import StructuredTool
from langgraph.types import Command

from deepagents.middleware._utils import append_to_system_message


class SubAgent(TypedDict):
    &quot;&quot;&quot;Specification for an agent.

    When specifying custom agents, the `default_middleware` from `SubAgentMiddleware`
    will be applied first, followed by any `middleware` specified in this spec.
    To use only custom middleware without the defaults, pass `default_middleware=[]`
    to `SubAgentMiddleware`.

    Required fields:
        name: Unique identifier for the subagent.

            The main agent uses this name when calling the `task()` tool.
        description: What this subagent does.

            Be specific and action-oriented. The main agent uses this to decide when to delegate.
        system_prompt: Instructions for the subagent.

            Include tool usage guidance and output format requirements.
        tools: Tools the subagent can use.

            Keep this minimal and include only what&#x27;s needed.

    Optional fields:
        model: Override the main agent&#x27;s model.

            Use the format `&#x27;provider:model-name&#x27;` (e.g., `&#x27;openai:gpt-4o&#x27;`).
        middleware: Additional middleware for custom behavior, logging, or rate limiting.
        interrupt_on: Configure human-in-the-loop for specific tools.

            Requires a checkpointer.
    &quot;&quot;&quot;

    name: str
    &quot;&quot;&quot;Unique identifier for the subagent.&quot;&quot;&quot;

    description: str
    &quot;&quot;&quot;What this subagent does. The main agent uses this to decide when to delegate.&quot;&quot;&quot;

    system_prompt: str
    &quot;&quot;&quot;Instructions for the subagent.&quot;&quot;&quot;

    tools: Sequence[BaseTool | Callable | dict[str, Any]]
    &quot;&quot;&quot;Tools the subagent can use.&quot;&quot;&quot;

    model: NotRequired[str | BaseChatModel]
    &quot;&quot;&quot;Override the main agent&#x27;s model. Use `&#x27;provider:model-name&#x27;` format.&quot;&quot;&quot;

    middleware: NotRequired[list[AgentMiddleware]]
    &quot;&quot;&quot;Additional middleware for custom behavior.&quot;&quot;&quot;

    interrupt_on: NotRequired[dict[str, bool | InterruptOnConfig]]
    &quot;&quot;&quot;Configure human-in-the-loop for specific tools.&quot;&quot;&quot;


class CompiledSubAgent(TypedDict):
    &quot;&quot;&quot;A pre-compiled agent spec.

    !!! note

        The runnable&#x27;s state schema must include a &#x27;messages&#x27; key.

        This is required for the subagent to communicate results back to the main agent.

    When the subagent completes, the final message in the &#x27;messages&#x27; list will be
    extracted and returned as a `ToolMessage` to the parent agent.
    &quot;&quot;&quot;

    name: str
    &quot;&quot;&quot;Unique identifier for the subagent.&quot;&quot;&quot;

    description: str
    &quot;&quot;&quot;What this subagent does.&quot;&quot;&quot;

    runnable: Runnable
    &quot;&quot;&quot;A custom agent implementation.

    Create a custom agent using either:

    1. LangChain&#x27;s [`create_agent()`](https://docs.langchain.com/oss/python/langchain/quickstart)
    2. A custom graph using [`langgraph`](https://docs.langchain.com/oss/python/langgraph/quickstart)

    If you&#x27;re creating a custom graph, make sure the state schema includes a &#x27;messages&#x27; key.
    This is required for the subagent to communicate results back to the main agent.
    &quot;&quot;&quot;


DEFAULT_SUBAGENT_PROMPT = &quot;In order to complete the objective that the user asks of you, you have access to a number of standard tools.&quot;

# State keys that are excluded when passing state to subagents and when returning
# updates from subagents.
# When returning updates:
# 1. The messages key is handled explicitly to ensure only the final message is included
# 2. The todos and structured_response keys are excluded as they do not have a defined reducer
#    and no clear meaning for returning them from a subagent to the main agent.
_EXCLUDED_STATE_KEYS = {&quot;messages&quot;, &quot;todos&quot;, &quot;structured_response&quot;}

TASK_TOOL_DESCRIPTION = &quot;&quot;&quot;Launch an ephemeral subagent to handle complex, multi-step independent tasks with isolated context windows.

Available agent types and the tools they have access to:
{available_agents}

When using the Task tool, you must specify a subagent_type parameter to select which agent type to use.

## Usage notes:
1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses
2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.
3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.
4. The agent&#x27;s outputs should generally be trusted
5. Clearly tell the agent whether you expect it to create content, perform analysis, or just do research (search, file reads, web fetches, etc.), since it is not aware of the user&#x27;s intent
6. If the agent description mentions that it should be used proactively, then you should try your best to use it without the user having to ask for it first. Use your judgement.
7. When only the general-purpose agent is provided, you should use it for all tasks. It is great for isolating context and token usage, and completing specific, complex tasks, as it has all the same capabilities as the main agent.

### Example usage of the general-purpose agent:

&lt;example_agent_descriptions&gt;
&quot;general-purpose&quot;: use this agent for general purpose tasks, it has access to all tools as the main agent.
&lt;/example_agent_descriptions&gt;

&lt;example&gt;
User: &quot;I want to conduct research on the accomplishments of Lebron James, Michael Jordan, and Kobe Bryant, and then compare them.&quot;
Assistant: *Uses the task tool in parallel to conduct isolated research on each of the three players*
Assistant: *Synthesizes the results of the three isolated research tasks and responds to the User*
&lt;commentary&gt;
Research is a complex, multi-step task in it of itself.
The research of each individual player is not dependent on the research of the other players.
The assistant uses the task tool to break down the complex objective into three isolated tasks.
Each research task only needs to worry about context and tokens about one player, then returns synthesized information about each player as the Tool Result.
This means each research task can dive deep and spend tokens and context deeply researching each player, but the final result is synthesized information, and saves us tokens in the long run when comparing the players to each other.
&lt;/commentary&gt;
&lt;/example&gt;

&lt;example&gt;
User: &quot;Analyze a single large code repository for security vulnerabilities and generate a report.&quot;
Assistant: *Launches a single `task` subagent for the repository analysis*
Assistant: *Receives report and integrates results into final summary*
&lt;commentary&gt;
Subagent is used to isolate a large, context-heavy task, even though there is only one. This prevents the main thread from being overloaded with details.
If the user then asks followup questions, we have a concise report to reference instead of the entire history of analysis and tool calls, which is good and saves us time and money.
&lt;/commentary&gt;
&lt;/example&gt;

&lt;example&gt;
User: &quot;Schedule two meetings for me and prepare agendas for each.&quot;
Assistant: *Calls the task tool in parallel to launch two `task` subagents (one per meeting) to prepare agendas*
Assistant: *Returns final schedules and agendas*
&lt;commentary&gt;
Tasks are simple individually, but subagents help silo agenda preparation.
Each subagent only needs to worry about the agenda for one meeting.
&lt;/commentary&gt;
&lt;/example&gt;

&lt;example&gt;
User: &quot;I want to order a pizza from Dominos, order a burger from McDonald&#x27;s, and order a salad from Subway.&quot;
Assistant: *Calls tools directly in parallel to order a pizza from Dominos, a burger from McDonald&#x27;s, and a salad from Subway*
&lt;commentary&gt;
The assistant did not use the task tool because the objective is super simple and clear and only requires a few trivial tool calls.
It is better to just complete the task directly and NOT use the `task`tool.
&lt;/commentary&gt;
&lt;/example&gt;

### Example usage with custom agents:

&lt;example_agent_descriptions&gt;
&quot;content-reviewer&quot;: use this agent after you are done creating significant content or documents
&quot;greeting-responder&quot;: use this agent when to respond to user greetings with a friendly joke
&quot;research-analyst&quot;: use this agent to conduct thorough research on complex topics
&lt;/example_agent_description&gt;

&lt;example&gt;
user: &quot;Please write a function that checks if a number is prime&quot;
assistant: Sure let me write a function that checks if a number is prime
assistant: First let me use the Write tool to write a function that checks if a number is prime
assistant: I&#x27;m going to use the Write tool to write the following code:
&lt;code&gt;
function isPrime(n) {{
  if (n &lt;= 1) return false
  for (let i = 2; i * i &lt;= n; i++) {{
    if (n % i === 0) return false
  }}
  return true
}}
&lt;/code&gt;
&lt;commentary&gt;
Since significant content was created and the task was completed, now use the content-reviewer agent to review the work
&lt;/commentary&gt;
assistant: Now let me use the content-reviewer agent to review the code
assistant: Uses the Task tool to launch with the content-reviewer agent
&lt;/example&gt;

&lt;example&gt;
user: &quot;Can you help me research the environmental impact of different renewable energy sources and create a comprehensive report?&quot;
&lt;commentary&gt;
This is a complex research task that would benefit from using the research-analyst agent to conduct thorough analysis
&lt;/commentary&gt;
assistant: I&#x27;ll help you research the environmental impact of renewable energy sources. Let me use the research-analyst agent to conduct comprehensive research on this topic.
assistant: Uses the Task tool to launch with the research-analyst agent, providing detailed instructions about what research to conduct and what format the report should take
&lt;/example&gt;

&lt;example&gt;
user: &quot;Hello&quot;
&lt;commentary&gt;
Since the user is greeting, use the greeting-responder agent to respond with a friendly joke
&lt;/commentary&gt;
assistant: &quot;I&#x27;m going to use the Task tool to launch with the greeting-responder agent&quot;
&lt;/example&gt;&quot;&quot;&quot;  # noqa: E501

TASK_SYSTEM_PROMPT = &quot;&quot;&quot;## `task` (subagent spawner)

You have access to a `task` tool to launch short-lived subagents that handle isolated tasks. These agents are ephemeral  they live only for the duration of the task and return a single result.

When to use the task tool:
- When a task is complex and multi-step, and can be fully delegated in isolation
- When a task is independent of other tasks and can run in parallel
- When a task requires focused reasoning or heavy token/context usage that would bloat the orchestrator thread
- When sandboxing improves reliability (e.g. code execution, structured searches, data formatting)
- When you only care about the output of the subagent, and not the intermediate steps (ex. performing a lot of research and then returned a synthesized report, performing a series of computations or lookups to achieve a concise, relevant answer.)

Subagent lifecycle:
1. **Spawn**  Provide clear role, instructions, and expected output
2. **Run**  The subagent completes the task autonomously
3. **Return**  The subagent provides a single structured result
4. **Reconcile**  Incorporate or synthesize the result into the main thread

When NOT to use the task tool:
- If you need to see the intermediate reasoning or steps after the subagent has completed (the task tool hides them)
- If the task is trivial (a few tool calls or simple lookup)
- If delegating does not reduce token usage, complexity, or context switching
- If splitting would add latency without benefit

## Important Task Tool Usage Notes to Remember
- Whenever possible, parallelize the work that you do. This is true for both tool_calls, and for tasks. Whenever you have independent steps to complete - make tool_calls, or kick off tasks (subagents) in parallel to accomplish them faster. This saves time for the user, which is incredibly important.
- Remember to use the `task` tool to silo independent tasks within a multi-part objective.
- You should use the `task` tool whenever you have a complex task that will take multiple steps, and is independent from other tasks that the agent needs to complete. These agents are highly competent and efficient.&quot;&quot;&quot;  # noqa: E501


DEFAULT_GENERAL_PURPOSE_DESCRIPTION = &quot;General-purpose agent for researching complex questions, searching for files and content, and executing multi-step tasks. When you are searching for a keyword or file and are not confident that you will find the right match in the first few tries use this agent to perform the search for you. This agent has access to all tools as the main agent.&quot;  # noqa: E501


def _get_subagents(
    *,
    default_model: str | BaseChatModel,
    default_tools: Sequence[BaseTool | Callable | dict[str, Any]],
    default_middleware: list[AgentMiddleware] | None,
    default_interrupt_on: dict[str, bool | InterruptOnConfig] | None,
    subagents: list[SubAgent | CompiledSubAgent],
    general_purpose_agent: bool,
) -&gt; tuple[dict[str, Any], list[str]]:
    &quot;&quot;&quot;Create subagent instances from specifications.

    Args:
        default_model: Default model for subagents that don&#x27;t specify one.
        default_tools: Default tools for subagents that don&#x27;t specify tools.
        default_middleware: Middleware to apply to all subagents. If `None`,
            no default middleware is applied.
        default_interrupt_on: The tool configs to use for the default general-purpose subagent. These
            are also the fallback for any subagents that don&#x27;t specify their own tool configs.
        subagents: List of agent specifications or pre-compiled agents.
        general_purpose_agent: Whether to include a general-purpose subagent.

    Returns:
        Tuple of (agent_dict, description_list) where agent_dict maps agent names
        to runnable instances and description_list contains formatted descriptions.
    &quot;&quot;&quot;
    # Use empty list if None (no default middleware)
    default_subagent_middleware = default_middleware or []

    agents: dict[str, Any] = {}
    subagent_descriptions = []

    # Create general-purpose agent if enabled
    if general_purpose_agent:
        general_purpose_middleware = [*default_subagent_middleware]
        if default_interrupt_on:
            general_purpose_middleware.append(HumanInTheLoopMiddleware(interrupt_on=default_interrupt_on))
        general_purpose_subagent = create_agent(
            default_model,
            system_prompt=DEFAULT_SUBAGENT_PROMPT,
            tools=default_tools,
            middleware=general_purpose_middleware,
            name=&quot;general-purpose&quot;,
        )
        agents[&quot;general-purpose&quot;] = general_purpose_subagent
        subagent_descriptions.append(f&quot;- general-purpose: {DEFAULT_GENERAL_PURPOSE_DESCRIPTION}&quot;)

    # Process custom subagents
    for agent_ in subagents:
        subagent_descriptions.append(f&quot;- {agent_[&#x27;name&#x27;]}: {agent_[&#x27;description&#x27;]}&quot;)
        if &quot;runnable&quot; in agent_:
            custom_agent = cast(&quot;CompiledSubAgent&quot;, agent_)
            agents[custom_agent[&quot;name&quot;]] = custom_agent[&quot;runnable&quot;]
            continue
        _tools = agent_.get(&quot;tools&quot;, list(default_tools))

        subagent_model = agent_.get(&quot;model&quot;, default_model)

        _middleware = [*default_subagent_middleware, *agent_[&quot;middleware&quot;]] if &quot;middleware&quot; in agent_ else [*default_subagent_middleware]

        interrupt_on = agent_.get(&quot;interrupt_on&quot;, default_interrupt_on)
        if interrupt_on:
            _middleware.append(HumanInTheLoopMiddleware(interrupt_on=interrupt_on))

        agents[agent_[&quot;name&quot;]] = create_agent(
            subagent_model,
            system_prompt=agent_[&quot;system_prompt&quot;],
            tools=_tools,
            middleware=_middleware,
            name=agent_[&quot;name&quot;],
        )
    return agents, subagent_descriptions


def _create_task_tool(
    *,
    default_model: str | BaseChatModel,
    default_tools: Sequence[BaseTool | Callable | dict[str, Any]],
    default_middleware: list[AgentMiddleware] | None,
    default_interrupt_on: dict[str, bool | InterruptOnConfig] | None,
    subagents: list[SubAgent | CompiledSubAgent],
    general_purpose_agent: bool,
    task_description: str | None = None,
) -&gt; BaseTool:
    &quot;&quot;&quot;Create a task tool for invoking subagents.

    Args:
        default_model: Default model for subagents.
        default_tools: Default tools for subagents.
        default_middleware: Middleware to apply to all subagents.
        default_interrupt_on: The tool configs to use for the default general-purpose subagent. These
            are also the fallback for any subagents that don&#x27;t specify their own tool configs.
        subagents: List of subagent specifications.
        general_purpose_agent: Whether to include general-purpose agent.
        task_description: Custom description for the task tool. If `None`,
            uses default template. Supports `{available_agents}` placeholder.

    Returns:
        A StructuredTool that can invoke subagents by type.
    &quot;&quot;&quot;
    subagent_graphs, subagent_descriptions = _get_subagents(
        default_model=default_model,
        default_tools=default_tools,
        default_middleware=default_middleware,
        default_interrupt_on=default_interrupt_on,
        subagents=subagents,
        general_purpose_agent=general_purpose_agent,
    )
    subagent_description_str = &quot;\n&quot;.join(subagent_descriptions)

    def _return_command_with_state_update(result: dict, tool_call_id: str) -&gt; Command:
        # Validate that the result contains a &#x27;messages&#x27; key
        if &quot;messages&quot; not in result:
            error_msg = (
                &quot;CompiledSubAgent must return a state containing a &#x27;messages&#x27; key. &quot;
                &quot;Custom StateGraphs used with CompiledSubAgent should include &#x27;messages&#x27; &quot;
                &quot;in their state schema to communicate results back to the main agent.&quot;
            )
            raise ValueError(error_msg)

        state_update = {k: v for k, v in result.items() if k not in _EXCLUDED_STATE_KEYS}
        # Strip trailing whitespace to prevent API errors with Anthropic
        message_text = result[&quot;messages&quot;][-1].text.rstrip() if result[&quot;messages&quot;][-1].text else &quot;&quot;
        return Command(
            update={
                **state_update,
                &quot;messages&quot;: [ToolMessage(message_text, tool_call_id=tool_call_id)],
            }
        )

    def _validate_and_prepare_state(subagent_type: str, description: str, runtime: ToolRuntime) -&gt; tuple[Runnable, dict]:
        &quot;&quot;&quot;Prepare state for invocation.&quot;&quot;&quot;
        subagent = subagent_graphs[subagent_type]
        # Create a new state dict to avoid mutating the original
        subagent_state = {k: v for k, v in runtime.state.items() if k not in _EXCLUDED_STATE_KEYS}
        subagent_state[&quot;messages&quot;] = [HumanMessage(content=description)]
        return subagent, subagent_state

    # Use custom description if provided, otherwise use default template
    if task_description is None:
        task_description = TASK_TOOL_DESCRIPTION.format(available_agents=subagent_description_str)
    elif &quot;{available_agents}&quot; in task_description:
        # If custom description has placeholder, format with agent descriptions
        task_description = task_description.format(available_agents=subagent_description_str)

    def task(
        description: str,
        subagent_type: str,
        runtime: ToolRuntime,
    ) -&gt; str | Command:
        if subagent_type not in subagent_graphs:
            allowed_types = &quot;, &quot;.join([f&quot;`{k}`&quot; for k in subagent_graphs])
            return f&quot;We cannot invoke subagent {subagent_type} because it does not exist, the only allowed types are {allowed_types}&quot;
        subagent, subagent_state = _validate_and_prepare_state(subagent_type, description, runtime)
        result = subagent.invoke(subagent_state)
        if not runtime.tool_call_id:
            value_error_msg = &quot;Tool call ID is required for subagent invocation&quot;
            raise ValueError(value_error_msg)
        return _return_command_with_state_update(result, runtime.tool_call_id)

    async def atask(
        description: str,
        subagent_type: str,
        runtime: ToolRuntime,
    ) -&gt; str | Command:
        if subagent_type not in subagent_graphs:
            allowed_types = &quot;, &quot;.join([f&quot;`{k}`&quot; for k in subagent_graphs])
            return f&quot;We cannot invoke subagent {subagent_type} because it does not exist, the only allowed types are {allowed_types}&quot;
        subagent, subagent_state = _validate_and_prepare_state(subagent_type, description, runtime)
        result = await subagent.ainvoke(subagent_state)
        if not runtime.tool_call_id:
            value_error_msg = &quot;Tool call ID is required for subagent invocation&quot;
            raise ValueError(value_error_msg)
        return _return_command_with_state_update(result, runtime.tool_call_id)

    return StructuredTool.from_function(
        name=&quot;task&quot;,
        func=task,
        coroutine=atask,
        description=task_description,
    )


class SubAgentMiddleware(AgentMiddleware):
    &quot;&quot;&quot;Middleware for providing subagents to an agent via a `task` tool.

    This  middleware adds a `task` tool to the agent that can be used to invoke subagents.
    Subagents are useful for handling complex tasks that require multiple steps, or tasks
    that require a lot of context to resolve.

    A chief benefit of subagents is that they can handle multi-step tasks, and then return
    a clean, concise response to the main agent.

    Subagents are also great for different domains of expertise that require a narrower
    subset of tools and focus.

    This middleware comes with a default general-purpose subagent that can be used to
    handle the same tasks as the main agent, but with isolated context.

    Args:
        default_model: The model to use for subagents.

            Can be a `LanguageModelLike` or a dict for `init_chat_model`.
        default_tools: The tools to use for the default general-purpose subagent.
        default_middleware: Default middleware to apply to all subagents.

            If `None`, no default middleware is applied.

            Pass a list to specify custom middleware.
        default_interrupt_on: The tool configs to use for the default general-purpose subagent.

            These are also the fallback for any subagents that don&#x27;t specify their own tool configs.
        subagents: A list of additional subagents to provide to the agent.
        system_prompt: Full system prompt override. When provided, completely replaces
            the agent&#x27;s system prompt.
        general_purpose_agent: Whether to include the general-purpose agent.
        task_description: Custom description for the task tool.

            If `None`, uses the default description template.

    Example:
        ```python
        from langchain.agents.middleware.subagents import SubAgentMiddleware
        from langchain.agents import create_agent

        # Basic usage with defaults (no default middleware)
        agent = create_agent(
            &quot;openai:gpt-4o&quot;,
            middleware=[
                SubAgentMiddleware(
                    default_model=&quot;openai:gpt-4o&quot;,
                    subagents=[],
                )
            ],
        )

        # Add custom middleware to subagents
        agent = create_agent(
            &quot;openai:gpt-4o&quot;,
            middleware=[
                SubAgentMiddleware(
                    default_model=&quot;openai:gpt-4o&quot;,
                    default_middleware=[TodoListMiddleware()],
                    subagents=[],
                )
            ],
        )
        ```
    &quot;&quot;&quot;

    def __init__(
        self,
        *,
        default_model: str | BaseChatModel,
        default_tools: Sequence[BaseTool | Callable | dict[str, Any]] | None = None,
        default_middleware: list[AgentMiddleware] | None = None,
        default_interrupt_on: dict[str, bool | InterruptOnConfig] | None = None,
        subagents: list[SubAgent | CompiledSubAgent] | None = None,
        system_prompt: str | None = TASK_SYSTEM_PROMPT,
        general_purpose_agent: bool = True,
        task_description: str | None = None,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize the `SubAgentMiddleware`.&quot;&quot;&quot;
        super().__init__()
        self.system_prompt = system_prompt
        task_tool = _create_task_tool(
            default_model=default_model,
            default_tools=default_tools or [],
            default_middleware=default_middleware,
            default_interrupt_on=default_interrupt_on,
            subagents=subagents or [],
            general_purpose_agent=general_purpose_agent,
            task_description=task_description,
        )
        self.tools = [task_tool]

    def wrap_model_call(
        self,
        request: ModelRequest,
        handler: Callable[[ModelRequest], ModelResponse],
    ) -&gt; ModelResponse:
        &quot;&quot;&quot;Update the system message to include instructions on using subagents.&quot;&quot;&quot;
        if self.system_prompt is not None:
            new_system_message = append_to_system_message(request.system_message, self.system_prompt)
            return handler(request.override(system_message=new_system_message))
        return handler(request)

    async def awrap_model_call(
        self,
        request: ModelRequest,
        handler: Callable[[ModelRequest], Awaitable[ModelResponse]],
    ) -&gt; ModelResponse:
        &quot;&quot;&quot;(async) Update the system message to include instructions on using subagents.&quot;&quot;&quot;
        if self.system_prompt is not None:
            new_system_message = append_to_system_message(request.system_message, self.system_prompt)
            return await handler(request.override(system_message=new_system_message))
        return await handler(request)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/subagents/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/middleware/subagents.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="summarization Imported skill summarization from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/middleware/summarization.py Unknown LICENSE sources/langchain/summarization/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">summarization</div>
                <button class="copy-btn" onclick="copyToClipboard('summarization')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill summarization from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Summarization middleware for offloading conversation history.

Persists conversation history to a backend prior to summarization, enabling retrieval of
full context if needed later by an agent.

## Usage

```python
from deepagents import create_deep_agent
from deepagents.middleware.summarization import SummarizationMiddleware
from deepagents.backends import FilesystemBackend

backend = FilesystemBackend(root_dir=&quot;/data&quot;)

middleware = SummarizationMiddleware(
    model=&quot;gpt-4o-mini&quot;,
    backend=backend,
    trigger=(&quot;fraction&quot;, 0.85),
    keep=(&quot;fraction&quot;, 0.10),
)

agent = create_deep_agent(middleware=[middleware])
```

## Storage

Offloaded messages are stored as markdown at `/conversation_history/{thread_id}.md`.

Each summarization event appends a new section to this file, creating a running log
of all evicted messages.
&quot;&quot;&quot;

from __future__ import annotations

import logging
import uuid
from datetime import UTC, datetime
from textwrap import dedent
from typing import TYPE_CHECKING, Any, cast

from langchain.agents.middleware.summarization import (
    _DEFAULT_MESSAGES_TO_KEEP,
    _DEFAULT_TRIM_TOKEN_LIMIT,
    DEFAULT_SUMMARY_PROMPT,
    ContextSize,
    SummarizationMiddleware as BaseSummarizationMiddleware,
    TokenCounter,
)
from langchain.tools import ToolRuntime
from langchain_core.messages import AnyMessage, HumanMessage, RemoveMessage, get_buffer_string
from langchain_core.messages.utils import count_tokens_approximately
from langgraph.config import get_config
from langgraph.graph.message import REMOVE_ALL_MESSAGES
from typing_extensions import override

if TYPE_CHECKING:
    from langchain.agents.middleware.types import AgentState
    from langchain.chat_models import BaseChatModel
    from langchain_core.runnables.config import RunnableConfig
    from langgraph.runtime import Runtime

    from deepagents.backends.protocol import BACKEND_TYPES, BackendProtocol

logger = logging.getLogger(__name__)


class SummarizationMiddleware(BaseSummarizationMiddleware):
    &quot;&quot;&quot;Summarization middleware with backend for conversation history offloading.&quot;&quot;&quot;

    def __init__(
        self,
        model: str | BaseChatModel,
        *,
        backend: BACKEND_TYPES,
        trigger: ContextSize | list[ContextSize] | None = None,
        keep: ContextSize = (&quot;messages&quot;, _DEFAULT_MESSAGES_TO_KEEP),
        token_counter: TokenCounter = count_tokens_approximately,
        summary_prompt: str = DEFAULT_SUMMARY_PROMPT,
        trim_tokens_to_summarize: int | None = _DEFAULT_TRIM_TOKEN_LIMIT,
        history_path_prefix: str = &quot;/conversation_history&quot;,
        **deprecated_kwargs: Any,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize summarization middleware with backend support.

        Args:
            model: The language model to use for generating summaries.
            backend: Backend instance or factory for persisting conversation history.
            trigger: Threshold(s) that trigger summarization.
            keep: Context retention policy after summarization.

                Defaults to keeping last 20 messages.
            token_counter: Function to count tokens in messages.
            summary_prompt: Prompt template for generating summaries.
            trim_tokens_to_summarize: Max tokens to include when generating summary.

                Defaults to 4000.
            history_path_prefix: Path prefix for storing conversation history.

        Example:
            ```python
            from deepagents.middleware.summarization import SummarizationMiddleware
            from deepagents.backends import StateBackend

            middleware = SummarizationMiddleware(
                model=&quot;gpt-4o-mini&quot;,
                backend=lambda tool_runtime: StateBackend(tool_runtime),
                trigger=(&quot;tokens&quot;, 100000),
                keep=(&quot;messages&quot;, 20),
            )
            ```
        &quot;&quot;&quot;
        super().__init__(
            model=model,
            trigger=trigger,
            keep=keep,
            token_counter=token_counter,
            summary_prompt=summary_prompt,
            trim_tokens_to_summarize=trim_tokens_to_summarize,
            **deprecated_kwargs,
        )
        self._backend = backend
        self._history_path_prefix = history_path_prefix

    def _get_backend(
        self,
        state: AgentState[Any],
        runtime: Runtime,
    ) -&gt; BackendProtocol:
        &quot;&quot;&quot;Resolve backend from instance or factory.

        Args:
            state: Current agent state.
            runtime: Runtime context for factory functions.

        Returns:
            Resolved backend instance.
        &quot;&quot;&quot;
        if callable(self._backend):
            # Because we&#x27;re using `before_model`, which doesn&#x27;t receive `config` as a
            # parameter, we access it via `runtime.config` instead.
            # Cast is safe: empty dict `{}` is a valid `RunnableConfig` (all fields are
            # optional in TypedDict).
            config = cast(&quot;RunnableConfig&quot;, getattr(runtime, &quot;config&quot;, {}))

            tool_runtime = ToolRuntime(
                state=state,
                context=runtime.context,
                stream_writer=runtime.stream_writer,
                store=runtime.store,
                config=config,
                tool_call_id=None,
            )
            return self._backend(tool_runtime)
        return self._backend

    def _get_thread_id(self) -&gt; str:
        &quot;&quot;&quot;Extract `thread_id` from langgraph config.

        Uses `get_config()` to access the `RunnableConfig` from langgraph&#x27;s
        `contextvar`. Falls back to a generated session ID if not available.

        Returns:
            Thread ID string from config, or a generated session ID
                (e.g., `&#x27;session_a1b2c3d4&#x27;`) if not in a runnable context.
        &quot;&quot;&quot;
        try:
            config = get_config()
            thread_id = config.get(&quot;configurable&quot;, {}).get(&quot;thread_id&quot;)
            if thread_id is not None:
                return str(thread_id)
        except RuntimeError:
            # Not in a runnable context
            pass

        # Fallback: generate session ID
        generated_id = f&quot;session_{uuid.uuid4().hex[:8]}&quot;
        logger.debug(&quot;No thread_id found, using generated session ID: %s&quot;, generated_id)
        return generated_id

    def _get_history_path(self) -&gt; str:
        &quot;&quot;&quot;Generate path for storing conversation history.

        Returns a single file per thread that gets appended to over time.

        Returns:
            Path string like `&#x27;/conversation_history/{thread_id}.md&#x27;`
        &quot;&quot;&quot;
        thread_id = self._get_thread_id()
        return f&quot;{self._history_path_prefix}/{thread_id}.md&quot;

    def _is_summary_message(self, msg: AnyMessage) -&gt; bool:
        &quot;&quot;&quot;Check if a message is a previous summarization message.

        Summary messages are `HumanMessage` objects with `lc_source=&#x27;summarization&#x27;` in
        `additional_kwargs`. These should be filtered from offloads to avoid redundant
        storage during chained summarization.

        Args:
            msg: Message to check.

        Returns:
            Whether this is a summary `HumanMessage` from a previous summarization.
        &quot;&quot;&quot;
        if not isinstance(msg, HumanMessage):
            return False
        return msg.additional_kwargs.get(&quot;lc_source&quot;) == &quot;summarization&quot;

    def _filter_summary_messages(self, messages: list[AnyMessage]) -&gt; list[AnyMessage]:
        &quot;&quot;&quot;Filter out previous summary messages from a message list.

        When chained summarization occurs, we don&#x27;t want to re-offload the previous
        summary `HumanMessage` since the original messages are already stored in the
        backend.

        Args:
            messages: List of messages to filter.

        Returns:
            Messages without previous summary `HumanMessage` objects.
        &quot;&quot;&quot;
        return [msg for msg in messages if not self._is_summary_message(msg)]

    def _build_new_messages_with_path(self, summary: str, file_path: str | None) -&gt; list[AnyMessage]:
        &quot;&quot;&quot;Build the summary message with optional file path reference.

        Args:
            summary: The generated summary text.
            file_path: Path where conversation history was stored, or `None`.

                Optional since offloading may fail.

        Returns:
            List containing the summary `HumanMessage`.
        &quot;&quot;&quot;
        if file_path is not None:
            content = dedent(f&quot;&quot;&quot;\
                You are in the middle of a conversation that has been summarized.

                The full conversation history has been saved to {file_path} should you need to refer back to it for details.

                A condensed summary follows:

                &lt;summary&gt;
                {summary}
                &lt;/summary&gt;&quot;&quot;&quot;)
        else:
            content = f&quot;Here is a summary of the conversation to date:\n\n{summary}&quot;

        return [
            HumanMessage(
                content=content,
                additional_kwargs={&quot;lc_source&quot;: &quot;summarization&quot;},
            )
        ]

    def _offload_to_backend(
        self,
        backend: BackendProtocol,
        messages: list[AnyMessage],
    ) -&gt; str | None:
        &quot;&quot;&quot;Persist messages to backend before summarization.

        Appends evicted messages to a single markdown file per thread. Each
        summarization event adds a new section with a timestamp header.

        Previous summary messages are filtered out to avoid redundant storage during
        chained summarization events.

        Args:
            backend: Backend to write to.
            messages: Messages being summarized.

        Returns:
            The file path where history was stored, or `None` if write failed.
        &quot;&quot;&quot;
        path = self._get_history_path()

        # Filter out previous summary messages to avoid redundant storage
        filtered_messages = self._filter_summary_messages(messages)

        timestamp = datetime.now(UTC).isoformat()
        new_section = f&quot;## Summarized at {timestamp}\n\n{get_buffer_string(filtered_messages)}\n\n&quot;

        # Read existing content (if any) and append
        # Note: We use download_files() instead of read() because read() returns
        # line-numbered content (for LLM consumption), but edit() expects raw content.
        existing_content = &quot;&quot;
        try:
            responses = backend.download_files([path])
            if responses and responses[0].content is not None and responses[0].error is None:
                existing_content = responses[0].content.decode(&quot;utf-8&quot;)
        except Exception as e:  # noqa: BLE001
            # File likely doesn&#x27;t exist yet, but log for observability
            logger.debug(
                &quot;Exception reading existing history from %s (treating as new file): %s: %s&quot;,
                path,
                type(e).__name__,
                e,
            )

        combined_content = existing_content + new_section

        try:
            result = backend.edit(path, existing_content, combined_content) if existing_content else backend.write(path, combined_content)
            if result is None or result.error:
                error_msg = result.error if result else &quot;backend returned None&quot;
                logger.warning(
                    &quot;Failed to offload conversation history to %s (%d messages): %s&quot;,
                    path,
                    len(filtered_messages),
                    error_msg,
                )
                return None
        except Exception as e:  # noqa: BLE001
            logger.warning(
                &quot;Exception offloading conversation history to %s (%d messages): %s: %s&quot;,
                path,
                len(filtered_messages),
                type(e).__name__,
                e,
            )
            return None
        else:
            logger.debug(&quot;Offloaded %d messages to %s&quot;, len(filtered_messages), path)
            return path

    async def _aoffload_to_backend(
        self,
        backend: BackendProtocol,
        messages: list[AnyMessage],
    ) -&gt; str | None:
        &quot;&quot;&quot;Persist messages to backend before summarization (async).

        Appends evicted messages to a single markdown file per thread. Each
        summarization event adds a new section with a timestamp header.

        Previous summary messages are filtered out to avoid redundant storage during
        chained summarization events.

        Args:
            backend: Backend to write to.
            messages: Messages being summarized.

        Returns:
            The file path where history was stored, or `None` if write failed.
        &quot;&quot;&quot;
        path = self._get_history_path()

        # Filter out previous summary messages to avoid redundant storage
        filtered_messages = self._filter_summary_messages(messages)

        timestamp = datetime.now(UTC).isoformat()
        new_section = f&quot;## Summarized at {timestamp}\n\n{get_buffer_string(filtered_messages)}\n\n&quot;

        # Read existing content (if any) and append
        # Note: We use adownload_files() instead of aread() because read() returns
        # line-numbered content (for LLM consumption), but edit() expects raw content.
        existing_content = &quot;&quot;
        try:
            responses = await backend.adownload_files([path])
            if responses and responses[0].content is not None and responses[0].error is None:
                existing_content = responses[0].content.decode(&quot;utf-8&quot;)
        except Exception as e:  # noqa: BLE001
            # File likely doesn&#x27;t exist yet, but log for observability
            logger.debug(
                &quot;Exception reading existing history from %s (treating as new file): %s: %s&quot;,
                path,
                type(e).__name__,
                e,
            )

        combined_content = existing_content + new_section

        try:
            result = (
                await backend.aedit(path, existing_content, combined_content) if existing_content else await backend.awrite(path, combined_content)
            )
            if result is None or result.error:
                error_msg = result.error if result else &quot;backend returned None&quot;
                logger.warning(
                    &quot;Failed to offload conversation history to %s (%d messages): %s&quot;,
                    path,
                    len(filtered_messages),
                    error_msg,
                )
                return None
        except Exception as e:  # noqa: BLE001
            logger.warning(
                &quot;Exception offloading conversation history to %s (%d messages): %s: %s&quot;,
                path,
                len(filtered_messages),
                type(e).__name__,
                e,
            )
            return None
        else:
            logger.debug(&quot;Offloaded %d messages to %s&quot;, len(filtered_messages), path)
            return path

    @override
    def before_model(
        self,
        state: AgentState[Any],
        runtime: Runtime,
    ) -&gt; dict[str, Any] | None:
        &quot;&quot;&quot;Process messages before model invocation, with history offloading.

        Overrides parent to offload messages to backend before summarization.

        The summary message includes a reference to the file path where the full
        conversation history was stored.

        Args:
            state: The agent state.
            runtime: The runtime environment.

        Returns:
            Updated state with summarized messages if summarization was performed.
        &quot;&quot;&quot;
        messages = state[&quot;messages&quot;]
        self._ensure_message_ids(messages)

        total_tokens = self.token_counter(messages)
        if not self._should_summarize(messages, total_tokens):
            return None

        cutoff_index = self._determine_cutoff_index(messages)
        if cutoff_index &lt;= 0:
            return None

        messages_to_summarize, preserved_messages = self._partition_messages(messages, cutoff_index)

        # Offload to backend first - abort summarization if this fails to prevent data loss
        backend = self._get_backend(state, runtime)
        file_path = self._offload_to_backend(backend, messages_to_summarize)
        if file_path is None:
            # Offloading failed - don&#x27;t proceed with summarization to preserve messages
            return None

        # Generate summary
        summary = self._create_summary(messages_to_summarize)

        # Build summary message with file path reference
        new_messages = self._build_new_messages_with_path(summary, file_path)

        return {
            &quot;messages&quot;: [
                RemoveMessage(id=REMOVE_ALL_MESSAGES),
                *new_messages,
                *preserved_messages,
            ]
        }

    @override
    async def abefore_model(
        self,
        state: AgentState[Any],
        runtime: Runtime,
    ) -&gt; dict[str, Any] | None:
        &quot;&quot;&quot;Process messages before model invocation, with history offloading (async).

        Overrides parent to offload messages to backend before summarization.

        The summary message includes a reference to the file path where the full
        conversation history was stored.

        Args:
            state: The agent state.
            runtime: The runtime environment.

        Returns:
            Updated state with summarized messages if summarization was performed.
        &quot;&quot;&quot;
        messages = state[&quot;messages&quot;]
        self._ensure_message_ids(messages)

        total_tokens = self.token_counter(messages)
        if not self._should_summarize(messages, total_tokens):
            return None

        cutoff_index = self._determine_cutoff_index(messages)
        if cutoff_index &lt;= 0:
            return None

        messages_to_summarize, preserved_messages = self._partition_messages(messages, cutoff_index)

        # Offload to backend first - abort summarization if this fails to prevent data loss
        backend = self._get_backend(state, runtime)
        file_path = await self._aoffload_to_backend(backend, messages_to_summarize)
        if file_path is None:
            # Offloading failed - don&#x27;t proceed with summarization to preserve messages
            return None

        # Generate summary
        summary = await self._acreate_summary(messages_to_summarize)

        # Build summary message with file path reference
        new_messages = self._build_new_messages_with_path(summary, file_path)

        return {
            &quot;messages&quot;: [
                RemoveMessage(id=REMOVE_ALL_MESSAGES),
                *new_messages,
                *preserved_messages,
            ]
        }</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/summarization/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/middleware/summarization.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="textual_adapter Imported skill textual_adapter from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/textual_adapter.py Unknown LICENSE sources/langchain/textual_adapter/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">textual_adapter</div>
                <button class="copy-btn" onclick="copyToClipboard('textual_adapter')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill textual_adapter from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Textual UI adapter for agent execution.&quot;&quot;&quot;
# ruff: noqa: PLR0912, PLR0915, ANN401, PLR2004, BLE001, TRY203
# This module has complex streaming logic ported from execution.py

from __future__ import annotations

import asyncio
import json
from datetime import UTC, datetime
from typing import TYPE_CHECKING, Any

from langchain.agents.middleware.human_in_the_loop import (
    ActionRequest,
    HITLRequest,
    HITLResponse,
)
from langchain_core.messages import HumanMessage, ToolMessage
from langgraph.types import Command, Interrupt
from pydantic import TypeAdapter, ValidationError

from deepagents_cli.file_ops import FileOpTracker
from deepagents_cli.image_utils import create_multimodal_content
from deepagents_cli.input import ImageTracker, parse_file_mentions
from deepagents_cli.ui import format_tool_display, format_tool_message_content
from deepagents_cli.widgets.messages import (
    AssistantMessage,
    DiffMessage,
    ErrorMessage,
    SystemMessage,
    ToolCallMessage,
)

if TYPE_CHECKING:
    from collections.abc import Callable

_HITL_REQUEST_ADAPTER = TypeAdapter(HITLRequest)


def _is_summarization_chunk(metadata: dict | None) -&gt; bool:
    &quot;&quot;&quot;Check if a message chunk is from summarization middleware.

    Args:
        metadata: The metadata dict from the stream chunk.

    Returns:
        Whether the chunk is from summarization and should be filtered.
    &quot;&quot;&quot;
    if metadata is None:
        return False
    return metadata.get(&quot;lc_source&quot;) == &quot;summarization&quot;


class TextualUIAdapter:
    &quot;&quot;&quot;Adapter for rendering agent output to Textual widgets.

    This adapter provides an abstraction layer between the agent execution
    and the Textual UI, allowing streaming output to be rendered as widgets.
    &quot;&quot;&quot;

    def __init__(
        self,
        mount_message: Callable,
        update_status: Callable[[str], None],
        request_approval: Callable,  # async callable returning Future
        on_auto_approve_enabled: Callable[[], None] | None = None,
        scroll_to_bottom: Callable[[], None] | None = None,
    ) -&gt; None:
        &quot;&quot;&quot;Initialize the adapter.

        Args:
            mount_message: Async callable to mount a message widget
            update_status: Callable to update the status bar message
            request_approval: Callable that returns a Future for HITL approval
            on_auto_approve_enabled: Callback when auto-approve is enabled
            scroll_to_bottom: Callback to scroll chat to bottom
        &quot;&quot;&quot;
        self._mount_message = mount_message
        self._update_status = update_status
        self._request_approval = request_approval
        self._on_auto_approve_enabled = on_auto_approve_enabled
        self._scroll_to_bottom = scroll_to_bottom

        # State tracking
        self._current_assistant_message: AssistantMessage | None = None
        self._current_tool_messages: dict[str, ToolCallMessage] = {}
        self._pending_text = &quot;&quot;
        self._token_tracker: Any = None

    def set_token_tracker(self, tracker: Any) -&gt; None:
        &quot;&quot;&quot;Set the token tracker for usage tracking.&quot;&quot;&quot;
        self._token_tracker = tracker


async def execute_task_textual(
    user_input: str,
    agent: Any,
    assistant_id: str | None,
    session_state: Any,
    adapter: TextualUIAdapter,
    backend: Any = None,
    image_tracker: ImageTracker | None = None,
) -&gt; None:
    &quot;&quot;&quot;Execute a task with output directed to Textual UI.

    This is the Textual-compatible version of execute_task() that uses
    the TextualUIAdapter for all UI operations.

    Args:
        user_input: The user&#x27;s input message
        agent: The LangGraph agent to execute
        assistant_id: The agent identifier
        session_state: Session state with auto_approve flag
        adapter: The TextualUIAdapter for UI operations
        backend: Optional backend for file operations
        image_tracker: Optional tracker for images
    &quot;&quot;&quot;
    # Parse file mentions and inject content if any
    prompt_text, mentioned_files = parse_file_mentions(user_input)

    # Max file size to embed inline (256KB, matching mistral-vibe)
    # Larger files get a reference instead - use read_file tool to view them
    max_embed_bytes = 256 * 1024

    if mentioned_files:
        context_parts = [prompt_text, &quot;\n\n## Referenced Files\n&quot;]
        for file_path in mentioned_files:
            try:
                file_size = file_path.stat().st_size
                if file_size &gt; max_embed_bytes:
                    # File too large - include reference instead of content
                    size_kb = file_size // 1024
                    context_parts.append(
                        f&quot;\n### {file_path.name}\n&quot;
                        f&quot;Path: `{file_path}`\n&quot;
                        f&quot;Size: {size_kb}KB (too large to embed, use read_file tool to view)&quot;
                    )
                else:
                    content = file_path.read_text()
                    context_parts.append(
                        f&quot;\n### {file_path.name}\nPath: `{file_path}`\n```\n{content}\n```&quot;
                    )
            except Exception as e:
                context_parts.append(f&quot;\n### {file_path.name}\n[Error reading file: {e}]&quot;)
        final_input = &quot;\n&quot;.join(context_parts)
    else:
        final_input = prompt_text

    # Include images in the message content
    images_to_send = []
    if image_tracker:
        images_to_send = image_tracker.get_images()
    if images_to_send:
        message_content = create_multimodal_content(final_input, images_to_send)
    else:
        message_content = final_input

    thread_id = session_state.thread_id
    config = {
        &quot;configurable&quot;: {&quot;thread_id&quot;: thread_id},
        &quot;metadata&quot;: {
            &quot;assistant_id&quot;: assistant_id,
            &quot;agent_name&quot;: assistant_id,
            &quot;updated_at&quot;: datetime.now(UTC).isoformat(),
        }
        if assistant_id
        else {},
    }

    captured_input_tokens = 0
    captured_output_tokens = 0

    # Update status to show thinking
    adapter._update_status(&quot;Agent is thinking...&quot;)

    # Hide token display during streaming (will be shown with accurate count at end)
    if adapter._token_tracker:
        adapter._token_tracker.hide()

    file_op_tracker = FileOpTracker(assistant_id=assistant_id, backend=backend)
    displayed_tool_ids: set[str] = set()
    tool_call_buffers: dict[str | int, dict] = {}

    # Track pending text and assistant messages PER NAMESPACE to avoid interleaving
    # when multiple subagents stream in parallel
    pending_text_by_namespace: dict[tuple, str] = {}
    assistant_message_by_namespace: dict[tuple, Any] = {}

    # Clear images from tracker after creating the message
    if image_tracker:
        image_tracker.clear()

    stream_input: dict | Command = {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: message_content}]}

    try:
        while True:
            interrupt_occurred = False
            hitl_response: dict[str, HITLResponse] = {}
            suppress_resumed_output = False
            pending_interrupts: dict[str, HITLRequest] = {}

            async for chunk in agent.astream(
                stream_input,
                stream_mode=[&quot;messages&quot;, &quot;updates&quot;],
                subgraphs=True,
                config=config,
                durability=&quot;exit&quot;,
            ):
                if not isinstance(chunk, tuple) or len(chunk) != 3:
                    continue

                namespace, current_stream_mode, data = chunk

                # Convert namespace to hashable tuple for dict keys
                ns_key = tuple(namespace) if namespace else ()

                # Filter out subagent outputs - only show main agent (empty namespace)
                # Subagents run via Task tool and should only report back to the main agent
                is_main_agent = ns_key == ()

                # Handle UPDATES stream - for interrupts and todos
                if current_stream_mode == &quot;updates&quot;:
                    if not isinstance(data, dict):
                        continue

                    # Check for interrupts
                    if &quot;__interrupt__&quot; in data:
                        interrupts: list[Interrupt] = data[&quot;__interrupt__&quot;]
                        if interrupts:
                            for interrupt_obj in interrupts:
                                try:
                                    validated_request = _HITL_REQUEST_ADAPTER.validate_python(
                                        interrupt_obj.value
                                    )
                                    pending_interrupts[interrupt_obj.id] = validated_request
                                    interrupt_occurred = True
                                except ValidationError:
                                    raise

                    # Check for todo updates (not yet implemented in Textual UI)
                    chunk_data = next(iter(data.values())) if data else None
                    if chunk_data and isinstance(chunk_data, dict) and &quot;todos&quot; in chunk_data:
                        pass  # Future: render todo list widget

                # Handle MESSAGES stream - for content and tool calls
                elif current_stream_mode == &quot;messages&quot;:
                    # Skip subagent outputs - only render main agent content in chat
                    if not is_main_agent:
                        continue

                    if not isinstance(data, tuple) or len(data) != 2:
                        continue

                    message, _metadata = data

                    # Filter out summarization LLM output &amp; update status to reflect
                    if _is_summarization_chunk(_metadata):
                        adapter._update_status(&quot;Summarizing conversation...&quot;)
                        continue

                    if isinstance(message, HumanMessage):
                        content = message.text
                        # Flush pending text for this namespace
                        pending_text = pending_text_by_namespace.get(ns_key, &quot;&quot;)
                        if content and pending_text:
                            await _flush_assistant_text_ns(
                                adapter, pending_text, ns_key, assistant_message_by_namespace
                            )
                            pending_text_by_namespace[ns_key] = &quot;&quot;
                        continue

                    if isinstance(message, ToolMessage):
                        tool_name = getattr(message, &quot;name&quot;, &quot;&quot;)
                        tool_status = getattr(message, &quot;status&quot;, &quot;success&quot;)
                        tool_content = format_tool_message_content(message.content)
                        record = file_op_tracker.complete_with_message(message)

                        adapter._update_status(&quot;Agent is thinking...&quot;)

                        # Update tool call status with output
                        tool_id = getattr(message, &quot;tool_call_id&quot;, None)
                        if tool_id and tool_id in adapter._current_tool_messages:
                            tool_msg = adapter._current_tool_messages[tool_id]
                            output_str = str(tool_content) if tool_content else &quot;&quot;
                            if tool_status == &quot;success&quot;:
                                tool_msg.set_success(output_str)
                            else:
                                tool_msg.set_error(output_str or &quot;Error&quot;)
                            # Clean up - remove from tracking dict after status update
                            del adapter._current_tool_messages[tool_id]

                        # Show shell errors
                        if tool_name == &quot;shell&quot; and tool_status != &quot;success&quot;:
                            pending_text = pending_text_by_namespace.get(ns_key, &quot;&quot;)
                            if pending_text:
                                await _flush_assistant_text_ns(
                                    adapter, pending_text, ns_key, assistant_message_by_namespace
                                )
                                pending_text_by_namespace[ns_key] = &quot;&quot;
                            if tool_content:
                                await adapter._mount_message(ErrorMessage(str(tool_content)))

                        # Show file operation results - always show diffs in chat
                        if record:
                            pending_text = pending_text_by_namespace.get(ns_key, &quot;&quot;)
                            if pending_text:
                                await _flush_assistant_text_ns(
                                    adapter, pending_text, ns_key, assistant_message_by_namespace
                                )
                                pending_text_by_namespace[ns_key] = &quot;&quot;
                            if record.diff:
                                await adapter._mount_message(
                                    DiffMessage(record.diff, record.display_path)
                                )
                        continue

                    # Extract token usage (before content_blocks check - usage may be on any chunk)
                    if adapter._token_tracker and hasattr(message, &quot;usage_metadata&quot;):
                        usage = message.usage_metadata
                        if usage:
                            # Use total_tokens which includes input + output
                            total_toks = usage.get(&quot;total_tokens&quot;, 0)
                            if total_toks:
                                captured_input_tokens = max(captured_input_tokens, total_toks)
                            else:
                                # Fallback to input + output if total not provided
                                input_toks = usage.get(&quot;input_tokens&quot;, 0)
                                output_toks = usage.get(&quot;output_tokens&quot;, 0)
                                if input_toks or output_toks:
                                    total = input_toks + output_toks
                                    captured_input_tokens = max(captured_input_tokens, total)

                    # Check if this is an AIMessageChunk with content
                    if not hasattr(message, &quot;content_blocks&quot;):
                        continue

                    # Process content blocks
                    for block in message.content_blocks:
                        block_type = block.get(&quot;type&quot;)

                        if block_type == &quot;text&quot;:
                            text = block.get(&quot;text&quot;, &quot;&quot;)
                            if text:
                                # Track accumulated text for reference
                                pending_text = pending_text_by_namespace.get(ns_key, &quot;&quot;)
                                pending_text += text
                                pending_text_by_namespace[ns_key] = pending_text

                                # Get or create assistant message for this namespace
                                current_msg = assistant_message_by_namespace.get(ns_key)
                                if current_msg is None:
                                    current_msg = AssistantMessage()
                                    await adapter._mount_message(current_msg)
                                    assistant_message_by_namespace[ns_key] = current_msg
                                    # Anchor scroll once when message is created
                                    # anchor() keeps scroll locked to bottom as content grows
                                    if adapter._scroll_to_bottom:
                                        adapter._scroll_to_bottom()

                                # Append just the new text chunk for smoother streaming
                                # (uses MarkdownStream internally for better performance)
                                await current_msg.append_content(text)

                        elif block_type in (&quot;tool_call_chunk&quot;, &quot;tool_call&quot;):
                            chunk_name = block.get(&quot;name&quot;)
                            chunk_args = block.get(&quot;args&quot;)
                            chunk_id = block.get(&quot;id&quot;)
                            chunk_index = block.get(&quot;index&quot;)

                            buffer_key: str | int
                            if chunk_index is not None:
                                buffer_key = chunk_index
                            elif chunk_id is not None:
                                buffer_key = chunk_id
                            else:
                                buffer_key = f&quot;unknown-{len(tool_call_buffers)}&quot;

                            buffer = tool_call_buffers.setdefault(
                                buffer_key,
                                {&quot;name&quot;: None, &quot;id&quot;: None, &quot;args&quot;: None, &quot;args_parts&quot;: []},
                            )

                            if chunk_name:
                                buffer[&quot;name&quot;] = chunk_name
                            if chunk_id:
                                buffer[&quot;id&quot;] = chunk_id

                            if isinstance(chunk_args, dict):
                                buffer[&quot;args&quot;] = chunk_args
                                buffer[&quot;args_parts&quot;] = []
                            elif isinstance(chunk_args, str):
                                if chunk_args:
                                    parts: list[str] = buffer.setdefault(&quot;args_parts&quot;, [])
                                    if not parts or chunk_args != parts[-1]:
                                        parts.append(chunk_args)
                                    buffer[&quot;args&quot;] = &quot;&quot;.join(parts)
                            elif chunk_args is not None:
                                buffer[&quot;args&quot;] = chunk_args

                            buffer_name = buffer.get(&quot;name&quot;)
                            buffer_id = buffer.get(&quot;id&quot;)
                            if buffer_name is None:
                                continue

                            parsed_args = buffer.get(&quot;args&quot;)
                            if isinstance(parsed_args, str):
                                if not parsed_args:
                                    continue
                                try:
                                    parsed_args = json.loads(parsed_args)
                                except json.JSONDecodeError:
                                    continue
                            elif parsed_args is None:
                                continue

                            if not isinstance(parsed_args, dict):
                                parsed_args = {&quot;value&quot;: parsed_args}

                            # Flush pending text before tool call
                            pending_text = pending_text_by_namespace.get(ns_key, &quot;&quot;)
                            if pending_text:
                                await _flush_assistant_text_ns(
                                    adapter, pending_text, ns_key, assistant_message_by_namespace
                                )
                                pending_text_by_namespace[ns_key] = &quot;&quot;
                                assistant_message_by_namespace.pop(ns_key, None)

                            if buffer_id is not None and buffer_id not in displayed_tool_ids:
                                displayed_tool_ids.add(buffer_id)
                                file_op_tracker.start_operation(buffer_name, parsed_args, buffer_id)

                                # Mount tool call message
                                tool_msg = ToolCallMessage(buffer_name, parsed_args)
                                await adapter._mount_message(tool_msg)
                                adapter._current_tool_messages[buffer_id] = tool_msg

                            tool_call_buffers.pop(buffer_key, None)
                            display_str = format_tool_display(buffer_name, parsed_args)
                            adapter._update_status(f&quot;Executing {display_str}...&quot;)

                    if getattr(message, &quot;chunk_position&quot;, None) == &quot;last&quot;:
                        pending_text = pending_text_by_namespace.get(ns_key, &quot;&quot;)
                        if pending_text:
                            await _flush_assistant_text_ns(
                                adapter, pending_text, ns_key, assistant_message_by_namespace
                            )
                            pending_text_by_namespace[ns_key] = &quot;&quot;
                            assistant_message_by_namespace.pop(ns_key, None)

            # Flush any remaining text from all namespaces
            for ns_key, pending_text in list(pending_text_by_namespace.items()):
                if pending_text:
                    await _flush_assistant_text_ns(
                        adapter, pending_text, ns_key, assistant_message_by_namespace
                    )
            pending_text_by_namespace.clear()
            assistant_message_by_namespace.clear()

            # Handle HITL after stream completes
            if interrupt_occurred:
                any_rejected = False

                for interrupt_id, hitl_request in pending_interrupts.items():
                    if session_state.auto_approve:
                        # Auto-approve silently (user sees tool calls already)
                        decisions = [{&quot;type&quot;: &quot;approve&quot;} for _ in hitl_request[&quot;action_requests&quot;]]
                        hitl_response[interrupt_id] = {&quot;decisions&quot;: decisions}
                    else:
                        # Request approval via adapter
                        decisions = []

                        def mark_hitl_approved(action_request: ActionRequest) -&gt; None:
                            tool_name = action_request.get(&quot;name&quot;)
                            if tool_name not in {&quot;write_file&quot;, &quot;edit_file&quot;}:
                                return
                            args = action_request.get(&quot;args&quot;, {})
                            if isinstance(args, dict):
                                file_op_tracker.mark_hitl_approved(tool_name, args)

                        for action_request in hitl_request[&quot;action_requests&quot;]:
                            future = await adapter._request_approval(action_request, assistant_id)
                            decision = await future

                            # Check for auto-approve-all
                            if (
                                isinstance(decision, dict)
                                and decision.get(&quot;type&quot;) == &quot;auto_approve_all&quot;
                            ):
                                session_state.auto_approve = True
                                if adapter._on_auto_approve_enabled:
                                    adapter._on_auto_approve_enabled()
                                decisions.append({&quot;type&quot;: &quot;approve&quot;})
                                mark_hitl_approved(action_request)
                                # Approve remaining actions
                                for _ in hitl_request[&quot;action_requests&quot;][len(decisions) :]:
                                    decisions.append({&quot;type&quot;: &quot;approve&quot;})
                                break

                            decisions.append(decision)
                            # Try multiple keys for tool call id
                            tool_id = (
                                action_request.get(&quot;id&quot;)
                                or action_request.get(&quot;tool_call_id&quot;)
                                or action_request.get(&quot;call_id&quot;)
                            )
                            tool_name = action_request.get(&quot;name&quot;, &quot;&quot;)

                            # Find matching tool message - by id or by name as fallback
                            tool_msg = None
                            tool_msg_key = None  # Track key for cleanup
                            if tool_id and tool_id in adapter._current_tool_messages:
                                tool_msg = adapter._current_tool_messages[tool_id]
                                tool_msg_key = tool_id
                            elif tool_name:
                                # Fallback: find last tool message with matching name
                                for key, msg in reversed(
                                    list(adapter._current_tool_messages.items())
                                ):
                                    if msg._tool_name == tool_name:
                                        tool_msg = msg
                                        tool_msg_key = key
                                        break

                            if isinstance(decision, dict) and decision.get(&quot;type&quot;) == &quot;approve&quot;:
                                mark_hitl_approved(action_request)
                                # Don&#x27;t call set_success here - wait for actual tool output
                                # The ToolMessage handler will update with real results
                            elif isinstance(decision, dict) and decision.get(&quot;type&quot;) == &quot;reject&quot;:
                                if tool_msg:
                                    tool_msg.set_rejected()
                                # Only remove from tracking on reject (approved tools need output update)
                                if tool_msg_key and tool_msg_key in adapter._current_tool_messages:
                                    del adapter._current_tool_messages[tool_msg_key]

                        if any(d.get(&quot;type&quot;) == &quot;reject&quot; for d in decisions):
                            any_rejected = True

                        hitl_response[interrupt_id] = {&quot;decisions&quot;: decisions}

                suppress_resumed_output = any_rejected

            if interrupt_occurred and hitl_response:
                if suppress_resumed_output:
                    await adapter._mount_message(
                        SystemMessage(&quot;Command rejected. Tell the agent what you&#x27;d like instead.&quot;)
                    )
                    return

                stream_input = Command(resume=hitl_response)
            else:
                break

    except asyncio.CancelledError:
        adapter._update_status(&quot;Interrupted&quot;)

        # Mark any pending tools as rejected
        for tool_msg in list(adapter._current_tool_messages.values()):
            tool_msg.set_rejected()
        adapter._current_tool_messages.clear()

        await adapter._mount_message(SystemMessage(&quot;Interrupted by user&quot;))

        # Append cancellation message to agent state so LLM knows what happened
        # This preserves context rather than rolling back
        try:
            cancellation_msg = HumanMessage(
                content=&quot;[SYSTEM] Task interrupted by user. Previous operation was cancelled.&quot;
            )
            await agent.aupdate_state(config, {&quot;messages&quot;: [cancellation_msg]})
        except Exception:  # noqa: S110
            pass  # State update is best-effort
        # Report tokens even on interrupt (or restore display if none captured)
        if adapter._token_tracker:
            if captured_input_tokens or captured_output_tokens:
                adapter._token_tracker.add(captured_input_tokens, captured_output_tokens)
            else:
                adapter._token_tracker.show()  # Restore previous value
        return

    except KeyboardInterrupt:
        adapter._update_status(&quot;Interrupted&quot;)

        # Mark any pending tools as rejected
        for tool_msg in list(adapter._current_tool_messages.values()):
            tool_msg.set_rejected()
        adapter._current_tool_messages.clear()

        await adapter._mount_message(SystemMessage(&quot;Interrupted by user&quot;))

        # Append cancellation message to agent state
        try:
            cancellation_msg = HumanMessage(
                content=&quot;[SYSTEM] Task interrupted by user. Previous operation was cancelled.&quot;
            )
            await agent.aupdate_state(config, {&quot;messages&quot;: [cancellation_msg]})
        except Exception:  # noqa: S110
            pass  # State update is best-effort
        # Report tokens even on interrupt (or restore display if none captured)
        if adapter._token_tracker:
            if captured_input_tokens or captured_output_tokens:
                adapter._token_tracker.add(captured_input_tokens, captured_output_tokens)
            else:
                adapter._token_tracker.show()  # Restore previous value
        return

    adapter._update_status(&quot;Ready&quot;)

    # Update token tracker
    if adapter._token_tracker and (captured_input_tokens or captured_output_tokens):
        adapter._token_tracker.add(captured_input_tokens, captured_output_tokens)


async def _flush_assistant_text_ns(
    adapter: TextualUIAdapter,
    text: str,
    ns_key: tuple,
    assistant_message_by_namespace: dict[tuple, Any],
) -&gt; None:
    &quot;&quot;&quot;Flush accumulated assistant text for a specific namespace.

    Finalizes the streaming by stopping the MarkdownStream.
    If no message exists yet, creates one with the full content.
    &quot;&quot;&quot;
    if not text.strip():
        return

    current_msg = assistant_message_by_namespace.get(ns_key)
    if current_msg is None:
        # No message was created during streaming - create one with full content
        current_msg = AssistantMessage(text)
        await adapter._mount_message(current_msg)
        await current_msg.write_initial_content()
        assistant_message_by_namespace[ns_key] = current_msg
    else:
        # Stop the stream to finalize the content
        await current_msg.stop_stream()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/textual_adapter/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="tool_renderers Imported skill tool_renderers from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/widgets/tool_renderers.py Unknown LICENSE sources/langchain/tool_renderers/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">tool_renderers</div>
                <button class="copy-btn" onclick="copyToClipboard('tool_renderers')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill tool_renderers from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Tool renderers for approval widgets - registry pattern.&quot;&quot;&quot;

from __future__ import annotations

import difflib
from typing import TYPE_CHECKING, Any

from deepagents_cli.widgets.tool_widgets import (
    BashApprovalWidget,
    EditFileApprovalWidget,
    GenericApprovalWidget,
    WriteFileApprovalWidget,
)

if TYPE_CHECKING:
    from deepagents_cli.widgets.tool_widgets import ToolApprovalWidget


class ToolRenderer:
    &quot;&quot;&quot;Base renderer for tool approval widgets.&quot;&quot;&quot;

    def get_approval_widget(
        self, tool_args: dict[str, Any]
    ) -&gt; tuple[type[ToolApprovalWidget], dict[str, Any]]:
        &quot;&quot;&quot;Get the approval widget class and data for this tool.

        Args:
            tool_args: The tool arguments from action_request

        Returns:
            Tuple of (widget_class, data_dict)
        &quot;&quot;&quot;
        return GenericApprovalWidget, tool_args


class WriteFileRenderer(ToolRenderer):
    &quot;&quot;&quot;Renderer for write_file tool - shows full file content.&quot;&quot;&quot;

    def get_approval_widget(
        self, tool_args: dict[str, Any]
    ) -&gt; tuple[type[ToolApprovalWidget], dict[str, Any]]:
        # Extract file extension for syntax highlighting
        file_path = tool_args.get(&quot;file_path&quot;, &quot;&quot;)
        content = tool_args.get(&quot;content&quot;, &quot;&quot;)

        # Get file extension
        file_extension = &quot;text&quot;
        if &quot;.&quot; in file_path:
            file_extension = file_path.rsplit(&quot;.&quot;, 1)[-1]

        data = {
            &quot;file_path&quot;: file_path,
            &quot;content&quot;: content,
            &quot;file_extension&quot;: file_extension,
        }
        return WriteFileApprovalWidget, data


class EditFileRenderer(ToolRenderer):
    &quot;&quot;&quot;Renderer for edit_file tool - shows unified diff.&quot;&quot;&quot;

    def get_approval_widget(
        self, tool_args: dict[str, Any]
    ) -&gt; tuple[type[ToolApprovalWidget], dict[str, Any]]:
        file_path = tool_args.get(&quot;file_path&quot;, &quot;&quot;)
        old_string = tool_args.get(&quot;old_string&quot;, &quot;&quot;)
        new_string = tool_args.get(&quot;new_string&quot;, &quot;&quot;)

        # Generate unified diff
        diff_lines = self._generate_diff(old_string, new_string)

        data = {
            &quot;file_path&quot;: file_path,
            &quot;diff_lines&quot;: diff_lines,
            &quot;old_string&quot;: old_string,
            &quot;new_string&quot;: new_string,
        }
        return EditFileApprovalWidget, data

    def _generate_diff(self, old_string: str, new_string: str) -&gt; list[str]:
        &quot;&quot;&quot;Generate unified diff lines from old and new strings.&quot;&quot;&quot;
        if not old_string and not new_string:
            return []

        old_lines = old_string.split(&quot;\n&quot;) if old_string else []
        new_lines = new_string.split(&quot;\n&quot;) if new_string else []

        # Generate unified diff
        diff = difflib.unified_diff(
            old_lines,
            new_lines,
            fromfile=&quot;before&quot;,
            tofile=&quot;after&quot;,
            lineterm=&quot;&quot;,
            n=3,  # Context lines
        )

        # Skip the first two header lines (--- and +++)
        diff_list = list(diff)
        return diff_list[2:] if len(diff_list) &gt; 2 else diff_list


class BashRenderer(ToolRenderer):
    &quot;&quot;&quot;Renderer for bash/shell tool - shows command.&quot;&quot;&quot;

    def get_approval_widget(
        self, tool_args: dict[str, Any]
    ) -&gt; tuple[type[ToolApprovalWidget], dict[str, Any]]:
        data = {
            &quot;command&quot;: tool_args.get(&quot;command&quot;, &quot;&quot;),
            &quot;description&quot;: tool_args.get(&quot;description&quot;, &quot;&quot;),
        }
        return BashApprovalWidget, data


# Registry mapping tool names to renderers
_RENDERER_REGISTRY: dict[str, type[ToolRenderer]] = {
    &quot;write_file&quot;: WriteFileRenderer,
    &quot;edit_file&quot;: EditFileRenderer,
    &quot;bash&quot;: BashRenderer,
    &quot;shell&quot;: BashRenderer,
}


def get_renderer(tool_name: str) -&gt; ToolRenderer:
    &quot;&quot;&quot;Get the renderer for a tool by name.

    Args:
        tool_name: The name of the tool

    Returns:
        The appropriate ToolRenderer instance
    &quot;&quot;&quot;
    renderer_class = _RENDERER_REGISTRY.get(tool_name, ToolRenderer)
    return renderer_class()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/tool_renderers/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="tool_widgets Imported skill tool_widgets from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/widgets/tool_widgets.py Unknown LICENSE sources/langchain/tool_widgets/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">tool_widgets</div>
                <button class="copy-btn" onclick="copyToClipboard('tool_widgets')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill tool_widgets from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Tool-specific approval widgets for HITL display.&quot;&quot;&quot;

from __future__ import annotations

from typing import TYPE_CHECKING, Any

from textual.containers import Vertical
from textual.widgets import Markdown, Static

if TYPE_CHECKING:
    from textual.app import ComposeResult

# Constants for display limits
_MAX_VALUE_LEN = 200
_MAX_LINES = 30
_MAX_DIFF_LINES = 50
_MAX_PREVIEW_LINES = 20


def _escape_markup(text: str) -&gt; str:
    &quot;&quot;&quot;Escape Rich markup characters in text.&quot;&quot;&quot;
    return text.replace(&quot;[&quot;, r&quot;\[&quot;).replace(&quot;]&quot;, r&quot;\]&quot;)


class ToolApprovalWidget(Vertical):
    &quot;&quot;&quot;Base class for tool approval widgets.&quot;&quot;&quot;

    def __init__(self, data: dict[str, Any]) -&gt; None:
        &quot;&quot;&quot;Initialize the tool approval widget with data.&quot;&quot;&quot;
        super().__init__(classes=&quot;tool-approval-widget&quot;)
        self.data = data

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Default compose - override in subclasses.&quot;&quot;&quot;
        yield Static(&quot;Tool details not available&quot;, classes=&quot;approval-description&quot;)


class GenericApprovalWidget(ToolApprovalWidget):
    &quot;&quot;&quot;Generic approval widget for unknown tools.&quot;&quot;&quot;

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the generic tool display.&quot;&quot;&quot;
        for key, value in self.data.items():
            if value is None:
                continue
            value_str = str(value)
            if len(value_str) &gt; _MAX_VALUE_LEN:
                hidden = len(value_str) - _MAX_VALUE_LEN
                value_str = value_str[:_MAX_VALUE_LEN] + f&quot;... ({hidden} more chars)&quot;
            yield Static(f&quot;{key}: {value_str}&quot;, markup=False, classes=&quot;approval-description&quot;)


class WriteFileApprovalWidget(ToolApprovalWidget):
    &quot;&quot;&quot;Approval widget for write_file - shows file content with syntax highlighting.&quot;&quot;&quot;

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the file content display with syntax highlighting.&quot;&quot;&quot;
        file_path = self.data.get(&quot;file_path&quot;, &quot;&quot;)
        content = self.data.get(&quot;content&quot;, &quot;&quot;)
        file_extension = self.data.get(&quot;file_extension&quot;, &quot;text&quot;)

        # File path header
        yield Static(f&quot;File: {file_path}&quot;, markup=False, classes=&quot;approval-file-path&quot;)
        yield Static(&quot;&quot;)

        # Content with syntax highlighting via Markdown code block
        lines = content.split(&quot;\n&quot;)
        total_lines = len(lines)

        if total_lines &gt; _MAX_LINES:
            # Truncate for display
            shown_lines = lines[:_MAX_LINES]
            remaining = total_lines - _MAX_LINES
            truncated_content = &quot;\n&quot;.join(shown_lines) + f&quot;\n... ({remaining} more lines)&quot;
            yield Markdown(f&quot;```{file_extension}\n{truncated_content}\n```&quot;)
        else:
            yield Markdown(f&quot;```{file_extension}\n{content}\n```&quot;)


class EditFileApprovalWidget(ToolApprovalWidget):
    &quot;&quot;&quot;Approval widget for edit_file - shows clean diff with colors.&quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    EditFileApprovalWidget .diff-removed-line {
        color: #ff6b6b;
        background: #3d1f1f;
    }
    EditFileApprovalWidget .diff-added-line {
        color: #69db7c;
        background: #1f3d1f;
    }
    EditFileApprovalWidget .diff-context-line {
        color: #888888;
    }
    EditFileApprovalWidget .diff-stats {
        color: #888888;
        margin-top: 1;
    }
    &quot;&quot;&quot;

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the diff display with colored additions and deletions.&quot;&quot;&quot;
        file_path = self.data.get(&quot;file_path&quot;, &quot;&quot;)
        diff_lines = self.data.get(&quot;diff_lines&quot;, [])
        old_string = self.data.get(&quot;old_string&quot;, &quot;&quot;)
        new_string = self.data.get(&quot;new_string&quot;, &quot;&quot;)

        # Calculate stats first for header
        additions, deletions = self._count_stats(diff_lines, old_string, new_string)

        # File path header with stats
        stats_str = self._format_stats(additions, deletions)
        yield Static(f&quot;[bold cyan]File:[/bold cyan] {file_path}  {stats_str}&quot;)
        yield Static(&quot;&quot;)

        if not diff_lines and not old_string and not new_string:
            yield Static(&quot;No changes to display&quot;, classes=&quot;approval-description&quot;)
            return

        # Render content
        if diff_lines:
            yield from self._render_diff_lines_only(diff_lines)
        else:
            yield from self._render_strings_only(old_string, new_string)

    def _count_stats(
        self, diff_lines: list[str], old_string: str, new_string: str
    ) -&gt; tuple[int, int]:
        &quot;&quot;&quot;Count additions and deletions from diff data.&quot;&quot;&quot;
        if diff_lines:
            additions = sum(
                1 for line in diff_lines if line.startswith(&quot;+&quot;) and not line.startswith(&quot;+++&quot;)
            )
            deletions = sum(
                1 for line in diff_lines if line.startswith(&quot;-&quot;) and not line.startswith(&quot;---&quot;)
            )
        else:
            additions = new_string.count(&quot;\n&quot;) + 1 if new_string else 0
            deletions = old_string.count(&quot;\n&quot;) + 1 if old_string else 0
        return additions, deletions

    def _format_stats(self, additions: int, deletions: int) -&gt; str:
        &quot;&quot;&quot;Format stats as colored string.&quot;&quot;&quot;
        parts = []
        if additions:
            parts.append(f&quot;[green]+{additions}[/green]&quot;)
        if deletions:
            parts.append(f&quot;[red]-{deletions}[/red]&quot;)
        return &quot; &quot;.join(parts)

    def _render_diff_lines_only(self, diff_lines: list[str]) -&gt; ComposeResult:
        &quot;&quot;&quot;Render unified diff lines without returning stats.&quot;&quot;&quot;
        lines_shown = 0

        for line in diff_lines:
            if lines_shown &gt;= _MAX_DIFF_LINES:
                yield Static(f&quot;[dim]... ({len(diff_lines) - lines_shown} more lines)[/dim]&quot;)
                break

            if line.startswith((&quot;@@&quot;, &quot;---&quot;, &quot;+++&quot;)):
                continue

            widget = self._render_diff_line(line)
            if widget:
                yield widget
                lines_shown += 1

    def _render_strings_only(self, old_string: str, new_string: str) -&gt; ComposeResult:
        &quot;&quot;&quot;Render old/new strings without returning stats.&quot;&quot;&quot;
        if old_string:
            yield Static(&quot;[bold red]Removing:[/bold red]&quot;)
            yield from self._render_string_lines(old_string, is_addition=False)
            yield Static(&quot;&quot;)

        if new_string:
            yield Static(&quot;[bold green]Adding:[/bold green]&quot;)
            yield from self._render_string_lines(new_string, is_addition=True)

    def _render_diff_line(self, line: str) -&gt; Static | None:
        &quot;&quot;&quot;Render a single diff line with appropriate styling.&quot;&quot;&quot;
        content = _escape_markup(line[1:] if len(line) &gt; 1 else &quot;&quot;)

        if line.startswith(&quot;-&quot;):
            return Static(f&quot;[on #3d1f1f][red]- {content}[/red][/on #3d1f1f]&quot;)
        if line.startswith(&quot;+&quot;):
            return Static(f&quot;[on #1f3d1f][green]+ {content}[/green][/on #1f3d1f]&quot;)
        if line.startswith(&quot; &quot;):
            return Static(f&quot;[dim]  {content}[/dim]&quot;)
        if line.strip():
            return Static(line, markup=False)
        return None

    def _render_string_lines(self, text: str, *, is_addition: bool) -&gt; ComposeResult:
        &quot;&quot;&quot;Render lines from a string with appropriate styling.&quot;&quot;&quot;
        lines = text.split(&quot;\n&quot;)
        style = &quot;[on #1f3d1f][green]+&quot; if is_addition else &quot;[on #3d1f1f][red]-&quot;
        end_style = &quot;[/green][/on #1f3d1f]&quot; if is_addition else &quot;[/red][/on #3d1f1f]&quot;

        for line in lines[:_MAX_PREVIEW_LINES]:
            escaped = _escape_markup(line)
            yield Static(f&quot;{style} {escaped}{end_style}&quot;)

        if len(lines) &gt; _MAX_PREVIEW_LINES:
            remaining = len(lines) - _MAX_PREVIEW_LINES
            yield Static(f&quot;[dim]... ({remaining} more lines)[/dim]&quot;)


class BashApprovalWidget(ToolApprovalWidget):
    &quot;&quot;&quot;Approval widget for bash/shell commands.&quot;&quot;&quot;

    def compose(self) -&gt; ComposeResult:
        &quot;&quot;&quot;Compose the bash command display with syntax highlighting.&quot;&quot;&quot;
        command = self.data.get(&quot;command&quot;, &quot;&quot;)
        description = self.data.get(&quot;description&quot;, &quot;&quot;)

        if description:
            yield Static(description, markup=False, classes=&quot;approval-description&quot;)
            yield Static(&quot;&quot;)

        # Show command with bash syntax highlighting
        yield Markdown(f&quot;```bash\n{command}\n```&quot;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/tool_widgets/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="tools Imported skill tools from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/tools.py Unknown LICENSE sources/langchain/tools/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">tools</div>
                <button class="copy-btn" onclick="copyToClipboard('tools')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill tools from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Custom tools for the CLI agent.&quot;&quot;&quot;

from typing import Any, Literal

import requests
from markdownify import markdownify
from tavily import TavilyClient

from deepagents_cli.config import settings

# Initialize Tavily client if API key is available
tavily_client = TavilyClient(api_key=settings.tavily_api_key) if settings.has_tavily else None


def http_request(
    url: str,
    method: str = &quot;GET&quot;,
    headers: dict[str, str] | None = None,
    data: str | dict | None = None,
    params: dict[str, str] | None = None,
    timeout: int = 30,
) -&gt; dict[str, Any]:
    &quot;&quot;&quot;Make HTTP requests to APIs and web services.

    Args:
        url: Target URL
        method: HTTP method (GET, POST, PUT, DELETE, etc.)
        headers: HTTP headers to include
        data: Request body data (string or dict)
        params: URL query parameters
        timeout: Request timeout in seconds

    Returns:
        Dictionary with response data including status, headers, and content
    &quot;&quot;&quot;
    try:
        kwargs = {&quot;url&quot;: url, &quot;method&quot;: method.upper(), &quot;timeout&quot;: timeout}

        if headers:
            kwargs[&quot;headers&quot;] = headers
        if params:
            kwargs[&quot;params&quot;] = params
        if data:
            if isinstance(data, dict):
                kwargs[&quot;json&quot;] = data
            else:
                kwargs[&quot;data&quot;] = data

        response = requests.request(**kwargs)

        try:
            content = response.json()
        except:
            content = response.text

        return {
            &quot;success&quot;: response.status_code &lt; 400,
            &quot;status_code&quot;: response.status_code,
            &quot;headers&quot;: dict(response.headers),
            &quot;content&quot;: content,
            &quot;url&quot;: response.url,
        }

    except requests.exceptions.Timeout:
        return {
            &quot;success&quot;: False,
            &quot;status_code&quot;: 0,
            &quot;headers&quot;: {},
            &quot;content&quot;: f&quot;Request timed out after {timeout} seconds&quot;,
            &quot;url&quot;: url,
        }
    except requests.exceptions.RequestException as e:
        return {
            &quot;success&quot;: False,
            &quot;status_code&quot;: 0,
            &quot;headers&quot;: {},
            &quot;content&quot;: f&quot;Request error: {e!s}&quot;,
            &quot;url&quot;: url,
        }
    except Exception as e:
        return {
            &quot;success&quot;: False,
            &quot;status_code&quot;: 0,
            &quot;headers&quot;: {},
            &quot;content&quot;: f&quot;Error making request: {e!s}&quot;,
            &quot;url&quot;: url,
        }


def web_search(
    query: str,
    max_results: int = 5,
    topic: Literal[&quot;general&quot;, &quot;news&quot;, &quot;finance&quot;] = &quot;general&quot;,
    include_raw_content: bool = False,
):
    &quot;&quot;&quot;Search the web using Tavily for current information and documentation.

    This tool searches the web and returns relevant results. After receiving results,
    you MUST synthesize the information into a natural, helpful response for the user.

    Args:
        query: The search query (be specific and detailed)
        max_results: Number of results to return (default: 5)
        topic: Search topic type - &quot;general&quot; for most queries, &quot;news&quot; for current events
        include_raw_content: Include full page content (warning: uses more tokens)

    Returns:
        Dictionary containing:
        - results: List of search results, each with:
            - title: Page title
            - url: Page URL
            - content: Relevant excerpt from the page
            - score: Relevance score (0-1)
        - query: The original search query

    IMPORTANT: After using this tool:
    1. Read through the &#x27;content&#x27; field of each result
    2. Extract relevant information that answers the user&#x27;s question
    3. Synthesize this into a clear, natural language response
    4. Cite sources by mentioning the page titles or URLs
    5. NEVER show the raw JSON to the user - always provide a formatted response
    &quot;&quot;&quot;
    if tavily_client is None:
        return {
            &quot;error&quot;: &quot;Tavily API key not configured. Please set TAVILY_API_KEY environment variable.&quot;,
            &quot;query&quot;: query,
        }

    try:
        return tavily_client.search(
            query,
            max_results=max_results,
            include_raw_content=include_raw_content,
            topic=topic,
        )
    except Exception as e:
        return {&quot;error&quot;: f&quot;Web search error: {e!s}&quot;, &quot;query&quot;: query}


def fetch_url(url: str, timeout: int = 30) -&gt; dict[str, Any]:
    &quot;&quot;&quot;Fetch content from a URL and convert HTML to markdown format.

    This tool fetches web page content and converts it to clean markdown text,
    making it easy to read and process HTML content. After receiving the markdown,
    you MUST synthesize the information into a natural, helpful response for the user.

    Args:
        url: The URL to fetch (must be a valid HTTP/HTTPS URL)
        timeout: Request timeout in seconds (default: 30)

    Returns:
        Dictionary containing:
        - success: Whether the request succeeded
        - url: The final URL after redirects
        - markdown_content: The page content converted to markdown
        - status_code: HTTP status code
        - content_length: Length of the markdown content in characters

    IMPORTANT: After using this tool:
    1. Read through the markdown content
    2. Extract relevant information that answers the user&#x27;s question
    3. Synthesize this into a clear, natural language response
    4. NEVER show the raw markdown to the user unless specifically requested
    &quot;&quot;&quot;
    try:
        response = requests.get(
            url,
            timeout=timeout,
            headers={&quot;User-Agent&quot;: &quot;Mozilla/5.0 (compatible; DeepAgents/1.0)&quot;},
        )
        response.raise_for_status()

        # Convert HTML content to markdown
        markdown_content = markdownify(response.text)

        return {
            &quot;url&quot;: str(response.url),
            &quot;markdown_content&quot;: markdown_content,
            &quot;status_code&quot;: response.status_code,
            &quot;content_length&quot;: len(markdown_content),
        }
    except Exception as e:
        return {&quot;error&quot;: f&quot;Fetch URL error: {e!s}&quot;, &quot;url&quot;: url}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/tools/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="tracing Imported skill tracing from langchain langchain /a0/tmp/skills_research/langchain/libs/harbor/deepagents_harbor/tracing.py Unknown LICENSE sources/langchain/tracing/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">tracing</div>
                <button class="copy-btn" onclick="copyToClipboard('tracing')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill tracing from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;LangSmith integration for Harbor DeepAgents.&quot;&quot;&quot;

import hashlib
import uuid


def create_example_id_from_instruction(instruction: str, seed: int = 42) -&gt; str:
    &quot;&quot;&quot;Create a deterministic UUID from an instruction string.

    Normalizes the instruction by stripping whitespace and creating a
    SHA-256 hash, then converting to a UUID for LangSmith compatibility.

    Args:
        instruction: The task instruction string to hash
        seed: Integer seed to avoid collisions with existing examples

    Returns:
        A UUID string generated from the hash of the normalized instruction
    &quot;&quot;&quot;
    # Normalize the instruction: strip leading/trailing whitespace
    normalized = instruction.strip()

    # Prepend seed as bytes to the instruction for hashing
    seeded_data = seed.to_bytes(8, byteorder=&quot;big&quot;) + normalized.encode(&quot;utf-8&quot;)

    # Create SHA-256 hash of the seeded instruction
    hash_bytes = hashlib.sha256(seeded_data).digest()

    # Use first 16 bytes to create a UUID
    example_uuid = uuid.UUID(bytes=hash_bytes[:16])

    return str(example_uuid)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/tracing/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="ui Imported skill ui from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/ui.py Unknown LICENSE sources/langchain/ui/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">ui</div>
                <button class="copy-btn" onclick="copyToClipboard('ui')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill ui from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;UI rendering and display utilities for the CLI.&quot;&quot;&quot;

import json
from pathlib import Path
from typing import Any

from .config import COLORS, DEEP_AGENTS_ASCII, MAX_ARG_LENGTH, console


def truncate_value(value: str, max_length: int = MAX_ARG_LENGTH) -&gt; str:
    &quot;&quot;&quot;Truncate a string value if it exceeds max_length.&quot;&quot;&quot;
    if len(value) &gt; max_length:
        return value[:max_length] + &quot;...&quot;
    return value


def format_tool_display(tool_name: str, tool_args: dict) -&gt; str:
    &quot;&quot;&quot;Format tool calls for display with tool-specific smart formatting.

    Shows the most relevant information for each tool type rather than all arguments.

    Args:
        tool_name: Name of the tool being called
        tool_args: Dictionary of tool arguments

    Returns:
        Formatted string for display (e.g., &quot;read_file(config.py)&quot;)

    Examples:
        read_file(path=&quot;/long/path/file.py&quot;)  &quot;read_file(file.py)&quot;
        web_search(query=&quot;how to code&quot;, max_results=5)  &#x27;web_search(&quot;how to code&quot;)&#x27;
        shell(command=&quot;pip install foo&quot;)  &#x27;shell(&quot;pip install foo&quot;)&#x27;
    &quot;&quot;&quot;

    def abbreviate_path(path_str: str, max_length: int = 60) -&gt; str:
        &quot;&quot;&quot;Abbreviate a file path intelligently - show basename or relative path.&quot;&quot;&quot;
        try:
            path = Path(path_str)

            # If it&#x27;s just a filename (no directory parts), return as-is
            if len(path.parts) == 1:
                return path_str

            # Try to get relative path from current working directory
            try:
                rel_path = path.relative_to(Path.cwd())
                rel_str = str(rel_path)
                # Use relative if it&#x27;s shorter and not too long
                if len(rel_str) &lt; len(path_str) and len(rel_str) &lt;= max_length:
                    return rel_str
            except (ValueError, Exception):
                pass

            # If absolute path is reasonable length, use it
            if len(path_str) &lt;= max_length:
                return path_str

            # Otherwise, just show basename (filename only)
            return path.name
        except Exception:
            # Fallback to original string if any error
            return truncate_value(path_str, max_length)

    # Tool-specific formatting - show the most important argument(s)
    if tool_name in (&quot;read_file&quot;, &quot;write_file&quot;, &quot;edit_file&quot;):
        # File operations: show the primary file path argument (file_path or path)
        path_value = tool_args.get(&quot;file_path&quot;)
        if path_value is None:
            path_value = tool_args.get(&quot;path&quot;)
        if path_value is not None:
            path = abbreviate_path(str(path_value))
            return f&quot;{tool_name}({path})&quot;

    elif tool_name == &quot;web_search&quot;:
        # Web search: show the query string
        if &quot;query&quot; in tool_args:
            query = str(tool_args[&quot;query&quot;])
            query = truncate_value(query, 100)
            return f&#x27;{tool_name}(&quot;{query}&quot;)&#x27;

    elif tool_name == &quot;grep&quot;:
        # Grep: show the search pattern
        if &quot;pattern&quot; in tool_args:
            pattern = str(tool_args[&quot;pattern&quot;])
            pattern = truncate_value(pattern, 70)
            return f&#x27;{tool_name}(&quot;{pattern}&quot;)&#x27;

    elif tool_name == &quot;shell&quot;:
        # Shell: show the command being executed
        if &quot;command&quot; in tool_args:
            command = str(tool_args[&quot;command&quot;])
            command = truncate_value(command, 120)
            return f&#x27;{tool_name}(&quot;{command}&quot;)&#x27;

    elif tool_name == &quot;ls&quot;:
        # ls: show directory, or empty if current directory
        if tool_args.get(&quot;path&quot;):
            path = abbreviate_path(str(tool_args[&quot;path&quot;]))
            return f&quot;{tool_name}({path})&quot;
        return f&quot;{tool_name}()&quot;

    elif tool_name == &quot;glob&quot;:
        # Glob: show the pattern
        if &quot;pattern&quot; in tool_args:
            pattern = str(tool_args[&quot;pattern&quot;])
            pattern = truncate_value(pattern, 80)
            return f&#x27;{tool_name}(&quot;{pattern}&quot;)&#x27;

    elif tool_name == &quot;http_request&quot;:
        # HTTP: show method and URL
        parts = []
        if &quot;method&quot; in tool_args:
            parts.append(str(tool_args[&quot;method&quot;]).upper())
        if &quot;url&quot; in tool_args:
            url = str(tool_args[&quot;url&quot;])
            url = truncate_value(url, 80)
            parts.append(url)
        if parts:
            return f&quot;{tool_name}({&#x27; &#x27;.join(parts)})&quot;

    elif tool_name == &quot;fetch_url&quot;:
        # Fetch URL: show the URL being fetched
        if &quot;url&quot; in tool_args:
            url = str(tool_args[&quot;url&quot;])
            url = truncate_value(url, 80)
            return f&#x27;{tool_name}(&quot;{url}&quot;)&#x27;

    elif tool_name == &quot;task&quot;:
        # Task: show the task description
        if &quot;description&quot; in tool_args:
            desc = str(tool_args[&quot;description&quot;])
            desc = truncate_value(desc, 100)
            return f&#x27;{tool_name}(&quot;{desc}&quot;)&#x27;

    elif tool_name == &quot;write_todos&quot;:
        # Todos: show count of items
        if &quot;todos&quot; in tool_args and isinstance(tool_args[&quot;todos&quot;], list):
            count = len(tool_args[&quot;todos&quot;])
            return f&quot;{tool_name}({count} items)&quot;

    # Fallback: generic formatting for unknown tools
    # Show all arguments in key=value format
    args_str = &quot;, &quot;.join(f&quot;{k}={truncate_value(str(v), 50)}&quot; for k, v in tool_args.items())
    return f&quot;{tool_name}({args_str})&quot;


def format_tool_message_content(content: Any) -&gt; str:
    &quot;&quot;&quot;Convert ToolMessage content into a printable string.&quot;&quot;&quot;
    if content is None:
        return &quot;&quot;
    if isinstance(content, list):
        parts = []
        for item in content:
            if isinstance(item, str):
                parts.append(item)
            else:
                try:
                    parts.append(json.dumps(item))
                except Exception:
                    parts.append(str(item))
        return &quot;\n&quot;.join(parts)
    return str(content)


def show_help() -&gt; None:
    &quot;&quot;&quot;Show help information.&quot;&quot;&quot;
    console.print()
    console.print(DEEP_AGENTS_ASCII, style=f&quot;bold {COLORS[&#x27;primary&#x27;]}&quot;)
    console.print()

    console.print(&quot;[bold]Usage:[/bold]&quot;, style=COLORS[&quot;primary&quot;])
    console.print(&quot;  deepagents [OPTIONS]                           Start interactive session&quot;)
    console.print(&quot;  deepagents list                                List all available agents&quot;)
    console.print(&quot;  deepagents reset --agent AGENT                 Reset agent to default prompt&quot;)
    console.print(
        &quot;  deepagents reset --agent AGENT --target SOURCE Reset agent to copy of another agent&quot;
    )
    console.print(&quot;  deepagents help                                Show this help message&quot;)
    console.print(&quot;  deepagents --version                           Show deepagents version&quot;)
    console.print()

    console.print(&quot;[bold]Options:[/bold]&quot;, style=COLORS[&quot;primary&quot;])
    console.print(&quot;  --agent NAME                  Agent identifier (default: agent)&quot;)
    console.print(
        &quot;  --model MODEL                 Model to use (e.g., claude-sonnet-4-5-20250929, gpt-4o)&quot;
    )
    console.print(&quot;  --auto-approve                Auto-approve tool usage without prompting&quot;)
    console.print(
        &quot;  --sandbox TYPE                Remote sandbox for execution (modal, runloop, daytona)&quot;
    )
    console.print(&quot;  --sandbox-id ID               Reuse existing sandbox (skips creation/cleanup)&quot;)
    console.print(
        &quot;  -r, --resume [ID]             Resume thread: -r for most recent, -r &lt;ID&gt; for specific&quot;
    )
    console.print()

    console.print(&quot;[bold]Examples:[/bold]&quot;, style=COLORS[&quot;primary&quot;])
    console.print(
        &quot;  deepagents                              # Start with default agent&quot;, style=COLORS[&quot;dim&quot;]
    )
    console.print(
        &quot;  deepagents --agent mybot                # Start with agent named &#x27;mybot&#x27;&quot;,
        style=COLORS[&quot;dim&quot;],
    )
    console.print(
        &quot;  deepagents --model gpt-4o               # Use specific model (auto-detects provider)&quot;,
        style=COLORS[&quot;dim&quot;],
    )
    console.print(
        &quot;  deepagents -r                           # Resume most recent session&quot;,
        style=COLORS[&quot;dim&quot;],
    )
    console.print(
        &quot;  deepagents -r abc123                    # Resume specific thread&quot;,
        style=COLORS[&quot;dim&quot;],
    )
    console.print(
        &quot;  deepagents --auto-approve               # Start with auto-approve enabled&quot;,
        style=COLORS[&quot;dim&quot;],
    )
    console.print(
        &quot;  deepagents --sandbox runloop            # Execute code in Runloop sandbox&quot;,
        style=COLORS[&quot;dim&quot;],
    )
    console.print()

    console.print(&quot;[bold]Thread Management:[/bold]&quot;, style=COLORS[&quot;primary&quot;])
    console.print(
        &quot;  deepagents threads list                 # List all sessions&quot;, style=COLORS[&quot;dim&quot;]
    )
    console.print(
        &quot;  deepagents threads delete &lt;ID&gt;          # Delete a session&quot;, style=COLORS[&quot;dim&quot;]
    )
    console.print()

    console.print(&quot;[bold]Interactive Features:[/bold]&quot;, style=COLORS[&quot;primary&quot;])
    console.print(&quot;  Enter           Submit your message&quot;, style=COLORS[&quot;dim&quot;])
    console.print(&quot;  Ctrl+J          Insert newline&quot;, style=COLORS[&quot;dim&quot;])
    console.print(&quot;  Shift+Tab       Toggle auto-approve mode&quot;, style=COLORS[&quot;dim&quot;])
    console.print(&quot;  @filename       Auto-complete files and inject content&quot;, style=COLORS[&quot;dim&quot;])
    console.print(&quot;  /command        Slash commands (/help, /clear, /quit)&quot;, style=COLORS[&quot;dim&quot;])
    console.print(&quot;  !command        Run bash commands directly&quot;, style=COLORS[&quot;dim&quot;])
    console.print()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/ui/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="utils Imported skill utils from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents/deepagents/backends/utils.py Unknown LICENSE sources/langchain/utils/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">utils</div>
                <button class="copy-btn" onclick="copyToClipboard('utils')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill utils from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Shared utility functions for memory backend implementations.

This module contains both user-facing string formatters and structured
helpers used by backends and the composite router. Structured helpers
enable composition without fragile string parsing.
&quot;&quot;&quot;

import re
from datetime import UTC, datetime
from pathlib import Path
from typing import Any, Literal

import wcmatch.glob as wcglob

from deepagents.backends.protocol import FileInfo as _FileInfo, GrepMatch as _GrepMatch

EMPTY_CONTENT_WARNING = &quot;System reminder: File exists but has empty contents&quot;
MAX_LINE_LENGTH = 5000
LINE_NUMBER_WIDTH = 6
TOOL_RESULT_TOKEN_LIMIT = 20000  # Same threshold as eviction
TRUNCATION_GUIDANCE = &quot;... [results truncated, try being more specific with your parameters]&quot;

# Re-export protocol types for backwards compatibility
FileInfo = _FileInfo
GrepMatch = _GrepMatch


def sanitize_tool_call_id(tool_call_id: str) -&gt; str:
    r&quot;&quot;&quot;Sanitize tool_call_id to prevent path traversal and separator issues.

    Replaces dangerous characters (., /, \) with underscores.
    &quot;&quot;&quot;
    sanitized = tool_call_id.replace(&quot;.&quot;, &quot;_&quot;).replace(&quot;/&quot;, &quot;_&quot;).replace(&quot;\\&quot;, &quot;_&quot;)
    return sanitized


def format_content_with_line_numbers(
    content: str | list[str],
    start_line: int = 1,
) -&gt; str:
    &quot;&quot;&quot;Format file content with line numbers (cat -n style).

    Chunks lines longer than MAX_LINE_LENGTH with continuation markers (e.g., 5.1, 5.2).

    Args:
        content: File content as string or list of lines
        start_line: Starting line number (default: 1)

    Returns:
        Formatted content with line numbers and continuation markers
    &quot;&quot;&quot;
    if isinstance(content, str):
        lines = content.split(&quot;\n&quot;)
        if lines and lines[-1] == &quot;&quot;:
            lines = lines[:-1]
    else:
        lines = content

    result_lines = []
    for i, line in enumerate(lines):
        line_num = i + start_line

        if len(line) &lt;= MAX_LINE_LENGTH:
            result_lines.append(f&quot;{line_num:{LINE_NUMBER_WIDTH}d}\t{line}&quot;)
        else:
            # Split long line into chunks with continuation markers
            num_chunks = (len(line) + MAX_LINE_LENGTH - 1) // MAX_LINE_LENGTH
            for chunk_idx in range(num_chunks):
                start = chunk_idx * MAX_LINE_LENGTH
                end = min(start + MAX_LINE_LENGTH, len(line))
                chunk = line[start:end]
                if chunk_idx == 0:
                    # First chunk: use normal line number
                    result_lines.append(f&quot;{line_num:{LINE_NUMBER_WIDTH}d}\t{chunk}&quot;)
                else:
                    # Continuation chunks: use decimal notation (e.g., 5.1, 5.2)
                    continuation_marker = f&quot;{line_num}.{chunk_idx}&quot;
                    result_lines.append(f&quot;{continuation_marker:&gt;{LINE_NUMBER_WIDTH}}\t{chunk}&quot;)

    return &quot;\n&quot;.join(result_lines)


def check_empty_content(content: str) -&gt; str | None:
    &quot;&quot;&quot;Check if content is empty and return warning message.

    Args:
        content: Content to check

    Returns:
        Warning message if empty, None otherwise
    &quot;&quot;&quot;
    if not content or content.strip() == &quot;&quot;:
        return EMPTY_CONTENT_WARNING
    return None


def file_data_to_string(file_data: dict[str, Any]) -&gt; str:
    &quot;&quot;&quot;Convert FileData to plain string content.

    Args:
        file_data: FileData dict with &#x27;content&#x27; key

    Returns:
        Content as string with lines joined by newlines
    &quot;&quot;&quot;
    return &quot;\n&quot;.join(file_data[&quot;content&quot;])


def create_file_data(content: str, created_at: str | None = None) -&gt; dict[str, Any]:
    &quot;&quot;&quot;Create a FileData object with timestamps.

    Args:
        content: File content as string
        created_at: Optional creation timestamp (ISO format)

    Returns:
        FileData dict with content and timestamps
    &quot;&quot;&quot;
    lines = content.split(&quot;\n&quot;) if isinstance(content, str) else content
    now = datetime.now(UTC).isoformat()

    return {
        &quot;content&quot;: lines,
        &quot;created_at&quot;: created_at or now,
        &quot;modified_at&quot;: now,
    }


def update_file_data(file_data: dict[str, Any], content: str) -&gt; dict[str, Any]:
    &quot;&quot;&quot;Update FileData with new content, preserving creation timestamp.

    Args:
        file_data: Existing FileData dict
        content: New content as string

    Returns:
        Updated FileData dict
    &quot;&quot;&quot;
    lines = content.split(&quot;\n&quot;) if isinstance(content, str) else content
    now = datetime.now(UTC).isoformat()

    return {
        &quot;content&quot;: lines,
        &quot;created_at&quot;: file_data[&quot;created_at&quot;],
        &quot;modified_at&quot;: now,
    }


def format_read_response(
    file_data: dict[str, Any],
    offset: int,
    limit: int,
) -&gt; str:
    &quot;&quot;&quot;Format file data for read response with line numbers.

    Args:
        file_data: FileData dict
        offset: Line offset (0-indexed)
        limit: Maximum number of lines

    Returns:
        Formatted content or error message
    &quot;&quot;&quot;
    content = file_data_to_string(file_data)
    empty_msg = check_empty_content(content)
    if empty_msg:
        return empty_msg

    lines = content.splitlines()
    start_idx = offset
    end_idx = min(start_idx + limit, len(lines))

    if start_idx &gt;= len(lines):
        return f&quot;Error: Line offset {offset} exceeds file length ({len(lines)} lines)&quot;

    selected_lines = lines[start_idx:end_idx]
    return format_content_with_line_numbers(selected_lines, start_line=start_idx + 1)


def perform_string_replacement(
    content: str,
    old_string: str,
    new_string: str,
    replace_all: bool,
) -&gt; tuple[str, int] | str:
    &quot;&quot;&quot;Perform string replacement with occurrence validation.

    Args:
        content: Original content
        old_string: String to replace
        new_string: Replacement string
        replace_all: Whether to replace all occurrences

    Returns:
        Tuple of (new_content, occurrences) on success, or error message string
    &quot;&quot;&quot;
    occurrences = content.count(old_string)

    if occurrences == 0:
        return f&quot;Error: String not found in file: &#x27;{old_string}&#x27;&quot;

    if occurrences &gt; 1 and not replace_all:
        return f&quot;Error: String &#x27;{old_string}&#x27; appears {occurrences} times in file. Use replace_all=True to replace all instances, or provide a more specific string with surrounding context.&quot;

    new_content = content.replace(old_string, new_string)
    return new_content, occurrences


def truncate_if_too_long(result: list[str] | str) -&gt; list[str] | str:
    &quot;&quot;&quot;Truncate list or string result if it exceeds token limit (rough estimate: 4 chars/token).&quot;&quot;&quot;
    if isinstance(result, list):
        total_chars = sum(len(item) for item in result)
        if total_chars &gt; TOOL_RESULT_TOKEN_LIMIT * 4:
            return result[: len(result) * TOOL_RESULT_TOKEN_LIMIT * 4 // total_chars] + [TRUNCATION_GUIDANCE]
        return result
    # string
    if len(result) &gt; TOOL_RESULT_TOKEN_LIMIT * 4:
        return result[: TOOL_RESULT_TOKEN_LIMIT * 4] + &quot;\n&quot; + TRUNCATION_GUIDANCE
    return result


def _validate_path(path: str | None) -&gt; str:
    &quot;&quot;&quot;Validate and normalize a path.

    Args:
        path: Path to validate

    Returns:
        Normalized path starting with /

    Raises:
        ValueError: If path is invalid
    &quot;&quot;&quot;
    path = path or &quot;/&quot;
    if not path or path.strip() == &quot;&quot;:
        raise ValueError(&quot;Path cannot be empty&quot;)

    normalized = path if path.startswith(&quot;/&quot;) else &quot;/&quot; + path

    if not normalized.endswith(&quot;/&quot;):
        normalized += &quot;/&quot;

    return normalized


def _glob_search_files(
    files: dict[str, Any],
    pattern: str,
    path: str = &quot;/&quot;,
) -&gt; str:
    &quot;&quot;&quot;Search files dict for paths matching glob pattern.

    Args:
        files: Dictionary of file paths to FileData.
        pattern: Glob pattern (e.g., &quot;*.py&quot;, &quot;**/*.ts&quot;).
        path: Base path to search from.

    Returns:
        Newline-separated file paths, sorted by modification time (most recent first).
        Returns &quot;No files found&quot; if no matches.

    Example:
        ```python
        files = {&quot;/src/main.py&quot;: FileData(...), &quot;/test.py&quot;: FileData(...)}
        _glob_search_files(files, &quot;*.py&quot;, &quot;/&quot;)
        # Returns: &quot;/test.py\n/src/main.py&quot; (sorted by modified_at)
        ```
    &quot;&quot;&quot;
    try:
        normalized_path = _validate_path(path)
    except ValueError:
        return &quot;No files found&quot;

    filtered = {fp: fd for fp, fd in files.items() if fp.startswith(normalized_path)}

    # Respect standard glob semantics:
    # - Patterns without path separators (e.g., &quot;*.py&quot;) match only in the current
    #   directory (non-recursive) relative to `path`.
    # - Use &quot;**&quot; explicitly for recursive matching.
    effective_pattern = pattern

    matches = []
    for file_path, file_data in filtered.items():
        relative = file_path[len(normalized_path) :].lstrip(&quot;/&quot;)
        if not relative:
            relative = file_path.split(&quot;/&quot;)[-1]

        if wcglob.globmatch(relative, effective_pattern, flags=wcglob.BRACE | wcglob.GLOBSTAR):
            matches.append((file_path, file_data[&quot;modified_at&quot;]))

    matches.sort(key=lambda x: x[1], reverse=True)

    if not matches:
        return &quot;No files found&quot;

    return &quot;\n&quot;.join(fp for fp, _ in matches)


def _format_grep_results(
    results: dict[str, list[tuple[int, str]]],
    output_mode: Literal[&quot;files_with_matches&quot;, &quot;content&quot;, &quot;count&quot;],
) -&gt; str:
    &quot;&quot;&quot;Format grep search results based on output mode.

    Args:
        results: Dictionary mapping file paths to list of (line_num, line_content) tuples
        output_mode: Output format - &quot;files_with_matches&quot;, &quot;content&quot;, or &quot;count&quot;

    Returns:
        Formatted string output
    &quot;&quot;&quot;
    if output_mode == &quot;files_with_matches&quot;:
        return &quot;\n&quot;.join(sorted(results.keys()))
    if output_mode == &quot;count&quot;:
        lines = []
        for file_path in sorted(results.keys()):
            count = len(results[file_path])
            lines.append(f&quot;{file_path}: {count}&quot;)
        return &quot;\n&quot;.join(lines)
    lines = []
    for file_path in sorted(results.keys()):
        lines.append(f&quot;{file_path}:&quot;)
        for line_num, line in results[file_path]:
            lines.append(f&quot;  {line_num}: {line}&quot;)
    return &quot;\n&quot;.join(lines)


def _grep_search_files(
    files: dict[str, Any],
    pattern: str,
    path: str | None = None,
    glob: str | None = None,
    output_mode: Literal[&quot;files_with_matches&quot;, &quot;content&quot;, &quot;count&quot;] = &quot;files_with_matches&quot;,
) -&gt; str:
    &quot;&quot;&quot;Search file contents for regex pattern.

    Args:
        files: Dictionary of file paths to FileData.
        pattern: Regex pattern to search for.
        path: Base path to search from.
        glob: Optional glob pattern to filter files (e.g., &quot;*.py&quot;).
        output_mode: Output format - &quot;files_with_matches&quot;, &quot;content&quot;, or &quot;count&quot;.

    Returns:
        Formatted search results. Returns &quot;No matches found&quot; if no results.

    Example:
        ```python
        files = {&quot;/file.py&quot;: FileData(content=[&quot;import os&quot;, &quot;print(&#x27;hi&#x27;)&quot;], ...)}
        _grep_search_files(files, &quot;import&quot;, &quot;/&quot;)
        # Returns: &quot;/file.py&quot; (with output_mode=&quot;files_with_matches&quot;)
        ```
    &quot;&quot;&quot;
    try:
        regex = re.compile(pattern)
    except re.error as e:
        return f&quot;Invalid regex pattern: {e}&quot;

    try:
        normalized_path = _validate_path(path)
    except ValueError:
        return &quot;No matches found&quot;

    filtered = {fp: fd for fp, fd in files.items() if fp.startswith(normalized_path)}

    if glob:
        filtered = {fp: fd for fp, fd in filtered.items() if wcglob.globmatch(Path(fp).name, glob, flags=wcglob.BRACE)}

    results: dict[str, list[tuple[int, str]]] = {}
    for file_path, file_data in filtered.items():
        for line_num, line in enumerate(file_data[&quot;content&quot;], 1):
            if regex.search(line):
                if file_path not in results:
                    results[file_path] = []
                results[file_path].append((line_num, line))

    if not results:
        return &quot;No matches found&quot;
    return _format_grep_results(results, output_mode)


# -------- Structured helpers for composition --------


def grep_matches_from_files(
    files: dict[str, Any],
    pattern: str,
    path: str | None = None,
    glob: str | None = None,
) -&gt; list[GrepMatch] | str:
    &quot;&quot;&quot;Return structured grep matches from an in-memory files mapping.

    Returns a list of GrepMatch on success, or a string for invalid inputs
    (e.g., invalid regex). We deliberately do not raise here to keep backends
    non-throwing in tool contexts and preserve user-facing error messages.
    &quot;&quot;&quot;
    try:
        regex = re.compile(pattern)
    except re.error as e:
        return f&quot;Invalid regex pattern: {e}&quot;

    try:
        normalized_path = _validate_path(path)
    except ValueError:
        return []

    filtered = {fp: fd for fp, fd in files.items() if fp.startswith(normalized_path)}

    if glob:
        filtered = {fp: fd for fp, fd in filtered.items() if wcglob.globmatch(Path(fp).name, glob, flags=wcglob.BRACE)}

    matches: list[GrepMatch] = []
    for file_path, file_data in filtered.items():
        for line_num, line in enumerate(file_data[&quot;content&quot;], 1):
            if regex.search(line):
                matches.append({&quot;path&quot;: file_path, &quot;line&quot;: int(line_num), &quot;text&quot;: line})
    return matches


def build_grep_results_dict(matches: list[GrepMatch]) -&gt; dict[str, list[tuple[int, str]]]:
    &quot;&quot;&quot;Group structured matches into the legacy dict form used by formatters.&quot;&quot;&quot;
    grouped: dict[str, list[tuple[int, str]]] = {}
    for m in matches:
        grouped.setdefault(m[&quot;path&quot;], []).append((m[&quot;line&quot;], m[&quot;text&quot;]))
    return grouped


def format_grep_matches(
    matches: list[GrepMatch],
    output_mode: Literal[&quot;files_with_matches&quot;, &quot;content&quot;, &quot;count&quot;],
) -&gt; str:
    &quot;&quot;&quot;Format structured grep matches using existing formatting logic.&quot;&quot;&quot;
    if not matches:
        return &quot;No matches found&quot;
    return _format_grep_results(build_grep_results_dict(matches), output_mode)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/utils/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/deepagents/backends/utils.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="welcome Imported skill welcome from langchain langchain /a0/tmp/skills_research/langchain/libs/deepagents-cli/deepagents_cli/widgets/welcome.py Unknown LICENSE sources/langchain/welcome/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">welcome</div>
                <button class="copy-btn" onclick="copyToClipboard('welcome')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">langchain</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill welcome from langchain</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">&quot;&quot;&quot;Welcome banner widget for deepagents-cli.&quot;&quot;&quot;

from __future__ import annotations

import os
from typing import Any

from textual.widgets import Static

from deepagents_cli.config import DEEP_AGENTS_ASCII, settings


class WelcomeBanner(Static):
    &quot;&quot;&quot;Welcome banner displayed at startup.&quot;&quot;&quot;

    DEFAULT_CSS = &quot;&quot;&quot;
    WelcomeBanner {
        height: auto;
        padding: 1;
        margin-bottom: 1;
    }
    &quot;&quot;&quot;

    def __init__(self, **kwargs: Any) -&gt; None:
        &quot;&quot;&quot;Initialize the welcome banner.&quot;&quot;&quot;
        # Use the same green color as the original UI (#10b981)
        banner_text = f&quot;[bold #10b981]{DEEP_AGENTS_ASCII}[/bold #10b981]\n&quot;

        # Show LangSmith status if tracing is enabled
        langsmith_key = os.environ.get(&quot;LANGSMITH_API_KEY&quot;) or os.environ.get(&quot;LANGCHAIN_API_KEY&quot;)
        langsmith_tracing = os.environ.get(&quot;LANGSMITH_TRACING&quot;) or os.environ.get(
            &quot;LANGCHAIN_TRACING_V2&quot;
        )

        if langsmith_key and langsmith_tracing:
            project = (
                settings.deepagents_langchain_project
                or os.environ.get(&quot;LANGSMITH_PROJECT&quot;)
                or &quot;default&quot;
            )
            banner_text += f&quot;[green][/green] LangSmith tracing: [cyan]&#x27;{project}&#x27;[/cyan]\n&quot;

        banner_text += &quot;[#10b981]Ready to code! What would you like to build?[/#10b981]\n&quot;
        banner_text += &quot;[dim]Enter send  Ctrl+J newline  @ files  / commands[/dim]&quot;
        super().__init__(banner_text, **kwargs)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/langchain/welcome/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/langchain-ai/deepagents" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/langchain-ai/deepagents/blob/main/LICENSE" class="source-link" target="_blank" rel="noopener">License: LICENSE</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="advanced_search Imported skill advanced_search from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/reference/advanced-search.md Unknown LICENSE.txt sources/openai/advanced_search/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">advanced_search</div>
                <button class="copy-btn" onclick="copyToClipboard('advanced_search')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill advanced_search from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Advanced Search Techniques

## Search Filtering

### By Date Range

Use `created_date_range` to find recent content:

```
filters: {
  created_date_range: {
    start_date: &quot;2024-01-01&quot;,
    end_date: &quot;2025-01-01&quot;
  }
}
```

**When to use**:
- Finding recent updates on a topic
- Focusing on current information
- Excluding outdated content

### By Creator

Use `created_by_user_ids` to find content from specific people:

```
filters: {
  created_by_user_ids: [&quot;user-id-1&quot;, &quot;user-id-2&quot;]
}
```

**When to use**:
- Research from subject matter experts
- Team-specific information
- Attribution tracking

### Combined Filters

Stack filters for precision:

```
filters: {
  created_date_range: {
    start_date: &quot;2024-10-01&quot;
  },
  created_by_user_ids: [&quot;expert-user-id&quot;]
}
```

## Scoped Searches

### Teamspace Scoping

Restrict search to specific teamspace:

```
teamspace_id: &quot;teamspace-uuid&quot;
```

**When to use**:
- Project-specific research
- Department-focused information
- Reducing noise from irrelevant results

### Page Scoping

Search within a specific page and its subpages:

```
page_url: &quot;https://notion.so/workspace/Page-Title-uuid&quot;
```

**When to use**:
- Research within a project hierarchy
- Documentation updates
- Focused investigation

### Database Scoping

Search within a database&#x27;s content:

```
data_source_url: &quot;collection://data-source-uuid&quot;
```

**When to use**:
- Task/project database research
- Structured data investigation
- Finding specific entries

## Search Strategies

### Broad to Narrow

1. Start with general search term
2. Review results for relevant teamspaces/pages
3. Re-search with scope filters
4. Fetch detailed content from top results

**Example**:
```
Search 1: query=&quot;API integration&quot;  50 results across workspace
Search 2: query=&quot;API integration&quot;, teamspace_id=&quot;engineering&quot;  12 results
Fetch: Top 3-5 most relevant pages
```

### Multi-Query Approach

Run parallel searches with related terms:

```
Query 1: &quot;API integration&quot;
Query 2: &quot;API authentication&quot;
Query 3: &quot;API documentation&quot;
```

Combine results to build comprehensive picture.

### Temporal Research

Search across time periods to track evolution:

```
Search 1: created_date_range 2023  Historical context
Search 2: created_date_range 2024  Recent developments
Search 3: created_date_range 2025  Current state
```

## Result Processing

### Identifying Relevant Results

Look for:
- **High semantic match**: Result summary closely matches query intent
- **Recent updates**: Last-edited date is recent
- **Authoritative sources**: Created by known experts or in official locations
- **Comprehensive content**: Result summary suggests detailed information

### Prioritizing Fetches

Fetch pages in order of relevance:

1. **Primary sources**: Direct documentation, official pages
2. **Recent updates**: Newly edited content
3. **Related context**: Supporting information
4. **Historical reference**: Background and context

Don&#x27;t fetch everything - be selective based on research needs.

### Handling Too Many Results

If search returns 20+ results:

1. **Add filters**: Narrow by date, creator, or teamspace
2. **Refine query**: Use more specific terms
3. **Use page scoping**: Search within relevant parent page
4. **Sample strategically**: Fetch diverse results (recent, popular, authoritative)

### Handling Too Few Results

If search returns &lt; 3 results:

1. **Broaden query**: Use more general terms
2. **Remove filters**: Search full workspace
3. **Try synonyms**: Alternative terminology
4. **Search in related areas**: Adjacent teamspaces or pages

## Search Quality

### Effective Search Queries

**Good queries** (specific, semantic):
- &quot;Q4 product roadmap&quot;
- &quot;authentication implementation guide&quot;
- &quot;customer feedback themes&quot;

**Weak queries** (too vague):
- &quot;roadmap&quot;
- &quot;guide&quot;
- &quot;feedback&quot;

**Over-specific queries** (too narrow):
- &quot;Q4 2024 product roadmap for mobile app version 3.2 feature X&quot;

### User Context

Always use available user context:
- Query should match their terminology
- Scope to their relevant teamspaces
- Consider their role/department
- Reference their recent pages

## Connected Sources

### Notion Integrations

Search extends beyond Notion pages to:
- Slack messages (if connected)
- Google Drive documents (if connected)
- GitHub issues/PRs (if connected)
- Jira tickets (if connected)

Be aware results may come from these sources.

### Source Attribution

When citing results from connected sources:
- Note the source type in documentation
- Use appropriate mention format
- Verify user has access to the source system</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/advanced_search/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/reference/advanced-search.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="api_feature Imported skill api_feature from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/examples/api-feature.md Unknown LICENSE.txt sources/openai/api_feature/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">api_feature</div>
                <button class="copy-btn" onclick="copyToClipboard('api_feature')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill api_feature from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: API Feature Implementation

## User Request

&gt; &quot;Create an implementation plan for the User Profile API spec&quot;

## Workflow Execution

### Step 1: Fetch Specification

```
Notion:notion-search
query: &quot;User Profile API spec&quot;
query_type: &quot;internal&quot;
```

Found: &quot;User Profile API Specification&quot; in Engineering Specs

```
Notion:notion-fetch
id: &quot;user-profile-api-spec-page-id&quot;
```

### Step 2: Parse Specification

**Spec Content Extracted:**

```markdown
# User Profile API Specification

## Overview
RESTful API for user profile management

## Requirements

### Functional
- FR-1: Get user profile by ID
- FR-2: Update user profile (name, bio, avatar)
- FR-3: Upload profile avatar
- FR-4: Get user&#x27;s public profile (limited fields)
- FR-5: Search users by name

### Non-Functional
- NFR-1: Response time &lt; 200ms (p95)
- NFR-2: Support 1000 concurrent users
- NFR-3: Avatar upload &lt; 5MB
- NFR-4: GDPR compliant (data portability)

## API Endpoints

GET /api/v1/users/:id
PUT /api/v1/users/:id
POST /api/v1/users/:id/avatar
GET /api/v1/users/:id/public
GET /api/v1/users/search

## Data Model
- id (UUID)
- email (string, unique)
- name (string)
- bio (text, max 500 chars)
- avatar_url (string)
- created_at (timestamp)
- updated_at (timestamp)

## Security
- Authentication: JWT bearer token
- Authorization: Users can only update own profile
- Rate limiting: 100 req/min per user

## Acceptance Criteria
- AC-1: All endpoints return proper HTTP status codes
- AC-2: Validation errors return 400 with error details
- AC-3: Unauthorized access returns 401
- AC-4: Rate limit exceeded returns 429
- AC-5: Avatar images stored in S3
```

### Step 3: Create Implementation Plan

```
Notion:notion-create-pages

parent: { page_id: &quot;engineering-plans-parent-id&quot; }

pages: [{
  properties: {
    &quot;title&quot;: &quot;Implementation Plan: User Profile API&quot;
  },
  content: &quot;[Implementation plan]&quot;
}]
```

**Implementation Plan Created:**

```markdown
# Implementation Plan: User Profile API

## Overview
Build RESTful API for user profile management with CRUD operations, avatar upload, and search functionality.

## Linked Specification
&lt;mention-page url=&quot;...&quot;&gt;User Profile API Specification&lt;/mention-page&gt;

## Requirements Summary

### Functional Requirements
-  Get user profile (authenticated)
-  Update profile fields (name, bio)
-  Upload avatar with image processing
-  Public profile view (limited fields)
-  User search by name

### Non-Functional Requirements
- **Performance**: &lt; 200ms response time (p95)
- **Scalability**: 1000 concurrent users
- **Storage**: Avatar files &lt; 5MB to S3
- **Compliance**: GDPR data portability

### Acceptance Criteria
- All endpoints with proper status codes
- Input validation with error details
- JWT authentication required
- Rate limiting enforced
- Avatars stored in S3

## Technical Approach

### Architecture
- **Framework**: Express.js (Node.js)
- **Database**: PostgreSQL
- **Storage**: AWS S3 for avatars
- **Cache**: Redis for profile data
- **Search**: PostgreSQL full-text search

### Key Design Decisions
1. **JWT Authentication**: Stateless auth, scales horizontally
2. **S3 for Avatars**: Offload storage, CDN integration ready
3. **Redis Caching**: Reduce DB load for frequently accessed profiles
4. **Rate Limiting**: Token bucket algorithm, per-user limits

## Implementation Phases

### Phase 1: Foundation (Days 1-2)
**Goal**: Set up core infrastructure

**Tasks**:
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Setup database schema&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Configure S3 bucket&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Setup Redis cache&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Create API scaffolding&lt;/mention-page&gt;

**Deliverables**: Working skeleton with DB, storage, cache ready  
**Estimated effort**: 2 days

### Phase 2: Core Endpoints (Days 3-5)
**Goal**: Implement main CRUD operations

**Tasks**:
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Implement GET user profile&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Implement PUT update profile&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Add input validation&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Add JWT authentication middleware&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Implement rate limiting&lt;/mention-page&gt;

**Deliverables**: Working CRUD operations with auth  
**Estimated effort**: 3 days

### Phase 3: Avatar Upload (Days 6-7)
**Goal**: Avatar management with S3

**Tasks**:
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Implement avatar upload endpoint&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Add image validation (size, format)&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Process and resize images&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Upload to S3 with signed URLs&lt;/mention-page&gt;

**Deliverables**: Avatar upload/update functionality  
**Estimated effort**: 2 days

### Phase 4: Search &amp; Public Profile (Days 8-9)
**Goal**: Complete remaining features

**Tasks**:
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Implement user search&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Implement public profile endpoint&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Add search indexing&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Optimize search queries&lt;/mention-page&gt;

**Deliverables**: Search and public profiles working  
**Estimated effort**: 2 days

### Phase 5: Testing &amp; Optimization (Days 10-12)
**Goal**: Production-ready quality

**Tasks**:
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Write unit tests&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Write integration tests&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Performance testing&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Security audit&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;API documentation&lt;/mention-page&gt;

**Deliverables**: Tested, documented, production-ready API  
**Estimated effort**: 3 days

## Dependencies

### External Dependencies
- AWS S3 bucket created 
- Redis instance available 
- PostgreSQL database provisioned 

### Internal Dependencies
- JWT authentication service (exists)
- User database table (exists)
- Logging infrastructure (exists)

### Blockers
None currently

## Risks &amp; Mitigation

### Risk 1: Image Processing Performance
- **Probability**: Medium
- **Impact**: Medium
- **Mitigation**: Use background job queue for processing, return signed upload URL immediately

### Risk 2: S3 Upload Failures
- **Probability**: Low
- **Impact**: Medium
- **Mitigation**: Implement retry logic with exponential backoff, fallback to local storage temporarily

### Risk 3: Rate Limiting Complexity
- **Probability**: Low
- **Impact**: Low
- **Mitigation**: Use proven library (express-rate-limit with Redis store)

### Risk 4: Search Performance
- **Probability**: Medium
- **Impact**: Medium
- **Mitigation**: Add database indexes, consider Elasticsearch if needed later

## Timeline

| Milestone | Target Date | Status |
|-----------|-------------|--------|
| Phase 1 Complete | Oct 16 |  Planned |
| Phase 2 Complete | Oct 19 |  Planned |
| Phase 3 Complete | Oct 21 |  Planned |
| Phase 4 Complete | Oct 23 |  Planned |
| Phase 5 Complete | Oct 26 |  Planned |
| **Production Deploy** | **Oct 28** |  Planned |

**Total Duration**: 12 working days (~2.5 weeks)

## Success Criteria

### Technical Success
- [ ] All 5 endpoints implemented and working
- [ ] Response time &lt; 200ms (p95) verified in load testing
- [ ] Handles 1000 concurrent users
- [ ] All acceptance criteria met
- [ ] Test coverage &gt; 80%
- [ ] Security scan passed
- [ ] API documentation complete

### Business Success
- [ ] User profile updates functional
- [ ] Avatar uploads working reliably
- [ ] Search returns relevant results in &lt; 500ms
- [ ] Zero critical bugs in first week

## Resources

### Documentation
- &lt;mention-page url=&quot;...&quot;&gt;User Profile API Specification&lt;/mention-page&gt; (original spec)
- &lt;mention-page url=&quot;...&quot;&gt;Authentication Service Docs&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;AWS S3 Setup Guide&lt;/mention-page&gt;

### Related Work
- &lt;mention-page url=&quot;...&quot;&gt;User Authentication API&lt;/mention-page&gt; (similar pattern)
- &lt;mention-page url=&quot;...&quot;&gt;File Upload Service&lt;/mention-page&gt; (avatar upload reference)

### External References
- Express.js best practices
- AWS S3 SDK documentation
- PostgreSQL full-text search guide

## Progress Tracking

### Phase Status
- Phase 1:  Not Started
- Phase 2:  Not Started
- Phase 3:  Not Started
- Phase 4:  Not Started
- Phase 5:  Not Started

**Overall Progress**: 0% complete

### Latest Update
*Implementation plan created on October 14, 2025*
```

### Step 4: Find Task Database

```
Notion:notion-search
query: &quot;Tasks database&quot;
query_type: &quot;internal&quot;
```

Found: &quot;Engineering Tasks&quot; database

### Step 5: Fetch Task Database Schema

```
Notion:notion-fetch
id: &quot;tasks-database-id&quot;
```

**Schema retrieved:**
- Data source: `collection://tasks-db-uuid`
- Properties: Name (title), Status (select), Priority (select), Related Tasks (relation), Story Points (number), Tags (multi_select)

### Step 6: Create Implementation Tasks

Now create tasks for Phase 1:

**Task 1: Setup database schema**

```
Notion:notion-create-pages

parent: { data_source_id: &quot;collection://tasks-db-uuid&quot; }

pages: [{
  properties: {
    &quot;Name&quot;: &quot;Setup database schema for User Profile API&quot;,
    &quot;Status&quot;: &quot;To Do&quot;,
    &quot;Priority&quot;: &quot;High&quot;,
    &quot;Related Tasks&quot;: [&quot;impl-plan-page-id&quot;, &quot;spec-page-id&quot;],
    &quot;Story Points&quot;: 3,
    &quot;Tags&quot;: &quot;backend, database, api&quot;
  },
  content: &quot;## Context\nImplementation task for &lt;mention-page url=\&quot;...\&quot;&gt;User Profile API Specification&lt;/mention-page&gt;\n\nPart of &lt;mention-page url=\&quot;...\&quot;&gt;Implementation Plan: User Profile API&lt;/mention-page&gt; - Phase 1\n\n## Objective\nCreate database schema for user profile storage\n\n## Requirements\nBased on spec data model:\n- id (UUID, primary key)\n- email (string, unique index)\n- name (string, not null)\n- bio (text, max 500 chars)\n- avatar_url (string, nullable)\n- created_at (timestamp)\n- updated_at (timestamp)\n\n## Acceptance Criteria\n- [ ] Migration file created\n- [ ] Schema includes all required fields\n- [ ] Indexes on email (unique) and name (search)\n- [ ] Constraints validated (bio length, email format)\n- [ ] Migration tested on dev database\n- [ ] Rollback migration created\n\n## Technical Approach\n```sql\nCREATE TABLE user_profiles (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  email VARCHAR(255) UNIQUE NOT NULL,\n  name VARCHAR(255) NOT NULL,\n  bio TEXT CHECK (length(bio) &lt;= 500),\n  avatar_url TEXT,\n  created_at TIMESTAMP DEFAULT NOW(),\n  updated_at TIMESTAMP DEFAULT NOW()\n);\n\nCREATE INDEX idx_user_profiles_email ON user_profiles(email);\nCREATE INDEX idx_user_profiles_name ON user_profiles USING gin(to_tsvector(&#x27;english&#x27;, name));\n```\n\n## Dependencies\n- Blocked By: None\n- Blocks: All Phase 2 tasks\n\n## Estimated Effort\n3 story points (half day)\n&quot;
}]
```

*[Create similar tasks for all phases - 20 tasks total]*

### Step 7: Link Plan Back to Spec

```
Notion:notion-update-page
page_id: &quot;user-profile-api-spec-page-id&quot;
command: &quot;insert_content_after&quot;
selection_with_ellipsis: &quot;## Acceptance Criteria...&quot;
new_str: &quot;

---

## Implementation

**Implementation Plan**: &lt;mention-page url=\&quot;...\&quot;&gt;Implementation Plan: User Profile API&lt;/mention-page&gt;

**Implementation Tasks**: See plan for full task breakdown (20 tasks across 5 phases)

**Status**: Planning complete, ready to start implementation
&quot;
```

## Summary Provided to User

```markdown
## Implementation Plan Created 

### Plan Overview
- **Feature**: User Profile API
- **Duration**: 12 days (~2.5 weeks)
- **Phases**: 5 (Foundation  Core  Avatar  Search  Testing)
- **Tasks**: 20 tasks created
- **Target Launch**: October 28, 2025

### Implementation Phases

**Phase 1: Foundation** (2 days)
- Database schema
- S3 and Redis setup
- API scaffolding

**Phase 2: Core Endpoints** (3 days)
- GET/PUT user profile
- Authentication &amp; validation
- Rate limiting

**Phase 3: Avatar Upload** (2 days)
- Image upload &amp; validation
- S3 integration
- Image processing

**Phase 4: Search &amp; Public Profile** (2 days)
- User search
- Public profile endpoint

**Phase 5: Testing &amp; Optimization** (3 days)
- Unit &amp; integration tests
- Performance testing
- Documentation

### Key Deliverables
- 5 REST API endpoints
- Avatar upload to S3
- User search functionality
- Comprehensive tests
- API documentation

### Links Created
 Plan page: &lt;mention-page url=&quot;...&quot;&gt;Implementation Plan: User Profile API&lt;/mention-page&gt;
 Spec updated with plan link
 20 tasks created in task database
 All tasks linked to plan and spec

### Next Steps
1. Review and approve plan
2. Assign tasks to team members
3. Begin Phase 1 (Foundation)
4. Daily standups for progress tracking

**Ready to start implementation! **
```

## Key Features Demonstrated

### Spec Parsing
- Extracted requirements (functional &amp; non-functional)
- Identified API endpoints
- Noted data model
- Captured acceptance criteria
- Understood security requirements

### Implementation Planning
- Broke into logical phases
- Sequenced work appropriately (foundation  features  testing)
- Identified dependencies
- Estimated effort per phase
- Created realistic timeline

### Task Creation
- Generated 20 specific tasks
- Each task has context, acceptance criteria, technical approach
- Tasks link to both spec and plan
- Proper dependencies noted

### Bidirectional Linking
- Plan links to spec
- Spec updated to link to plan
- Tasks link to both
- Easy navigation between all artifacts

Perfect for: Feature implementation, API development, technical projects</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/api_feature/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/examples/api-feature.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="basic_research Imported skill basic_research from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/evaluations/basic-research.json Unknown LICENSE.txt sources/openai/basic_research/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">basic_research</div>
                <button class="copy-btn" onclick="copyToClipboard('basic_research')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill basic_research from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;name&quot;: &quot;Basic Research and Documentation&quot;,
  &quot;skills&quot;: [&quot;research-documentation&quot;],
  &quot;query&quot;: &quot;Research our API authentication approach and create a summary document in Notion&quot;,
  &quot;expected_behavior&quot;: [
    &quot;Searches Notion workspace for authentication-related pages using Notion:notion-search&quot;,
    &quot;Uses appropriate search terms like &#x27;API authentication&#x27;, &#x27;auth&#x27;, &#x27;API security&#x27;&quot;,
    &quot;Applies filters if relevant (e.g., created_date_range, creator filters)&quot;,
    &quot;Fetches at least 2-3 relevant pages using Notion:notion-fetch to get detailed content&quot;,
    &quot;Analyzes the fetched content to extract key information about authentication approach&quot;,
    &quot;Creates a structured research summary document using Research Summary format (see reference/formats.md)&quot;,
    &quot;Includes sections: Executive Summary, Key Findings, Detailed Analysis, Recommendations, Sources&quot;,
    &quot;Cites source pages using &lt;mention-page&gt; tags for proper linking&quot;,
    &quot;Uses Notion:notion-create-pages to save the document to Notion&quot;,
    &quot;Applies Notion-flavored markdown with headings, bullets, and clear structure&quot;,
    &quot;Places document appropriately (asks user or uses project/research area)&quot;
  ],
  &quot;success_criteria&quot;: [
    &quot;Document contains synthesized information from multiple searched pages&quot;,
    &quot;At least 2-3 source pages are cited with mention-page tags&quot;,
    &quot;Document follows Research Summary format structure from reference/formats.md&quot;,
    &quot;Title is descriptive with topic and date (e.g., &#x27;API Authentication Research - Oct 2025&#x27;)&quot;,
    &quot;Content is concise but comprehensive with clear findings&quot;,
    &quot;Uses Notion markdown correctly (headings, lists, mentions)&quot;,
    &quot;Document is placed in appropriate location or user is consulted&quot;
  ]
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/basic_research/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/evaluations/basic-research.json" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="basic_spec_implementation Imported skill basic_spec_implementation from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/evaluations/basic-spec-implementation.json Unknown LICENSE.txt sources/openai/basic_spec_implementation/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">basic_spec_implementation</div>
                <button class="copy-btn" onclick="copyToClipboard('basic_spec_implementation')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill basic_spec_implementation from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;name&quot;: &quot;Create Implementation Plan from Spec&quot;,
  &quot;skills&quot;: [&quot;spec-to-implementation&quot;],
  &quot;query&quot;: &quot;Create an implementation plan for the User Authentication spec page&quot;,
  &quot;expected_behavior&quot;: [
    &quot;Step 1: Uses Notion:notion-search to find &#x27;User Authentication spec&#x27; with keywords like &#x27;User Authentication&#x27; or &#x27;auth spec&#x27;&quot;,
    &quot;Step 2: If not found or ambiguous, asks user for spec page URL/ID&quot;,
    &quot;Step 3: Fetches spec page using Notion:notion-fetch with URL/ID from search results&quot;,
    &quot;Step 4: Parses spec using patterns from reference/spec-parsing.md to extract requirements, acceptance criteria, constraints&quot;,
    &quot;Step 5: Identifies functional requirements (user stories, features, workflows) and non-functional requirements (performance, security)&quot;,
    &quot;Step 6: Creates implementation plan following structure from reference/templates.md&quot;,
    &quot;Step 7: Includes sections: Overview, Linked Spec, Requirements Summary, Technical Approach, Implementation Phases&quot;,
    &quot;Step 8: Breaks work into logical phases with Goal, Tasks checklist, Estimated effort per phase&quot;,
    &quot;Step 9: Identifies dependencies and risks from spec content&quot;,
    &quot;Step 10: Links plan back to original spec page using &lt;mention-page url=&#x27;...&#x27;&gt;&quot;,
    &quot;Step 11: Creates plan page using Notion:notion-create-pages with appropriate title (e.g., &#x27;Implementation Plan: User Authentication&#x27;)&quot;,
    &quot;Step 12: Places plan appropriately (asks user or suggests under project/spec parent)&quot;
  ],
  &quot;success_criteria&quot;: [
    &quot;Spec is found using Notion:notion-search before attempting to fetch (or user is asked for URL if not found)&quot;,
    &quot;Spec is fetched using Notion:notion-fetch with correct URL/ID from search results&quot;,
    &quot;Plan includes clear overview and spec link with mention-page tag&quot;,
    &quot;Requirements are extracted from actual spec content (not generic) using spec-parsing patterns&quot;,
    &quot;Work is broken into multiple phases (typically 3-5) following template structure&quot;,
    &quot;Each phase has Goal, Tasks (as checkboxes), and Estimated effort&quot;,
    &quot;Dependencies and risks sections are included with specific details from spec&quot;,
    &quot;Plan follows Implementation Plan structure from reference/templates.md&quot;,
    &quot;Success criteria or acceptance criteria from spec are referenced in plan&quot;,
    &quot;Uses correct tool names and sequence: Notion:notion-search  Notion:notion-fetch  Notion:notion-create-pages&quot;
  ]
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/basic_spec_implementation/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/evaluations/basic-spec-implementation.json" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="brainstorming_template Imported skill brainstorming_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/reference/brainstorming-template.md Unknown LICENSE.txt sources/openai/brainstorming_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">brainstorming_template</div>
                <button class="copy-btn" onclick="copyToClipboard('brainstorming_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill brainstorming_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Brainstorming Meeting Template

Use this template for creative ideation and brainstorming sessions.

```markdown
# [Topic] Brainstorming - [Date]

## Meeting Details
**Date**: [Date]
**Facilitator**: [Name]
**Note-taker**: [Name]
**Attendees**: [List]

## Objective

[Clear statement of what we&#x27;re brainstorming]

**Success looks like**: [How we&#x27;ll know brainstorming was successful]

## Background &amp; Context

[Context from research - 2-3 paragraphs]

**Related Pages**:
- &lt;mention-page url=&quot;...&quot;&gt;Context Page 1&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Context Page 2&lt;/mention-page&gt;

## Constraints

- [Constraint]
- [Constraint]
- [Constraint]

## Seed Ideas

[Starting ideas from research to spark discussion]:

1. **[Idea]**: [Brief description]
2. **[Idea]**: [Brief description]

## Ground Rules

- No criticism during ideation
- Build on others&#x27; ideas
- Quantity over quality initially
- Wild ideas welcome

## Brainstorming Notes

### Ideas Generated

[To be filled during meeting]

1. [Idea with brief description]
2. [Idea with brief description]

### Themes/Patterns

[Groupings that emerge]

## Evaluation

[If time permits, evaluate top ideas]

### Top Ideas

| Idea | Feasibility | Impact | Effort | Score |
|------|-------------|---------|--------|-------|
| [Idea] | [H/M/L] | [H/M/L] | [H/M/L] | [#] |

## Next Steps

- [ ] [Action to explore idea]
- [ ] [Action to prototype]
- [ ] [Action to research]

## Follow-up

**Next meeting**: [Date to reconvene]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/brainstorming_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/reference/brainstorming-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="citations Imported skill citations from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/reference/citations.md Unknown LICENSE.txt sources/openai/citations/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">citations</div>
                <button class="copy-btn" onclick="copyToClipboard('citations')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill citations from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Citation Styles

## Basic Page Citation

Always cite sources using Notion page mentions:

```markdown
&lt;mention-page url=&quot;https://notion.so/workspace/Page-Title-uuid&quot;&gt;Page Title&lt;/mention-page&gt;
```

The URL must be provided. The title is optional but improves readability:

```markdown
&lt;mention-page url=&quot;https://notion.so/workspace/Page-Title-uuid&quot;/&gt;
```

## Inline Citations

Cite immediately after referenced information:

```markdown
The Q4 revenue increased by 23% quarter-over-quarter (&lt;mention-page url=&quot;...&quot;&gt;Q4 Financial Report&lt;/mention-page&gt;).
```

## Multiple Sources

When information comes from multiple sources:

```markdown
Customer satisfaction has improved across all metrics (&lt;mention-page url=&quot;...&quot;&gt;Q3 Survey Results&lt;/mention-page&gt;, &lt;mention-page url=&quot;...&quot;&gt;Support Analysis&lt;/mention-page&gt;).
```

## Section-Level Citations

For longer sections derived from one source:

```markdown
### Engineering Priorities

According to the &lt;mention-page url=&quot;...&quot;&gt;Engineering Roadmap 2025&lt;/mention-page&gt;:

- Focus on API scalability
- Improve developer experience
- Migrate to microservices architecture
```

## Sources Section

Always include a &quot;Sources&quot; section at document end:

```markdown
## Sources

- &lt;mention-page url=&quot;...&quot;&gt;Strategic Plan 2025&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Market Analysis Report&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Competitor Research: Q3&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Customer Interview Notes&lt;/mention-page&gt;
```

Group by category for long lists:

```markdown
## Sources

### Primary Sources
- &lt;mention-page url=&quot;...&quot;&gt;Official Roadmap&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Strategy Document&lt;/mention-page&gt;

### Supporting Research
- &lt;mention-page url=&quot;...&quot;&gt;Market Trends&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Customer Feedback&lt;/mention-page&gt;

### Background Context
- &lt;mention-page url=&quot;...&quot;&gt;Historical Analysis&lt;/mention-page&gt;
```

## Quoting Content

When quoting directly from source:

```markdown
The product team noted: &quot;We need to prioritize mobile experience improvements&quot; (&lt;mention-page url=&quot;...&quot;&gt;Product Meeting Notes&lt;/mention-page&gt;).
```

For block quotes:

```markdown
&gt; We need to prioritize mobile experience improvements to meet our Q4 goals. This includes performance optimization and UI refresh.
&gt;
&gt;  &lt;mention-page url=&quot;...&quot;&gt;Product Meeting Notes - Oct 2025&lt;/mention-page&gt;
```

## Data Citations

When presenting data, cite the source:

```markdown
| Metric | Q3 | Q4 | Change |
|--------|----|----|--------|
| Revenue | $2.3M | $2.8M | +21.7% |
| Users | 12.4K | 15.1K | +21.8% |

Source: &lt;mention-page url=&quot;...&quot;&gt;Financial Dashboard&lt;/mention-page&gt;
```

## Database Citations

When referencing database content:

```markdown
Based on analysis of the &lt;mention-database url=&quot;...&quot;&gt;Projects Database&lt;/mention-database&gt;, 67% of projects are on track.
```

## User Citations

When attributing information to specific people:

```markdown
&lt;mention-user url=&quot;...&quot;&gt;Sarah Chen&lt;/mention-user&gt; noted in &lt;mention-page url=&quot;...&quot;&gt;Architecture Review&lt;/mention-page&gt; that the microservices migration is ahead of schedule.
```

## Citation Frequency

**Over-citing** (every sentence):
```markdown
The revenue increased (&lt;mention-page url=&quot;...&quot;&gt;Report&lt;/mention-page&gt;). 
Costs decreased (&lt;mention-page url=&quot;...&quot;&gt;Report&lt;/mention-page&gt;). 
Margin improved (&lt;mention-page url=&quot;...&quot;&gt;Report&lt;/mention-page&gt;).
```

**Under-citing** (no attribution):
```markdown
The revenue increased, costs decreased, and margin improved.
```

**Right balance** (grouped citation):
```markdown
The revenue increased, costs decreased, and margin improved (&lt;mention-page url=&quot;...&quot;&gt;Q4 Financial Report&lt;/mention-page&gt;).
```

## Outdated Information

Note when source information might be outdated:

```markdown
The original API design (&lt;mention-page url=&quot;...&quot;&gt;API Spec v1&lt;/mention-page&gt;, last updated January 2024) has been superseded by the new architecture in &lt;mention-page url=&quot;...&quot;&gt;API Spec v2&lt;/mention-page&gt;.
```

## Cross-References

Link to related research documents:

```markdown
## Related Research

This research builds on previous findings:
- &lt;mention-page url=&quot;...&quot;&gt;Market Analysis - Q2 2025&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Competitor Landscape Review&lt;/mention-page&gt;

For implementation details, see:
- &lt;mention-page url=&quot;...&quot;&gt;Technical Implementation Guide&lt;/mention-page&gt;
```

## Citation Validation

Before finalizing research:

 Every key claim has a source citation
 All page mentions have valid URLs
 Sources section includes all cited pages
 Outdated sources are noted as such
 Direct quotes are clearly marked
 Data sources are attributed

## Citation Style Consistency

Choose one citation style and use throughout:

**Inline style** (lightweight):
```markdown
Revenue grew 23% (Financial Report). Customer count increased 18% (Metrics Dashboard).
```

**Formal style** (full mentions):
```markdown
Revenue grew 23% (&lt;mention-page url=&quot;...&quot;&gt;Q4 Financial Report&lt;/mention-page&gt;). Customer count increased 18% (&lt;mention-page url=&quot;...&quot;&gt;Metrics Dashboard&lt;/mention-page&gt;).
```

**Recommend formal style** for most research documentation as it provides clickable navigation.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/citations/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/reference/citations.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="cla Imported skill cla from openai openai /a0/tmp/skills_research/openai/CLA.md Unknown LICENSE.txt sources/openai/cla/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">cla</div>
                <button class="copy-btn" onclick="copyToClipboard('cla')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill cla from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Individual Contributor License Agreement (v1.0, OpenAI)

_Based on the Apache Software Foundation Individual CLAv2.2._

By commenting **I have read the CLA Document and I hereby sign the CLA**
on a Pull Request, **you (Contributor) agree to the following terms** for any
past and future Contributions submitted to the **OpenAICodexCLI project
(the Project)**.

---

## 1.Definitions

- **Contribution**  any original work of authorship submitted to the Project
  (code, documentation, designs, etc.).
- **You / Your**  the individual (or legal entity) posting the acceptance
  comment.

## 2.CopyrightLicense

You grant **OpenAI,Inc.** and all recipients of software distributed by the
Project a perpetual, worldwide, nonexclusive, royaltyfree, irrevocable
license to reproduce, prepare derivative works of, publicly display, publicly
perform, sublicense, and distribute Your Contributions and derivative works.

## 3.PatentLicense

You grant **OpenAI,Inc.** and all recipients of the Project a perpetual,
worldwide, nonexclusive, royaltyfree, irrevocable (except as below) patent
license to make, have made, use, sell, offer to sell, import, and otherwise
transfer Your Contributions alone or in combination with the Project.

If any entity brings patent litigation alleging that the Project or a
Contribution infringes a patent, the patent licenses granted by You to that
entity under this CLA terminate.

## 4.Representations

1. You are legally entitled to grant the licenses above.
2. Each Contribution is either Your original creation or You have authority to
   submit it under this CLA.
3. Your Contributions are provided **ASIS** without warranties of any kind.
4. You will notify the Project if any statement above becomes inaccurate.

## 5.Miscellany

This Agreement is governed by the laws of the **State of California**, USA,
excluding its conflictoflaws rules. If any provision is held unenforceable,
the remaining provisions remain in force.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/cla/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/openai/skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <span class="badge muted">License: LICENSE.txt</span>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="comparison_format Imported skill comparison_format from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/reference/comparison-format.md Unknown LICENSE.txt sources/openai/comparison_format/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">comparison_format</div>
                <button class="copy-btn" onclick="copyToClipboard('comparison_format')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill comparison_format from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Comparison Format

**When to use**:
- Evaluating multiple options
- Tool/vendor selection
- Approach comparison
- Decision support

## Characteristics

**Length**: 800-1200 words typically

**Structure**:
- Overview of what&#x27;s being compared
- Comparison matrix table
- Detailed analysis per option (pros/cons)
- Clear recommendation with rationale
- Sources

## Template

See [comparison-template.md](comparison-template.md) for the full template.

## Best For

- Decision support with multiple options
- Tool or vendor selection
- Comparing different technical approaches
- Evaluating trade-offs between alternatives

## Example Use Cases

- &quot;Compare the three database options discussed in our tech docs&quot;
- &quot;What are the pros and cons of each deployment approach?&quot;
- &quot;Compare the vendor proposals&quot;
- &quot;Evaluate the different authentication methods we&#x27;ve documented&quot;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/comparison_format/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/reference/comparison-format.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="comparison_template Imported skill comparison_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/reference/comparison-template.md Unknown LICENSE.txt sources/openai/comparison_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">comparison_template</div>
                <button class="copy-btn" onclick="copyToClipboard('comparison_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill comparison_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Comparison Template

Use when researching multiple options or alternatives. See [comparison-format.md](comparison-format.md) for when to use this format.

```markdown
# [Topic] Comparison

## Overview
[Brief introduction to what&#x27;s being compared and why]

## Comparison Matrix

| Criteria | Option A | Option B | Option C |
|----------|----------|----------|----------|
| [Criterion 1] | [Rating/Details] | [Rating/Details] | [Rating/Details] |
| [Criterion 2] | [Rating/Details] | [Rating/Details] | [Rating/Details] |

## Detailed Analysis

### Option A
**Pros**:
- [Advantage]
- [Advantage]

**Cons**:
- [Disadvantage]
- [Disadvantage]

**Best for**: [Use case]

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Source Page&lt;/mention-page&gt;

[Repeat for each option]

## Recommendation

**Selected option**: [Choice]

**Rationale**: [Why this option is best given the context]

## Sources
[List all consulted pages]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/comparison_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/reference/comparison-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="competitor_analysis Imported skill competitor_analysis from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/examples/competitor-analysis.md Unknown LICENSE.txt sources/openai/competitor_analysis/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">competitor_analysis</div>
                <button class="copy-btn" onclick="copyToClipboard('competitor_analysis')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill competitor_analysis from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: Competitor Analysis

## User Request

&gt; &quot;Research competitor pricing models and create a comparison document&quot;

## Workflow Execution

### Step 1: Search for Competitor Information

```
Notion:notion-search
query: &quot;competitor pricing&quot;
query_type: &quot;internal&quot;
filters: {
  created_date_range: {
    start_date: &quot;2024-01-01&quot;
  }
}
```

**Results Found:**
- &quot;Competitor Analysis - Stripe&quot; (Product)
- &quot;Market Research Q3 2024&quot; (Strategy)
- &quot;Pricing Strategy Discussion&quot; (Product)
- &quot;Competitor Feature Matrix&quot; (Product)

### Step 2: Fetch and Analyze

```
Notion:notion-fetch for each page
```

**Extracted Information:**

**Stripe**:
- Pay-as-you-go: 2.9% + $0.30 per transaction
- No monthly fees
- Volume discounts available

**Square**:
- Pay-as-you-go: 2.6% + $0.10 per transaction
- Monthly plan: $29/month with lower rates
- Hardware costs separate

**PayPal**:
- Standard: 3.49% + $0.49 per transaction
- Advanced: $30/month + 2.59% + $0.49
- Multi-currency fees

**Adyen**:
- Interchange++ pricing model
- Custom enterprise pricing
- Setup and monthly fees apply

### Step 3: Create Comparison Document

```
Notion:notion-create-pages

pages: [{
  properties: {
    &quot;title&quot;: &quot;Competitor Pricing Analysis - Payment Processors&quot;
  },
  content: &quot;[Comparison document using template]&quot;
}]
```

## Output Document

```markdown
# Competitor Pricing Analysis - Payment Processors

**Date**: October 14, 2025  
**Research Team**: Product Strategy

## Executive Summary

We analyzed four major payment processor competitors: Stripe, Square, PayPal, and Adyen. Pricing models vary from simple pay-as-you-go (Stripe) to complex interchange-plus (Adyen). Key insight: All competitors offer volume discounts for high-transaction merchants, with breakpoints typically at $100K/month processing volume.

## Comparison Matrix

| Feature | Stripe | Square | PayPal | Adyen |
|---------|--------|--------|--------|-------|
| **Base Rate** | 2.9% + $0.30 | 2.6% + $0.10 | 3.49% + $0.49 | Interchange++ |
| **Monthly Fee** | $0 | $0-29 | $0-30 | Custom |
| **Volume Discounts** | Yes, &gt;$80K | Yes, &gt;$250K | Yes, &gt;$100K | Yes, custom |
| **Setup Fee** | $0 | $0 | $0 | $1,000-5,000 |
| **Multi-currency** | 1% extra | 3% extra | 3-4% extra | Included |
| **Chargeback Fee** | $15 | $15-25 | $20 | Custom |
| **Target Market** | Startups-Enterprise | Small-Medium | Small-Medium | Enterprise |

## Detailed Analysis

### Stripe

**Pricing Structure**:
- **Standard**: 2.9% + $0.30 per successful card charge
- **Volume discounts**: Available for businesses processing &gt;$80,000/month
- **International cards**: +1% fee
- **Currency conversion**: 1% above market rate

**Strengths**:
- Simple, transparent pricing
- No setup fees or monthly minimums
- Excellent developer experience
- Quick onboarding

**Weaknesses**:
- Higher per-transaction fee for high volume
- Volume discounts less aggressive than Adyen

**Best for**: Startups and growth-stage companies needing quick integration

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Competitor Analysis - Stripe&lt;/mention-page&gt;

### Square

**Pricing Structure**:
- **Pay-as-you-go**: 2.6% + $0.10 per tap, dip, or swipe
- **Keyed-in**: 3.5% + $0.15
- **Plus plan**: $29/month for lower rates (2.5% + $0.10)
- **Premium plan**: Custom pricing

**Strengths**:
- Lowest per-transaction fee for in-person
- All-in-one hardware + software
- No long-term contracts

**Weaknesses**:
- Higher rates for online/keyed transactions
- Hardware costs ($49-$299)
- Less suitable for online-only businesses

**Best for**: Brick-and-mortar retail and restaurants

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Market Research Q3 2024&lt;/mention-page&gt;

### PayPal

**Pricing Structure**:
- **Standard**: 3.49% + $0.49 per transaction
- **Advanced**: $30/month + 2.59% + $0.49
- **Payments Pro**: Additional $30/month for direct credit card processing

**Strengths**:
- Huge customer base (PayPal checkout)
- Buyer protection increases trust
- International reach (200+ countries)

**Weaknesses**:
- Highest per-transaction fees
- Complex fee structure
- Account holds and reserves common

**Best for**: Businesses where PayPal brand trust matters (e-commerce, marketplaces)

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Pricing Strategy Discussion&lt;/mention-page&gt;

### Adyen

**Pricing Structure**:
- **Interchange++**: Actual interchange + scheme fees + fixed markup
- **Setup fee**: $1,000-5,000 (negotiable)
- **Monthly minimum**: Typically $10,000+ processing volume
- **Per-transaction**: Interchange + 0.6% + $0.12 (example)

**Strengths**:
- Most transparent cost structure at scale
- Lowest effective rate for high volume
- True multi-currency (100+ currencies)
- Direct connections to schemes

**Weaknesses**:
- Complex pricing requires analysis
- High minimums ($10K+/month)
- Longer integration time
- Not suitable for small businesses

**Best for**: Enterprise with $1M+/month processing volume

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Competitor Feature Matrix&lt;/mention-page&gt;

## Pricing Trends &amp; Insights

### Volume-Based Discounting
All competitors offer discounts at scale:
- **Entry point**: $80K-$250K/month processing
- **Typical discount**: 10-30 basis points reduction
- **Negotiation leverage**: Begins at $500K/month+

### Hidden Costs to Consider

| Cost Type | Stripe | Square | PayPal | Adyen |
|-----------|--------|--------|--------|-------|
| Chargeback | $15 | $15-25 | $20 | $15-25 |
| Account verification | $0 | $0 | $0 | Varies |
| PCI compliance | $0 | $0 | $0 | $0 |
| Currency conversion | 1% | 3% | 3-4% | 0% |
| Refund fees | Returned | Returned | Not returned | Varies |

### Market Positioning

```
High Volume / Enterprise
    
    |                    Adyen
    |                      
    |         Stripe             
    |    
    |  Square    PayPal
    |
    
      Small / Simple        Complex / International
```

## Strategic Implications

### For Startups (&lt;$100K/month)
**Recommended**: Stripe
- Lowest friction to start
- No upfront costs
- Great documentation
- Acceptable rates at this scale

### For Growing Companies ($100K-$1M/month)
**Recommended**: Stripe or Square
- Negotiate volume discounts
- Evaluate interchange++ if international
- Consider Square if in-person dominant

### For Enterprises (&gt;$1M/month)
**Recommended**: Adyen or Negotiated Stripe
- Interchange++ models save significantly
- Direct scheme connections
- Multi-region capabilities matter
- ROI on integration complexity

## Recommendations

1. **Immediate**: Benchmark our current 2.8% + $0.25 against Stripe&#x27;s standard
2. **Short-term**: Request volume discount quote from Stripe at our current $150K/month
3. **Long-term**: Evaluate Adyen when we cross $1M/month threshold

## Next Steps

- [ ] Request detailed pricing proposal from Stripe for volume discounts
- [ ] Create pricing calculator comparing all 4 at different volume levels
- [ ] Interview customers about payment method preferences
- [ ] Analyze our transaction mix (domestic vs international, card types)

## Sources

### Primary Research
- &lt;mention-page url=&quot;...&quot;&gt;Competitor Analysis - Stripe&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Market Research Q3 2024&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Pricing Strategy Discussion&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Competitor Feature Matrix&lt;/mention-page&gt;

### External References
- Stripe.com pricing page (Oct 2025)
- Square pricing documentation
- PayPal merchant fees
- Adyen pricing transparency report
```

## Key Success Factors

1. **Structured comparison**: Matrix format for quick scanning
2. **Multiple dimensions**: Price, features, target market
3. **Strategic recommendations**: Not just data, but implications
4. **Visual elements**: Table and positioning diagram
5. **Actionable next steps**: Clear recommendations
6. **Comprehensive sources**: Internal research + external validation

## Workflow Pattern Demonstrated

- **Date-filtered search** (recent information only)
- **Multiple competitor synthesis** (4 different companies)
- **Comparison template** (matrix + detailed analysis)
- **Strategic layer** (implications and recommendations)
- **Action-oriented** (next steps included)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/competitor_analysis/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/examples/competitor-analysis.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="comprehensive_report_format Imported skill comprehensive_report_format from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/reference/comprehensive-report-format.md Unknown LICENSE.txt sources/openai/comprehensive_report_format/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">comprehensive_report_format</div>
                <button class="copy-btn" onclick="copyToClipboard('comprehensive_report_format')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill comprehensive_report_format from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Comprehensive Report Format

**When to use**: 
- Formal documentation requirements
- Strategic decision support
- Complex topics requiring extensive analysis
- Multiple stakeholders need alignment

## Characteristics

**Length**: 1500+ words

**Structure**:
- Executive summary
- Background &amp; context
- Methodology
- Detailed findings with subsections
- Data &amp; evidence section
- Implications (short and long-term)
- Prioritized recommendations
- Appendix

## Template

See [comprehensive-report-template.md](comprehensive-report-template.md) for the full template.

## Best For

- Deep analysis and strategic decisions
- Formal documentation requirements
- Complex topics with multiple facets
- When stakeholders need extensive context
- Board presentations or executive briefings

## Example Use Cases

- &quot;Create a comprehensive analysis of our market position&quot;
- &quot;Document the full technical investigation of the database migration&quot;
- &quot;Prepare an in-depth report on vendor options for executive review&quot;
- &quot;Analyze the pros and cons of different architectural approaches&quot;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/comprehensive_report_format/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/reference/comprehensive-report-format.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="comprehensive_report_template Imported skill comprehensive_report_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/reference/comprehensive-report-template.md Unknown LICENSE.txt sources/openai/comprehensive_report_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">comprehensive_report_template</div>
                <button class="copy-btn" onclick="copyToClipboard('comprehensive_report_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill comprehensive_report_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Comprehensive Report Template

Use for in-depth research requiring extensive analysis. See [comprehensive-report-format.md](comprehensive-report-format.md) for when to use this format.

```markdown
# [Report Title]

## Executive Summary
[One paragraph summarizing the entire report]

## Background &amp; Context
[Why this research was conducted, what questions it addresses]

## Methodology
- Sources consulted: [number] Notion pages across [teamspaces]
- Time period: [if relevant]
- Scope: [what was included/excluded]

## Key Findings

### [Major Theme 1]
**Summary**: [One sentence]

**Details**:
- [Supporting point with evidence]
- [Supporting point with evidence]
- [Supporting point with evidence]

**Sources**: [Page mentions]

### [Major Theme 2]
[Repeat structure]

## Data &amp; Evidence

[Tables, quotes, specific data points]

## Implications

### Short-term
[Immediate implications]

### Long-term
[Strategic implications]

## Recommendations

### Priority 1: [High priority action]
- **What**: [Specific action]
- **Why**: [Rationale]
- **How**: [Implementation approach]

### Priority 2: [Medium priority action]
[Repeat structure]

## Appendix

### Additional Resources
- [Related pages]

### Open Questions
- [Unanswered questions for future research]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/comprehensive_report_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/reference/comprehensive-report-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="contributing Imported skill contributing from openai openai /a0/tmp/skills_research/openai/contributing.md Unknown LICENSE.txt sources/openai/contributing/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">contributing</div>
                <button class="copy-btn" onclick="copyToClipboard('contributing')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill contributing from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">## Contributing

### Community values

- **Be kind and inclusive.** Treat others with respect; we follow the [Contributor Covenant](https://www.contributor-covenant.org/).
- **Assume good intent.** Written communication is hard - err on the side of generosity.
- **Teach &amp; learn.** If you spot something confusing, open an issue or PR with improvements.

### Contributor license agreement (CLA)

All contributors **must** accept the CLA. The process is lightweight:

1. Open your pull request.
2. Paste the following comment (or reply `recheck` if you&#x27;ve signed before):

   ```text
   I have read the CLA Document and I hereby sign the CLA
   ```

3. The CLA-Assistant bot records your signature in the repo and marks the status check as passed.

No special Git commands, email attachments, or commit footers required.

### Security &amp; responsible AI

Have you discovered a vulnerability or have concerns about model output? Please e-mail **security@openai.com** and we will respond promptly.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/contributing/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/openai/skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <span class="badge muted">License: LICENSE.txt</span>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="conversation_to_faq Imported skill conversation_to_faq from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/examples/conversation-to-faq.md Unknown LICENSE.txt sources/openai/conversation_to_faq/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">conversation_to_faq</div>
                <button class="copy-btn" onclick="copyToClipboard('conversation_to_faq')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill conversation_to_faq from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: Conversation to FAQ

## User Request

&gt; &quot;Save this conversation about deployment troubleshooting to the FAQ&quot;

**Context**: User just had a conversation explaining how to troubleshoot common deployment errors.

## Conversation Summary

The conversation covered:
1. **Question**: &quot;Why does deployment fail with &#x27;port already in use&#x27; error?&quot;
2. **Answer**: Process from previous deployment still running, need to kill it
3. **Question**: &quot;How do I find and kill the process?&quot;
4. **Commands shared**: `lsof -ti:3000 | xargs kill -9` or use `pm2 restart app`
5. **Question**: &quot;What about &#x27;cannot connect to database&#x27; errors?&quot;
6. **Answer**: Check database credentials, verify database is running, check network connectivity
7. **Best practice**: Always check logs first (`pm2 logs` or `docker logs`)

## Workflow Execution

### Step 1: Identify Content Type

This is Q&amp;A content  **FAQ Entry** format is appropriate

### Step 2: Structure FAQ Entries

Extract distinct Q&amp;A pairs from conversation:

**FAQ 1**: Port already in use error
**FAQ 2**: Cannot connect to database error
**FAQ 3**: General troubleshooting approach

### Step 3: Determine Destination

```
Notion:notion-search
query: &quot;FAQ deployment&quot;
query_type: &quot;internal&quot;
```

Found: &quot;Deployment FAQ&quot; database in Engineering Docs

```
Notion:notion-fetch
id: &quot;deployment-faq-database-id&quot;
```

**Schema**:
- Question (title)
- Category (select): Deployment, Configuration, Troubleshooting, etc.
- Tags (multi_select)
- Last Reviewed (date)

### Step 4: Create FAQ Entries

**FAQ Entry 1: Port Already in Use**

```
Notion:notion-create-pages

parent: { data_source_id: &quot;collection://faq-db-uuid&quot; }

pages: [{
  properties: {
    &quot;Question&quot;: &quot;Why does deployment fail with &#x27;port already in use&#x27; error?&quot;,
    &quot;Category&quot;: &quot;Troubleshooting&quot;,
    &quot;Tags&quot;: &quot;deployment, errors, ports&quot;,
    &quot;date:Last Reviewed:start&quot;: &quot;2025-10-14&quot;,
    &quot;date:Last Reviewed:is_datetime&quot;: 0
  },
  content: &quot;## Short Answer\n\nThe deployment port (usually 3000) is still occupied by a process from a previous deployment. You need to kill the existing process before deploying again.\n\n## Detailed Explanation\n\nWhen you deploy the application, it tries to bind to a specific port (e.g., port 3000). If a previous deployment didn&#x27;t shut down cleanly, that process may still be running and holding the port. This prevents the new deployment from starting.\n\n**Common causes**:\n- Previous deployment crashed without cleanup\n- Manual `node` process started and forgotten\n- PM2 or other process manager didn&#x27;t restart properly\n- Multiple deployments attempted simultaneously\n\n## Solution\n\n### Option 1: Kill the process using the port\n\n```bash\n# Find and kill process on port 3000\nlsof -ti:3000 | xargs kill -9\n```\n\nReplace `3000` with your application&#x27;s port number.\n\n### Option 2: If using PM2\n\n```bash\n# Restart the application\npm2 restart app\n\n# Or delete and restart\npm2 delete app\npm2 start app.js --name app\n```\n\n### Option 3: Check all node processes\n\n```bash\n# List all node processes\nps aux | grep node\n\n# Kill specific process by PID\nkill -9 &lt;PID&gt;\n```\n\n## Prevention\n\n1. **Use process managers**: PM2, systemd, or Docker handle cleanup automatically\n2. **Graceful shutdown**: Implement proper shutdown handlers in your app\n3. **Health checks**: Monitor if previous deployment shut down before starting new one\n\n```javascript\n// Graceful shutdown example\nprocess.on(&#x27;SIGTERM&#x27;, () =&gt; {\n  server.close(() =&gt; {\n    console.log(&#x27;Server closed&#x27;);\n    process.exit(0);\n  });\n});\n```\n\n## Verification\n\nAfter killing the process, verify the port is free:\n\n```bash\nlsof -ti:3000\n# Should return nothing if port is free\n```\n\n## Related Questions\n- &lt;mention-page url=\&quot;...\&quot;&gt;How do I check what&#x27;s using a port?&lt;/mention-page&gt;\n- &lt;mention-page url=\&quot;...\&quot;&gt;How do I configure the application port?&lt;/mention-page&gt;\n- &lt;mention-page url=\&quot;...\&quot;&gt;PM2 deployment best practices&lt;/mention-page&gt;\n\n## Last Updated\nOctober 14, 2025&quot;
}]
```

**FAQ Entry 2: Database Connection Errors**

```
Notion:notion-create-pages

parent: { data_source_id: &quot;collection://faq-db-uuid&quot; }

pages: [{
  properties: {
    &quot;Question&quot;: &quot;Why do I get &#x27;cannot connect to database&#x27; errors during deployment?&quot;,
    &quot;Category&quot;: &quot;Troubleshooting&quot;,
    &quot;Tags&quot;: &quot;deployment, database, errors&quot;,
    &quot;date:Last Reviewed:start&quot;: &quot;2025-10-14&quot;,
    &quot;date:Last Reviewed:is_datetime&quot;: 0
  },
  content: &quot;## Short Answer\n\nDatabase connection errors usually mean either the database isn&#x27;t running, credentials are incorrect, or there&#x27;s a network connectivity issue. Check database status, verify credentials, and test connectivity.\n\n## Detailed Explanation\n\nThe application can&#x27;t establish a connection to the database during startup. This prevents the application from initializing properly.\n\n**Common causes**:\n- Database service isn&#x27;t running\n- Incorrect connection credentials\n- Network connectivity issues (firewall, security groups)\n- Database host/port misconfigured\n- Database is at connection limit\n- SSL/TLS configuration mismatch\n\n## Troubleshooting Steps\n\n### Step 1: Check database status\n\n```bash\n# For local PostgreSQL\npg_isready -h localhost -p 5432\n\n# For Docker\ndocker ps | grep postgres\n\n# For MongoDB\nmongosh --eval \&quot;db.adminCommand(&#x27;ping&#x27;)\&quot;\n```\n\n### Step 2: Verify credentials\n\nCheck your `.env` or configuration file:\n\n```bash\n# Common environment variables\nDB_HOST=localhost\nDB_PORT=5432\nDB_NAME=myapp_production\nDB_USER=myapp_user\nDB_PASSWORD=***********\n```\n\nTest connection manually:\n\n```bash\n# PostgreSQL\npsql -h $DB_HOST -p $DB_PORT -U $DB_USER -d $DB_NAME\n\n# MongoDB\nmongosh \&quot;mongodb://$DB_USER:$DB_PASSWORD@$DB_HOST:$DB_PORT/$DB_NAME\&quot;\n```\n\n### Step 3: Check network connectivity\n\n```bash\n# Test if port is reachable\ntelnet $DB_HOST $DB_PORT\n\n# Or using nc\nnc -zv $DB_HOST $DB_PORT\n\n# Check firewall rules (if applicable)\nsudo iptables -L\n```\n\n### Step 4: Check application logs\n\n```bash\n# PM2 logs\npm2 logs app\n\n# Docker logs\ndocker logs container-name\n\n# Application logs\ntail -f /var/log/app/error.log\n```\n\nLook for specific error messages:\n- `ECONNREFUSED`: Database not running or wrong host/port\n- `Authentication failed`: Wrong credentials\n- `Timeout`: Network/firewall issue\n- `Too many connections`: Database connection limit reached\n\n## Solutions by Error Type\n\n### Database Not Running\n\n```bash\n# Start PostgreSQL\nsudo systemctl start postgresql\n\n# Start via Docker\ndocker start postgres-container\n```\n\n### Wrong Credentials\n\n1. Reset database password\n2. Update `.env` file\n3. Restart application\n\n### Connection Limit Reached\n\n```sql\n-- Check current connections (PostgreSQL)\nSELECT count(*) FROM pg_stat_activity;\n\n-- Increase max connections\nALTER SYSTEM SET max_connections = 200;\n```\n\n### SSL/TLS Issues\n\nAdd to connection string:\n```\nssl=true&amp;sslmode=require\n```\n\nOr disable SSL for dev:\n```\nsslmode=disable\n```\n\n## Prevention\n\n1. **Connection pooling**: Limits concurrent connections\n```javascript\npool: {\n  min: 2,\n  max: 10\n}\n```\n\n2. **Health checks**: Verify database before starting app\n```javascript\nconst healthCheck = async () =&gt; {\n  try {\n    await db.raw(&#x27;SELECT 1&#x27;);\n    console.log(&#x27;Database connected&#x27;);\n  } catch (err) {\n    console.error(&#x27;Database connection failed:&#x27;, err);\n    process.exit(1);\n  }\n};\n```\n\n3. **Retry logic**: Auto-reconnect on temporary failures\n```javascript\nretry: {\n  max: 3,\n  backoff: 1000\n}\n```\n\n4. **Environment validation**: Check all required env vars exist\n```javascript\nconst required = [&#x27;DB_HOST&#x27;, &#x27;DB_PORT&#x27;, &#x27;DB_NAME&#x27;, &#x27;DB_USER&#x27;, &#x27;DB_PASSWORD&#x27;];\nfor (const key of required) {\n  if (!process.env[key]) {\n    throw new Error(`Missing required env var: ${key}`);\n  }\n}\n```\n\n## Related Questions\n- &lt;mention-page url=\&quot;...\&quot;&gt;How do I configure database connection pooling?&lt;/mention-page&gt;\n- &lt;mention-page url=\&quot;...\&quot;&gt;Database backup and restore procedures&lt;/mention-page&gt;\n- &lt;mention-page url=\&quot;...\&quot;&gt;Database performance optimization&lt;/mention-page&gt;\n\n## Last Updated\nOctober 14, 2025&quot;
}]
```

**FAQ Entry 3: General Troubleshooting**

```
Notion:notion-create-pages

parent: { data_source_id: &quot;collection://faq-db-uuid&quot; }

pages: [{
  properties: {
    &quot;Question&quot;: &quot;What&#x27;s the first thing I should check when deployment fails?&quot;,
    &quot;Category&quot;: &quot;Troubleshooting&quot;,
    &quot;Tags&quot;: &quot;deployment, debugging, best-practices&quot;,
    &quot;date:Last Reviewed:start&quot;: &quot;2025-10-14&quot;,
    &quot;date:Last Reviewed:is_datetime&quot;: 0
  },
  content: &quot;## Short Answer\n\n**Always check the logs first.** Logs contain error messages that point you directly to the problem. Use `pm2 logs`, `docker logs`, or check your application&#x27;s log files.\n\n## Detailed Explanation\n\nLogs are your first and most important debugging tool. They show:\n- Exact error messages\n- Stack traces\n- Timing information\n- Configuration issues\n- Dependency problems\n\nMost deployment issues can be diagnosed and fixed by reading the logs carefully.\n\n## How to Check Logs\n\n### PM2\n\n```bash\n# View all logs\npm2 logs\n\n# View logs for specific app\npm2 logs app-name\n\n# View only errors\npm2 logs --err\n\n# Follow logs in real-time\npm2 logs --lines 100\n```\n\n### Docker\n\n```bash\n# View logs\ndocker logs container-name\n\n# Follow logs\ndocker logs -f container-name\n\n# Last 100 lines\ndocker logs --tail 100 container-name\n\n# With timestamps\ndocker logs -t container-name\n```\n\n### Application Logs\n\n```bash\n# Tail application logs\ntail -f /var/log/app/app.log\ntail -f /var/log/app/error.log\n\n# Search logs for errors\ngrep -i error /var/log/app/*.log\n\n# View logs with context\ngrep -B 5 -A 5 \&quot;ERROR\&quot; app.log\n```\n\n## Systematic Troubleshooting Approach\n\n### 1. Check the logs\n- Read error messages carefully\n- Note the exact error type and message\n- Check timestamps to find when error occurred\n\n### 2. Verify configuration\n- Environment variables set correctly?\n- Configuration files present and valid?\n- Paths and file permissions correct?\n\n### 3. Check dependencies\n- All packages installed? (`node_modules` present?)\n- Correct versions installed?\n- Any native module compilation errors?\n\n### 4. Verify environment\n- Required services running (database, Redis, etc.)?\n- Ports available?\n- Network connectivity working?\n\n### 5. Test components individually\n- Can you connect to database manually?\n- Can you run application locally?\n- Do health check endpoints work?\n\n### 6. Check recent changes\n- What changed since last successful deployment?\n- New dependencies added?\n- Configuration modified?\n- Environment differences?\n\n## Common Error Patterns\n\n### \&quot;Module not found\&quot;\n```bash\n# Solution: Install dependencies\nnpm install\n# or\nnpm ci\n```\n\n### \&quot;Permission denied\&quot;\n```bash\n# Solution: Fix file permissions\nchmod +x start.sh\nsudo chown -R appuser:appuser /app\n```\n\n### \&quot;Address already in use\&quot;\n```bash\n# Solution: Kill process on port\nlsof -ti:3000 | xargs kill -9\n```\n\n### \&quot;Cannot connect to...\&quot;\n```bash\n# Solution: Verify service is running and reachable\ntelnet service-host port\n```\n\n## Debugging Tools\n\n### Log Aggregation\n- **PM2**: Built-in log management\n- **Docker**: Centralized logging with log drivers\n- **ELK Stack**: Elasticsearch, Logstash, Kibana for large scale\n- **CloudWatch**: For AWS deployments\n\n### Monitoring\n- **PM2 Monit**: `pm2 monit` for real-time metrics\n- **Docker Stats**: `docker stats` for resource usage\n- **System metrics**: `top`, `htop` for CPU/memory\n\n### Network Debugging\n```bash\n# Check open connections\nnetstat -tulpn\n\n# Check specific port\nlsof -i :3000\n\n# Test connectivity\ncurl http://localhost:3000/health\n```\n\n## When to Escalate\n\nEscalate to senior team member if:\n- Error message is cryptic and not Google-able\n- Problem persists after trying obvious solutions\n- Production is affected\n- Data integrity may be compromised\n- Security-related errors\n\n## Prevention\n\n1. **Automated health checks** before deployment\n2. **Staged deployments** (dev  staging  production)\n3. **Rollback plan** ready for quick recovery\n4. **Monitoring and alerts** for early problem detection\n5. **Deployment checklist** to ensure all steps followed\n\n## Related Questions\n- &lt;mention-page url=\&quot;...\&quot;&gt;How do I set up log aggregation?&lt;/mention-page&gt;\n- &lt;mention-page url=\&quot;...\&quot;&gt;Deployment checklist and best practices&lt;/mention-page&gt;\n- &lt;mention-page url=\&quot;...\&quot;&gt;How to roll back a failed deployment?&lt;/mention-page&gt;\n\n## Last Updated\nOctober 14, 2025&quot;
}]
```

### Step 5: Update FAQ Index

```
Notion:notion-fetch
id: &quot;faq-index-page-id&quot;
```

```
Notion:notion-update-page
page_id: &quot;faq-index-page-id&quot;
command: &quot;insert_content_after&quot;
selection_with_ellipsis: &quot;## Deployment &amp; Troubleshooting...&quot;
new_str: &quot;
- &lt;mention-page url=\&quot;...\&quot;&gt;Why does deployment fail with &#x27;port already in use&#x27; error?&lt;/mention-page&gt;
- &lt;mention-page url=\&quot;...\&quot;&gt;Why do I get &#x27;cannot connect to database&#x27; errors?&lt;/mention-page&gt;
- &lt;mention-page url=\&quot;...\&quot;&gt;What&#x27;s the first thing I should check when deployment fails?&lt;/mention-page&gt;
&quot;
```

## Summary Provided to User

```markdown
## FAQ Entries Created 

### Conversation Captured
Transformed deployment troubleshooting conversation into 3 comprehensive FAQ entries.

### FAQ Entries Created

1. **Port Already in Use Error**
   - Problem: Deployment fails due to occupied port
   - Solutions: Kill process, use PM2, check node processes
   - Prevention: Use process managers, graceful shutdown
   - Link: &lt;mention-page url=&quot;...&quot;&gt;Port already in use FAQ&lt;/mention-page&gt;

2. **Database Connection Errors**
   - Problem: Cannot connect to database during deployment
   - Troubleshooting: 4-step systematic approach
   - Solutions: By error type (credentials, network, limits)
   - Prevention: Connection pooling, health checks, retry logic
   - Link: &lt;mention-page url=&quot;...&quot;&gt;Database connection FAQ&lt;/mention-page&gt;

3. **General Troubleshooting Approach**
   - Best practice: Always check logs first
   - Tools: PM2 logs, Docker logs, application logs
   - Systematic approach: 6-step debugging process
   - Common errors: Module not found, permissions, ports
   - Link: &lt;mention-page url=&quot;...&quot;&gt;Troubleshooting first steps FAQ&lt;/mention-page&gt;

### Content Structure

Each FAQ includes:
 Short answer (quick reference)
 Detailed explanation (full context)
 Multiple solution options
 Code examples and commands
 Prevention strategies
 Links to related FAQs
 Last updated date

### Database Integration

-  Added to FAQ database (not standalone pages)
-  Properties set: Category (Troubleshooting), Tags, Date
-  FAQ index page updated with links
-  Cross-references between related questions

### Value Added

**From conversation**  **To structured knowledge**:
- Casual Q&amp;A  Professional FAQ entries
- Implicit knowledge  Explicit documentation
- One-time help  Reusable resource
- 5-minute conversation  Permanent team knowledge

**Future benefit**:
- Team can self-serve on common issues
- New team members can onboard faster
- Reduces repeated questions
- Improves troubleshooting speed

**Knowledge captured and preserved! **
```

## Key Features Demonstrated

### Content Extraction
- Identified distinct Q&amp;A pairs from conversation
- Extracted commands, solutions, and best practices
- Preserved troubleshooting workflows

### FAQ Structure
- Short answer for quick reference
- Detailed explanation for understanding
- Multiple solutions (Options 1, 2, 3)
- Code examples with comments
- Prevention strategies
- Related questions linking

### Database Integration
- Created in FAQ database (not standalone)
- Set appropriate properties (category, tags, date)
- Updated index page with links
- Cross-referenced related questions

### Value Transformation
- Converted informal conversation to professional docs
- Added structure, examples, and prevention tips
- Made knowledge searchable and discoverable
- Created permanent team resource

Perfect for: FAQ creation, knowledge preservation, team documentation</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/conversation_to_faq/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/examples/conversation-to-faq.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="conversation_to_wiki Imported skill conversation_to_wiki from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/evaluations/conversation-to-wiki.json Unknown LICENSE.txt sources/openai/conversation_to_wiki/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">conversation_to_wiki</div>
                <button class="copy-btn" onclick="copyToClipboard('conversation_to_wiki')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill conversation_to_wiki from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;name&quot;: &quot;Save Conversation to Wiki&quot;,
  &quot;skills&quot;: [&quot;knowledge-capture&quot;],
  &quot;query&quot;: &quot;Save this conversation about deploying our application to production to the team wiki&quot;,
  &quot;context&quot;: &quot;Preceding conversation contains discussion about deployment process, including steps, gotchas, and best practices&quot;,
  &quot;expected_behavior&quot;: [
    &quot;Extracts key information from conversation context (deployment steps, gotchas, best practices)&quot;,
    &quot;Identifies content type as How-To Guide based on procedural nature&quot;,
    &quot;Structures content using How-To structure: Overview  Prerequisites  Steps (numbered)  Verification  Troubleshooting  Related&quot;,
    &quot;Organizes information into clear sections with proper headings&quot;,
    &quot;Includes specific commands, configurations, or examples from conversation&quot;,
    &quot;Adds context about why/when to use this process in Overview section&quot;,
    &quot;Notes common issues and solutions mentioned in discussion in Troubleshooting section&quot;,
    &quot;Uses Notion:notion-search to find team wiki location or asks user&quot;,
    &quot;Creates page using Notion:notion-create-pages with structured content and appropriate parent&quot;,
    &quot;Uses clear, descriptive title like &#x27;How to Deploy to Production&#x27;&quot;,
    &quot;Applies Notion markdown formatting (headings, code blocks, bullets)&quot;,
    &quot;Suggests tags/categories for discoverability if wiki database&quot;
  ],
  &quot;success_criteria&quot;: [
    &quot;Content is structured using How-To format from SKILL.md content types&quot;,
    &quot;Key points from conversation are captured accurately (not generic)&quot;,
    &quot;Information is organized with proper Notion markdown (##, ###, bullets, code blocks)&quot;,
    &quot;Specific technical details (commands, configs) are preserved from conversation&quot;,
    &quot;Document is written for future reference with clear step-by-step instructions&quot;,
    &quot;Title is searchable and descriptive (e.g., &#x27;How to Deploy to Production&#x27;)&quot;,
    &quot;Page is placed in appropriate wiki location (general wiki or specific section)&quot;,
    &quot;Uses correct tool name (Notion:notion-create-pages)&quot;
  ]
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/conversation_to_wiki/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/evaluations/conversation-to-wiki.json" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="customer_meeting Imported skill customer_meeting from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/examples/customer-meeting.md Unknown LICENSE.txt sources/openai/customer_meeting/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">customer_meeting</div>
                <button class="copy-btn" onclick="copyToClipboard('customer_meeting')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill customer_meeting from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: Customer Meeting Prep

**User Request**: &quot;Prep for sales meeting with Acme Corp on Thursday&quot;

## Workflow

### 1. Search Customer Info
```
Notion:notion-search
query: &quot;Acme Corp&quot;
```

Found:
- CRM notes from initial call
- Product demo feedback
- Pricing proposal
- Competitor analysis

### 2. Fetch Details
```
Notion:notion-fetch (4 pages)
```

**Key context**:
- **Company**: 500-person fintech startup, Series B
- **Pain Points**: Manual workflows, data silos, scaling issues
- **Decision Makers**: CTO (technical), VP Product (user needs), CFO (budget)
- **Timeline**: Need solution by Q1
- **Budget**: $50-75K/year range
- **Competition**: Evaluating us vs. Competitor A and Competitor B

### 3. Add Research Context
Codex research added:
- Fintech industry compliance requirements
- Common integration needs for financial products
- Typical procurement processes for Series B companies

### 4. Create Internal Pre-Read
```
Notion:notion-create-pages
pages: [{
  properties: {
    title: &quot;Acme Corp Meeting - Pre-Read (Internal)&quot;
  },
  content: &quot;# Acme Corp Meeting - Pre-Read (Internal)

## Company Overview
**Company**: Acme Corp (500-person fintech, Series B)
**Decision Makers**: CTO, VP Product, CFO
Source: &lt;mention-page url=&#x27;...&#x27;&gt;CRM Notes&lt;/mention-page&gt;

## Their Pain Points  Our Solutions
- Manual workflows  Workflow automation
- Data silos  API integrations
- Scaling issues  Enterprise features

## Competitive Position
**Our advantages over Competitor A/B**:
- Better integration ecosystem (Stripe, Plaid)
- Stronger compliance features
- Faster implementation (4 weeks vs 12 weeks)

## Pricing Strategy
Recommend: $60K/year (mid-range of their budget)

## Potential Objections &amp; Responses
...&quot;
}]
```

### 5. Create Meeting Agenda
```
Notion:notion-create-pages
pages: [{
  properties: {
    title: &quot;Acme Corp - Product Demo &amp; Q&amp;A&quot;
  },
  content: &quot;# Acme Corp - Product Demo &amp; Q&amp;A

## Meeting Details
**Date**: Thursday, Oct 17, 2025 @ 2pm PST
**Attendees**: CTO, VP Product, CFO (Acme) | Sales Lead, Solutions Engineer (Us)
**Duration**: 60 minutes

## Objective
Demonstrate how our platform solves Acme&#x27;s workflow automation and integration challenges.

## Agenda

**1. Introductions** (5 min)

**2. Understand Current Workflow** (10 min)
- Current pain points
- Integration requirements
- Success criteria

**3. Product Demo** (25 min)
- Workflow automation capabilities
- API integrations (Stripe, Plaid)
- Security &amp; compliance features

**4. Pricing &amp; Implementation** (10 min)

**5. Next Steps** (10 min)
&quot;
}]
```

### 6. Link Resources
Connected agenda to CRM page, pricing sheet, and technical integration docs.

## Outputs

**Internal Pre-Read**: Full context for sales team
**Customer Agenda**: Professional meeting structure
**Both in Notion** with links to supporting materials

## Key Success Factors
- Understood customer&#x27;s specific pain points
- Researched industry context (fintech compliance)
- Mapped features to their needs
- Prepared competitive differentiators
- Structured demo around their use cases
- Pre-planned objection responses
- Clear next steps in agenda</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/customer_meeting/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/examples/customer-meeting.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="database_best_practices Imported skill database_best_practices from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/reference/database-best-practices.md Unknown LICENSE.txt sources/openai/database_best_practices/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">database_best_practices</div>
                <button class="copy-btn" onclick="copyToClipboard('database_best_practices')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill database_best_practices from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Database Best Practices

General guidance for creating and maintaining knowledge capture databases.

## Core Principles

### 1. Keep It Simple
- Start with core properties
- Add more only when needed
- Don&#x27;t over-engineer

### 2. Use Consistent Naming
- Title property for main identifier
- Status for lifecycle tracking
- Tags for flexible categorization
- Owner for accountability

### 3. Include Metadata
- Created/Updated timestamps
- Owner or maintainer
- Last reviewed dates
- Status indicators

### 4. Enable Discovery
- Use tags liberally
- Create helpful views
- Link related content
- Use clear titles

### 5. Plan for Scale
- Consider filters early
- Use relations for connections
- Think about search
- Organize with categories

## Creating a Database

### Using `Notion:notion-create-database`

Example for documentation database:

```javascript
{
  &quot;parent&quot;: {&quot;page_id&quot;: &quot;wiki-page-id&quot;},
  &quot;title&quot;: [{&quot;text&quot;: {&quot;content&quot;: &quot;Team Documentation&quot;}}],
  &quot;properties&quot;: {
    &quot;Type&quot;: {
      &quot;select&quot;: {
        &quot;options&quot;: [
          {&quot;name&quot;: &quot;How-To&quot;, &quot;color&quot;: &quot;blue&quot;},
          {&quot;name&quot;: &quot;Concept&quot;, &quot;color&quot;: &quot;green&quot;},
          {&quot;name&quot;: &quot;Reference&quot;, &quot;color&quot;: &quot;gray&quot;},
          {&quot;name&quot;: &quot;FAQ&quot;, &quot;color&quot;: &quot;yellow&quot;}
        ]
      }
    },
    &quot;Category&quot;: {
      &quot;select&quot;: {
        &quot;options&quot;: [
          {&quot;name&quot;: &quot;Engineering&quot;, &quot;color&quot;: &quot;red&quot;},
          {&quot;name&quot;: &quot;Product&quot;, &quot;color&quot;: &quot;purple&quot;},
          {&quot;name&quot;: &quot;Design&quot;, &quot;color&quot;: &quot;pink&quot;}
        ]
      }
    },
    &quot;Tags&quot;: {&quot;multi_select&quot;: {&quot;options&quot;: []}},
    &quot;Owner&quot;: {&quot;people&quot;: {}},
    &quot;Status&quot;: {
      &quot;select&quot;: {
        &quot;options&quot;: [
          {&quot;name&quot;: &quot;Draft&quot;, &quot;color&quot;: &quot;gray&quot;},
          {&quot;name&quot;: &quot;Final&quot;, &quot;color&quot;: &quot;green&quot;},
          {&quot;name&quot;: &quot;Deprecated&quot;, &quot;color&quot;: &quot;red&quot;}
        ]
      }
    }
  }
}
```

### Fetching Database Schema

Before creating pages, always fetch database to get schema:

```
Notion:notion-fetch
id: &quot;database-url-or-id&quot;
```

This returns the exact property names and types to use.

## Database Selection Guide

| Need | Use This Database |
|------|-------------------|
| General documentation | [Documentation Database](documentation-database.md) |
| Track decisions | [Decision Log](decision-log-database.md) |
| Q&amp;A knowledge base | [FAQ Database](faq-database.md) |
| Team-specific content | [Team Wiki](team-wiki-database.md) |
| Step-by-step guides | [How-To Guide Database](how-to-guide-database.md) |
| Incident/project learnings | [Learning Database](learning-database.md) |

## Tips

1. **Start with general documentation database** - most flexible
2. **Add specialized databases** as needs emerge (FAQ, Decisions)
3. **Use relations** to connect related docs
4. **Create views** for common use cases
5. **Review properties** quarterly - remove unused ones
6. **Document the schema** in database description
7. **Train team** on property usage and conventions</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/database_best_practices/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/reference/database-best-practices.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="database_migration Imported skill database_migration from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/examples/database-migration.md Unknown LICENSE.txt sources/openai/database_migration/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">database_migration</div>
                <button class="copy-btn" onclick="copyToClipboard('database_migration')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill database_migration from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: Database Migration Implementation

**User Request**: &quot;Plan and implement the database migration for user preferences schema&quot;

## Workflow

### 1. Find &amp; Fetch Spec
```
Notion:notion-search  Found &quot;User Preferences Schema Migration Spec&quot;
Notion:notion-fetch  Extracted requirements
```

**Spec Summary**: Migrate from JSON blob to structured schema for better performance and data integrity.

### 2. Parse Requirements
- **Current**: JSONB preferences column
- **Target**: Separate `user_preferences` and `notification_preferences` tables
- **Must maintain**: Backward compatibility during migration
- **Performance**: Support 1M+ users with zero downtime

### 3. Create Implementation Plan
```
Notion:notion-create-pages
pages: [{
  properties: {
    title: &quot;Implementation Plan: User Preferences Migration&quot;
  },
  content: &quot;[Full implementation plan with phases]&quot;
}]
```

**Plan included**:
- **Phase 1**: Create new tables with indexes
- **Phase 2**: Backfill data from JSONB
- **Phase 3**: Dual-write mode (both old and new)
- **Phase 4**: Switch reads to new schema
- **Phase 5**: Drop old JSONB column

### 4. Find Task Database &amp; Create Tasks
```
Notion:notion-search  Found &quot;Engineering Tasks&quot; database
Notion:notion-fetch  Got schema (Task, Status, Priority, Assignee, etc.)

Notion:notion-create-pages
parent: { data_source_id: &quot;collection://xyz&quot; }
pages: [
  {
    properties: {
      &quot;Task&quot;: &quot;Write migration SQL scripts&quot;,
      &quot;Status&quot;: &quot;To Do&quot;,
      &quot;Priority&quot;: &quot;High&quot;,
      &quot;Sprint&quot;: &quot;Sprint 25&quot;
    },
    content: &quot;## Context\nPart of User Preferences Migration...\n\n## Acceptance Criteria\n- [ ] Migration script creates tables\n- [ ] Indexes defined...&quot;
  },
  // ... 4 more tasks
]
```

**Tasks created**:
1. Write migration SQL scripts
2. Implement backfill job
3. Add dual-write logic to API
4. Update read queries
5. Rollback plan &amp; monitoring

### 5. Track Progress
Regular updates to implementation plan with status, blockers, and completion notes.

## Key Outputs

**Implementation Plan Page** (linked to spec)
**5 Tasks in Database** (with dependencies, acceptance criteria)
**Progress Tracking** (updated as work progresses)

## Success Factors
- Broke down complex migration into clear phases
- Created tasks with specific acceptance criteria
- Established dependencies (Phase 1  2  3  4  5)
- Zero-downtime approach with rollback plan
- Linked all work back to original spec</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/database_migration/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/examples/database-migration.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="decision_capture Imported skill decision_capture from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/examples/decision-capture.md Unknown LICENSE.txt sources/openai/decision_capture/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">decision_capture</div>
                <button class="copy-btn" onclick="copyToClipboard('decision_capture')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill decision_capture from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: Decision Record Capture

**User Request**: &quot;Document our decision to move from REST to GraphQL API&quot;

## Workflow

### 1. Extract Decision from Context
From conversation, identified:
- **Decision**: Migrate customer-facing API from REST to GraphQL
- **Context**: REST endpoints becoming unwieldy (50+ endpoints)
- **Alternatives**: Keep REST, try gRPC, adopt GraphQL
- **Rationale**: Better client experience, type safety, single endpoint

### 2. Find Decision Log
```
Notion:notion-search
query: &quot;architecture decisions&quot; or &quot;ADR&quot;
```

Found: &quot;Architecture Decision Records&quot; database

### 3. Fetch Schema
```
Notion:notion-fetch
```

Got properties: Decision (title), Date, Status, Domain, Impact, Deciders, Stakeholders

### 4. Create Decision Record
```
Notion:notion-create-pages
parent: { data_source_id: &quot;decision-log-collection-id&quot; }
pages: [{
  properties: {
    &quot;Decision&quot;: &quot;Migrate to GraphQL API&quot;,
    &quot;date:Date:start&quot;: &quot;2025-10-16&quot;,
    &quot;date:Date:is_datetime&quot;: 0,
    &quot;Status&quot;: &quot;Accepted&quot;,
    &quot;Domain&quot;: &quot;Architecture&quot;,
    &quot;Impact&quot;: &quot;High&quot;
  },
  content: &quot;[Full decision record with context, rationale, alternatives...]&quot;
}]
```

**Content sample**:

```markdown
# Migrate Customer-Facing API to GraphQL

## Context
Our REST API has grown to 50+ endpoints with inconsistent patterns. Frontend and mobile teams request new endpoints frequently, leading to:
- API bloat and maintenance burden
- Over-fetching/under-fetching data
- Slow iteration on client features
- Inconsistent error handling

## Decision
Migrate customer-facing API from REST to GraphQL while maintaining REST for internal services.

## Rationale
**Why GraphQL**:
- Clients fetch exactly what they need (no over/under-fetching)
- Single endpoint, self-documenting schema
- Type safety with code generation
- Better developer experience
- Industry standard for client-facing APIs

## Options Considered

### Option A: Keep REST (Status Quo)
**Pros**: No migration cost, team familiar
**Cons**: Doesn&#x27;t solve core problems, maintenance keeps growing
**Decision**: Rejected - doesn&#x27;t address root cause

### Option B: gRPC
**Pros**: Performance, strong typing
**Cons**: Browser support issues, steeper learning curve, not designed for client-facing
**Decision**: Rejected - better for internal services

### Option C: GraphQL
**Pros**: Solves over/under-fetching, great DX, strong ecosystem
**Cons**: Learning curve, caching complexity, migration effort
**Decision**: **Accepted**

## Consequences

**Positive**:
- Faster frontend/mobile development
- Reduced API maintenance burden
- Better type safety and tooling
- Single endpoint simplifies deployment

**Negative**:
- 3-4 month migration timeline
- Team needs training
- Need to solve caching strategy
- Monitoring/debugging patterns different

## Implementation Plan
1. GraphQL server setup (Apollo Server)
2. Schema design workshop
3. Gradual migration (start with new features)
4. Dual-run period (both REST and GraphQL)
5. Deprecate old REST endpoints

**Timeline**: Start Q4 2025, complete Q1 2026
**Owner**: Backend team lead

## Success Metrics
- API response times improve 30%
- Client fetch efficiency (less data transferred)
- Reduced new endpoint requests
- Developer satisfaction scores
```

### 5. Make Discoverable
Added link from Architecture Wiki and notified team in Slack.

## Key Success Factors
- Captured decision while context fresh
- Documented alternatives considered
- Included both pros and cons
- Clear implementation plan
- Saved to decision log for future reference
- Made discoverable for team</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/decision_capture/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/examples/decision-capture.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="decision_log_database Imported skill decision_log_database from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/reference/decision-log-database.md Unknown LICENSE.txt sources/openai/decision_log_database/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">decision_log_database</div>
                <button class="copy-btn" onclick="copyToClipboard('decision_log_database')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill decision_log_database from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Decision Log Database (ADR - Architecture Decision Records)

**Purpose**: Track important decisions with context and rationale.

## Schema

| Property | Type | Options | Purpose |
|----------|------|---------|---------|
| **Decision** | title | - | What was decided |
| **Date** | date | - | When decision was made |
| **Status** | select | Proposed, Accepted, Superseded, Deprecated | Current decision status |
| **Domain** | select | Architecture, Product, Business, Design, Operations | Decision category |
| **Impact** | select | High, Medium, Low | Expected impact level |
| **Deciders** | people | - | Who made the decision |
| **Stakeholders** | people | - | Who&#x27;s affected by decision |
| **Related Decisions** | relation | Links to other decisions | Context and dependencies |

## Usage

```
Create decision records with properties:
{
  &quot;Decision&quot;: &quot;Use PostgreSQL for Primary Database&quot;,
  &quot;Date&quot;: &quot;2025-10-15&quot;,
  &quot;Status&quot;: &quot;Accepted&quot;,
  &quot;Domain&quot;: &quot;Architecture&quot;,
  &quot;Impact&quot;: &quot;High&quot;,
  &quot;Deciders&quot;: [tech_lead, architect],
  &quot;Stakeholders&quot;: [eng_team]
}
```

## Content Template

Each decision page should include:
- **Context**: Why this decision was needed
- **Decision**: What was decided
- **Rationale**: Why this option was chosen
- **Options Considered**: Alternatives and trade-offs
- **Consequences**: Expected outcomes (positive and negative)
- **Implementation**: How decision will be executed

## Views

**Recent Decisions**: Sort by Date descending
**Active Decisions**: Filter where Status = &quot;Accepted&quot;
**By Domain**: Group by Domain
**High Impact**: Filter where Impact = &quot;High&quot;
**Pending**: Filter where Status = &quot;Proposed&quot;

## Best Practices

1. **Document immediately**: Record decisions when made, while context is fresh
2. **Include alternatives**: Show what was considered and why it wasn&#x27;t chosen
3. **Track superseded decisions**: Update status when decisions change
4. **Link related decisions**: Use relations to show dependencies
5. **Review periodically**: Check if old decisions are still valid</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/decision_log_database/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/reference/decision-log-database.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="decision_meeting_prep Imported skill decision_meeting_prep from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/evaluations/decision-meeting-prep.json Unknown LICENSE.txt sources/openai/decision_meeting_prep/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">decision_meeting_prep</div>
                <button class="copy-btn" onclick="copyToClipboard('decision_meeting_prep')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill decision_meeting_prep from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;name&quot;: &quot;Decision Meeting Preparation&quot;,
  &quot;skills&quot;: [&quot;meeting-intelligence&quot;],
  &quot;query&quot;: &quot;Prep for tomorrow&#x27;s meeting where we need to decide on our database migration approach. Create both an internal pre-read for the team and an agenda for the meeting.&quot;,
  &quot;expected_behavior&quot;: [
    &quot;Step 1: Uses Notion:notion-search to find context about database migration (project pages, technical specs, previous discussions, options analysis)&quot;,
    &quot;Step 2: Fetches at least 2-3 relevant pages using Notion:notion-fetch to gather information from Notion&quot;,
    &quot;Step 3: Identifies the decision to be made and available options from fetched Notion content&quot;,
    &quot;Step 4: Enriches with Codex research - adds decision-making frameworks (e.g., cost-benefit analysis, risk assessment), technical context for migration approaches, best practices for database migrations&quot;,
    &quot;Step 5: Distinguishes Notion facts from Codex insights in synthesis&quot;,
    &quot;Step 6: Creates INTERNAL PRE-READ using Notion:notion-create-pages with title like &#x27;INTERNAL: Database Migration Decision - Pre-Read - [Date]&#x27;&quot;,
    &quot;Step 6a: Internal pre-read includes: Meeting overview, background context (from Notion), current status and technical details, context &amp; insights (from Codex research on migration best practices), decision options with detailed pros/cons, recommendation with rationale, what we need from meeting&quot;,
    &quot;Step 6b: Internal pre-read marked clearly as &#x27;INTERNAL ONLY&#x27; or &#x27;For team only&#x27;&quot;,
    &quot;Step 7: Creates EXTERNAL AGENDA using Notion:notion-create-pages with title like &#x27;Meeting Agenda: Database Migration Decision - [Date]&#x27;&quot;,
    &quot;Step 7a: External agenda includes: Meeting details, objective (clear decision to make), agenda items with time allocations, discussion topics, decisions needed, action items section (empty), related resources with link to pre-read&quot;,
    &quot;Step 7b: External agenda is clean, professional, focused (no internal strategy or detailed pros/cons)&quot;,
    &quot;Step 8: Links both documents together (agenda mentions pre-read, pre-read mentions agenda)&quot;,
    &quot;Both documents link to source pages using &lt;mention-page url=&#x27;...&#x27;&gt;&quot;
  ],
  &quot;success_criteria&quot;: [
    &quot;TWO documents are created (internal pre-read + external agenda), not just one&quot;,
    &quot;Internal pre-read is comprehensive with: Notion context + Codex insights + detailed pros/cons + recommendation&quot;,
    &quot;Internal pre-read is clearly marked &#x27;INTERNAL&#x27; or &#x27;For team only&#x27;&quot;,
    &quot;External agenda is professional, structured, focused on meeting flow (not internal strategy)&quot;,
    &quot;Codex enrichment is present and adds value (decision frameworks, migration best practices, risk patterns)&quot;,
    &quot;Notion facts are clearly sourced, Codex insights are distinguished&quot;,
    &quot;At least 2-3 Notion source pages are cited using mention-page tags&quot;,
    &quot;Internal pre-read follows structure from SKILL.md Step 5 (Meeting Overview  Background  Current Status  Context &amp; Insights  Key Discussion Points  What We Need)&quot;,
    &quot;External agenda follows structure from SKILL.md Step 6 (Meeting Details  Objective  Agenda Items  Discussion Topics  Decisions Needed  Action Items  Related Resources)&quot;,
    &quot;Documents are cross-linked (pre-read mentions agenda, agenda mentions pre-read)&quot;,
    &quot;Meeting date is included in both titles&quot;,
    &quot;Uses correct tool names (Notion:notion-search, Notion:notion-fetch, Notion:notion-create-pages for BOTH documents)&quot;
  ]
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/decision_meeting_prep/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/evaluations/decision-meeting-prep.json" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="decision_meeting_template Imported skill decision_meeting_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/reference/decision-meeting-template.md Unknown LICENSE.txt sources/openai/decision_meeting_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">decision_meeting_template</div>
                <button class="copy-btn" onclick="copyToClipboard('decision_meeting_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill decision_meeting_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Decision Meeting Template

Use this template when you need to make an important decision with your team.

```markdown
# [Decision Topic] - [Date]

## Meeting Details
**Date &amp; Time**: [Date and time]
**Duration**: [Length]
**Attendees**: [List of attendees with roles]
**Location**: [Physical location or video link]
**Facilitator**: [Name]

## Pre-Read Summary

### Background
[2-3 sentences providing context from related project pages]

**Related Pages**:
- &lt;mention-page url=&quot;...&quot;&gt;Project Overview&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Previous Discussion&lt;/mention-page&gt;

### Current Situation
[What brings us to this decision point]

## Decision Required

**Question**: [Clear statement of decision needed]

**Timeline**: [When decision needs to be made]

**Impact**: [Who/what is affected by this decision]

## Options Analysis

### Option A: [Name]
**Description**: [What this option entails]

**Pros**:
- [Advantage]
- [Advantage]

**Cons**:
- [Disadvantage]
- [Disadvantage]

**Cost/Effort**: [Estimate]
**Risk**: [Risk assessment]

### Option B: [Name]
[Repeat structure]

### Option C: Do Nothing
**Description**: What happens if we don&#x27;t decide
**Implications**: [Consequences]

## Recommendation

[If there is a recommended option, state it with rationale]

## Discussion Topics

1. [Topic to discuss]
2. [Clarification needed on]
3. [Trade-offs to consider]

## Decision Framework

**Criteria for evaluation**:
- [Criterion 1]
- [Criterion 2]
- [Criterion 3]

## Decision

[To be filled during meeting]

**Selected Option**: [Option chosen]
**Rationale**: [Why]
**Owner**: [Who will implement]
**Timeline**: [When]

## Action Items

- [ ] [Action] - @[Owner] - Due: [Date]
- [ ] [Action] - @[Owner] - Due: [Date]

## Follow-up

**Next review**: [Date]
**Success metrics**: [How we&#x27;ll know this worked]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/decision_meeting_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/reference/decision-meeting-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="decision_record Imported skill decision_record from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/evaluations/decision-record.json Unknown LICENSE.txt sources/openai/decision_record/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">decision_record</div>
                <button class="copy-btn" onclick="copyToClipboard('decision_record')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill decision_record from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;name&quot;: &quot;Create Decision Record&quot;,
  &quot;skills&quot;: [&quot;knowledge-capture&quot;],
  &quot;query&quot;: &quot;Document our decision to use PostgreSQL instead of MongoDB for our new service&quot;,
  &quot;context&quot;: &quot;User has just explained the decision with rationale, options considered, and trade-offs&quot;,
  &quot;expected_behavior&quot;: [
    &quot;Recognizes this as a decision record (architectural decision) from conversation context&quot;,
    &quot;Uses Decision structure: Context  Decision  Rationale  Options Considered (with Pros/Cons)  Consequences  Implementation&quot;,
    &quot;Extracts from context: decision made, options considered (PostgreSQL vs MongoDB), rationale, trade-offs&quot;,
    &quot;Creates document with proper structure including Date, Status (Accepted), and Deciders&quot;,
    &quot;Includes both positive and negative consequences (trade-offs) in Consequences section&quot;,
    &quot;Uses Notion:notion-search to check if decision log database exists&quot;,
    &quot;If database exists, asks whether to add there or create standalone page&quot;,
    &quot;If creating in database, fetches schema using Notion:notion-fetch and sets properties: Decision title, Date, Status, Domain (Architecture), Deciders, Impact&quot;,
    &quot;Uses Notion:notion-create-pages with parent: { data_source_id } for database or { page_id } for parent page&quot;,
    &quot;Applies proper Notion markdown formatting with sections&quot;,
    &quot;Suggests linking from architecture docs or project pages&quot;
  ],
  &quot;success_criteria&quot;: [
    &quot;Document follows Decision structure from SKILL.md content types&quot;,
    &quot;All key sections present: Context, Decision, Rationale, Options Considered (with Pros/Cons for each), Consequences, Implementation&quot;,
    &quot;Decision is clearly stated (PostgreSQL chosen over MongoDB)&quot;,
    &quot;Options that were considered are documented with pros/cons structure&quot;,
    &quot;Rationale explains why PostgreSQL was chosen based on conversation context&quot;,
    &quot;Consequences include both positive (benefits) and negative (trade-offs)&quot;,
    &quot;If in database, properties are set correctly from schema (Decision, Date, Status: Accepted, Domain: Architecture, Impact)&quot;,
    &quot;Document is dated and has status &#x27;Accepted&#x27;&quot;,
    &quot;Uses correct tool names (Notion:notion-search, Notion:notion-fetch, Notion:notion-create-pages)&quot;
  ]
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/decision_record/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/evaluations/decision-record.json" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="documentation_database Imported skill documentation_database from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/reference/documentation-database.md Unknown LICENSE.txt sources/openai/documentation_database/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">documentation_database</div>
                <button class="copy-btn" onclick="copyToClipboard('documentation_database')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill documentation_database from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># General Documentation Database

**Purpose**: Store all types of documentation in a searchable, organized database.

## Schema

| Property | Type | Options | Purpose |
|----------|------|---------|---------|
| **Title** | title | - | Document name |
| **Type** | select | How-To, Concept, Reference, FAQ, Decision, Post-Mortem | Categorize content type |
| **Category** | select | Engineering, Product, Design, Operations, General | Organize by department/topic |
| **Tags** | multi_select | - | Additional categorization (languages, tools, topics) |
| **Status** | select | Draft, In Review, Final, Deprecated | Track document lifecycle |
| **Owner** | people | - | Document maintainer |
| **Created** | created_time | - | Auto-populated creation date |
| **Last Updated** | last_edited_time | - | Auto-populated last edit |
| **Last Reviewed** | date | - | Manual review tracking |

## Usage

```
Create pages with properties:
{
  &quot;Title&quot;: &quot;How to Deploy to Production&quot;,
  &quot;Type&quot;: &quot;How-To&quot;,
  &quot;Category&quot;: &quot;Engineering&quot;,
  &quot;Tags&quot;: &quot;deployment, production, DevOps&quot;,
  &quot;Status&quot;: &quot;Final&quot;,
  &quot;Owner&quot;: [current_user],
  &quot;Last Reviewed&quot;: &quot;2025-10-01&quot;
}
```

## Views

**By Type**: Group by Type property
**By Category**: Group by Category property  
**Recent Updates**: Sort by Last Updated descending
**Needs Review**: Filter where Last Reviewed &gt; 90 days ago
**Draft Docs**: Filter where Status = &quot;Draft&quot;

## Creating This Database

Use `Notion:notion-create-database`:

```javascript
{
  &quot;parent&quot;: {&quot;page_id&quot;: &quot;wiki-page-id&quot;},
  &quot;title&quot;: [{&quot;text&quot;: {&quot;content&quot;: &quot;Team Documentation&quot;}}],
  &quot;properties&quot;: {
    &quot;Type&quot;: {
      &quot;select&quot;: {
        &quot;options&quot;: [
          {&quot;name&quot;: &quot;How-To&quot;, &quot;color&quot;: &quot;blue&quot;},
          {&quot;name&quot;: &quot;Concept&quot;, &quot;color&quot;: &quot;green&quot;},
          {&quot;name&quot;: &quot;Reference&quot;, &quot;color&quot;: &quot;gray&quot;},
          {&quot;name&quot;: &quot;FAQ&quot;, &quot;color&quot;: &quot;yellow&quot;}
        ]
      }
    },
    &quot;Category&quot;: {
      &quot;select&quot;: {
        &quot;options&quot;: [
          {&quot;name&quot;: &quot;Engineering&quot;, &quot;color&quot;: &quot;red&quot;},
          {&quot;name&quot;: &quot;Product&quot;, &quot;color&quot;: &quot;purple&quot;},
          {&quot;name&quot;: &quot;Design&quot;, &quot;color&quot;: &quot;pink&quot;}
        ]
      }
    },
    &quot;Tags&quot;: {&quot;multi_select&quot;: {&quot;options&quot;: []}},
    &quot;Owner&quot;: {&quot;people&quot;: {}},
    &quot;Status&quot;: {
      &quot;select&quot;: {
        &quot;options&quot;: [
          {&quot;name&quot;: &quot;Draft&quot;, &quot;color&quot;: &quot;gray&quot;},
          {&quot;name&quot;: &quot;Final&quot;, &quot;color&quot;: &quot;green&quot;},
          {&quot;name&quot;: &quot;Deprecated&quot;, &quot;color&quot;: &quot;red&quot;}
        ]
      }
    }
  }
}
```

## Best Practices

1. **Start with this schema** - most flexible for general documentation
2. **Use relations** to connect related docs
3. **Create views** for common use cases
4. **Review properties** quarterly - remove unused ones
5. **Document the schema** in database description
6. **Train team** on property usage and conventions</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/documentation_database/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/reference/documentation-database.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="executive_review Imported skill executive_review from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/examples/executive-review.md Unknown LICENSE.txt sources/openai/executive_review/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">executive_review</div>
                <button class="copy-btn" onclick="copyToClipboard('executive_review')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill executive_review from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: Executive Review Prep

**User Request**: &quot;Prep for quarterly executive review on Friday&quot;

## Workflow

### 1. Search for Context
```
Notion:notion-search
query: &quot;Q4 objectives&quot; + &quot;KPIs&quot; + &quot;quarterly results&quot;
```

Found:
- Q4 OKRs and progress
- Product metrics dashboard
- Engineering velocity reports
- Customer feedback summary

### 2. Fetch &amp; Analyze
```
Notion:notion-fetch (5 pages)
```

**Key metrics**:
- **Revenue**: $2.4M ARR (96% of Q4 target)
- **Customer Growth**: 145 new customers (exceeds 120 target)
- **Churn**: 3.2% (below 5% target)
- **Product**: 3 major features shipped, 2 in beta
- **Engineering**: 94% uptime (above 95% SLA)

### 3. Add Codex Research Context
Added context on:
- Industry benchmarks for SaaS metrics
- Typical Q4 sales patterns
- Best practices for executive presentations

### 4. Create Pre-Read (Internal)
```
Notion:notion-create-pages
title: &quot;Q4 Review - Pre-Read (Internal)&quot;
```

**Pre-read sections**:
- **Executive Summary**: Strong quarter, missed revenue by 4% but exceeded customer growth
- **Detailed Metrics**: All KPIs with trend lines
- **Wins**: Product launches, key customer acquisitions
- **Challenges**: Sales pipeline conversion, engineering hiring
- **Q1 Preview**: Strategic priorities

### 5. Create Presentation Agenda
```
Notion:notion-create-pages
title: &quot;Q4 Executive Review - Agenda&quot;
```

**Agenda** (90 min):
- Q4 Results Overview (15 min)
- Revenue &amp; Growth Deep Dive (20 min)
- Product &amp; Engineering Update (20 min)
- Customer Success Highlights (15 min)
- Q1 Strategic Plan (15 min)
- Discussion &amp; Questions (15 min)

### 6. Link Supporting Docs
Connected to OKRs, metrics dashboards, and Q1 planning docs.

## Outputs

**Internal Pre-Read**: Comprehensive context with honest assessment
**Executive Agenda**: Structured 90-min presentation
**Both in Notion** with links to supporting data

## Key Success Factors
- Synthesized data from multiple sources (OKRs, metrics, feedback)
- Added industry context and benchmarks
- Created honest internal assessment (not just wins)
- Structured agenda with time allocations
- Linked to source data for drill-down during Q&amp;A</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/executive_review/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/examples/executive-review.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="faq_database Imported skill faq_database from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/reference/faq-database.md Unknown LICENSE.txt sources/openai/faq_database/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">faq_database</div>
                <button class="copy-btn" onclick="copyToClipboard('faq_database')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill faq_database from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># FAQ Database

**Purpose**: Organize frequently asked questions with answers.

## Schema

| Property | Type | Options | Purpose |
|----------|------|---------|---------|
| **Question** | title | - | The question being asked |
| **Category** | select | Product, Engineering, Support, HR, General | Question topic |
| **Tags** | multi_select | - | Specific topics (auth, billing, onboarding, etc.) |
| **Answer Type** | select | Quick Answer, Detailed Guide, Link to Docs | Response format |
| **Last Reviewed** | date | - | When answer was verified |
| **Helpful Count** | number | - | Track usefulness (optional) |
| **Audience** | select | Internal, External, All | Who should see this |
| **Related Questions** | relation | Links to related FAQs | Connect similar topics |

## Usage

```
Create FAQ entries with properties:
{
  &quot;Question&quot;: &quot;How do I reset my password?&quot;,
  &quot;Category&quot;: &quot;Support&quot;,
  &quot;Tags&quot;: &quot;authentication, password, login&quot;,
  &quot;Answer Type&quot;: &quot;Quick Answer&quot;,
  &quot;Last Reviewed&quot;: &quot;2025-10-01&quot;,
  &quot;Audience&quot;: &quot;External&quot;
}
```

## Content Template

Each FAQ page should include:
- **Short Answer**: 1-2 sentence quick response
- **Detailed Explanation**: Full answer with context
- **Steps** (if applicable): Numbered procedure
- **Screenshots** (if helpful): Visual guidance
- **Related Questions**: Links to similar FAQs
- **Additional Resources**: External docs or videos

## Views

**By Category**: Group by Category
**Recently Updated**: Sort by Last Reviewed descending
**Needs Review**: Filter where Last Reviewed &gt; 180 days ago
**External FAQs**: Filter where Audience contains &quot;External&quot;
**Popular**: Sort by Helpful Count descending (if tracking)

## Best Practices

1. **Use clear questions**: Write questions as users would ask them
2. **Provide quick answers**: Lead with the direct answer, then elaborate
3. **Link related FAQs**: Help users discover related information
4. **Review regularly**: Keep answers current and accurate
5. **Track what&#x27;s helpful**: Use feedback to improve frequently accessed FAQs</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/faq_database/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/reference/faq-database.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="fetch_comments Imported skill fetch_comments from openai openai /a0/tmp/skills_research/openai/skills/.curated/gh-address-comments/scripts/fetch_comments.py Unknown LICENSE.txt sources/openai/fetch_comments/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">fetch_comments</div>
                <button class="copy-btn" onclick="copyToClipboard('fetch_comments')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill fetch_comments from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Fetch all PR conversation comments + reviews + review threads (inline threads)
for the PR associated with the current git branch, by shelling out to:

  gh api graphql

Requires:
  - `gh auth login` already set up
  - current branch has an associated (open) PR

Usage:
  python fetch_comments.py &gt; pr_comments.json
&quot;&quot;&quot;

from __future__ import annotations

import json
import subprocess
import sys
from typing import Any

QUERY = &quot;&quot;&quot;\
query(
  $owner: String!,
  $repo: String!,
  $number: Int!,
  $commentsCursor: String,
  $reviewsCursor: String,
  $threadsCursor: String
) {
  repository(owner: $owner, name: $repo) {
    pullRequest(number: $number) {
      number
      url
      title
      state

      # Top-level &quot;Conversation&quot; comments (issue comments on the PR)
      comments(first: 100, after: $commentsCursor) {
        pageInfo { hasNextPage endCursor }
        nodes {
          id
          body
          createdAt
          updatedAt
          author { login }
        }
      }

      # Review submissions (Approve / Request changes / Comment), with body if present
      reviews(first: 100, after: $reviewsCursor) {
        pageInfo { hasNextPage endCursor }
        nodes {
          id
          state
          body
          submittedAt
          author { login }
        }
      }

      # Inline review threads (grouped), includes resolved state
      reviewThreads(first: 100, after: $threadsCursor) {
        pageInfo { hasNextPage endCursor }
        nodes {
          id
          isResolved
          isOutdated
          path
          line
          diffSide
          startLine
          startDiffSide
          originalLine
          originalStartLine
          resolvedBy { login }
          comments(first: 100) {
            nodes {
              id
              body
              createdAt
              updatedAt
              author { login }
            }
          }
        }
      }
    }
  }
}
&quot;&quot;&quot;


def _run(cmd: list[str], stdin: str | None = None) -&gt; str:
    p = subprocess.run(cmd, input=stdin, capture_output=True, text=True)
    if p.returncode != 0:
        raise RuntimeError(f&quot;Command failed: {&#x27; &#x27;.join(cmd)}\n{p.stderr}&quot;)
    return p.stdout


def _run_json(cmd: list[str], stdin: str | None = None) -&gt; dict[str, Any]:
    out = _run(cmd, stdin=stdin)
    try:
        return json.loads(out)
    except json.JSONDecodeError as e:
        raise RuntimeError(f&quot;Failed to parse JSON from command output: {e}\nRaw:\n{out}&quot;) from e


def _ensure_gh_authenticated() -&gt; None:
    try:
        _run([&quot;gh&quot;, &quot;auth&quot;, &quot;status&quot;])
    except RuntimeError:
        print(&quot;run `gh auth login` to authenticate the GitHub CLI&quot;, file=sys.stderr)
        raise RuntimeError(&quot;gh auth status failed; run `gh auth login` to authenticate the GitHub CLI&quot;) from None


def gh_pr_view_json(fields: str) -&gt; dict[str, Any]:
    # fields is a comma-separated list like: &quot;number,headRepositoryOwner,headRepository&quot;
    return _run_json([&quot;gh&quot;, &quot;pr&quot;, &quot;view&quot;, &quot;--json&quot;, fields])


def get_current_pr_ref() -&gt; tuple[str, str, int]:
    &quot;&quot;&quot;
    Resolve the PR for the current branch (whatever gh considers associated).
    Works for cross-repo PRs too, by reading head repository owner/name.
    &quot;&quot;&quot;
    pr = gh_pr_view_json(&quot;number,headRepositoryOwner,headRepository&quot;)
    owner = pr[&quot;headRepositoryOwner&quot;][&quot;login&quot;]
    repo = pr[&quot;headRepository&quot;][&quot;name&quot;]
    number = int(pr[&quot;number&quot;])
    return owner, repo, number


def gh_api_graphql(
    owner: str,
    repo: str,
    number: int,
    comments_cursor: str | None = None,
    reviews_cursor: str | None = None,
    threads_cursor: str | None = None,
) -&gt; dict[str, Any]:
    &quot;&quot;&quot;
    Call `gh api graphql` using -F variables, avoiding JSON blobs with nulls.
    Query is passed via stdin using query=@- to avoid shell newline/quoting issues.
    &quot;&quot;&quot;
    cmd = [
        &quot;gh&quot;,
        &quot;api&quot;,
        &quot;graphql&quot;,
        &quot;-F&quot;,
        &quot;query=@-&quot;,
        &quot;-F&quot;,
        f&quot;owner={owner}&quot;,
        &quot;-F&quot;,
        f&quot;repo={repo}&quot;,
        &quot;-F&quot;,
        f&quot;number={number}&quot;,
    ]
    if comments_cursor:
        cmd += [&quot;-F&quot;, f&quot;commentsCursor={comments_cursor}&quot;]
    if reviews_cursor:
        cmd += [&quot;-F&quot;, f&quot;reviewsCursor={reviews_cursor}&quot;]
    if threads_cursor:
        cmd += [&quot;-F&quot;, f&quot;threadsCursor={threads_cursor}&quot;]

    return _run_json(cmd, stdin=QUERY)


def fetch_all(owner: str, repo: str, number: int) -&gt; dict[str, Any]:
    conversation_comments: list[dict[str, Any]] = []
    reviews: list[dict[str, Any]] = []
    review_threads: list[dict[str, Any]] = []

    comments_cursor: str | None = None
    reviews_cursor: str | None = None
    threads_cursor: str | None = None

    pr_meta: dict[str, Any] | None = None

    while True:
        payload = gh_api_graphql(
            owner=owner,
            repo=repo,
            number=number,
            comments_cursor=comments_cursor,
            reviews_cursor=reviews_cursor,
            threads_cursor=threads_cursor,
        )

        if &quot;errors&quot; in payload and payload[&quot;errors&quot;]:
            raise RuntimeError(f&quot;GitHub GraphQL errors:\n{json.dumps(payload[&#x27;errors&#x27;], indent=2)}&quot;)

        pr = payload[&quot;data&quot;][&quot;repository&quot;][&quot;pullRequest&quot;]
        if pr_meta is None:
            pr_meta = {
                &quot;number&quot;: pr[&quot;number&quot;],
                &quot;url&quot;: pr[&quot;url&quot;],
                &quot;title&quot;: pr[&quot;title&quot;],
                &quot;state&quot;: pr[&quot;state&quot;],
                &quot;owner&quot;: owner,
                &quot;repo&quot;: repo,
            }

        c = pr[&quot;comments&quot;]
        r = pr[&quot;reviews&quot;]
        t = pr[&quot;reviewThreads&quot;]

        conversation_comments.extend(c.get(&quot;nodes&quot;) or [])
        reviews.extend(r.get(&quot;nodes&quot;) or [])
        review_threads.extend(t.get(&quot;nodes&quot;) or [])

        comments_cursor = c[&quot;pageInfo&quot;][&quot;endCursor&quot;] if c[&quot;pageInfo&quot;][&quot;hasNextPage&quot;] else None
        reviews_cursor = r[&quot;pageInfo&quot;][&quot;endCursor&quot;] if r[&quot;pageInfo&quot;][&quot;hasNextPage&quot;] else None
        threads_cursor = t[&quot;pageInfo&quot;][&quot;endCursor&quot;] if t[&quot;pageInfo&quot;][&quot;hasNextPage&quot;] else None

        if not (comments_cursor or reviews_cursor or threads_cursor):
            break

    assert pr_meta is not None
    return {
        &quot;pull_request&quot;: pr_meta,
        &quot;conversation_comments&quot;: conversation_comments,
        &quot;reviews&quot;: reviews,
        &quot;review_threads&quot;: review_threads,
    }


def main() -&gt; None:
    _ensure_gh_authenticated()
    owner, repo, number = get_current_pr_ref()
    result = fetch_all(owner, repo, number)
    print(json.dumps(result, indent=2))


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/fetch_comments/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/gh-address-comments/scripts/fetch_comments.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/gh-address-comments/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="format_selection_guide Imported skill format_selection_guide from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/reference/format-selection-guide.md Unknown LICENSE.txt sources/openai/format_selection_guide/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">format_selection_guide</div>
                <button class="copy-btn" onclick="copyToClipboard('format_selection_guide')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill format_selection_guide from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Format Selection Guide

Choose the right output format for your research needs.

## Decision Tree

```
Is this comparing multiple options?
   YES  Use Comparison Format
   NO 

Is this time-sensitive or simple?
   YES  Use Quick Brief
   NO 

Does this require formal/extensive documentation?
   YES  Use Comprehensive Report
   NO  Use Research Summary (default)
```

## Format Overview

| Format | Length | When to Use | Template |
|--------|--------|-------------|----------|
| [Research Summary](research-summary-format.md) | 500-1000 words | Most research requests (default) | [Template](research-summary-template.md) |
| [Comprehensive Report](comprehensive-report-format.md) | 1500+ words | Formal docs, strategic decisions | [Template](comprehensive-report-template.md) |
| [Quick Brief](quick-brief-format.md) | 200-400 words | Time-sensitive, simple topics | [Template](quick-brief-template.md) |
| [Comparison](comparison-format.md) | 800-1200 words | Evaluating options | [Template](comparison-template.md) |

## Formatting Guidelines

### Headings
- Use `#` for title
- Use `##` for major sections
- Use `###` for subsections
- Keep heading hierarchy consistent

### Lists
- Use `-` for bullet points
- Use `1.` for numbered lists
- Keep list items parallel in structure

### Emphasis
- Use `**bold**` for key terms and section labels
- Use `*italic*` for emphasis
- Use sparingly for maximum impact

### Citations
- Always use `&lt;mention-page url=&quot;...&quot;&gt;Page Title&lt;/mention-page&gt;` for source pages
- Include citation immediately after referenced information
- Group all sources in a &quot;Sources&quot; section at the end

### Tables
- Use for structured data comparison
- Keep columns to 3-5 for readability
- Include header row
- Align content appropriately

### Code Blocks
Use when including:
- Technical specifications
- Configuration examples
- Command examples

```
Example code or configuration here
```

## Content Guidelines

### Executive Summaries
- Lead with the most important finding
- Include 1-2 key implications
- Make it standalone (reader gets value without reading further)
- Target 2-3 sentences for summaries, 1 paragraph for reports

### Key Findings
- Start with a clear headline
- Support with specific evidence
- Include relevant data points or quotes
- Cite source immediately
- Focus on actionable insights

### Recommendations
- Make them specific and actionable
- Explain the &quot;why&quot; behind each recommendation
- Prioritize clearly (Priority 1, 2, 3 or High/Medium/Low)
- Include implementation hints when relevant

### Source Citations
- Link to original pages using mentions
- Note if information is outdated (check last-edited dates)
- Credit specific sections when quoting
- Group related sources together</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/format_selection_guide/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/reference/format-selection-guide.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="github_utils Imported skill github_utils from openai openai /a0/tmp/skills_research/openai/skills/.system/skill-installer/scripts/github_utils.py Unknown LICENSE.txt sources/openai/github_utils/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">github_utils</div>
                <button class="copy-btn" onclick="copyToClipboard('github_utils')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill github_utils from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;Shared GitHub helpers for skill install scripts.&quot;&quot;&quot;

from __future__ import annotations

import os
import urllib.request


def github_request(url: str, user_agent: str) -&gt; bytes:
    headers = {&quot;User-Agent&quot;: user_agent}
    token = os.environ.get(&quot;GITHUB_TOKEN&quot;) or os.environ.get(&quot;GH_TOKEN&quot;)
    if token:
        headers[&quot;Authorization&quot;] = f&quot;token {token}&quot;
    req = urllib.request.Request(url, headers=headers)
    with urllib.request.urlopen(req) as resp:
        return resp.read()


def github_api_contents_url(repo: str, path: str, ref: str) -&gt; str:
    return f&quot;https://api.github.com/repos/{repo}/contents/{path}?ref={ref}&quot;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/github_utils/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.system/skill-installer/scripts/github_utils.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.system/skill-installer/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="how_to_guide Imported skill how_to_guide from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/examples/how-to-guide.md Unknown LICENSE.txt sources/openai/how_to_guide/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">how_to_guide</div>
                <button class="copy-btn" onclick="copyToClipboard('how_to_guide')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill how_to_guide from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: How-To Guide from Discussion

**User Request**: &quot;Save our discussion about deploying to production as a how-to guide&quot;

## Workflow

### 1. Extract Content from Chat
From conversation, identified:
- Deployment prerequisites
- Step-by-step procedure
- Common issues and solutions
- Best practices and tips

### 2. Structure as How-To
Organized into:
- Overview &amp; prerequisites
- Numbered deployment steps
- Verification steps
- Troubleshooting section
- Related resources

### 3. Find Location
```
Notion:notion-search
query: &quot;deployment documentation&quot;
```
Found: Engineering Wiki  Deployment section

### 4. Create Guide
```
Notion:notion-create-pages
parent: { page_id: &quot;deployment-section-id&quot; }
```

## Output

```markdown
# How to Deploy to Production

## Overview
Production deployment using GitHub Actions with zero-downtime rolling updates.
**Time Required**: 15-20 minutes | **Complexity**: Intermediate

## Prerequisites
- [ ] PR approved and merged to main
- [ ] All CI tests passing
- [ ] Database migrations reviewed
- [ ] Feature flags configured

## Deployment Steps

1. **Verify main branch is ready**
   ```bash
   git checkout main &amp;&amp; git pull
   ```

2. **Tag release**
   ```bash
   git tag -a v1.2.3 -m &quot;Release v1.2.3&quot;
   git push origin v1.2.3
   ```

3. **Trigger deployment**
   - GitHub Actions auto-starts from tag push
   - Monitor: https://github.com/org/repo/actions

4. **Database migrations** (if needed)
   - Auto-run in GitHub Actions
   - Check logs for completion

5. **Verify deployment**
   - Wait for health checks (2-3 min)
   - Test key endpoints
   - Check error rates in Datadog

## Verification Checklist
- [ ] All pods healthy in k8s dashboard
- [ ] Error rate &lt; 0.1% in last 10 min
- [ ] Response time p95 &lt; 500ms
- [ ] Test login flow
- [ ] Check Slack #alerts channel

## Troubleshooting

**Health checks failing**
 Check pod logs: `kubectl logs -f deployment/api -n production`

**Migration errors**
 Rollback: Revert tag, migrations auto-rollback

**High error rate**
 Emergency rollback: Previous tag auto-deploys via GitHub Actions

## Best Practices
- Deploy during low-traffic hours (2-4am PST)
- Have 2 engineers available
- Monitor for 30 min post-deploy
- Update #engineering Slack with deploy notice

## Related Docs
- &lt;mention-page url=&quot;...&quot;&gt;Rollback Procedure&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Database Migration Guide&lt;/mention-page&gt;
```

### 5. Make Discoverable
```
Notion:notion-update-page
page_id: &quot;engineering-wiki-homepage&quot;
command: &quot;insert_content_after&quot;
```
Added link in Engineering Wiki  How-To Guides section

## Key Success Factors
- Captured tribal knowledge from discussion
- Structured as actionable steps
- Included troubleshooting from experience
- Made discoverable by linking from wiki index
- Added metadata (time, complexity)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/how_to_guide/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/examples/how-to-guide.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="how_to_guide_database Imported skill how_to_guide_database from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/reference/how-to-guide-database.md Unknown LICENSE.txt sources/openai/how_to_guide_database/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">how_to_guide_database</div>
                <button class="copy-btn" onclick="copyToClipboard('how_to_guide_database')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill how_to_guide_database from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># How-To Guide Database

**Purpose**: Procedural documentation for common tasks.

## Schema

| Property | Type | Options | Purpose |
|----------|------|---------|---------|
| **Title** | title | - | &quot;How to [Task]&quot; |
| **Complexity** | select | Beginner, Intermediate, Advanced | Skill level required |
| **Time Required** | number | - | Estimated minutes to complete |
| **Prerequisites** | relation | Links to other guides | Required knowledge |
| **Category** | select | Development, Deployment, Testing, Tools | Task category |
| **Last Tested** | date | - | When procedure was verified |
| **Tags** | multi_select | - | Technology/tool tags |

## Usage

```
Create how-to guides with properties:
{
  &quot;Title&quot;: &quot;How to Set Up Local Development Environment&quot;,
  &quot;Complexity&quot;: &quot;Beginner&quot;,
  &quot;Time Required&quot;: 30,
  &quot;Category&quot;: &quot;Development&quot;,
  &quot;Last Tested&quot;: &quot;2025-10-01&quot;,
  &quot;Tags&quot;: &quot;setup, environment, docker&quot;
}
```

## Best Practices

1. **Use consistent naming**: Always start with &quot;How to...&quot;
2. **Test procedures**: Verify steps work before publishing
3. **Include time estimates**: Help users plan their time
4. **Link prerequisites**: Make dependencies clear
5. **Update regularly**: Re-test procedures when tools/systems change</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/how_to_guide_database/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/reference/how-to-guide-database.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="init_skill Imported skill init_skill from openai openai /a0/tmp/skills_research/openai/skills/.system/skill-creator/scripts/init_skill.py Unknown LICENSE.txt sources/openai/init_skill/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">init_skill</div>
                <button class="copy-btn" onclick="copyToClipboard('init_skill')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill init_skill from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Skill Initializer - Creates a new skill from template

Usage:
    init_skill.py &lt;skill-name&gt; --path &lt;path&gt; [--resources scripts,references,assets] [--examples]

Examples:
    init_skill.py my-new-skill --path skills/public
    init_skill.py my-new-skill --path skills/public --resources scripts,references
    init_skill.py my-api-helper --path skills/private --resources scripts --examples
    init_skill.py custom-skill --path /custom/location
&quot;&quot;&quot;

import argparse
import re
import sys
from pathlib import Path

MAX_SKILL_NAME_LENGTH = 64
ALLOWED_RESOURCES = {&quot;scripts&quot;, &quot;references&quot;, &quot;assets&quot;}

SKILL_TEMPLATE = &quot;&quot;&quot;---
name: {skill_name}
description: [TODO: Complete and informative explanation of what the skill does and when to use it. Include WHEN to use this skill - specific scenarios, file types, or tasks that trigger it.]
---

# {skill_title}

## Overview

[TODO: 1-2 sentences explaining what this skill enables]

## Structuring This Skill

[TODO: Choose the structure that best fits this skill&#x27;s purpose. Common patterns:

**1. Workflow-Based** (best for sequential processes)
- Works well when there are clear step-by-step procedures
- Example: DOCX skill with &quot;Workflow Decision Tree&quot; -&gt; &quot;Reading&quot; -&gt; &quot;Creating&quot; -&gt; &quot;Editing&quot;
- Structure: ## Overview -&gt; ## Workflow Decision Tree -&gt; ## Step 1 -&gt; ## Step 2...

**2. Task-Based** (best for tool collections)
- Works well when the skill offers different operations/capabilities
- Example: PDF skill with &quot;Quick Start&quot; -&gt; &quot;Merge PDFs&quot; -&gt; &quot;Split PDFs&quot; -&gt; &quot;Extract Text&quot;
- Structure: ## Overview -&gt; ## Quick Start -&gt; ## Task Category 1 -&gt; ## Task Category 2...

**3. Reference/Guidelines** (best for standards or specifications)
- Works well for brand guidelines, coding standards, or requirements
- Example: Brand styling with &quot;Brand Guidelines&quot; -&gt; &quot;Colors&quot; -&gt; &quot;Typography&quot; -&gt; &quot;Features&quot;
- Structure: ## Overview -&gt; ## Guidelines -&gt; ## Specifications -&gt; ## Usage...

**4. Capabilities-Based** (best for integrated systems)
- Works well when the skill provides multiple interrelated features
- Example: Product Management with &quot;Core Capabilities&quot; -&gt; numbered capability list
- Structure: ## Overview -&gt; ## Core Capabilities -&gt; ### 1. Feature -&gt; ### 2. Feature...

Patterns can be mixed and matched as needed. Most skills combine patterns (e.g., start with task-based, add workflow for complex operations).

Delete this entire &quot;Structuring This Skill&quot; section when done - it&#x27;s just guidance.]

## [TODO: Replace with the first main section based on chosen structure]

[TODO: Add content here. See examples in existing skills:
- Code samples for technical skills
- Decision trees for complex workflows
- Concrete examples with realistic user requests
- References to scripts/templates/references as needed]

## Resources (optional)

Create only the resource directories this skill actually needs. Delete this section if no resources are required.

### scripts/
Executable code (Python/Bash/etc.) that can be run directly to perform specific operations.

**Examples from other skills:**
- PDF skill: `fill_fillable_fields.py`, `extract_form_field_info.py` - utilities for PDF manipulation
- DOCX skill: `document.py`, `utilities.py` - Python modules for document processing

**Appropriate for:** Python scripts, shell scripts, or any executable code that performs automation, data processing, or specific operations.

**Note:** Scripts may be executed without loading into context, but can still be read by Codex for patching or environment adjustments.

### references/
Documentation and reference material intended to be loaded into context to inform Codex&#x27;s process and thinking.

**Examples from other skills:**
- Product management: `communication.md`, `context_building.md` - detailed workflow guides
- BigQuery: API reference documentation and query examples
- Finance: Schema documentation, company policies

**Appropriate for:** In-depth documentation, API references, database schemas, comprehensive guides, or any detailed information that Codex should reference while working.

### assets/
Files not intended to be loaded into context, but rather used within the output Codex produces.

**Examples from other skills:**
- Brand styling: PowerPoint template files (.pptx), logo files
- Frontend builder: HTML/React boilerplate project directories
- Typography: Font files (.ttf, .woff2)

**Appropriate for:** Templates, boilerplate code, document templates, images, icons, fonts, or any files meant to be copied or used in the final output.

---

**Not every skill requires all three types of resources.**
&quot;&quot;&quot;

EXAMPLE_SCRIPT = &#x27;&#x27;&#x27;#!/usr/bin/env python3
&quot;&quot;&quot;
Example helper script for {skill_name}

This is a placeholder script that can be executed directly.
Replace with actual implementation or delete if not needed.

Example real scripts from other skills:
- pdf/scripts/fill_fillable_fields.py - Fills PDF form fields
- pdf/scripts/convert_pdf_to_images.py - Converts PDF pages to images
&quot;&quot;&quot;

def main():
    print(&quot;This is an example script for {skill_name}&quot;)
    # TODO: Add actual script logic here
    # This could be data processing, file conversion, API calls, etc.

if __name__ == &quot;__main__&quot;:
    main()
&#x27;&#x27;&#x27;

EXAMPLE_REFERENCE = &quot;&quot;&quot;# Reference Documentation for {skill_title}

This is a placeholder for detailed reference documentation.
Replace with actual reference content or delete if not needed.

Example real reference docs from other skills:
- product-management/references/communication.md - Comprehensive guide for status updates
- product-management/references/context_building.md - Deep-dive on gathering context
- bigquery/references/ - API references and query examples

## When Reference Docs Are Useful

Reference docs are ideal for:
- Comprehensive API documentation
- Detailed workflow guides
- Complex multi-step processes
- Information too lengthy for main SKILL.md
- Content that&#x27;s only needed for specific use cases

## Structure Suggestions

### API Reference Example
- Overview
- Authentication
- Endpoints with examples
- Error codes
- Rate limits

### Workflow Guide Example
- Prerequisites
- Step-by-step instructions
- Common patterns
- Troubleshooting
- Best practices
&quot;&quot;&quot;

EXAMPLE_ASSET = &quot;&quot;&quot;# Example Asset File

This placeholder represents where asset files would be stored.
Replace with actual asset files (templates, images, fonts, etc.) or delete if not needed.

Asset files are NOT intended to be loaded into context, but rather used within
the output Codex produces.

Example asset files from other skills:
- Brand guidelines: logo.png, slides_template.pptx
- Frontend builder: hello-world/ directory with HTML/React boilerplate
- Typography: custom-font.ttf, font-family.woff2
- Data: sample_data.csv, test_dataset.json

## Common Asset Types

- Templates: .pptx, .docx, boilerplate directories
- Images: .png, .jpg, .svg, .gif
- Fonts: .ttf, .otf, .woff, .woff2
- Boilerplate code: Project directories, starter files
- Icons: .ico, .svg
- Data files: .csv, .json, .xml, .yaml

Note: This is a text placeholder. Actual assets can be any file type.
&quot;&quot;&quot;


def normalize_skill_name(skill_name):
    &quot;&quot;&quot;Normalize a skill name to lowercase hyphen-case.&quot;&quot;&quot;
    normalized = skill_name.strip().lower()
    normalized = re.sub(r&quot;[^a-z0-9]+&quot;, &quot;-&quot;, normalized)
    normalized = normalized.strip(&quot;-&quot;)
    normalized = re.sub(r&quot;-{2,}&quot;, &quot;-&quot;, normalized)
    return normalized


def title_case_skill_name(skill_name):
    &quot;&quot;&quot;Convert hyphenated skill name to Title Case for display.&quot;&quot;&quot;
    return &quot; &quot;.join(word.capitalize() for word in skill_name.split(&quot;-&quot;))


def parse_resources(raw_resources):
    if not raw_resources:
        return []
    resources = [item.strip() for item in raw_resources.split(&quot;,&quot;) if item.strip()]
    invalid = sorted({item for item in resources if item not in ALLOWED_RESOURCES})
    if invalid:
        allowed = &quot;, &quot;.join(sorted(ALLOWED_RESOURCES))
        print(f&quot;[ERROR] Unknown resource type(s): {&#x27;, &#x27;.join(invalid)}&quot;)
        print(f&quot;   Allowed: {allowed}&quot;)
        sys.exit(1)
    deduped = []
    seen = set()
    for resource in resources:
        if resource not in seen:
            deduped.append(resource)
            seen.add(resource)
    return deduped


def create_resource_dirs(skill_dir, skill_name, skill_title, resources, include_examples):
    for resource in resources:
        resource_dir = skill_dir / resource
        resource_dir.mkdir(exist_ok=True)
        if resource == &quot;scripts&quot;:
            if include_examples:
                example_script = resource_dir / &quot;example.py&quot;
                example_script.write_text(EXAMPLE_SCRIPT.format(skill_name=skill_name))
                example_script.chmod(0o755)
                print(&quot;[OK] Created scripts/example.py&quot;)
            else:
                print(&quot;[OK] Created scripts/&quot;)
        elif resource == &quot;references&quot;:
            if include_examples:
                example_reference = resource_dir / &quot;api_reference.md&quot;
                example_reference.write_text(EXAMPLE_REFERENCE.format(skill_title=skill_title))
                print(&quot;[OK] Created references/api_reference.md&quot;)
            else:
                print(&quot;[OK] Created references/&quot;)
        elif resource == &quot;assets&quot;:
            if include_examples:
                example_asset = resource_dir / &quot;example_asset.txt&quot;
                example_asset.write_text(EXAMPLE_ASSET)
                print(&quot;[OK] Created assets/example_asset.txt&quot;)
            else:
                print(&quot;[OK] Created assets/&quot;)


def init_skill(skill_name, path, resources, include_examples):
    &quot;&quot;&quot;
    Initialize a new skill directory with template SKILL.md.

    Args:
        skill_name: Name of the skill
        path: Path where the skill directory should be created
        resources: Resource directories to create
        include_examples: Whether to create example files in resource directories

    Returns:
        Path to created skill directory, or None if error
    &quot;&quot;&quot;
    # Determine skill directory path
    skill_dir = Path(path).resolve() / skill_name

    # Check if directory already exists
    if skill_dir.exists():
        print(f&quot;[ERROR] Skill directory already exists: {skill_dir}&quot;)
        return None

    # Create skill directory
    try:
        skill_dir.mkdir(parents=True, exist_ok=False)
        print(f&quot;[OK] Created skill directory: {skill_dir}&quot;)
    except Exception as e:
        print(f&quot;[ERROR] Error creating directory: {e}&quot;)
        return None

    # Create SKILL.md from template
    skill_title = title_case_skill_name(skill_name)
    skill_content = SKILL_TEMPLATE.format(skill_name=skill_name, skill_title=skill_title)

    skill_md_path = skill_dir / &quot;SKILL.md&quot;
    try:
        skill_md_path.write_text(skill_content)
        print(&quot;[OK] Created SKILL.md&quot;)
    except Exception as e:
        print(f&quot;[ERROR] Error creating SKILL.md: {e}&quot;)
        return None

    # Create resource directories if requested
    if resources:
        try:
            create_resource_dirs(skill_dir, skill_name, skill_title, resources, include_examples)
        except Exception as e:
            print(f&quot;[ERROR] Error creating resource directories: {e}&quot;)
            return None

    # Print next steps
    print(f&quot;\n[OK] Skill &#x27;{skill_name}&#x27; initialized successfully at {skill_dir}&quot;)
    print(&quot;\nNext steps:&quot;)
    print(&quot;1. Edit SKILL.md to complete the TODO items and update the description&quot;)
    if resources:
        if include_examples:
            print(&quot;2. Customize or delete the example files in scripts/, references/, and assets/&quot;)
        else:
            print(&quot;2. Add resources to scripts/, references/, and assets/ as needed&quot;)
    else:
        print(&quot;2. Create resource directories only if needed (scripts/, references/, assets/)&quot;)
    print(&quot;3. Run the validator when ready to check the skill structure&quot;)

    return skill_dir


def main():
    parser = argparse.ArgumentParser(
        description=&quot;Create a new skill directory with a SKILL.md template.&quot;,
    )
    parser.add_argument(&quot;skill_name&quot;, help=&quot;Skill name (normalized to hyphen-case)&quot;)
    parser.add_argument(&quot;--path&quot;, required=True, help=&quot;Output directory for the skill&quot;)
    parser.add_argument(
        &quot;--resources&quot;,
        default=&quot;&quot;,
        help=&quot;Comma-separated list: scripts,references,assets&quot;,
    )
    parser.add_argument(
        &quot;--examples&quot;,
        action=&quot;store_true&quot;,
        help=&quot;Create example files inside the selected resource directories&quot;,
    )
    args = parser.parse_args()

    raw_skill_name = args.skill_name
    skill_name = normalize_skill_name(raw_skill_name)
    if not skill_name:
        print(&quot;[ERROR] Skill name must include at least one letter or digit.&quot;)
        sys.exit(1)
    if len(skill_name) &gt; MAX_SKILL_NAME_LENGTH:
        print(
            f&quot;[ERROR] Skill name &#x27;{skill_name}&#x27; is too long ({len(skill_name)} characters). &quot;
            f&quot;Maximum is {MAX_SKILL_NAME_LENGTH} characters.&quot;
        )
        sys.exit(1)
    if skill_name != raw_skill_name:
        print(f&quot;Note: Normalized skill name from &#x27;{raw_skill_name}&#x27; to &#x27;{skill_name}&#x27;.&quot;)

    resources = parse_resources(args.resources)
    if args.examples and not resources:
        print(&quot;[ERROR] --examples requires --resources to be set.&quot;)
        sys.exit(1)

    path = args.path

    print(f&quot;Initializing skill: {skill_name}&quot;)
    print(f&quot;   Location: {path}&quot;)
    if resources:
        print(f&quot;   Resources: {&#x27;, &#x27;.join(resources)}&quot;)
        if args.examples:
            print(&quot;   Examples: enabled&quot;)
    else:
        print(&quot;   Resources: none (create as needed)&quot;)
    print()

    result = init_skill(skill_name, path, resources, args.examples)

    if result:
        sys.exit(0)
    else:
        sys.exit(1)


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/init_skill/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.system/skill-creator/scripts/init_skill.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.system/skill-creator/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="inspect_pr_checks Imported skill inspect_pr_checks from openai openai /a0/tmp/skills_research/openai/skills/.curated/gh-fix-ci/scripts/inspect_pr_checks.py Unknown LICENSE.txt sources/openai/inspect_pr_checks/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">inspect_pr_checks</div>
                <button class="copy-btn" onclick="copyToClipboard('inspect_pr_checks')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill inspect_pr_checks from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
from __future__ import annotations

import argparse
import json
import re
import subprocess
import sys
from pathlib import Path
from typing import Any, Iterable, Sequence

FAILURE_CONCLUSIONS = {
    &quot;failure&quot;,
    &quot;cancelled&quot;,
    &quot;timed_out&quot;,
    &quot;action_required&quot;,
}

FAILURE_STATES = {
    &quot;failure&quot;,
    &quot;error&quot;,
    &quot;cancelled&quot;,
    &quot;timed_out&quot;,
    &quot;action_required&quot;,
}

FAILURE_BUCKETS = {&quot;fail&quot;}

FAILURE_MARKERS = (
    &quot;error&quot;,
    &quot;fail&quot;,
    &quot;failed&quot;,
    &quot;traceback&quot;,
    &quot;exception&quot;,
    &quot;assert&quot;,
    &quot;panic&quot;,
    &quot;fatal&quot;,
    &quot;timeout&quot;,
    &quot;segmentation fault&quot;,
)

DEFAULT_MAX_LINES = 160
DEFAULT_CONTEXT_LINES = 30
PENDING_LOG_MARKERS = (
    &quot;still in progress&quot;,
    &quot;log will be available when it is complete&quot;,
)


class GhResult:
    def __init__(self, returncode: int, stdout: str, stderr: str):
        self.returncode = returncode
        self.stdout = stdout
        self.stderr = stderr


def run_gh_command(args: Sequence[str], cwd: Path) -&gt; GhResult:
    process = subprocess.run(
        [&quot;gh&quot;, *args],
        cwd=cwd,
        text=True,
        capture_output=True,
    )
    return GhResult(process.returncode, process.stdout, process.stderr)


def run_gh_command_raw(args: Sequence[str], cwd: Path) -&gt; tuple[int, bytes, str]:
    process = subprocess.run(
        [&quot;gh&quot;, *args],
        cwd=cwd,
        capture_output=True,
    )
    stderr = process.stderr.decode(errors=&quot;replace&quot;)
    return process.returncode, process.stdout, stderr


def parse_args() -&gt; argparse.Namespace:
    parser = argparse.ArgumentParser(
        description=(
            &quot;Inspect failing GitHub PR checks, fetch GitHub Actions logs, and extract a &quot;
            &quot;failure snippet.&quot;
        ),
        formatter_class=argparse.ArgumentDefaultsHelpFormatter,
    )
    parser.add_argument(&quot;--repo&quot;, default=&quot;.&quot;, help=&quot;Path inside the target Git repository.&quot;)
    parser.add_argument(
        &quot;--pr&quot;, default=None, help=&quot;PR number or URL (defaults to current branch PR).&quot;
    )
    parser.add_argument(&quot;--max-lines&quot;, type=int, default=DEFAULT_MAX_LINES)
    parser.add_argument(&quot;--context&quot;, type=int, default=DEFAULT_CONTEXT_LINES)
    parser.add_argument(&quot;--json&quot;, action=&quot;store_true&quot;, help=&quot;Emit JSON instead of text output.&quot;)
    return parser.parse_args()


def main() -&gt; int:
    args = parse_args()
    repo_root = find_git_root(Path(args.repo))
    if repo_root is None:
        print(&quot;Error: not inside a Git repository.&quot;, file=sys.stderr)
        return 1

    if not ensure_gh_available(repo_root):
        return 1

    pr_value = resolve_pr(args.pr, repo_root)
    if pr_value is None:
        return 1

    checks = fetch_checks(pr_value, repo_root)
    if checks is None:
        return 1

    failing = [c for c in checks if is_failing(c)]
    if not failing:
        print(f&quot;PR #{pr_value}: no failing checks detected.&quot;)
        return 0

    results = []
    for check in failing:
        results.append(
            analyze_check(
                check,
                repo_root=repo_root,
                max_lines=max(1, args.max_lines),
                context=max(1, args.context),
            )
        )

    if args.json:
        print(json.dumps({&quot;pr&quot;: pr_value, &quot;results&quot;: results}, indent=2))
    else:
        render_results(pr_value, results)

    return 1


def find_git_root(start: Path) -&gt; Path | None:
    result = subprocess.run(
        [&quot;git&quot;, &quot;rev-parse&quot;, &quot;--show-toplevel&quot;],
        cwd=start,
        text=True,
        capture_output=True,
    )
    if result.returncode != 0:
        return None
    return Path(result.stdout.strip())


def ensure_gh_available(repo_root: Path) -&gt; bool:
    result = run_gh_command([&quot;auth&quot;, &quot;status&quot;], cwd=repo_root)
    if result.returncode == 0:
        return True
    message = (result.stderr or result.stdout or &quot;&quot;).strip()
    print(message or &quot;Error: gh not authenticated.&quot;, file=sys.stderr)
    return False


def resolve_pr(pr_value: str | None, repo_root: Path) -&gt; str | None:
    if pr_value:
        return pr_value
    result = run_gh_command([&quot;pr&quot;, &quot;view&quot;, &quot;--json&quot;, &quot;number&quot;], cwd=repo_root)
    if result.returncode != 0:
        message = (result.stderr or result.stdout or &quot;&quot;).strip()
        print(message or &quot;Error: unable to resolve PR.&quot;, file=sys.stderr)
        return None
    try:
        data = json.loads(result.stdout or &quot;{}&quot;)
    except json.JSONDecodeError:
        print(&quot;Error: unable to parse PR JSON.&quot;, file=sys.stderr)
        return None
    number = data.get(&quot;number&quot;)
    if not number:
        print(&quot;Error: no PR number found.&quot;, file=sys.stderr)
        return None
    return str(number)


def fetch_checks(pr_value: str, repo_root: Path) -&gt; list[dict[str, Any]] | None:
    primary_fields = [&quot;name&quot;, &quot;state&quot;, &quot;conclusion&quot;, &quot;detailsUrl&quot;, &quot;startedAt&quot;, &quot;completedAt&quot;]
    result = run_gh_command(
        [&quot;pr&quot;, &quot;checks&quot;, pr_value, &quot;--json&quot;, &quot;,&quot;.join(primary_fields)],
        cwd=repo_root,
    )
    if result.returncode != 0:
        message = &quot;\n&quot;.join(filter(None, [result.stderr, result.stdout])).strip()
        available_fields = parse_available_fields(message)
        if available_fields:
            fallback_fields = [
                &quot;name&quot;,
                &quot;state&quot;,
                &quot;bucket&quot;,
                &quot;link&quot;,
                &quot;startedAt&quot;,
                &quot;completedAt&quot;,
                &quot;workflow&quot;,
            ]
            selected_fields = [field for field in fallback_fields if field in available_fields]
            if not selected_fields:
                print(&quot;Error: no usable fields available for gh pr checks.&quot;, file=sys.stderr)
                return None
            result = run_gh_command(
                [&quot;pr&quot;, &quot;checks&quot;, pr_value, &quot;--json&quot;, &quot;,&quot;.join(selected_fields)],
                cwd=repo_root,
            )
            if result.returncode != 0:
                message = (result.stderr or result.stdout or &quot;&quot;).strip()
                print(message or &quot;Error: gh pr checks failed.&quot;, file=sys.stderr)
                return None
        else:
            print(message or &quot;Error: gh pr checks failed.&quot;, file=sys.stderr)
            return None
    try:
        data = json.loads(result.stdout or &quot;[]&quot;)
    except json.JSONDecodeError:
        print(&quot;Error: unable to parse checks JSON.&quot;, file=sys.stderr)
        return None
    if not isinstance(data, list):
        print(&quot;Error: unexpected checks JSON shape.&quot;, file=sys.stderr)
        return None
    return data


def is_failing(check: dict[str, Any]) -&gt; bool:
    conclusion = normalize_field(check.get(&quot;conclusion&quot;))
    if conclusion in FAILURE_CONCLUSIONS:
        return True
    state = normalize_field(check.get(&quot;state&quot;) or check.get(&quot;status&quot;))
    if state in FAILURE_STATES:
        return True
    bucket = normalize_field(check.get(&quot;bucket&quot;))
    return bucket in FAILURE_BUCKETS


def analyze_check(
    check: dict[str, Any],
    repo_root: Path,
    max_lines: int,
    context: int,
) -&gt; dict[str, Any]:
    url = check.get(&quot;detailsUrl&quot;) or check.get(&quot;link&quot;) or &quot;&quot;
    run_id = extract_run_id(url)
    job_id = extract_job_id(url)
    base: dict[str, Any] = {
        &quot;name&quot;: check.get(&quot;name&quot;, &quot;&quot;),
        &quot;detailsUrl&quot;: url,
        &quot;runId&quot;: run_id,
        &quot;jobId&quot;: job_id,
    }

    if run_id is None:
        base[&quot;status&quot;] = &quot;external&quot;
        base[&quot;note&quot;] = &quot;No GitHub Actions run id detected in detailsUrl.&quot;
        return base

    metadata = fetch_run_metadata(run_id, repo_root)
    log_text, log_error, log_status = fetch_check_log(
        run_id=run_id,
        job_id=job_id,
        repo_root=repo_root,
    )

    if log_status == &quot;pending&quot;:
        base[&quot;status&quot;] = &quot;log_pending&quot;
        base[&quot;note&quot;] = log_error or &quot;Logs are not available yet.&quot;
        if metadata:
            base[&quot;run&quot;] = metadata
        return base

    if log_error:
        base[&quot;status&quot;] = &quot;log_unavailable&quot;
        base[&quot;error&quot;] = log_error
        if metadata:
            base[&quot;run&quot;] = metadata
        return base

    snippet = extract_failure_snippet(log_text, max_lines=max_lines, context=context)
    base[&quot;status&quot;] = &quot;ok&quot;
    base[&quot;run&quot;] = metadata or {}
    base[&quot;logSnippet&quot;] = snippet
    base[&quot;logTail&quot;] = tail_lines(log_text, max_lines)
    return base


def extract_run_id(url: str) -&gt; str | None:
    if not url:
        return None
    for pattern in (r&quot;/actions/runs/(\d+)&quot;, r&quot;/runs/(\d+)&quot;):
        match = re.search(pattern, url)
        if match:
            return match.group(1)
    return None


def extract_job_id(url: str) -&gt; str | None:
    if not url:
        return None
    match = re.search(r&quot;/actions/runs/\d+/job/(\d+)&quot;, url)
    if match:
        return match.group(1)
    match = re.search(r&quot;/job/(\d+)&quot;, url)
    if match:
        return match.group(1)
    return None


def fetch_run_metadata(run_id: str, repo_root: Path) -&gt; dict[str, Any] | None:
    fields = [
        &quot;conclusion&quot;,
        &quot;status&quot;,
        &quot;workflowName&quot;,
        &quot;name&quot;,
        &quot;event&quot;,
        &quot;headBranch&quot;,
        &quot;headSha&quot;,
        &quot;url&quot;,
    ]
    result = run_gh_command([&quot;run&quot;, &quot;view&quot;, run_id, &quot;--json&quot;, &quot;,&quot;.join(fields)], cwd=repo_root)
    if result.returncode != 0:
        return None
    try:
        data = json.loads(result.stdout or &quot;{}&quot;)
    except json.JSONDecodeError:
        return None
    if not isinstance(data, dict):
        return None
    return data


def fetch_check_log(
    run_id: str,
    job_id: str | None,
    repo_root: Path,
) -&gt; tuple[str, str, str]:
    log_text, log_error = fetch_run_log(run_id, repo_root)
    if not log_error:
        return log_text, &quot;&quot;, &quot;ok&quot;

    if is_log_pending_message(log_error) and job_id:
        job_log, job_error = fetch_job_log(job_id, repo_root)
        if job_log:
            return job_log, &quot;&quot;, &quot;ok&quot;
        if job_error and is_log_pending_message(job_error):
            return &quot;&quot;, job_error, &quot;pending&quot;
        if job_error:
            return &quot;&quot;, job_error, &quot;error&quot;
        return &quot;&quot;, log_error, &quot;pending&quot;

    if is_log_pending_message(log_error):
        return &quot;&quot;, log_error, &quot;pending&quot;

    return &quot;&quot;, log_error, &quot;error&quot;


def fetch_run_log(run_id: str, repo_root: Path) -&gt; tuple[str, str]:
    result = run_gh_command([&quot;run&quot;, &quot;view&quot;, run_id, &quot;--log&quot;], cwd=repo_root)
    if result.returncode != 0:
        error = (result.stderr or result.stdout or &quot;&quot;).strip()
        return &quot;&quot;, error or &quot;gh run view failed&quot;
    return result.stdout, &quot;&quot;


def fetch_job_log(job_id: str, repo_root: Path) -&gt; tuple[str, str]:
    repo_slug = fetch_repo_slug(repo_root)
    if not repo_slug:
        return &quot;&quot;, &quot;Error: unable to resolve repository name for job logs.&quot;
    endpoint = f&quot;/repos/{repo_slug}/actions/jobs/{job_id}/logs&quot;
    returncode, stdout_bytes, stderr = run_gh_command_raw([&quot;api&quot;, endpoint], cwd=repo_root)
    if returncode != 0:
        message = (stderr or stdout_bytes.decode(errors=&quot;replace&quot;)).strip()
        return &quot;&quot;, message or &quot;gh api job logs failed&quot;
    if is_zip_payload(stdout_bytes):
        return &quot;&quot;, &quot;Job logs returned a zip archive; unable to parse.&quot;
    return stdout_bytes.decode(errors=&quot;replace&quot;), &quot;&quot;


def fetch_repo_slug(repo_root: Path) -&gt; str | None:
    result = run_gh_command([&quot;repo&quot;, &quot;view&quot;, &quot;--json&quot;, &quot;nameWithOwner&quot;], cwd=repo_root)
    if result.returncode != 0:
        return None
    try:
        data = json.loads(result.stdout or &quot;{}&quot;)
    except json.JSONDecodeError:
        return None
    name_with_owner = data.get(&quot;nameWithOwner&quot;)
    if not name_with_owner:
        return None
    return str(name_with_owner)


def normalize_field(value: Any) -&gt; str:
    if value is None:
        return &quot;&quot;
    return str(value).strip().lower()


def parse_available_fields(message: str) -&gt; list[str]:
    if &quot;Available fields:&quot; not in message:
        return []
    fields: list[str] = []
    collecting = False
    for line in message.splitlines():
        if &quot;Available fields:&quot; in line:
            collecting = True
            continue
        if not collecting:
            continue
        field = line.strip()
        if not field:
            continue
        fields.append(field)
    return fields


def is_log_pending_message(message: str) -&gt; bool:
    lowered = message.lower()
    return any(marker in lowered for marker in PENDING_LOG_MARKERS)


def is_zip_payload(payload: bytes) -&gt; bool:
    return payload.startswith(b&quot;PK&quot;)


def extract_failure_snippet(log_text: str, max_lines: int, context: int) -&gt; str:
    lines = log_text.splitlines()
    if not lines:
        return &quot;&quot;

    marker_index = find_failure_index(lines)
    if marker_index is None:
        return &quot;\n&quot;.join(lines[-max_lines:])

    start = max(0, marker_index - context)
    end = min(len(lines), marker_index + context)
    window = lines[start:end]
    if len(window) &gt; max_lines:
        window = window[-max_lines:]
    return &quot;\n&quot;.join(window)


def find_failure_index(lines: Sequence[str]) -&gt; int | None:
    for idx in range(len(lines) - 1, -1, -1):
        lowered = lines[idx].lower()
        if any(marker in lowered for marker in FAILURE_MARKERS):
            return idx
    return None


def tail_lines(text: str, max_lines: int) -&gt; str:
    if max_lines &lt;= 0:
        return &quot;&quot;
    lines = text.splitlines()
    return &quot;\n&quot;.join(lines[-max_lines:])


def render_results(pr_number: str, results: Iterable[dict[str, Any]]) -&gt; None:
    results_list = list(results)
    print(f&quot;PR #{pr_number}: {len(results_list)} failing checks analyzed.&quot;)
    for result in results_list:
        print(&quot;-&quot; * 60)
        print(f&quot;Check: {result.get(&#x27;name&#x27;, &#x27;&#x27;)}&quot;)
        if result.get(&quot;detailsUrl&quot;):
            print(f&quot;Details: {result[&#x27;detailsUrl&#x27;]}&quot;)
        run_id = result.get(&quot;runId&quot;)
        if run_id:
            print(f&quot;Run ID: {run_id}&quot;)
        job_id = result.get(&quot;jobId&quot;)
        if job_id:
            print(f&quot;Job ID: {job_id}&quot;)
        status = result.get(&quot;status&quot;, &quot;unknown&quot;)
        print(f&quot;Status: {status}&quot;)

        run_meta = result.get(&quot;run&quot;, {})
        if run_meta:
            branch = run_meta.get(&quot;headBranch&quot;, &quot;&quot;)
            sha = (run_meta.get(&quot;headSha&quot;) or &quot;&quot;)[:12]
            workflow = run_meta.get(&quot;workflowName&quot;) or run_meta.get(&quot;name&quot;) or &quot;&quot;
            conclusion = run_meta.get(&quot;conclusion&quot;) or run_meta.get(&quot;status&quot;) or &quot;&quot;
            print(f&quot;Workflow: {workflow} ({conclusion})&quot;)
            if branch or sha:
                print(f&quot;Branch/SHA: {branch} {sha}&quot;)
            if run_meta.get(&quot;url&quot;):
                print(f&quot;Run URL: {run_meta[&#x27;url&#x27;]}&quot;)

        if result.get(&quot;note&quot;):
            print(f&quot;Note: {result[&#x27;note&#x27;]}&quot;)

        if result.get(&quot;error&quot;):
            print(f&quot;Error fetching logs: {result[&#x27;error&#x27;]}&quot;)
            continue

        snippet = result.get(&quot;logSnippet&quot;) or &quot;&quot;
        if snippet:
            print(&quot;Failure snippet:&quot;)
            print(indent_block(snippet, prefix=&quot;  &quot;))
        else:
            print(&quot;No snippet available.&quot;)
    print(&quot;-&quot; * 60)


def indent_block(text: str, prefix: str = &quot;  &quot;) -&gt; str:
    return &quot;\n&quot;.join(f&quot;{prefix}{line}&quot; for line in text.splitlines())


if __name__ == &quot;__main__&quot;:
    raise SystemExit(main())</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/inspect_pr_checks/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/gh-fix-ci/scripts/inspect_pr_checks.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/gh-fix-ci/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="install_skill_from_github Imported skill install_skill_from_github from openai openai /a0/tmp/skills_research/openai/skills/.system/skill-installer/scripts/install-skill-from-github.py Unknown LICENSE.txt sources/openai/install_skill_from_github/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">install_skill_from_github</div>
                <button class="copy-btn" onclick="copyToClipboard('install_skill_from_github')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill install_skill_from_github from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;Install a skill from a GitHub repo path into $CODEX_HOME/skills.&quot;&quot;&quot;

from __future__ import annotations

import argparse
from dataclasses import dataclass
import os
import shutil
import subprocess
import sys
import tempfile
import urllib.error
import urllib.parse
import zipfile

from github_utils import github_request
DEFAULT_REF = &quot;main&quot;


@dataclass
class Args:
    url: str | None = None
    repo: str | None = None
    path: list[str] | None = None
    ref: str = DEFAULT_REF
    dest: str | None = None
    name: str | None = None
    method: str = &quot;auto&quot;


@dataclass
class Source:
    owner: str
    repo: str
    ref: str
    paths: list[str]
    repo_url: str | None = None


class InstallError(Exception):
    pass


def _codex_home() -&gt; str:
    return os.environ.get(&quot;CODEX_HOME&quot;, os.path.expanduser(&quot;~/.codex&quot;))


def _tmp_root() -&gt; str:
    base = os.path.join(tempfile.gettempdir(), &quot;codex&quot;)
    os.makedirs(base, exist_ok=True)
    return base


def _request(url: str) -&gt; bytes:
    return github_request(url, &quot;codex-skill-install&quot;)


def _parse_github_url(url: str, default_ref: str) -&gt; tuple[str, str, str, str | None]:
    parsed = urllib.parse.urlparse(url)
    if parsed.netloc != &quot;github.com&quot;:
        raise InstallError(&quot;Only GitHub URLs are supported for download mode.&quot;)
    parts = [p for p in parsed.path.split(&quot;/&quot;) if p]
    if len(parts) &lt; 2:
        raise InstallError(&quot;Invalid GitHub URL.&quot;)
    owner, repo = parts[0], parts[1]
    ref = default_ref
    subpath = &quot;&quot;
    if len(parts) &gt; 2:
        if parts[2] in (&quot;tree&quot;, &quot;blob&quot;):
            if len(parts) &lt; 4:
                raise InstallError(&quot;GitHub URL missing ref or path.&quot;)
            ref = parts[3]
            subpath = &quot;/&quot;.join(parts[4:])
        else:
            subpath = &quot;/&quot;.join(parts[2:])
    return owner, repo, ref, subpath or None


def _download_repo_zip(owner: str, repo: str, ref: str, dest_dir: str) -&gt; str:
    zip_url = f&quot;https://codeload.github.com/{owner}/{repo}/zip/{ref}&quot;
    zip_path = os.path.join(dest_dir, &quot;repo.zip&quot;)
    try:
        payload = _request(zip_url)
    except urllib.error.HTTPError as exc:
        raise InstallError(f&quot;Download failed: HTTP {exc.code}&quot;) from exc
    with open(zip_path, &quot;wb&quot;) as file_handle:
        file_handle.write(payload)
    with zipfile.ZipFile(zip_path, &quot;r&quot;) as zip_file:
        _safe_extract_zip(zip_file, dest_dir)
        top_levels = {name.split(&quot;/&quot;)[0] for name in zip_file.namelist() if name}
    if not top_levels:
        raise InstallError(&quot;Downloaded archive was empty.&quot;)
    if len(top_levels) != 1:
        raise InstallError(&quot;Unexpected archive layout.&quot;)
    return os.path.join(dest_dir, next(iter(top_levels)))


def _run_git(args: list[str]) -&gt; None:
    result = subprocess.run(args, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
    if result.returncode != 0:
        raise InstallError(result.stderr.strip() or &quot;Git command failed.&quot;)


def _safe_extract_zip(zip_file: zipfile.ZipFile, dest_dir: str) -&gt; None:
    dest_root = os.path.realpath(dest_dir)
    for info in zip_file.infolist():
        extracted_path = os.path.realpath(os.path.join(dest_dir, info.filename))
        if extracted_path == dest_root or extracted_path.startswith(dest_root + os.sep):
            continue
        raise InstallError(&quot;Archive contains files outside the destination.&quot;)
    zip_file.extractall(dest_dir)


def _validate_relative_path(path: str) -&gt; None:
    if os.path.isabs(path) or os.path.normpath(path).startswith(&quot;..&quot;):
        raise InstallError(&quot;Skill path must be a relative path inside the repo.&quot;)


def _validate_skill_name(name: str) -&gt; None:
    altsep = os.path.altsep
    if not name or os.path.sep in name or (altsep and altsep in name):
        raise InstallError(&quot;Skill name must be a single path segment.&quot;)
    if name in (&quot;.&quot;, &quot;..&quot;):
        raise InstallError(&quot;Invalid skill name.&quot;)


def _git_sparse_checkout(repo_url: str, ref: str, paths: list[str], dest_dir: str) -&gt; str:
    repo_dir = os.path.join(dest_dir, &quot;repo&quot;)
    clone_cmd = [
        &quot;git&quot;,
        &quot;clone&quot;,
        &quot;--filter=blob:none&quot;,
        &quot;--depth&quot;,
        &quot;1&quot;,
        &quot;--sparse&quot;,
        &quot;--single-branch&quot;,
        &quot;--branch&quot;,
        ref,
        repo_url,
        repo_dir,
    ]
    try:
        _run_git(clone_cmd)
    except InstallError:
        _run_git(
            [
                &quot;git&quot;,
                &quot;clone&quot;,
                &quot;--filter=blob:none&quot;,
                &quot;--depth&quot;,
                &quot;1&quot;,
                &quot;--sparse&quot;,
                &quot;--single-branch&quot;,
                repo_url,
                repo_dir,
            ]
        )
    _run_git([&quot;git&quot;, &quot;-C&quot;, repo_dir, &quot;sparse-checkout&quot;, &quot;set&quot;, *paths])
    _run_git([&quot;git&quot;, &quot;-C&quot;, repo_dir, &quot;checkout&quot;, ref])
    return repo_dir


def _validate_skill(path: str) -&gt; None:
    if not os.path.isdir(path):
        raise InstallError(f&quot;Skill path not found: {path}&quot;)
    skill_md = os.path.join(path, &quot;SKILL.md&quot;)
    if not os.path.isfile(skill_md):
        raise InstallError(&quot;SKILL.md not found in selected skill directory.&quot;)


def _copy_skill(src: str, dest_dir: str) -&gt; None:
    os.makedirs(os.path.dirname(dest_dir), exist_ok=True)
    if os.path.exists(dest_dir):
        raise InstallError(f&quot;Destination already exists: {dest_dir}&quot;)
    shutil.copytree(src, dest_dir)


def _build_repo_url(owner: str, repo: str) -&gt; str:
    return f&quot;https://github.com/{owner}/{repo}.git&quot;


def _build_repo_ssh(owner: str, repo: str) -&gt; str:
    return f&quot;git@github.com:{owner}/{repo}.git&quot;


def _prepare_repo(source: Source, method: str, tmp_dir: str) -&gt; str:
    if method in (&quot;download&quot;, &quot;auto&quot;):
        try:
            return _download_repo_zip(source.owner, source.repo, source.ref, tmp_dir)
        except InstallError as exc:
            if method == &quot;download&quot;:
                raise
            err_msg = str(exc)
            if &quot;HTTP 401&quot; in err_msg or &quot;HTTP 403&quot; in err_msg or &quot;HTTP 404&quot; in err_msg:
                pass
            else:
                raise
    if method in (&quot;git&quot;, &quot;auto&quot;):
        repo_url = source.repo_url or _build_repo_url(source.owner, source.repo)
        try:
            return _git_sparse_checkout(repo_url, source.ref, source.paths, tmp_dir)
        except InstallError:
            repo_url = _build_repo_ssh(source.owner, source.repo)
            return _git_sparse_checkout(repo_url, source.ref, source.paths, tmp_dir)
    raise InstallError(&quot;Unsupported method.&quot;)


def _resolve_source(args: Args) -&gt; Source:
    if args.url:
        owner, repo, ref, url_path = _parse_github_url(args.url, args.ref)
        if args.path is not None:
            paths = list(args.path)
        elif url_path:
            paths = [url_path]
        else:
            paths = []
        if not paths:
            raise InstallError(&quot;Missing --path for GitHub URL.&quot;)
        return Source(owner=owner, repo=repo, ref=ref, paths=paths)

    if not args.repo:
        raise InstallError(&quot;Provide --repo or --url.&quot;)
    if &quot;://&quot; in args.repo:
        return _resolve_source(
            Args(url=args.repo, repo=None, path=args.path, ref=args.ref)
        )

    repo_parts = [p for p in args.repo.split(&quot;/&quot;) if p]
    if len(repo_parts) != 2:
        raise InstallError(&quot;--repo must be in owner/repo format.&quot;)
    if not args.path:
        raise InstallError(&quot;Missing --path for --repo.&quot;)
    paths = list(args.path)
    return Source(
        owner=repo_parts[0],
        repo=repo_parts[1],
        ref=args.ref,
        paths=paths,
    )


def _default_dest() -&gt; str:
    return os.path.join(_codex_home(), &quot;skills&quot;)


def _parse_args(argv: list[str]) -&gt; Args:
    parser = argparse.ArgumentParser(description=&quot;Install a skill from GitHub.&quot;)
    parser.add_argument(&quot;--repo&quot;, help=&quot;owner/repo&quot;)
    parser.add_argument(&quot;--url&quot;, help=&quot;https://github.com/owner/repo[/tree/ref/path]&quot;)
    parser.add_argument(
        &quot;--path&quot;,
        nargs=&quot;+&quot;,
        help=&quot;Path(s) to skill(s) inside repo&quot;,
    )
    parser.add_argument(&quot;--ref&quot;, default=DEFAULT_REF)
    parser.add_argument(&quot;--dest&quot;, help=&quot;Destination skills directory&quot;)
    parser.add_argument(
        &quot;--name&quot;, help=&quot;Destination skill name (defaults to basename of path)&quot;
    )
    parser.add_argument(
        &quot;--method&quot;,
        choices=[&quot;auto&quot;, &quot;download&quot;, &quot;git&quot;],
        default=&quot;auto&quot;,
    )
    return parser.parse_args(argv, namespace=Args())


def main(argv: list[str]) -&gt; int:
    args = _parse_args(argv)
    try:
        source = _resolve_source(args)
        source.ref = source.ref or args.ref
        if not source.paths:
            raise InstallError(&quot;No skill paths provided.&quot;)
        for path in source.paths:
            _validate_relative_path(path)
        dest_root = args.dest or _default_dest()
        tmp_dir = tempfile.mkdtemp(prefix=&quot;skill-install-&quot;, dir=_tmp_root())
        try:
            repo_root = _prepare_repo(source, args.method, tmp_dir)
            installed = []
            for path in source.paths:
                skill_name = args.name if len(source.paths) == 1 else None
                skill_name = skill_name or os.path.basename(path.rstrip(&quot;/&quot;))
                _validate_skill_name(skill_name)
                if not skill_name:
                    raise InstallError(&quot;Unable to derive skill name.&quot;)
                dest_dir = os.path.join(dest_root, skill_name)
                if os.path.exists(dest_dir):
                    raise InstallError(f&quot;Destination already exists: {dest_dir}&quot;)
                skill_src = os.path.join(repo_root, path)
                _validate_skill(skill_src)
                _copy_skill(skill_src, dest_dir)
                installed.append((skill_name, dest_dir))
        finally:
            if os.path.isdir(tmp_dir):
                shutil.rmtree(tmp_dir, ignore_errors=True)
        for skill_name, dest_dir in installed:
            print(f&quot;Installed {skill_name} to {dest_dir}&quot;)
        return 0
    except InstallError as exc:
        print(f&quot;Error: {exc}&quot;, file=sys.stderr)
        return 1


if __name__ == &quot;__main__&quot;:
    raise SystemExit(main(sys.argv[1:]))</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/install_skill_from_github/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.system/skill-installer/scripts/install-skill-from-github.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.system/skill-installer/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="learning_database Imported skill learning_database from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/reference/learning-database.md Unknown LICENSE.txt sources/openai/learning_database/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">learning_database</div>
                <button class="copy-btn" onclick="copyToClipboard('learning_database')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill learning_database from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Learning/Post-Mortem Database

**Purpose**: Capture learnings from incidents, projects, or experiences.

## Schema

| Property | Type | Options | Purpose |
|----------|------|---------|---------|
| **Title** | title | - | Event or project name |
| **Date** | date | - | When it happened |
| **Type** | select | Incident, Project, Experiment, Retrospective | Learning type |
| **Severity** | select | Critical, Major, Minor | Impact level (for incidents) |
| **Team** | people | - | Who was involved |
| **Key Learnings** | number | - | Count of learnings |
| **Action Items** | relation | Links to tasks | Follow-up actions |

## Content Template

Each learning page should include:
- **What Happened**: Situation description
- **What Went Well**: Success factors
- **What Didn&#x27;t Go Well**: Problems encountered
- **Root Causes**: Why things happened
- **Learnings**: Key takeaways
- **Action Items**: Improvements to implement

## Best Practices

1. **Blameless approach**: Focus on systems and processes, not individuals
2. **Document quickly**: Capture while memory is fresh
3. **Identify root causes**: Go beyond surface-level problems
4. **Create action items**: Turn learnings into improvements
5. **Follow up**: Track that action items are completed
6. **Share widely**: Make learnings accessible to entire team</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/learning_database/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/reference/learning-database.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="license Imported skill license from openai openai /a0/tmp/skills_research/openai/skills/.curated/gh-address-comments/LICENSE.txt Unknown LICENSE.txt sources/openai/license/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">license</div>
                <button class="copy-btn" onclick="copyToClipboard('license')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill license from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      &quot;License&quot; shall mean the terms and conditions for use, reproduction,
      and distribution as defined by Sections 1 through 9 of this document.

      &quot;Licensor&quot; shall mean the copyright owner or entity authorized by
      the copyright owner that is granting the License.

      &quot;Legal Entity&quot; shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under common
      control with that entity. For the purposes of this definition,
      &quot;control&quot; means (i) the power, direct or indirect, to cause the
      direction or management of such entity, whether by contract or
      otherwise, or (ii) ownership of fifty percent (50%) or more of the
      outstanding shares, or (iii) beneficial ownership of such entity.

      &quot;You&quot; (or &quot;Your&quot;) shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      &quot;Source&quot; form shall mean the preferred form for making modifications,
      including but not limited to software source code, documentation
      source, and configuration files.

      &quot;Object&quot; form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      &quot;Work&quot; shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      &quot;Derivative Works&quot; shall mean any work, whether in Source or Object
      form, that is based on (or derived from) the Work and for which the
      editorial revisions, annotations, elaborations, or other modifications
      represent, as a whole, an original work of authorship. For the purposes
      of this License, Derivative Works shall not include works that remain
      separable from, or merely link (or bind by name) to the interfaces of,
      the Work and Derivative Works thereof.

      &quot;Contribution&quot; shall mean any work of authorship, including
      the original version of the Work and any modifications or additions
      to that Work or Derivative Works thereof, that is intentionally
      submitted to Licensor for inclusion in the Work by the copyright owner
      or by an individual or Legal Entity authorized to submit on behalf of
      the copyright owner. For the purposes of this definition, &quot;submitted&quot;
      means any form of electronic, verbal, or written communication sent
      to the Licensor or its representatives, including but not limited to
      communication on electronic mailing lists, source code control systems,
      and issue tracking systems that are managed by, or on behalf of, the
      Licensor for the purpose of discussing and improving the Work, but
      excluding communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as &quot;Not a Contribution.&quot;

      &quot;Contributor&quot; shall mean Licensor and any individual or Legal Entity
      on behalf of whom a Contribution has been received by Licensor and
      subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      copyright license to reproduce, prepare Derivative Works of,
      publicly display, publicly perform, sublicense, and distribute the
      Work and such Derivative Works in Source or Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have made,
      use, offer to sell, sell, import, and otherwise transfer the Work,
      where such license applies only to those patent claims licensable
      by such Contributor that are necessarily infringed by their
      Contribution(s) alone or by combination of their Contribution(s)
      with the Work to which such Contribution(s) was submitted. If You
      institute patent litigation against any entity (including a
      cross-claim or counterclaim in a lawsuit) alleging that the Work
      or a Contribution incorporated within the Work constitutes direct
      or contributory patent infringement, then any patent licenses
      granted to You under this License for that Work shall terminate
      as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a &quot;NOTICE&quot; text file as part of its
          distribution, then any Derivative Works that You distribute must
          include a readable copy of the attribution notices contained
          within such NOTICE file, excluding those notices that do not
          pertain to any part of the Derivative Works, in at least one
          of the following places: within a NOTICE text file distributed
          as part of the Derivative Works; within the Source form or
          documentation, if provided along with the Derivative Works; or,
          within a display generated by the Derivative Works, if and
          wherever such third-party notices normally appear. The contents
          of the NOTICE file are for informational purposes only and
          do not modify the License. You may add Your own attribution
          notices within Derivative Works that You distribute, alongside
          or as an addendum to the NOTICE text from the Work, provided
          that such additional attribution notices cannot be construed
          as modifying the License.

      You may add Your own copyright statement to Your modifications and
      may provide additional or different license terms and conditions
      for use, reproduction, or distribution of Your modifications, or
      for any such Derivative Works as a whole, provided Your use,
      reproduction, and distribution of the Work otherwise complies with
      the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state otherwise,
      any Contribution intentionally submitted for inclusion in the Work
      by You to the Licensor shall be under the terms and conditions of
      this License, without any additional terms or conditions.
      Notwithstanding the above, nothing herein shall supersede or modify
      the terms of any separate license agreement you may have executed
      with Licensor regarding such Contributions.

   6. Trademarks. This License does not grant permission to use the trade
      names, trademarks, service marks, or product names of the Licensor,
      except as required for reasonable and customary use in describing the
      origin of the Work and reproducing the content of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an &quot;AS IS&quot; BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or conditions
      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
      PARTICULAR PURPOSE. You are solely responsible for determining the
      appropriateness of using or redistributing the Work and assume any
      risks associated with Your exercise of permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
      liable to You for damages, including any direct, indirect, special,
      incidental, or consequential damages of any character arising as a
      result of this License or out of the use or inability to use the
      Work (including but not limited to damages for loss of goodwill,
      work stoppage, computer failure or malfunction, or any and all
      other commercial damages or losses), even if such Contributor
      has been advised of the possibility of such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by reason
      of your accepting any such warranty or additional liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets &quot;[]&quot;
      replaced with your own identifying information. (Don&#x27;t include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same &quot;printed page&quot; as the copyright notice for easier
      identification within third-party archives.

   Copyright [yyyy] [name of copyright owner]

   Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/license/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/gh-address-comments/LICENSE.txt" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/gh-address-comments/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="list_skills Imported skill list_skills from openai openai /a0/tmp/skills_research/openai/skills/.system/skill-installer/scripts/list-skills.py Unknown LICENSE.txt sources/openai/list_skills/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">list_skills</div>
                <button class="copy-btn" onclick="copyToClipboard('list_skills')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill list_skills from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;List skills from a GitHub repo path.&quot;&quot;&quot;

from __future__ import annotations

import argparse
import json
import os
import sys
import urllib.error

from github_utils import github_api_contents_url, github_request

DEFAULT_REPO = &quot;openai/skills&quot;
DEFAULT_PATH = &quot;skills/.curated&quot;
DEFAULT_REF = &quot;main&quot;


class ListError(Exception):
    pass


class Args(argparse.Namespace):
    repo: str
    path: str
    ref: str
    format: str


def _request(url: str) -&gt; bytes:
    return github_request(url, &quot;codex-skill-list&quot;)


def _codex_home() -&gt; str:
    return os.environ.get(&quot;CODEX_HOME&quot;, os.path.expanduser(&quot;~/.codex&quot;))


def _installed_skills() -&gt; set[str]:
    root = os.path.join(_codex_home(), &quot;skills&quot;)
    if not os.path.isdir(root):
        return set()
    entries = set()
    for name in os.listdir(root):
        path = os.path.join(root, name)
        if os.path.isdir(path):
            entries.add(name)
    return entries


def _list_skills(repo: str, path: str, ref: str) -&gt; list[str]:
    api_url = github_api_contents_url(repo, path, ref)
    try:
        payload = _request(api_url)
    except urllib.error.HTTPError as exc:
        if exc.code == 404:
            raise ListError(
                &quot;Skills path not found: &quot;
                f&quot;https://github.com/{repo}/tree/{ref}/{path}&quot;
            ) from exc
        raise ListError(f&quot;Failed to fetch skills: HTTP {exc.code}&quot;) from exc
    data = json.loads(payload.decode(&quot;utf-8&quot;))
    if not isinstance(data, list):
        raise ListError(&quot;Unexpected skills listing response.&quot;)
    skills = [item[&quot;name&quot;] for item in data if item.get(&quot;type&quot;) == &quot;dir&quot;]
    return sorted(skills)


def _parse_args(argv: list[str]) -&gt; Args:
    parser = argparse.ArgumentParser(description=&quot;List skills.&quot;)
    parser.add_argument(&quot;--repo&quot;, default=DEFAULT_REPO)
    parser.add_argument(
        &quot;--path&quot;,
        default=DEFAULT_PATH,
        help=&quot;Repo path to list (default: skills/.curated)&quot;,
    )
    parser.add_argument(&quot;--ref&quot;, default=DEFAULT_REF)
    parser.add_argument(
        &quot;--format&quot;,
        choices=[&quot;text&quot;, &quot;json&quot;],
        default=&quot;text&quot;,
        help=&quot;Output format&quot;,
    )
    return parser.parse_args(argv, namespace=Args())


def main(argv: list[str]) -&gt; int:
    args = _parse_args(argv)
    try:
        skills = _list_skills(args.repo, args.path, args.ref)
        installed = _installed_skills()
        if args.format == &quot;json&quot;:
            payload = [
                {&quot;name&quot;: name, &quot;installed&quot;: name in installed} for name in skills
            ]
            print(json.dumps(payload))
        else:
            for idx, name in enumerate(skills, start=1):
                suffix = &quot; (already installed)&quot; if name in installed else &quot;&quot;
                print(f&quot;{idx}. {name}{suffix}&quot;)
        return 0
    except ListError as exc:
        print(f&quot;Error: {exc}&quot;, file=sys.stderr)
        return 1


if __name__ == &quot;__main__&quot;:
    raise SystemExit(main(sys.argv[1:]))</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/list_skills/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.system/skill-installer/scripts/list-skills.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.system/skill-installer/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="market_research Imported skill market_research from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/examples/market-research.md Unknown LICENSE.txt sources/openai/market_research/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">market_research</div>
                <button class="copy-btn" onclick="copyToClipboard('market_research')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill market_research from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: Market Research

**User Request**: &quot;Research the current state of AI coding assistants market and create a summary document in Notion&quot;

## Workflow

### 1. Search
```
Notion:notion-search
query: &quot;AI coding assistants market&quot;
```
Found 3 relevant pages across Engineering, Strategy, and Product teamspaces.

### 2. Fetch &amp; Analyze
```
Notion:notion-fetch (3x)
```
Extracted market size, competitive landscape, technology trends from source pages.

### 3. Create Documentation
```
Notion:notion-create-pages
```

## Output (Condensed)

```markdown
# AI Coding Assistants Market Research - Oct 2025

## Executive Summary
The AI coding assistant market is experiencing 150%+ YoY growth. GitHub Copilot dominates with 60% share, but specialized tools are gaining traction in specific niches.

## Key Findings

### Market Size and Growth
$800M in 2024  $2.5B projected by 2026. Developer adoption: 23% (2023)  47% (2024).
Source: &lt;mention-page url=&quot;...&quot;&gt;Market Trends Q3 2025&lt;/mention-page&gt;

### Competitive Landscape
- GitHub Copilot: 60% (strong IDE integration)
- Cursor: 15% (rapid growth, full IDE)
- Tabnine: 10% (enterprise, on-premise)
- Cody: 5% (codebase-aware)
- CodeWhisperer: 8% (AWS integration)
Source: &lt;mention-page url=&quot;...&quot;&gt;AI Tools Competitive Analysis&lt;/mention-page&gt;

### Technology Trends
Key differentiators: context awareness, customization, multi-modal interfaces, code verification.
Source: &lt;mention-page url=&quot;...&quot;&gt;Developer Tools Landscape&lt;/mention-page&gt;

## Next Steps
1. Monitor Cursor growth and feature releases
2. Evaluate Cody&#x27;s codebase-aware capabilities
3. Document enterprise security/compliance requirements
4. Track pricing trends
```

## Key Takeaways
- Found relevant pages across multiple teamspaces
- Synthesized competitive, market, and technical perspectives
- Used proper citations linking to source pages
- Created actionable recommendations</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/market_research/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/examples/market-research.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="milestone_summary_template Imported skill milestone_summary_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/reference/milestone-summary-template.md Unknown LICENSE.txt sources/openai/milestone_summary_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">milestone_summary_template</div>
                <button class="copy-btn" onclick="copyToClipboard('milestone_summary_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill milestone_summary_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Milestone Summary Template

Use this when completing major phases or milestones.

```markdown
## Phase [N] Complete: [Date]

### Accomplishments
- [Major item delivered]
- [Major item delivered]

### Deliverables
- &lt;mention-page url=&quot;...&quot;&gt;Deliverable 1&lt;/mention-page&gt;
- [Link to PR/deployment]

### Metrics
- [Relevant metric]
- [Relevant metric]

### Learnings
- [What went well]
- [What to improve]

### Next Phase
Starting [Phase name] on [Date]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/milestone_summary_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/reference/milestone-summary-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="one_on_one_template Imported skill one_on_one_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/reference/one-on-one-template.md Unknown LICENSE.txt sources/openai/one_on_one_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">one_on_one_template</div>
                <button class="copy-btn" onclick="copyToClipboard('one_on_one_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill one_on_one_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># 1:1 Meeting Template

Use this template for manager/report one-on-one meetings.

```markdown
# 1:1: [Manager] &amp; [Report] - [Date]

## Meeting Details
**Date**: [Date]
**Last meeting**: &lt;mention-page url=&quot;...&quot;&gt;Previous 1:1&lt;/mention-page&gt;

## Agenda

### [Report]&#x27;s Topics
1. [Topic to discuss]
2. [Question or concern]

### [Manager]&#x27;s Topics
1. [Topic to cover]
2. [Feedback or update]

## Discussion Notes

### [Topic 1]
[Discussion points]

**Action items**:
- [ ] [Action] - @[Owner]

### [Topic 2]
[Discussion points]

## Career Development

**Current focus**: [Development goal]
**Progress**: [Update on progress]

## Feedback

**What&#x27;s going well**:
- [Positive feedback]

**Areas for growth**:
- [Developmental feedback]

## Action Items

- [ ] [Action] - @[Report] - Due: [Date]
- [ ] [Action] - @[Manager] - Due: [Date]

## Next Meeting

**Date**: [Date]
**Topics to cover**:
- [Carry-over topic]
- [Upcoming topic]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/one_on_one_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/reference/one-on-one-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="package_skill Imported skill package_skill from openai openai /a0/tmp/skills_research/openai/skills/.system/skill-creator/scripts/package_skill.py Unknown LICENSE.txt sources/openai/package_skill/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">package_skill</div>
                <button class="copy-btn" onclick="copyToClipboard('package_skill')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill package_skill from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Skill Packager - Creates a distributable .skill file of a skill folder

Usage:
    python utils/package_skill.py &lt;path/to/skill-folder&gt; [output-directory]

Example:
    python utils/package_skill.py skills/public/my-skill
    python utils/package_skill.py skills/public/my-skill ./dist
&quot;&quot;&quot;

import sys
import zipfile
from pathlib import Path

from quick_validate import validate_skill


def package_skill(skill_path, output_dir=None):
    &quot;&quot;&quot;
    Package a skill folder into a .skill file.

    Args:
        skill_path: Path to the skill folder
        output_dir: Optional output directory for the .skill file (defaults to current directory)

    Returns:
        Path to the created .skill file, or None if error
    &quot;&quot;&quot;
    skill_path = Path(skill_path).resolve()

    # Validate skill folder exists
    if not skill_path.exists():
        print(f&quot;[ERROR] Skill folder not found: {skill_path}&quot;)
        return None

    if not skill_path.is_dir():
        print(f&quot;[ERROR] Path is not a directory: {skill_path}&quot;)
        return None

    # Validate SKILL.md exists
    skill_md = skill_path / &quot;SKILL.md&quot;
    if not skill_md.exists():
        print(f&quot;[ERROR] SKILL.md not found in {skill_path}&quot;)
        return None

    # Run validation before packaging
    print(&quot;Validating skill...&quot;)
    valid, message = validate_skill(skill_path)
    if not valid:
        print(f&quot;[ERROR] Validation failed: {message}&quot;)
        print(&quot;   Please fix the validation errors before packaging.&quot;)
        return None
    print(f&quot;[OK] {message}\n&quot;)

    # Determine output location
    skill_name = skill_path.name
    if output_dir:
        output_path = Path(output_dir).resolve()
        output_path.mkdir(parents=True, exist_ok=True)
    else:
        output_path = Path.cwd()

    skill_filename = output_path / f&quot;{skill_name}.skill&quot;

    # Create the .skill file (zip format)
    try:
        with zipfile.ZipFile(skill_filename, &quot;w&quot;, zipfile.ZIP_DEFLATED) as zipf:
            # Walk through the skill directory
            for file_path in skill_path.rglob(&quot;*&quot;):
                if file_path.is_file():
                    # Calculate the relative path within the zip
                    arcname = file_path.relative_to(skill_path.parent)
                    zipf.write(file_path, arcname)
                    print(f&quot;  Added: {arcname}&quot;)

        print(f&quot;\n[OK] Successfully packaged skill to: {skill_filename}&quot;)
        return skill_filename

    except Exception as e:
        print(f&quot;[ERROR] Error creating .skill file: {e}&quot;)
        return None


def main():
    if len(sys.argv) &lt; 2:
        print(&quot;Usage: python utils/package_skill.py &lt;path/to/skill-folder&gt; [output-directory]&quot;)
        print(&quot;\nExample:&quot;)
        print(&quot;  python utils/package_skill.py skills/public/my-skill&quot;)
        print(&quot;  python utils/package_skill.py skills/public/my-skill ./dist&quot;)
        sys.exit(1)

    skill_path = sys.argv[1]
    output_dir = sys.argv[2] if len(sys.argv) &gt; 2 else None

    print(f&quot;Packaging skill: {skill_path}&quot;)
    if output_dir:
        print(f&quot;   Output directory: {output_dir}&quot;)
    print()

    result = package_skill(skill_path, output_dir)

    if result:
        sys.exit(0)
    else:
        sys.exit(1)


if __name__ == &quot;__main__&quot;:
    main()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/package_skill/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.system/skill-creator/scripts/package_skill.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.system/skill-creator/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="progress_tracking Imported skill progress_tracking from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/reference/progress-tracking.md Unknown LICENSE.txt sources/openai/progress_tracking/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">progress_tracking</div>
                <button class="copy-btn" onclick="copyToClipboard('progress_tracking')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill progress_tracking from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Progress Tracking

## Update Frequency

### Daily Updates

For active implementation work:

**What to update**:
- Task status if changed
- Add progress note to task
- Update blockers

**When**:
- End of work day
- After completing significant work
- When encountering blockers

### Milestone Updates

For phase/milestone completion:

**What to update**:
- Mark phase complete in plan
- Add milestone summary
- Update timeline if needed
- Report to stakeholders

**When**:
- Phase completion
- Major deliverable ready
- Sprint end
- Release

### Status Change Updates

For task state transitions:

**What to update**:
- Task status property
- Add transition note
- Notify relevant people

**When**:
- Start work (To Do  In Progress)
- Ready for review (In Progress  In Review)
- Complete (In Review  Done)
- Block (Any  Blocked)

## Progress Note Format

### Daily Progress Note

```markdown
## Progress: [Date]

### Completed
- [Specific accomplishment with details]
- [Specific accomplishment with details]

### In Progress
- [Current work item]
- Current status: [Percentage or description]

### Next Steps
1. [Next planned action]
2. [Next planned action]

### Blockers
- [Blocker description and who/what needed to unblock]
- Or: None

### Decisions Made
- [Any technical/product decisions]

### Notes
[Additional context, learnings, issues encountered]
```

Example:

```markdown
## Progress: Oct 14, 2025

### Completed
- Implemented user authentication API endpoints (login, logout, refresh)
- Added JWT token generation and validation
- Wrote unit tests for auth service (95% coverage)

### In Progress
- Frontend login form integration
- Currently: Form submits but need to handle error states

### Next Steps
1. Complete error handling in login form
2. Add loading states
3. Implement &quot;remember me&quot; functionality

### Blockers
None

### Decisions Made
- Using HttpOnly cookies for refresh tokens (more secure than localStorage)
- Session timeout set to 24 hours based on security review

### Notes
- Found edge case with concurrent login attempts, added to backlog
- Performance of auth check is good (&lt;10ms)
```

### Milestone Summary

```markdown
## Phase [N] Complete: [Date]

### Overview
[Brief description of what was accomplished in this phase]

### Completed Tasks
- &lt;mention-page url=&quot;...&quot;&gt;Task 1&lt;/mention-page&gt; 
- &lt;mention-page url=&quot;...&quot;&gt;Task 2&lt;/mention-page&gt; 
- &lt;mention-page url=&quot;...&quot;&gt;Task 3&lt;/mention-page&gt; 

### Deliverables
- [Deliverable 1]: [Link/description]
- [Deliverable 2]: [Link/description]

### Key Accomplishments
- [Major achievement]
- [Major achievement]

### Metrics
- [Relevant metric]: [Value]
- [Relevant metric]: [Value]

### Challenges Overcome
- [Challenge and how it was solved]

### Learnings
**What went well**:
- [Success factor]

**What to improve**:
- [Area for improvement]

### Impact on Timeline
- On schedule / [X days ahead/behind]
- Reason: [If deviation, explain why]

### Next Phase
- **Starting**: [Next phase name]
- **Target start date**: [Date]
- **Focus**: [Main objectives]
```

## Updating Implementation Plan

### Progress Indicators

Update plan page regularly:

```markdown
## Status Overview

**Overall Progress**: 45% complete

### Phase Status
-  Phase 1: Foundation - Complete
-  Phase 2: Core Features - In Progress (60%)
-  Phase 3: Integration - Not Started

### Task Summary
-  Completed: 12 tasks
-  In Progress: 5 tasks
-  Blocked: 1 task
-  Not Started: 8 tasks

**Last Updated**: [Date]
```

### Task Checklist Updates

Mark completed tasks:

```markdown
## Implementation Phases

### Phase 1: Foundation
- [x] &lt;mention-page url=&quot;...&quot;&gt;Database schema&lt;/mention-page&gt;
- [x] &lt;mention-page url=&quot;...&quot;&gt;API scaffolding&lt;/mention-page&gt;
- [x] &lt;mention-page url=&quot;...&quot;&gt;Auth setup&lt;/mention-page&gt;

### Phase 2: Core Features
- [x] &lt;mention-page url=&quot;...&quot;&gt;User management&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Dashboard&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Reporting&lt;/mention-page&gt;
```

### Timeline Updates

Update milestone dates:

```markdown
## Timeline

| Milestone | Original | Current | Status |
|-----------|----------|---------|--------|
| Phase 1 | Oct 15 | Oct 14 |  Complete (1 day early) |
| Phase 2 | Oct 30 | Nov 2 |  In Progress (3 days delay) |
| Phase 3 | Nov 15 | Nov 18 |  Planned (adjusted) |
| Launch | Nov 20 | Nov 22 |  Planned (adjusted) |

**Timeline Status**: Slightly behind due to [reason]
```

## Task Status Tracking

### Status Definitions

**To Do**: Not started
- Task is ready to begin
- Dependencies met
- Assigned (or available)

**In Progress**: Actively being worked
- Work has started
- Assigned to someone
- Regular updates expected

**Blocked**: Cannot proceed
- Dependency not met
- External blocker
- Waiting on decision/resource

**In Review**: Awaiting review
- Work complete from implementer perspective
- Needs code review, QA, or approval
- Reviewers identified

**Done**: Complete
- All acceptance criteria met
- Reviewed and approved
- Deployed/delivered

### Updating Task Status

When updating:

```
1. Update Status property
2. Add progress note explaining change
3. Update related tasks if needed
4. Notify relevant people via comment

Example:
properties: { &quot;Status&quot;: &quot;In Progress&quot; }

Content update:
## Progress: Oct 14, 2025
Started implementation. Set up basic structure and wrote initial tests.
```

## Blocker Tracking

### Recording Blockers

When encountering a blocker:

```markdown
## Blockers

### [Date]: [Blocker Description]
**Status**:  Active
**Impact**: [What&#x27;s blocked]
**Needed to unblock**: [Action/person/decision needed]
**Owner**: [Who&#x27;s responsible for unblocking]
**Target resolution**: [Date or timeframe]
```

### Resolving Blockers

When unblocked:

```markdown
## Blockers

### [Date]: [Blocker Description]
**Status**:  Resolved on [Date]
**Resolution**: [How it was resolved]
**Impact**: [Any timeline/scope impact]
```

### Escalating Blockers

If blocker needs escalation:

```
1. Update blocker status in task
2. Add comment tagging stakeholder
3. Update plan with blocker impact
4. Propose mitigation if possible
```

## Metrics Tracking

### Velocity Tracking

Track completion rate:

```markdown
## Velocity

### Week 1
- Tasks completed: 8
- Story points: 21
- Velocity: Strong

### Week 2
- Tasks completed: 6
- Story points: 18
- Velocity: Moderate (1 blocker)

### Week 3
- Tasks completed: 9
- Story points: 24
- Velocity: Strong (blocker resolved)
```

### Quality Metrics

Track quality indicators:

```markdown
## Quality Metrics

- Test coverage: 87%
- Code review approval rate: 95%
- Bug count: 3 (2 minor, 1 cosmetic)
- Performance: All targets met
- Security: No issues found
```

### Progress Metrics

Quantitative progress:

```markdown
## Progress Metrics

- Requirements implemented: 15/20 (75%)
- Acceptance criteria met: 42/56 (75%)
- Test cases passing: 128/135 (95%)
- Code complete: 80%
- Documentation: 60%
```

## Stakeholder Communication

### Weekly Status Report

```markdown
## Weekly Status: [Week of Date]

### Summary
[One paragraph overview of progress and status]

### This Week&#x27;s Accomplishments
- [Key accomplishment]
- [Key accomplishment]
- [Key accomplishment]

### Next Week&#x27;s Plan
- [Planned work]
- [Planned work]

### Status
- On track / At risk / Behind schedule
- [If at risk or behind, explain and provide mitigation plan]

### Blockers &amp; Needs
- [Active blocker or need for help]
- Or: None

### Risks
- [New or evolving risk]
- Or: None currently identified
```

### Executive Summary

For leadership updates:

```markdown
## Implementation Status: [Feature Name]

**Overall Status**:  On Track /  At Risk /  Behind

**Progress**: [X]% complete

**Key Updates**:
- [Most important update]
- [Most important update]

**Timeline**: [Status vs original plan]

**Risks**: [Top 1-2 risks]

**Next Milestone**: [Upcoming milestone and date]
```

## Automated Progress Tracking

### Query-Based Status

Generate status from task database:

```
Query task database:
SELECT 
  &quot;Status&quot;,
  COUNT(*) as count
FROM &quot;collection://tasks-uuid&quot;
WHERE &quot;Related Tasks&quot; CONTAINS &#x27;plan-page-id&#x27;
GROUP BY &quot;Status&quot;

Generate summary:
- To Do: 8
- In Progress: 5
- Blocked: 1
- In Review: 2
- Done: 12

Overall: 44% complete (12/28 tasks)
```

### Timeline Calculation

Calculate projected completion:

```
Average velocity: 6 tasks/week
Remaining tasks: 14
Projected completion: 2.3 weeks from now

Compares to target: [On schedule/Behind/Ahead]
```

## Best Practices

1. **Update regularly**: Don&#x27;t let updates pile up
2. **Be specific**: &quot;Completed login&quot; vs &quot;Made progress&quot;
3. **Quantify progress**: Use percentages, counts, metrics
4. **Note blockers immediately**: Don&#x27;t wait to report blockers
5. **Link to work**: Reference PRs, deployments, demos
6. **Track decisions**: Document why, not just what
7. **Be honest**: Report actual status, not optimistic status
8. **Update in one place**: Keep implementation plan as source of truth</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/progress_tracking/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/reference/progress-tracking.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="progress_update_template Imported skill progress_update_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/reference/progress-update-template.md Unknown LICENSE.txt sources/openai/progress_update_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">progress_update_template</div>
                <button class="copy-btn" onclick="copyToClipboard('progress_update_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill progress_update_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Progress Update Template

Use this to update progress on implementation plans and tasks.

```markdown
## Progress: [Date]

### Completed Today
- [Specific item completed]
- [Specific item completed]

### In Progress
- [Current work item and status]

### Next Steps
1. [Next action]
2. [Next action]

### Blockers
- [Blocker description] or None

### Notes
[Additional context, decisions made, issues encountered]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/progress_update_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/reference/progress-update-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="project_decision Imported skill project_decision from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/examples/project-decision.md Unknown LICENSE.txt sources/openai/project_decision/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">project_decision</div>
                <button class="copy-btn" onclick="copyToClipboard('project_decision')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill project_decision from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: Project Decision Meeting Prep

## User Request

&gt; &quot;Prep for tomorrow&#x27;s architecture meeting where we need to decide on database migration strategy&quot;

## Workflow Execution

### Step 1: Search for Context

```
Notion:notion-search
query: &quot;database migration&quot;
query_type: &quot;internal&quot;
teamspace_id: &quot;engineering-teamspace-id&quot;
filters: {
  created_date_range: {
    start_date: &quot;2024-01-01&quot;
  }
}
```

**Results Found:**
- &quot;Database Migration Proposal&quot; (Engineering)
- &quot;Current Database Performance Issues&quot; (Engineering)
- &quot;Migration Options Analysis&quot; (Architecture)
- &quot;Previous Migration Post-mortem&quot; (Engineering)

### Step 2: Fetch Relevant Pages

```
Notion:notion-fetch
id: &quot;database-migration-proposal-page-id&quot;
```

**Extracted**: Proposes migrating from MongoDB to PostgreSQL, outlines timeline and risks

```
Notion:notion-fetch
id: &quot;database-performance-issues-page-id&quot;
```

**Extracted**: Current pain points - slow queries, schema flexibility issues, transaction limitations

```
Notion:notion-fetch
id: &quot;migration-options-analysis-page-id&quot;
```

**Extracted**: Three options analyzed:
1. Stay on MongoDB with optimizations
2. Migrate to PostgreSQL
3. Hybrid approach (MongoDB + PostgreSQL)

```
Notion:notion-fetch
id: &quot;previous-migration-postmortem-page-id&quot;
```

**Extracted**: Lessons from 2023 Redis migration - importance of rollback plan, testing strategy

### Step 3: Synthesize Pre-Read

**Key Information Identified:**
- **Problem**: MongoDB performance degrading, schema flexibility causing data consistency issues
- **Options**: Three approaches with different trade-offs
- **Recommendation**: PostgreSQL migration favored by engineering team
- **Concerns**: Downtime requirements, data migration complexity, application changes needed
- **Historical context**: Previous migration took 6 weeks, had rollback issues

### Step 4: Create Meeting Agenda

```
Notion:notion-create-pages

parent: { page_id: &quot;meetings-parent-id&quot; }

pages: [{
  properties: {
    &quot;title&quot;: &quot;Architecture Decision: Database Migration Strategy - Oct 15, 2025&quot;
  },
  content: &quot;[Decision meeting agenda]&quot;
}]
```

**Agenda Created:**

```markdown
# Architecture Decision: Database Migration Strategy

## Meeting Details
**Date &amp; Time**: October 15, 2025 at 2:00 PM  
**Duration**: 90 minutes  
**Location**: Conference Room B / Zoom  
**Facilitator**: Sarah Chen (Engineering Lead)  
**Attendees**:
- Sarah Chen (Engineering Lead)
- David Kim (CTO)
- Alice Wang (Backend Team Lead)
- Bob Martinez (DevOps Lead)
- Carol Johnson (Product Director)

## Pre-Read Summary

### Background

Our MongoDB database is experiencing performance degradation as we scale. Query response times have increased from 50ms to 400ms average over the past 6 months. The schema-less nature that initially provided flexibility is now causing data consistency issues and making application logic more complex.

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Current Database Performance Issues&lt;/mention-page&gt;

### Current Situation

**Performance metrics**:
- Average query time: 400ms (was 50ms 6 months ago)
- p95 query time: 1.2s (was 200ms)
- Database size: 500GB (growing 20GB/month)
- Connection pool exhaustion during peak traffic

**Technical debt**:
- 15+ application-layer validation rules compensating for lack of schema
- Complex data migration scripts for schema changes
- Limited transaction support causing race conditions

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Database Migration Proposal&lt;/mention-page&gt;

### Historical Context

We successfully migrated from Redis to Memcached in 2023, which took 6 weeks. Key learnings:
- Underestimated application code changes (3 weeks instead of 1 week)
- Rollback plan was crucial when we discovered compatibility issues
- Parallel running period (dual writes) was essential for safe migration

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Previous Migration Post-mortem&lt;/mention-page&gt;

## Decision Required

**Question**: Which database migration strategy should we adopt?

**Timeline**: Need decision by end of week to include in Q4 planning

**Impact**: 
- Engineering team (4-8 weeks of work)
- Application architecture
- Operations &amp; monitoring
- Future feature development velocity

## Options Analysis

### Option A: Stay on MongoDB with Optimizations

**Description**: Invest in MongoDB performance tuning, add indexes, upgrade to latest version, implement better query patterns.

**Pros**:
-  No migration complexity
-  Team familiar with MongoDB
-  Can implement immediately
-  Lower risk
-  Estimated 2 weeks effort

**Cons**:
-  Doesn&#x27;t solve fundamental schema flexibility issues
-  Still limited transaction support
-  Performance improvements may be temporary
-  Continues technical debt accumulation

**Cost/Effort**: 2 weeks engineering + $5K/year additional MongoDB infrastructure

**Risk**: Medium - Improvements may not be sufficient

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Migration Options Analysis&lt;/mention-page&gt;

### Option B: Migrate to PostgreSQL

**Description**: Full migration from MongoDB to PostgreSQL. Redesign schema with proper constraints, implement dual-write period, then cut over.

**Pros**:
-  Solves schema consistency issues
-  Full ACID transactions
-  Better performance for relational queries
-  Lower long-term complexity
-  Industry standard, easier hiring

**Cons**:
-  High migration effort (6-8 weeks)
-  Requires schema redesign
-  Application code changes extensive
-  Risk of data loss during migration
-  Downtime required (4-6 hours estimated)

**Cost/Effort**: 8 weeks engineering + $8K migration costs - $15K/year MongoDB savings = net $7K/year savings

**Risk**: High - Complex migration, application changes required

**Recommendation**:  **Favored by engineering team**

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Database Migration Proposal&lt;/mention-page&gt;

### Option C: Hybrid Approach

**Description**: Keep MongoDB for document-heavy data (logs, analytics), migrate transactional data to PostgreSQL. Run both databases.

**Pros**:
-  Phased migration (lower risk)
-  Use best tool for each data type
-  Can migrate incrementally
-  Smaller initial scope (4 weeks)

**Cons**:
-  Increased operational complexity
-  Two databases to maintain
-  Data consistency between databases challenging
-  Higher infrastructure costs
-  Complex application logic

**Cost/Effort**: 4 weeks initial + ongoing complexity + $10K/year additional infrastructure

**Risk**: Medium - Operational complexity increases

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Migration Options Analysis&lt;/mention-page&gt;

### Option D: Do Nothing

**Description**: Accept current performance and continue with MongoDB as-is.

**Implications**:
- Performance continues to degrade
- Technical debt increases
- Feature development slows
- Customer experience suffers
- Eventually forced into emergency migration

**Not recommended**

## Discussion Topics

### Technical Feasibility
1. Can we achieve &lt; 4 hours downtime for Option B?
2. What&#x27;s the rollback plan if PostgreSQL migration fails?
3. How do we handle data migration for 500GB?
4. Schema design - what constraints do we need?

### Business Impact
5. What&#x27;s the customer impact of 4-6 hours downtime?
6. Can we schedule migration during low-traffic period?
7. How does this affect Q4 feature roadmap?
8. Cost-benefit analysis over 2-year horizon?

### Risk Management
9. What are the biggest risks with Option B?
10. How do we test thoroughly before cutover?
11. What&#x27;s the rollback procedure and time?
12. Do we have necessary expertise on team?

### Timeline &amp; Resources
13. Can we allocate 2 engineers full-time for 8 weeks?
14. Do we need external consultants?
15. What&#x27;s the impact on other Q4 projects?
16. When could we realistically complete this?

## Decision Framework

**Evaluation criteria**:
1. **Performance improvement**: Will this solve our performance issues?
2. **Technical debt**: Does this reduce or increase complexity?
3. **Risk**: What&#x27;s the probability and impact of failure?
4. **Cost**: Total cost of ownership (effort + infrastructure)
5. **Timeline**: Can we complete in Q4?
6. **Reversibility**: Can we roll back if needed?

**Decision makers**:
- Primary: David Kim (CTO)
- Consulted: Sarah Chen (Engineering), Bob Martinez (DevOps)
- Informed: Product, Executive team

## Decision

*[To be filled during meeting]*

**Selected Option**: ___________________

**Rationale**:

**Timeline**:

**Owner**: ___________________

**Success Criteria**:

## Action Items

*[To be filled during meeting]*

- [ ] [Action item] - @[Owner] - Due: [Date]
- [ ] [Action item] - @[Owner] - Due: [Date]

## Next Steps

**Immediate**:
- Document decision rationale
- Create detailed implementation plan
- Schedule kickoff meeting

**Follow-up meeting**: [Date] to review migration plan

## Related Resources

### Primary Sources
- &lt;mention-page url=&quot;...&quot;&gt;Database Migration Proposal&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Current Database Performance Issues&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Migration Options Analysis&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Previous Migration Post-mortem&lt;/mention-page&gt;

### Supporting Documents
- MongoDB performance metrics dashboard
- PostgreSQL evaluation results
- Cost analysis spreadsheet
```

### Step 5: Share Agenda

```
Notion:notion-create-comment
parent: { page_id: &quot;agenda-page-id&quot; }
rich_text: [{
  type: &quot;text&quot;,
  text: { content: &quot; Meeting agenda ready! Please review the pre-read before tomorrow&#x27;s meeting. cc: @Sarah @David @Alice @Bob @Carol&quot; }
}]
```

## Summary Provided to User

```markdown
## Meeting Prep Complete 

### Meeting Details
- **Topic**: Database Migration Strategy Decision
- **Date**: October 15, 2025 at 2:00 PM
- **Duration**: 90 minutes
- **Attendees**: 5 (Engineering leads + CTO + Product)

### Agenda Created
&lt;mention-page url=&quot;...&quot;&gt;Architecture Decision: Database Migration Strategy&lt;/mention-page&gt;

### Pre-Read Summary

**Problem**: MongoDB performance degrading (50ms  400ms queries), schema flexibility causing issues

**Decision needed**: Choose between:
1. Stay on MongoDB (optimizations) - 2 weeks, low risk
2. Migrate to PostgreSQL - 8 weeks, high value, high risk  Recommended
3. Hybrid approach - 4 weeks, medium complexity
4. Do nothing - Not recommended

**Recommendation**: Engineering team favors PostgreSQL migration

### Key Information Included

 **Background context** from 4 relevant pages
 **Options analysis** with pros/cons for each
 **Cost-benefit** breakdown
 **Risk assessment** for each option
 **Discussion topics** (16 questions organized by theme)
 **Decision framework** with evaluation criteria
 **Historical context** from previous migration
 **Empty sections** for decision and action items

### Discussion Topics Prepared

**Technical** (4 questions):
- Downtime achievability
- Rollback planning
- Data migration approach
- Schema design

**Business** (4 questions):
- Customer impact
- Scheduling
- Roadmap impact
- Cost analysis

**Risk** (4 questions):
- Risk identification
- Testing strategy
- Rollback procedure
- Expertise availability

**Resources** (4 questions):
- Team allocation
- External help needs
- Project trade-offs
- Timeline realism

### Success Factors

1. **Comprehensive research**: 4 relevant pages analyzed
2. **Clear options**: Pros/cons for each approach
3. **Structured discussion**: 16 questions organized by theme
4. **Decision framework**: Clear criteria for evaluation
5. **Historical context**: Lessons from previous migration
6. **Ready for outcomes**: Sections prepared for decision and actions

**Meeting is well-prepared for productive decision-making! **
```

## Key Features Demonstrated

### Context Gathering
- **Targeted search**: Engineering teamspace, recent documents
- **Multiple perspectives**: Performance data, proposals, analysis, historical lessons
- **Comprehensive synthesis**: Combined technical, business, and historical context

### Options Analysis
- **Structured comparison**: Pros/cons for each option
- **Cost-benefit**: Effort and infrastructure costs included
- **Risk assessment**: Probability and impact noted
- **Recommendation**: Clear engineering preference stated

### Decision Support
- **Discussion topics**: 16 questions organized by theme
- **Decision framework**: Evaluation criteria defined
- **Decision makers**: Roles and responsibilities clear
- **Outcome capture**: Sections ready for decision and actions

### Meeting Structure
- **Pre-read**: Comprehensive background (can be read in 10 minutes)
- **Options**: Clear comparison for quick decision
- **Discussion**: Structured topics prevent rambling
- **Capture**: Templates for decision and actions

Perfect for: Architecture decisions, technical trade-offs, strategic choices</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/project_decision/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/examples/project-decision.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="quick_brief_format Imported skill quick_brief_format from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/reference/quick-brief-format.md Unknown LICENSE.txt sources/openai/quick_brief_format/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">quick_brief_format</div>
                <button class="copy-btn" onclick="copyToClipboard('quick_brief_format')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill quick_brief_format from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Quick Brief Format

**When to use**:
- Time-sensitive requests
- Simple topics
- Status updates
- Quick reference needs

## Characteristics

**Length**: 200-400 words

**Structure**:
- 3-4 sentence summary
- 3-5 bullet key points
- Short action items list
- Brief source list

## Template

See [quick-brief-template.md](quick-brief-template.md) for the full template.

## Best For

- Fast turnaround requests
- Simple, straightforward topics
- Quick status updates
- When time is more important than depth
- Initial exploration before deeper research

## Example Use Cases

- &quot;Quick summary of what&#x27;s in our API docs&quot;
- &quot;Fast brief on the meeting notes from yesterday&quot;
- &quot;What are the key points from that spec?&quot;
- &quot;Give me a quick overview of the project status&quot;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/quick_brief_format/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/reference/quick-brief-format.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="quick_brief_template Imported skill quick_brief_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/reference/quick-brief-template.md Unknown LICENSE.txt sources/openai/quick_brief_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">quick_brief_template</div>
                <button class="copy-btn" onclick="copyToClipboard('quick_brief_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill quick_brief_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Quick Brief Template

Use for fast turnaround requests or simple topics. See [quick-brief-format.md](quick-brief-format.md) for when to use this format.

```markdown
# [Topic] - Quick Brief

**Date**: [Current date]

## Summary
[3-4 sentences covering the essentials]

## Key Points
- **Point 1**: [Details]
- **Point 2**: [Details]
- **Point 3**: [Details]

## Action Items
1. [Immediate next step]
2. [Follow-up action]

## Sources
[Brief list of pages consulted]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/quick_brief_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/reference/quick-brief-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="quick_implementation_plan Imported skill quick_implementation_plan from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/reference/quick-implementation-plan.md Unknown LICENSE.txt sources/openai/quick_implementation_plan/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">quick_implementation_plan</div>
                <button class="copy-btn" onclick="copyToClipboard('quick_implementation_plan')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill quick_implementation_plan from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Quick Implementation Plan Template

For simpler features or small changes.

```markdown
# Implementation: [Feature Name]

## Spec
&lt;mention-page url=&quot;...&quot;&gt;Specification&lt;/mention-page&gt;

## Summary
[Quick description]

## Tasks
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Task 1&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Task 2&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Task 3&lt;/mention-page&gt;

## Timeline
Start: [Date]
Target completion: [Date]

## Status
[Update as work progresses]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/quick_implementation_plan/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/reference/quick-implementation-plan.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="quick_validate Imported skill quick_validate from openai openai /a0/tmp/skills_research/openai/skills/.system/skill-creator/scripts/quick_validate.py Unknown LICENSE.txt sources/openai/quick_validate/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">quick_validate</div>
                <button class="copy-btn" onclick="copyToClipboard('quick_validate')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill quick_validate from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env python3
&quot;&quot;&quot;
Quick validation script for skills - minimal version
&quot;&quot;&quot;

import re
import sys
from pathlib import Path

import yaml

MAX_SKILL_NAME_LENGTH = 64


def validate_skill(skill_path):
    &quot;&quot;&quot;Basic validation of a skill&quot;&quot;&quot;
    skill_path = Path(skill_path)

    skill_md = skill_path / &quot;SKILL.md&quot;
    if not skill_md.exists():
        return False, &quot;SKILL.md not found&quot;

    content = skill_md.read_text()
    if not content.startswith(&quot;---&quot;):
        return False, &quot;No YAML frontmatter found&quot;

    match = re.match(r&quot;^---\n(.*?)\n---&quot;, content, re.DOTALL)
    if not match:
        return False, &quot;Invalid frontmatter format&quot;

    frontmatter_text = match.group(1)

    try:
        frontmatter = yaml.safe_load(frontmatter_text)
        if not isinstance(frontmatter, dict):
            return False, &quot;Frontmatter must be a YAML dictionary&quot;
    except yaml.YAMLError as e:
        return False, f&quot;Invalid YAML in frontmatter: {e}&quot;

    allowed_properties = {&quot;name&quot;, &quot;description&quot;, &quot;license&quot;, &quot;allowed-tools&quot;, &quot;metadata&quot;}

    unexpected_keys = set(frontmatter.keys()) - allowed_properties
    if unexpected_keys:
        allowed = &quot;, &quot;.join(sorted(allowed_properties))
        unexpected = &quot;, &quot;.join(sorted(unexpected_keys))
        return (
            False,
            f&quot;Unexpected key(s) in SKILL.md frontmatter: {unexpected}. Allowed properties are: {allowed}&quot;,
        )

    if &quot;name&quot; not in frontmatter:
        return False, &quot;Missing &#x27;name&#x27; in frontmatter&quot;
    if &quot;description&quot; not in frontmatter:
        return False, &quot;Missing &#x27;description&#x27; in frontmatter&quot;

    name = frontmatter.get(&quot;name&quot;, &quot;&quot;)
    if not isinstance(name, str):
        return False, f&quot;Name must be a string, got {type(name).__name__}&quot;
    name = name.strip()
    if name:
        if not re.match(r&quot;^[a-z0-9-]+$&quot;, name):
            return (
                False,
                f&quot;Name &#x27;{name}&#x27; should be hyphen-case (lowercase letters, digits, and hyphens only)&quot;,
            )
        if name.startswith(&quot;-&quot;) or name.endswith(&quot;-&quot;) or &quot;--&quot; in name:
            return (
                False,
                f&quot;Name &#x27;{name}&#x27; cannot start/end with hyphen or contain consecutive hyphens&quot;,
            )
        if len(name) &gt; MAX_SKILL_NAME_LENGTH:
            return (
                False,
                f&quot;Name is too long ({len(name)} characters). &quot;
                f&quot;Maximum is {MAX_SKILL_NAME_LENGTH} characters.&quot;,
            )

    description = frontmatter.get(&quot;description&quot;, &quot;&quot;)
    if not isinstance(description, str):
        return False, f&quot;Description must be a string, got {type(description).__name__}&quot;
    description = description.strip()
    if description:
        if &quot;&lt;&quot; in description or &quot;&gt;&quot; in description:
            return False, &quot;Description cannot contain angle brackets (&lt; or &gt;)&quot;
        if len(description) &gt; 1024:
            return (
                False,
                f&quot;Description is too long ({len(description)} characters). Maximum is 1024 characters.&quot;,
            )

    return True, &quot;Skill is valid!&quot;


if __name__ == &quot;__main__&quot;:
    if len(sys.argv) != 2:
        print(&quot;Usage: python quick_validate.py &lt;skill_directory&gt;&quot;)
        sys.exit(1)

    valid, message = validate_skill(sys.argv[1])
    print(message)
    sys.exit(0 if valid else 1)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/quick_validate/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.system/skill-creator/scripts/quick_validate.py" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.system/skill-creator/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="readme Imported skill readme from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/evaluations/README.md Unknown LICENSE.txt sources/openai/readme/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">readme</div>
                <button class="copy-btn" onclick="copyToClipboard('readme')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill readme from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Knowledge Capture Skill Evaluations

Evaluation scenarios for testing the Knowledge Capture skill across different Codex models.

## Purpose

These evaluations ensure the Knowledge Capture skill:
- Correctly identifies content types (how-to guides, FAQs, decision records, wikis)
- Extracts relevant information from conversations
- Structures content appropriately for each type
- Searches and places content in the right Notion location
- Works consistently across Haiku, Sonnet, and Opus

## Evaluation Files

### conversation-to-wiki.json
Tests capturing conversation content as a how-to guide for the team wiki.

**Scenario**: Save deployment discussion to wiki  
**Key Behaviors**:
- Extracts steps, gotchas, and best practices from conversation
- Identifies content as How-To Guide
- Structures with proper sections (Overview, Prerequisites, Steps, Troubleshooting)
- Searches for team wiki location
- Preserves technical details (commands, configs)

### decision-record.json
Tests capturing architectural or technical decisions with full context.

**Scenario**: Document database migration decision  
**Key Behaviors**:
- Extracts decision context, alternatives, and rationale
- Follows decision record structure (Context, Decision, Alternatives, Consequences)
- Captures both selected and rejected options with reasoning
- Places in decision log or ADR database
- Links to related technical documentation

## Running Evaluations

1. Enable the `knowledge-capture` skill
2. Submit the query from the evaluation file
3. Provide conversation context as specified
4. Verify all expected behaviors are met
5. Check success criteria for quality
6. Test with Haiku, Sonnet, and Opus

## Expected Skill Behaviors

Knowledge Capture evaluations should verify:

### Content Extraction
- Accurately captures key points from conversation context
- Preserves specific technical details, not generic placeholders
- Maintains context and nuance from discussion

### Content Type Selection
- Correctly identifies appropriate content type (how-to, FAQ, decision record, wiki page)
- Uses matching structure from reference documentation
- Applies proper Notion markdown formatting

### Notion Integration
- Searches for appropriate target location (wiki, decision log, etc.)
- Creates well-structured pages with clear titles
- Uses proper parent placement
- Includes discoverable titles and metadata

### Quality Standards
- Content is actionable and future-reference ready
- Technical accuracy is preserved
- Organization aids discoverability
- Formatting enhances readability

## Creating New Evaluations

When adding Knowledge Capture evaluations:

1. **Use realistic conversation content** - Include actual technical details, decisions, or processes
2. **Test different content types** - How-to guides, FAQs, decision records, meeting notes, learnings
3. **Vary complexity** - Simple captures vs. complex technical discussions
4. **Test discovery** - Finding the right wiki section or database
5. **Include edge cases** - Unclear content types, minimal context, overlapping categories

## Example Success Criteria

**Good** (specific, testable):
- &quot;Structures content using How-To format with numbered steps&quot;
- &quot;Preserves exact bash commands from conversation&quot;
- &quot;Creates page with title format &#x27;How to [Action]&#x27;&quot;
- &quot;Places in Engineering Wiki  Deployment section&quot;

**Bad** (vague, untestable):
- &quot;Creates good documentation&quot;
- &quot;Uses appropriate structure&quot;
- &quot;Saves to the right place&quot;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/readme/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/evaluations/README.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="research_summary_format Imported skill research_summary_format from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/reference/research-summary-format.md Unknown LICENSE.txt sources/openai/research_summary_format/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">research_summary_format</div>
                <button class="copy-btn" onclick="copyToClipboard('research_summary_format')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill research_summary_format from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Research Summary Format

**When to use**: General research requests, most common format

## Characteristics

**Length**: 500-1000 words typically

**Structure**:
- Executive summary (2-3 sentences)
- 3-5 key findings with supporting evidence
- Detailed analysis section
- Conclusions and next steps
- Source citations

## Template

See [research-summary-template.md](research-summary-template.md) for the full template.

## Best For

- Most general-purpose research requests
- Standard documentation needs
- Balanced depth and readability
- When you need comprehensive but accessible information

## Example Use Cases

- &quot;Research our authentication options&quot;
- &quot;What does our project documentation say about the API redesign?&quot;
- &quot;Summarize the team&#x27;s discussion about mobile strategy&quot;
- &quot;Compile information about our deployment process&quot;</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/research_summary_format/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/reference/research-summary-format.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="research_summary_template Imported skill research_summary_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/reference/research-summary-template.md Unknown LICENSE.txt sources/openai/research_summary_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">research_summary_template</div>
                <button class="copy-btn" onclick="copyToClipboard('research_summary_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill research_summary_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Research Summary Template

Use this for most research requests. See [research-summary-format.md](research-summary-format.md) for when to use this format.

```markdown
# [Topic Name]

## Executive Summary
[2-3 sentence overview of key findings and implications]

## Key Findings

### Finding 1: [Clear headline]
[Details and supporting evidence]
- Source: &lt;mention-page url=&quot;...&quot;&gt;Original Page&lt;/mention-page&gt;

### Finding 2: [Clear headline]
[Details and supporting evidence]
- Source: &lt;mention-page url=&quot;...&quot;&gt;Original Page&lt;/mention-page&gt;

### Finding 3: [Clear headline]
[Details and supporting evidence]
- Source: &lt;mention-page url=&quot;...&quot;&gt;Original Page&lt;/mention-page&gt;

## Detailed Analysis

### [Section 1]
[In-depth discussion of first major theme]

### [Section 2]
[In-depth discussion of second major theme]

## Conclusions

[Summary of implications and insights]

## Next Steps

1. [Actionable recommendation]
2. [Actionable recommendation]
3. [Actionable recommendation]

## Sources

- &lt;mention-page url=&quot;...&quot;&gt;Page Title&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Page Title&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Page Title&lt;/mention-page&gt;
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/research_summary_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/reference/research-summary-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="research_to_database Imported skill research_to_database from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/evaluations/research-to-database.json Unknown LICENSE.txt sources/openai/research_to_database/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">research_to_database</div>
                <button class="copy-btn" onclick="copyToClipboard('research_to_database')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill research_to_database from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;name&quot;: &quot;Research with Database Integration&quot;,
  &quot;skills&quot;: [&quot;research-documentation&quot;],
  &quot;query&quot;: &quot;Research competitor pricing strategies and add to our Research database&quot;,
  &quot;expected_behavior&quot;: [
    &quot;Searches for competitor and pricing information using Notion:notion-search&quot;,
    &quot;Applies appropriate search strategy (see reference/advanced-search.md patterns)&quot;,
    &quot;Fetches relevant pages using Notion:notion-fetch and synthesizes findings&quot;,
    &quot;Recognizes need to add to database (mentioned in query)&quot;,
    &quot;Searches for or asks about the Research database location&quot;,
    &quot;Fetches database using Notion:notion-fetch to get schema, data sources, and properties&quot;,
    &quot;Identifies correct data source from &lt;data-source&gt; tags if multiple exist&quot;,
    &quot;Creates page with appropriate database properties (Type: Competitor Analysis, Category, Tags, Date, Status, etc.)&quot;,
    &quot;Uses parent: { data_source_id: &#x27;collection://...&#x27; } for correct database placement&quot;,
    &quot;Includes research content using Competitor Analysis format (see reference/formats.md)&quot;,
    &quot;Sets all required properties from schema with correct values&quot;,
    &quot;Cites sources using mention-page tags per reference/citations.md&quot;
  ],
  &quot;success_criteria&quot;: [
    &quot;Page is created in correct database using data_source_id as parent&quot;,
    &quot;All required database properties are set correctly&quot;,
    &quot;Property values match available options from fetched schema&quot;,
    &quot;Content follows Competitor Analysis format structure&quot;,
    &quot;Sources are cited with proper mention-page tags&quot;,
    &quot;Title is descriptive (e.g., &#x27;Competitor Pricing Analysis&#x27;)&quot;,
    &quot;Research synthesizes findings rather than just listing sources&quot;
  ]
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/research_to_database/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/evaluations/research-to-database.json" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="retrospective_template Imported skill retrospective_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/reference/retrospective-template.md Unknown LICENSE.txt sources/openai/retrospective_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">retrospective_template</div>
                <button class="copy-btn" onclick="copyToClipboard('retrospective_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill retrospective_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Retrospective Template

Use this template for sprint retrospectives and team retrospectives.

```markdown
# Sprint [#] Retrospective - [Date]

## Meeting Details
**Date**: [Date]
**Team**: [Team]
**Sprint**: [Sprint dates]
**Facilitator**: [Name]

## Sprint Summary

**Sprint Goal**: [Goal]
**Goal Met**: Yes / Partially / No

**Completed**: [#] points
**Velocity**: [#] points
**Planned**: [#] points

## Pre-Read

**Sprint Metrics**:
- Tasks completed: [#]
- Tasks carried over: [#]
- Bugs found: [#]
- Blockers encountered: [#]

## Discussion

### What Went Well (Keep)

[Team input during meeting]

### What Didn&#x27;t Go Well (Stop)

[Team input during meeting]

### What To Try (Start)

[Team input during meeting]

### Shout-outs

[Team recognition]

## Action Items

- [ ] [Improvement to implement] - @[Owner] - Due: [Date]
- [ ] [Process change] - @[Owner] - Due: [Date]

## Follow-up

**Review actions in**: [Next retro date]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/retrospective_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/reference/retrospective-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="skill Imported skill skill from openai openai /a0/tmp/skills_research/openai/skills/.curated/gh-address-comments/SKILL.md Unknown LICENSE.txt sources/openai/skill/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">skill</div>
                <button class="copy-btn" onclick="copyToClipboard('skill')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill skill from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
name: gh-address-comments
description: Help address review/issue comments on the open GitHub PR for the current branch using gh CLI; verify gh auth first and prompt the user to authenticate if not logged in.
metadata:
  short-description: Address comments in a GitHub PR review
---

# PR Comment Handler

Guide to find the open PR for the current branch and address its comments with gh CLI. Run all `gh` commands with elevated network access.

Prereq: ensure `gh` is authenticated (for example, run `gh auth login` once), then run `gh auth status` with escalated permissions (include workflow/repo scopes) so `gh` commands succeed. If sandboxing blocks `gh auth status`, rerun it with `sandbox_permissions=require_escalated`.

## 1) Inspect comments needing attention
- Run scripts/fetch_comments.py which will print out all the comments and review threads on the PR

## 2) Ask the user for clarification
- Number all the review threads and comments and provide a short summary of what would be required to apply a fix for it
- Ask the user which numbered comments should be addressed

## 3) If user chooses comments
- Apply fixes for the selected comments

Notes:
- If gh hits auth/rate issues mid-run, prompt the user to re-authenticate with `gh auth login`, then retry.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/skill/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/gh-address-comments/SKILL.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/gh-address-comments/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="spec_parsing Imported skill spec_parsing from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/reference/spec-parsing.md Unknown LICENSE.txt sources/openai/spec_parsing/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">spec_parsing</div>
                <button class="copy-btn" onclick="copyToClipboard('spec_parsing')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill spec_parsing from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Specification Parsing

## Finding the Specification

Before parsing, locate the spec page:

```
1. Search for spec:
   Notion:notion-search
   query: &quot;[Feature Name] spec&quot; or &quot;[Feature Name] specification&quot;
   
2. Handle results:
   - If found  use page URL/ID
   - If multiple  ask user which one
   - If not found  ask user for URL/ID

Example:
Notion:notion-search
query: &quot;User Profile API spec&quot;
query_type: &quot;internal&quot;
```

## Reading Specifications

After finding the spec, fetch it with `Notion:notion-fetch`:

1. Read the full content
2. Identify key sections
3. Extract structured information
4. Note ambiguities or gaps

```
Notion:notion-fetch
id: &quot;spec-page-id-from-search&quot;
```

## Common Spec Structures

### Requirements-Based Spec

```
# Feature Spec
## Overview
[Feature description]

## Requirements
### Functional
- REQ-1: [Requirement]
- REQ-2: [Requirement]

### Non-Functional
- PERF-1: [Performance requirement]
- SEC-1: [Security requirement]

## Acceptance Criteria
- AC-1: [Criterion]
- AC-2: [Criterion]
```

Extract:
- List of functional requirements
- List of non-functional requirements
- List of acceptance criteria

### User Story Based Spec

```
# Feature Spec
## User Stories
### As a [user type]
I want [goal]
So that [benefit]

**Acceptance Criteria**:
- [Criterion]
- [Criterion]
```

Extract:
- User personas
- Goals/capabilities needed
- Acceptance criteria per story

### Technical Design Doc

```
# Technical Design
## Problem Statement
[Problem description]

## Proposed Solution
[Solution approach]

## Architecture
[Architecture details]

## Implementation Plan
[Implementation approach]
```

Extract:
- Problem being solved
- Proposed solution approach
- Architectural decisions
- Implementation guidance

### Product Requirements Document (PRD)

```
# PRD: [Feature]
## Goals
[Business goals]

## User Needs
[User problems being solved]

## Features
[Feature list]

## Success Metrics
[How to measure success]
```

Extract:
- Business goals
- User needs
- Feature list
- Success metrics

## Extraction Strategies

### Requirement Identification

Look for:
- &quot;Must&quot;, &quot;Should&quot;, &quot;Will&quot; statements
- Numbered requirements (REQ-1, etc.)
- User stories (As a... I want...)
- Acceptance criteria sections
- Feature lists

### Categorization

Group requirements by:

**Functional**: What the system does
- User capabilities
- System behaviors
- Data operations

**Non-Functional**: How the system performs
- Performance targets
- Security requirements
- Scalability needs
- Availability requirements
- Compliance requirements

**Constraints**: Limitations
- Technical constraints
- Business constraints
- Timeline constraints

### Priority Extraction

Identify priority indicators:
- &quot;Critical&quot;, &quot;Must have&quot;, &quot;P0&quot;
- &quot;Important&quot;, &quot;Should have&quot;, &quot;P1&quot;
- &quot;Nice to have&quot;, &quot;Could have&quot;, &quot;P2&quot;
- &quot;Future&quot;, &quot;Won&#x27;t have&quot;, &quot;P3&quot;

Map to implementation phases based on priority.

## Handling Ambiguity

### Unclear Requirements

When requirement is ambiguous:

```markdown
## Clarifications Needed

### [Requirement ID/Description]
**Current text**: &quot;[Ambiguous requirement]&quot;
**Question**: [What needs clarification]
**Impact**: [Why this matters for implementation]
**Assumed for now**: [Working assumption if any]
```

Create clarification task or add comment to spec.

### Missing Information

When critical info is missing:

```markdown
## Missing Information

- **[Topic]**: Spec doesn&#x27;t specify [what&#x27;s missing]
- **Impact**: Blocks [affected tasks]
- **Action**: Need to [how to resolve]
```

### Conflicting Requirements

When requirements conflict:

```markdown
## Conflicting Requirements

**Conflict**: REQ-1 says [X] but REQ-5 says [Y]
**Impact**: [Implementation impact]
**Resolution needed**: [Decision needed]
```

## Acceptance Criteria Parsing

### Explicit Criteria

Direct acceptance criteria:

```
## Acceptance Criteria
- User can log in with email and password
- System sends confirmation email
- Session expires after 24 hours
```

Convert to checklist:
- [ ] User can log in with email and password
- [ ] System sends confirmation email
- [ ] Session expires after 24 hours

### Implicit Criteria

Derive from requirements:

```
Requirement: &quot;Users can upload files up to 100MB&quot;

Implied acceptance criteria:
- [ ] Files up to 100MB upload successfully
- [ ] Files over 100MB are rejected with error message
- [ ] Progress indicator shows during upload
- [ ] Upload can be cancelled
```

### Testable Criteria

Ensure criteria are testable:

 **Not testable**: &quot;System is fast&quot;
 **Testable**: &quot;Page loads in &lt; 2 seconds&quot;

 **Not testable**: &quot;Users like the interface&quot;
 **Testable**: &quot;90% of test users complete task successfully&quot;

## Technical Detail Extraction

### Architecture Information

Extract:
- System components
- Data models
- APIs/interfaces
- Integration points
- Technology choices

### Design Decisions

Note:
- Technology selections
- Architecture patterns
- Trade-offs made
- Rationale provided

### Implementation Guidance

Look for:
- Suggested approach
- Code examples
- Library recommendations
- Best practices mentioned

## Dependency Identification

### External Dependencies

From spec, identify:
- Third-party services required
- External APIs needed
- Infrastructure requirements
- Tool/library dependencies

### Internal Dependencies

Identify:
- Other features needed first
- Shared components required
- Team dependencies
- Data dependencies

### Timeline Dependencies

Note:
- Hard deadlines
- Milestone dependencies
- Sequencing requirements

## Scope Extraction

### In Scope

What&#x27;s explicitly included:
- Features to build
- Use cases to support
- Users/personas to serve

### Out of Scope

What&#x27;s explicitly excluded:
- Features deferred
- Use cases not supported
- Edge cases not handled

### Assumptions

What&#x27;s assumed:
- Environment assumptions
- User assumptions
- System state assumptions

## Risk Identification

Extract risk information:

### Technical Risks
- Unproven technology
- Complex integration
- Performance concerns
- Scalability unknowns

### Business Risks
- Market timing
- Resource availability
- Dependency on others

### Mitigation Strategies

Note any mitigation approaches mentioned in spec.

## Spec Quality Assessment

Evaluate spec completeness:

 **Good spec**:
- Clear requirements
- Explicit acceptance criteria
- Priorities defined
- Risks identified
- Technical approach outlined

 **Incomplete spec**:
- Vague requirements
- Missing acceptance criteria
- Unclear priorities
- No risk analysis
- Technical details absent

Document gaps and create clarification tasks.

## Parsing Checklist

Before creating implementation plan:

 All functional requirements identified
 Non-functional requirements noted
 Acceptance criteria extracted
 Dependencies identified
 Risks noted
 Ambiguities documented
 Technical approach understood
 Scope is clear
 Priorities are defined</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/spec_parsing/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/reference/spec-parsing.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="spec_to_tasks Imported skill spec_to_tasks from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/evaluations/spec-to-tasks.json Unknown LICENSE.txt sources/openai/spec_to_tasks/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">spec_to_tasks</div>
                <button class="copy-btn" onclick="copyToClipboard('spec_to_tasks')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill spec_to_tasks from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;name&quot;: &quot;Create Tasks from Specification&quot;,
  &quot;skills&quot;: [&quot;spec-to-implementation&quot;, &quot;task-manager&quot;],
  &quot;query&quot;: &quot;Read the Payment Integration spec and create implementation tasks in our Tasks database&quot;,
  &quot;expected_behavior&quot;: [
    &quot;Step 1: Uses Notion:notion-search to find Payment Integration spec or asks for URL&quot;,
    &quot;Step 2: Fetches spec page using Notion:notion-fetch to read full content&quot;,
    &quot;Step 3: Parses spec using reference/spec-parsing.md patterns to identify work items&quot;,
    &quot;Step 4: Breaks down into appropriately-sized tasks using breakdown patterns from reference/task-creation.md&quot;,
    &quot;Step 5: Uses Notion:notion-search to find Tasks database location&quot;,
    &quot;Step 6: Fetches Tasks database using Notion:notion-fetch to get schema, property names, and data sources&quot;,
    &quot;Step 7: Identifies correct data source from &lt;data-source&gt; tags in fetch results&quot;,
    &quot;Step 8: Optionally creates implementation plan page first (recommended per workflow)&quot;,
    &quot;Step 9: For each task - creates task page using Notion:notion-create-pages with parent: { data_source_id: &#x27;collection://...&#x27; }&quot;,
    &quot;Step 10: Sets task properties from schema: Title, Status (To Do), Priority, Related Tasks (link to spec)&quot;,
    &quot;Step 11: Includes task description with context, acceptance criteria from spec, dependencies&quot;,
    &quot;Step 12: Links tasks to spec page using &lt;mention-page&gt; and to each other for dependencies&quot;,
    &quot;Step 13: Sequences tasks appropriately (setup  implementation  testing per reference/task-creation.md)&quot;,
    &quot;Step 14: Reports summary: &#x27;Created X tasks for Payment Integration: [task list with links]&#x27;&quot;
  ],
  &quot;success_criteria&quot;: [
    &quot;Spec is found using Notion:notion-search before attempting to fetch&quot;,
    &quot;Task database is found using Notion:notion-search before attempting to fetch schema&quot;,
    &quot;Database schema is fetched and data source identified from &lt;data-source&gt; tags&quot;,
    &quot;Multiple tasks created (at least 3-5) covering spec scope&quot;,
    &quot;Tasks are right-sized per reference/task-creation.md (1-2 days each)&quot;,
    &quot;Each task has clear acceptance criteria extracted from spec&quot;,
    &quot;Tasks are properly sequenced with dependencies using relation properties&quot;,
    &quot;All tasks link back to original spec using mention-page tags&quot;,
    &quot;Task properties match exact schema from fetched database&quot;,
    &quot;Tasks use correct parent (data_source_id: &#x27;collection://...&#x27;) for database placement&quot;,
    &quot;Uses correct tool names and sequence: Notion:notion-search (2x)  Notion:notion-fetch (2x)  Notion:notion-create-pages (Nx)&quot;
  ]
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/spec_to_tasks/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/evaluations/spec-to-tasks.json" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="sprint_planning Imported skill sprint_planning from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/examples/sprint-planning.md Unknown LICENSE.txt sources/openai/sprint_planning/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">sprint_planning</div>
                <button class="copy-btn" onclick="copyToClipboard('sprint_planning')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill sprint_planning from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: Sprint Planning Meeting Prep

**User Request**: &quot;Prepare for tomorrow&#x27;s sprint planning meeting&quot;

## Workflow

### 1. Search for Context
```
Notion:notion-search
query: &quot;sprint planning&quot; + &quot;product backlog&quot;
teamspace_id: &quot;engineering-team&quot;
```

Found:
- Last sprint retrospective
- Product backlog (prioritized)
- Current sprint progress
- Team capacity notes

### 2. Fetch Details
```
Notion:notion-fetch (4 pages)
```

**Key context**:
- **Last Sprint**: Completed 32/35 story points (91%)
- **Velocity**: Consistent 30-35 points over last 3 sprints
- **Team**: 5 engineers, 1 on vacation next sprint (80% capacity)
- **Top Backlog Items**: User auth improvements, API performance, mobile responsive fixes

### 3. Query Current Sprint Tasks
```
Notion:notion-query-data-sources
query: &quot;SELECT * FROM tasks WHERE Sprint = &#x27;Sprint 24&#x27; AND Status != &#x27;Done&#x27;&quot;
```

3 tasks carrying over (technical debt items)

### 4. Create Pre-Read (Internal)
```
Notion:notion-create-pages
title: &quot;Sprint 25 Planning - Pre-Read (Internal)&quot;
```

**Pre-read included**:
- Sprint 24 summary (velocity, what carried over)
- Team capacity for Sprint 25
- Top backlog candidates with story points
- Technical dependencies
- Risk items (auth changes need QA time)

### 5. Create Agenda
```
Notion:notion-create-pages  
title: &quot;Sprint 25 Planning - Agenda&quot;
```

**Agenda**:
- Review Sprint 24 completion (5 min)
- Discuss carryover items (5 min)
- Review capacity (28 points available)
- Select backlog items (30 min)
- Identify dependencies &amp; risks (10 min)
- Confirm commitments (10 min)

### 6. Link Documents
Cross-linked pre-read and agenda, referenced last retro and backlog.

## Output Summary

**Internal Pre-Read**: Team context, capacity, blockers
**External Agenda**: Meeting structure, discussion topics
**Both saved to Notion** and linked to project pages

## Key Success Factors
- Gathered sprint history for velocity trends
- Calculated realistic capacity (account for PTO)
- Identified carryover items upfront
- Pre-read gave team context before meeting
- Agenda kept meeting focused and timeboxed</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/sprint_planning/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/examples/sprint-planning.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="sprint_planning_template Imported skill sprint_planning_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/reference/sprint-planning-template.md Unknown LICENSE.txt sources/openai/sprint_planning_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">sprint_planning_template</div>
                <button class="copy-btn" onclick="copyToClipboard('sprint_planning_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill sprint_planning_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Sprint Planning Template

Use this template for agile sprint planning meetings.

```markdown
# Sprint [#] Planning - [Date]

## Meeting Details
**Date**: [Date]
**Team**: [Team name]
**Sprint Duration**: [Dates]

## Sprint Goal

[Clear statement of what this sprint aims to accomplish]

## Capacity

| Team Member | Availability | Capacity (points) |
|-------------|--------------|-------------------|
| [Name] | [%] | [#] |
| **Total** | | [#] |

## Backlog Review

### High Priority Items

[From product backlog, linked from task database]

- &lt;mention-page url=&quot;...&quot;&gt;Task 1&lt;/mention-page&gt; - [Points]
- &lt;mention-page url=&quot;...&quot;&gt;Task 2&lt;/mention-page&gt; - [Points]

## Sprint Backlog

### Committed Items

- [x] &lt;mention-page url=&quot;...&quot;&gt;Task&lt;/mention-page&gt; - [Points] - @[Owner]
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Task&lt;/mention-page&gt; - [Points] - @[Owner]

**Total committed**: [Points]

### Stretch Goals

- [ ] &lt;mention-page url=&quot;...&quot;&gt;Task&lt;/mention-page&gt; - [Points]

## Dependencies &amp; Risks

**Dependencies**:
- [Dependency]

**Risks**:
- [Risk]

## Definition of Done

- [ ] Code complete and reviewed
- [ ] Tests written and passing
- [ ] Documentation updated
- [ ] Deployed to staging
- [ ] QA approved

## Next Steps

- Team begins sprint work
- Daily standups at [Time]
- Sprint review on [Date]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/sprint_planning_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/reference/sprint-planning-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="standard_implementation_plan Imported skill standard_implementation_plan from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/reference/standard-implementation-plan.md Unknown LICENSE.txt sources/openai/standard_implementation_plan/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">standard_implementation_plan</div>
                <button class="copy-btn" onclick="copyToClipboard('standard_implementation_plan')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill standard_implementation_plan from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Standard Implementation Plan Template

Use this template for most feature implementations.

```markdown
# Implementation Plan: [Feature Name]

## Overview
[1-2 sentence feature description and business value]

## Linked Specification
&lt;mention-page url=&quot;...&quot;&gt;Original Specification&lt;/mention-page&gt;

## Requirements Summary

### Functional Requirements
- [Requirement 1]
- [Requirement 2]
- [Requirement 3]

### Non-Functional Requirements
- **Performance**: [Targets]
- **Security**: [Requirements]
- **Scalability**: [Needs]

### Acceptance Criteria
- [ ] [Criterion 1]
- [ ] [Criterion 2]
- [ ] [Criterion 3]

## Technical Approach

### Architecture
[High-level architectural decisions]

### Technology Stack
- Backend: [Technologies]
- Frontend: [Technologies]
- Infrastructure: [Technologies]

### Key Design Decisions
1. **[Decision]**: [Rationale]
2. **[Decision]**: [Rationale]

## Implementation Phases

### Phase 1: Foundation (Week 1)
**Goal**: Set up core infrastructure

**Tasks**:
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Database schema design&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;API scaffolding&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Authentication setup&lt;/mention-page&gt;

**Deliverables**: Working API skeleton
**Estimated effort**: 3 days

### Phase 2: Core Features (Week 2-3)
**Goal**: Implement main functionality

**Tasks**:
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Feature A implementation&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Feature B implementation&lt;/mention-page&gt;

**Deliverables**: Core features working
**Estimated effort**: 1 week

### Phase 3: Integration &amp; Polish (Week 4)
**Goal**: Complete integration and refinement

**Tasks**:
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Frontend integration&lt;/mention-page&gt;
- [ ] &lt;mention-page url=&quot;...&quot;&gt;Testing &amp; QA&lt;/mention-page&gt;

**Deliverables**: Production-ready feature
**Estimated effort**: 1 week

## Dependencies

### External Dependencies
- [Dependency 1]: [Status]
- [Dependency 2]: [Status]

### Internal Dependencies
- [Team/component dependency]

### Blockers
- [Known blocker] or None currently

## Risks &amp; Mitigation

### Risk 1: [Description]
- **Probability**: High/Medium/Low
- **Impact**: High/Medium/Low
- **Mitigation**: [Strategy]

### Risk 2: [Description]
- **Probability**: High/Medium/Low
- **Impact**: High/Medium/Low
- **Mitigation**: [Strategy]

## Timeline

| Milestone | Target Date | Status |
|-----------|-------------|--------|
| Phase 1 Complete | [Date] |  Planned |
| Phase 2 Complete | [Date] |  Planned |
| Phase 3 Complete | [Date] |  Planned |
| Launch | [Date] |  Planned |

## Success Criteria

### Technical Success
- [ ] All acceptance criteria met
- [ ] Performance targets achieved
- [ ] Security requirements satisfied
- [ ] Test coverage &gt; 80%

### Business Success
- [ ] [Business metric 1]
- [ ] [Business metric 2]

## Resources

### Documentation
- &lt;mention-page url=&quot;...&quot;&gt;Design Doc&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;API Spec&lt;/mention-page&gt;

### Related Work
- &lt;mention-page url=&quot;...&quot;&gt;Related Feature&lt;/mention-page&gt;

## Progress Tracking

[This section updated regularly]

### Phase Status
- Phase 1:  Not Started
- Phase 2:  Not Started
- Phase 3:  Not Started

**Overall Progress**: 0% complete

### Latest Update: [Date]
[Brief status update]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/standard_implementation_plan/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/reference/standard-implementation-plan.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="status_meeting_prep Imported skill status_meeting_prep from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/evaluations/status-meeting-prep.json Unknown LICENSE.txt sources/openai/status_meeting_prep/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">status_meeting_prep</div>
                <button class="copy-btn" onclick="copyToClipboard('status_meeting_prep')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill status_meeting_prep from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;name&quot;: &quot;Status Update Meeting Preparation&quot;,
  &quot;skills&quot;: [&quot;meeting-intelligence&quot;, &quot;task-manager&quot;],
  &quot;query&quot;: &quot;Prep for Friday&#x27;s project status meeting on the Mobile App Redesign project. Create both an internal pre-read and an external agenda.&quot;,
  &quot;expected_behavior&quot;: [
    &quot;Step 1: Uses Notion:notion-search to find Mobile App Redesign project page&quot;,
    &quot;Step 2: Fetches project page using Notion:notion-fetch to get current status and context&quot;,
    &quot;Step 3: Uses Notion:notion-search to find tasks database&quot;,
    &quot;Step 4: Queries task database using Notion:notion-query-data-sources for project tasks (WHERE Project = &#x27;Mobile App Redesign&#x27;)&quot;,
    &quot;Step 5: Analyzes task data: calculates completion %, identifies completed work, in-progress items, and blockers&quot;,
    &quot;Step 6: Enriches with Codex research - adds project management insights (velocity trends, risk patterns, common project pitfalls), suggests discussion frameworks if risks identified, provides context on timeline implications&quot;,
    &quot;Step 7: Creates INTERNAL PRE-READ using Notion:notion-create-pages with title &#x27;INTERNAL: Mobile App Redesign Status - Pre-Read - [Date]&#x27;&quot;,
    &quot;Step 7a: Internal pre-read includes: Project overview, current status with metrics (from Notion/tasks), progress summary with specifics, context &amp; insights (Codex research on project health patterns), honest assessment of challenges/risks, what we need from meeting&quot;,
    &quot;Step 7b: Internal pre-read contains detailed metrics, blockers, and strategic considerations&quot;,
    &quot;Step 8: Creates EXTERNAL AGENDA using Notion:notion-create-pages with title &#x27;Meeting Agenda: Mobile App Redesign Status Update - [Date]&#x27;&quot;,
    &quot;Step 8a: External agenda uses Status Update structure: Meeting Details  Objective  Agenda Items (timed)  Discussion Topics  Action Items&quot;,
    &quot;Step 8b: External agenda is concise, professional, focuses on meeting flow (summary-level metrics only)&quot;,
    &quot;Step 9: Links both documents together&quot;,
    &quot;Both documents link to project page and task database using &lt;mention-page&gt; and &lt;mention-database&gt;&quot;
  ],
  &quot;success_criteria&quot;: [
    &quot;TWO documents are created (internal pre-read + external agenda)&quot;,
    &quot;Internal pre-read contains: Detailed metrics from task query, honest assessment of blockers/risks, Codex insights on project health patterns, strategic considerations&quot;,
    &quot;Internal pre-read is marked &#x27;INTERNAL&#x27; or &#x27;For team only&#x27;&quot;,
    &quot;External agenda is professional status update format with: Overall status, progress summary (high-level), upcoming work, discussion topics, action items section&quot;,
    &quot;External agenda does NOT contain detailed risk analysis or internal strategic discussion (that&#x27;s in pre-read)&quot;,
    &quot;Progress metrics are accurate based on Notion:notion-query-data-sources results (e.g., X complete, Y in progress, Z blocked)&quot;,
    &quot;Blockers identified from task query are included in internal pre-read with full context&quot;,
    &quot;Codex enrichment adds value (project management insights, risk patterns, velocity analysis)&quot;,
    &quot;Links to project page and task database using mention tags&quot;,
    &quot;Documents are cross-linked for easy navigation&quot;,
    &quot;Uses correct tool names (Notion:notion-search, Notion:notion-fetch, Notion:notion-query-data-sources, Notion:notion-create-pages for BOTH documents)&quot;
  ]
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/status_meeting_prep/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/evaluations/status-meeting-prep.json" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="status_update_template Imported skill status_update_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/reference/status-update-template.md Unknown LICENSE.txt sources/openai/status_update_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">status_update_template</div>
                <button class="copy-btn" onclick="copyToClipboard('status_update_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill status_update_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Status Update Meeting Template

Use this template for regular project status updates and check-ins.

```markdown
# [Project Name] Status Update - [Date]

## Meeting Details
**Date**: [Date and time]
**Attendees**: [List]
**Project**: &lt;mention-page url=&quot;...&quot;&gt;Project Page&lt;/mention-page&gt;

## Executive Summary

**Status**:  On Track /  At Risk /  Behind

**Progress**: [Percentage] complete
**Timeline**: [Status vs original plan]

## Progress Since Last Meeting

### Completed
- [Accomplishment with specifics]
- [Accomplishment with specifics]

### In Progress
- [Work item and status]
- [Work item and status]

## Metrics

| Metric | Current | Target | Status |
|--------|---------|--------|--------|
| [Metric] | [Value] | [Value] | [Icon] |
| [Metric] | [Value] | [Value] | [Icon] |

## Upcoming Work

**Next 2 Weeks**:
- [Planned work]
- [Planned work]

**Next Month**:
- [Milestone or major work]

## Blockers &amp; Risks

### Active Blockers
- **[Blocker]**: [Description and impact]
  - Action: [What&#x27;s being done]

### Risks
- **[Risk]**: [Description]
  - Mitigation: [Strategy]

## Discussion Topics

1. [Topic requiring input]
2. [Topic for alignment]

## Decisions Needed

- [Decision] or None

## Action Items

- [ ] [Action] - @[Owner] - Due: [Date]

## Next Meeting

**Date**: [Date]
**Focus**: [What next meeting will cover]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/status_update_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/reference/status-update-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="task_creation Imported skill task_creation from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/reference/task-creation.md Unknown LICENSE.txt sources/openai/task_creation/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">task_creation</div>
                <button class="copy-btn" onclick="copyToClipboard('task_creation')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill task_creation from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Task Creation from Specs

## Finding the Task Database

Before creating tasks, locate the task database:

```
1. Search for task database:
   Notion:notion-search
   query: &quot;Tasks&quot; or &quot;Task Management&quot; or &quot;[Project] Tasks&quot;
   
2. Fetch database schema:
   Notion:notion-fetch
   id: &quot;database-id-from-search&quot;
   
3. Identify data source:
   - Look for &lt;data-source url=&quot;collection://...&quot;&gt; tags
   - Extract collection ID for parent parameter
   
4. Note schema:
   - Required properties
   - Property types and options
   - Relation properties for linking

Example:
Notion:notion-search
query: &quot;Engineering Tasks&quot;
query_type: &quot;internal&quot;

Notion:notion-fetch
id: &quot;tasks-database-id&quot;
```

Result: `collection://abc-123-def` for use as parent

## Task Breakdown Strategy

### Size Guidelines

**Good task size**:
- Completable in 1-2 days
- Single clear deliverable
- Independently testable
- Minimal dependencies

**Too large**:
- Takes &gt; 3 days
- Multiple deliverables
- Many dependencies
- Break down further

**Too small**:
- Takes &lt; 2 hours
- Too granular
- Group with related work

### Granularity by Phase

**Early phases**: Larger tasks acceptable
- &quot;Design database schema&quot;
- &quot;Set up API structure&quot;

**Middle phases**: Medium-sized tasks
- &quot;Implement user authentication&quot;
- &quot;Build dashboard UI&quot;

**Late phases**: Smaller, precise tasks
- &quot;Fix validation bug in form&quot;
- &quot;Add loading state to button&quot;

## Task Creation Pattern

For each requirement or work item:

```
1. Identify the work
2. Determine task size
3. Create task in database
4. Set properties
5. Write task description
6. Link to spec/plan
```

### Creating Task

```
Use Notion:notion-create-pages:

parent: {
  type: &quot;data_source_id&quot;,
  data_source_id: &quot;collection://tasks-db-uuid&quot;
}

properties: {
  &quot;[Title Property]&quot;: &quot;Task: [Clear task name]&quot;,
  &quot;Status&quot;: &quot;To Do&quot;,
  &quot;Priority&quot;: &quot;[High/Medium/Low]&quot;,
  &quot;[Project/Related]&quot;: [&quot;spec-page-id&quot;, &quot;plan-page-id&quot;],
  &quot;Assignee&quot;: &quot;[Person]&quot; (if known),
  &quot;date:Due Date:start&quot;: &quot;[Date]&quot; (if applicable),
  &quot;date:Due Date:is_datetime&quot;: 0
}

content: &quot;[Task description using template]&quot;
```

## Task Description Template

```markdown
# [Task Name]

## Context
Implementation task for &lt;mention-page url=&quot;...&quot;&gt;Feature Spec&lt;/mention-page&gt;

Part of &lt;mention-page url=&quot;...&quot;&gt;Implementation Plan&lt;/mention-page&gt; - Phase [N]

## Objective
[What this task accomplishes]

## Requirements
Based on spec requirements:
- [Relevant requirement 1]
- [Relevant requirement 2]

## Acceptance Criteria
- [ ] [Specific, testable criterion]
- [ ] [Specific, testable criterion]
- [ ] [Specific, testable criterion]

## Technical Approach
[Suggested implementation approach]

### Components Affected
- [Component 1]
- [Component 2]

### Key Decisions
- [Decision point 1]
- [Decision point 2]

## Dependencies

### Blocked By
- &lt;mention-page url=&quot;...&quot;&gt;Prerequisite Task&lt;/mention-page&gt; or None

### Blocks
- &lt;mention-page url=&quot;...&quot;&gt;Dependent Task&lt;/mention-page&gt; or None

## Resources
- [Link to design mockup]
- [Link to API spec]
- [Link to relevant code]

## Estimated Effort
[Time estimate]

## Progress
[To be updated during implementation]
```

## Task Types

### Infrastructure/Setup Tasks

```
Title: &quot;Setup: [What&#x27;s being set up]&quot;
Examples:
- &quot;Setup: Configure database connection pool&quot;
- &quot;Setup: Initialize authentication middleware&quot;
- &quot;Setup: Create CI/CD pipeline&quot;

Focus: Getting environment/tooling ready
```

### Feature Implementation Tasks

```
Title: &quot;Implement: [Feature name]&quot;
Examples:
- &quot;Implement: User login flow&quot;
- &quot;Implement: File upload functionality&quot;
- &quot;Implement: Dashboard widget&quot;

Focus: Building specific functionality
```

### Integration Tasks

```
Title: &quot;Integrate: [What&#x27;s being integrated]&quot;
Examples:
- &quot;Integrate: Connect frontend to API&quot;
- &quot;Integrate: Add payment provider&quot;
- &quot;Integrate: Link user profile to dashboard&quot;

Focus: Connecting components
```

### Testing Tasks

```
Title: &quot;Test: [What&#x27;s being tested]&quot;
Examples:
- &quot;Test: Write unit tests for auth service&quot;
- &quot;Test: E2E testing for checkout flow&quot;
- &quot;Test: Performance testing for API&quot;

Focus: Validation and quality assurance
```

### Documentation Tasks

```
Title: &quot;Document: [What&#x27;s being documented]&quot;
Examples:
- &quot;Document: API endpoints&quot;
- &quot;Document: Setup instructions&quot;
- &quot;Document: Architecture decisions&quot;

Focus: Creating documentation
```

### Bug Fix Tasks

```
Title: &quot;Fix: [Bug description]&quot;
Examples:
- &quot;Fix: Login error on Safari&quot;
- &quot;Fix: Memory leak in image processing&quot;
- &quot;Fix: Race condition in payment flow&quot;

Focus: Resolving issues
```

### Refactoring Tasks

```
Title: &quot;Refactor: [What&#x27;s being refactored]&quot;
Examples:
- &quot;Refactor: Extract auth logic to service&quot;
- &quot;Refactor: Optimize database queries&quot;
- &quot;Refactor: Simplify component hierarchy&quot;

Focus: Code quality improvement
```

## Sequencing Tasks

### Critical Path

Identify must-happen-first tasks:

```
1. Database schema
2. API foundation
3. Core business logic
4. Frontend integration
5. Testing
6. Deployment
```

### Parallel Tracks

Tasks that can happen simultaneously:

```
Track A: Backend development
- API endpoints
- Business logic
- Database operations

Track B: Frontend development
- UI components
- State management
- Routing

Track C: Infrastructure
- CI/CD setup
- Monitoring
- Documentation
```

### Phase-Based Sequencing

Group by implementation phase:

```
Phase 1 (Foundation):
- Setup tasks
- Infrastructure tasks

Phase 2 (Core):
- Feature implementation tasks
- Integration tasks

Phase 3 (Polish):
- Testing tasks
- Documentation tasks
- Optimization tasks
```

## Priority Assignment

### P0/Critical
- Blocks everything else
- Core functionality
- Security requirements
- Data integrity

### P1/High
- Important features
- User-facing functionality
- Performance requirements

### P2/Medium
- Nice-to-have features
- Optimizations
- Minor improvements

### P3/Low
- Future enhancements
- Edge case handling
- Cosmetic improvements

## Estimation

### Story Points

If using story points:
- 1 point: Few hours
- 2 points: Half day
- 3 points: Full day
- 5 points: 2 days
- 8 points: 3-4 days (consider breaking down)

### Time Estimates

Direct time estimates:
- 2-4 hours: Small task
- 1 day: Medium task
- 2 days: Large task
- 3+ days: Break down further

### Estimation Factors

Consider:
- Complexity
- Unknowns
- Dependencies
- Testing requirements
- Documentation needs

## Task Relationships

### Parent Task Pattern

For large features:

```
Parent: &quot;Feature: User Authentication&quot;
Children:
- &quot;Setup: Configure auth library&quot;
- &quot;Implement: Login flow&quot;
- &quot;Implement: Password reset&quot;
- &quot;Test: Auth functionality&quot;
```

### Dependency Chain Pattern

For sequential work:

```
Task A: &quot;Design database schema&quot;
 (blocks)
Task B: &quot;Implement data models&quot;
 (blocks)
Task C: &quot;Create API endpoints&quot;
 (blocks)
Task D: &quot;Integrate with frontend&quot;
```

### Related Tasks Pattern

For parallel work:

```
Central: &quot;Feature: Dashboard&quot;
Related:
- &quot;Backend API for dashboard data&quot;
- &quot;Frontend dashboard component&quot;
- &quot;Dashboard data caching&quot;
```

## Bulk Task Creation

When creating many tasks:

```
For each work item in breakdown:
  1. Determine task properties
  2. Create task page
  3. Link to spec/plan
  4. Set relationships

Then:
  1. Update plan with task links
  2. Review sequencing
  3. Assign tasks (if known)
```

## Task Naming Conventions

**Be specific**:
 &quot;Implement user login with email/password&quot;
 &quot;Add login&quot;

**Include context**:
 &quot;Dashboard: Add revenue chart widget&quot;
 &quot;Add chart&quot;

**Use action verbs**:
- Implement, Build, Create
- Integrate, Connect, Link
- Fix, Resolve, Debug
- Test, Validate, Verify
- Document, Write, Update
- Refactor, Optimize, Improve

## Validation Checklist

Before finalizing tasks:

 Each task has clear objective
 Acceptance criteria are testable
 Dependencies identified
 Appropriate size (1-2 days)
 Priority assigned
 Linked to spec/plan
 Proper sequencing
 Resources noted</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/task_creation/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/reference/task-creation.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="task_creation_template Imported skill task_creation_template from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/reference/task-creation-template.md Unknown LICENSE.txt sources/openai/task_creation_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">task_creation_template</div>
                <button class="copy-btn" onclick="copyToClipboard('task_creation_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill task_creation_template from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Task Creation Template

When creating tasks from spec.

```markdown
# [Task Name]

## Context
Part of implementation for &lt;mention-page url=&quot;...&quot;&gt;Feature Spec&lt;/mention-page&gt;

Implementation plan: &lt;mention-page url=&quot;...&quot;&gt;Implementation Plan&lt;/mention-page&gt;

## Description
[What needs to be done]

## Acceptance Criteria
- [ ] [Criterion 1]
- [ ] [Criterion 2]

## Technical Details
[Technical approach or notes]

## Dependencies
- Blocked by: [Task] or None
- Blocks: [Task] or None

## Resources
- [Link to design]
- [Link to related code]

## Progress
[To be updated during implementation]
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/task_creation_template/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/reference/task-creation-template.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="team_wiki_database Imported skill team_wiki_database from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-knowledge-capture/reference/team-wiki-database.md Unknown LICENSE.txt sources/openai/team_wiki_database/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">team_wiki_database</div>
                <button class="copy-btn" onclick="copyToClipboard('team_wiki_database')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill team_wiki_database from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Team Wiki Database

**Purpose**: Centralized team knowledge and resources.

## Schema

| Property | Type | Options | Purpose |
|----------|------|---------|---------|
| **Title** | title | - | Page name |
| **Section** | select | Getting Started, Processes, Tools, Reference, Onboarding | Wiki organization |
| **Tags** | multi_select | - | Topic tags |
| **Owner** | people | - | Page maintainer |
| **Last Updated** | last_edited_time | - | Auto-tracked |
| **Visibility** | select | Public, Team Only, Confidential | Access level |

## Usage

Use for team-specific documentation that doesn&#x27;t fit other databases.

## Best Practices

1. **Organize by sections**: Use clear top-level organization
2. **Assign owners**: Every page should have a maintainer
3. **Control visibility**: Set appropriate access levels
4. **Link extensively**: Connect related pages
5. **Keep current**: Regular reviews to remove outdated content</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/team_wiki_database/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/reference/team-wiki-database.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-knowledge-capture/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="technical_investigation Imported skill technical_investigation from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/examples/technical-investigation.md Unknown LICENSE.txt sources/openai/technical_investigation/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">technical_investigation</div>
                <button class="copy-btn" onclick="copyToClipboard('technical_investigation')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill technical_investigation from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: Technical Investigation

## User Request

&gt; &quot;Research our current caching strategy and create a technical summary&quot;

## Workflow Execution

### Step 1: Search for Caching Information

```
Notion:notion-search
query: &quot;caching strategy architecture&quot;
query_type: &quot;internal&quot;
teamspace_id: &quot;engineering-teamspace-id&quot;
```

**Results Found:**
- &quot;System Architecture Overview&quot; (Engineering)
- &quot;Redis Implementation Guide&quot; (Backend Docs)
- &quot;Performance Optimization - Q3 2024&quot; (Engineering)
- &quot;API Caching Decision Record&quot; (Architecture)

### Step 2: Fetch Relevant Pages

```
Notion:notion-fetch
id: &quot;system-architecture-page-url&quot;
```

Extracted: Current caching architecture uses Redis for API responses, Memcached for session storage.

```
Notion:notion-fetch
id: &quot;redis-implementation-guide-url&quot;
```

Extracted: Implementation details, TTL settings, invalidation strategies.

```
Notion:notion-fetch
id: &quot;api-caching-decision-record-url&quot;
```

Extracted: Why Redis was chosen over alternatives, trade-offs considered.

### Step 3: Synthesize Findings

**Key findings identified:**
- Two-tier caching: Redis (API responses) + Memcached (sessions)
- TTL strategy: 5 minutes for dynamic data, 1 hour for static
- Invalidation: Event-driven for critical updates
- Performance impact: 75% reduction in database load
- Known issues: Cache stampede on popular endpoints

### Step 4: Create Technical Summary

```
Notion:notion-create-pages

parent: { page_id: &quot;engineering-docs-parent-id&quot; }

pages: [{
  properties: {
    &quot;title&quot;: &quot;Technical Summary: Caching Strategy - Oct 2025&quot;
  },
  content: &quot;[Structured technical summary using template]&quot;
}]
```

## Output Document

```markdown
# Technical Summary: Caching Strategy - Oct 2025

## Executive Summary

Our caching infrastructure uses a two-tier approach with Redis for API response caching and Memcached for session management. This strategy has reduced database load by 75% and improved API response times from 200ms to 50ms average.

## Architecture Overview

### Layer 1: API Response Caching (Redis)
**Technology**: Redis 7.0 cluster (3 nodes)
**Purpose**: Cache GET endpoint responses
**TTL Strategy**:
- Dynamic content: 5 minutes
- Static content: 1 hour
- User-specific: 15 minutes

**Source**: &lt;mention-page url=&quot;...&quot;&gt;System Architecture Overview&lt;/mention-page&gt;

### Layer 2: Session Storage (Memcached)
**Technology**: Memcached 1.6
**Purpose**: User session data, temporary state
**TTL**: 24 hours (session lifetime)

## Implementation Details

### Cache Key Format
```
api:v1:{endpoint}:{params_hash}
session:{user_id}:{session_id}
```

### Invalidation Strategy
- **Event-driven**: Critical data changes trigger immediate invalidation
- **Time-based**: TTL expiration for non-critical data
- **Manual**: Admin tools for emergency cache clear

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Redis Implementation Guide&lt;/mention-page&gt;

## Decision Rationale

### Why Redis for API Caching?

**Pros**:
- Advanced data structures (sorted sets, hashes)
- Built-in TTL with automatic eviction
- Pub/sub for cache invalidation events
- Persistence options for durability

**Cons**:
- Higher memory usage than Memcached
- More complex cluster management

**Decision**: Chosen for flexibility and rich feature set needed for API caching.

**Source**: &lt;mention-page url=&quot;...&quot;&gt;API Caching Decision Record&lt;/mention-page&gt;

### Why Memcached for Sessions?

**Pros**:
- Simpler, lighter weight
- Excellent for key-value storage
- Lower memory footprint

**Cons**:
- No persistence
- Limited data structures

**Decision**: Perfect fit for ephemeral session data where simplicity is valued.

## Performance Impact

| Metric | Before Caching | After Caching | Improvement |
|--------|----------------|---------------|-------------|
| Avg Response Time | 200ms | 50ms | 75% faster |
| Database Load | 100% | 25% | 75% reduction |
| Cache Hit Rate | - | 85% | - |
| Peak RPS Handled | 1,000 | 4,000 | 4x increase |

**Source**: &lt;mention-page url=&quot;...&quot;&gt;Performance Optimization - Q3 2024&lt;/mention-page&gt;

## Known Issues &amp; Limitations

### Cache Stampede
**Issue**: When popular cache entries expire, multiple requests hit database simultaneously

**Mitigation**: Implemented probabilistic early expiration and request coalescing

**Status**: Reduced by 90% but not eliminated

### Stale Data Risk
**Issue**: Cached data can be up to TTL duration stale

**Mitigation**: Event-driven invalidation for critical data paths

**Status**: Acceptable trade-off for performance gains

## Monitoring &amp; Observability

**Metrics tracked**:
- Cache hit/miss rates per endpoint
- Memory usage and eviction rates
- Response time distributions
- Invalidation event frequency

**Tools**: DataDog dashboards, CloudWatch alarms

## Future Considerations

1. **Edge Caching**: Evaluate CDN integration for static assets
2. **Cache Warming**: Pre-populate cache for predictable traffic spikes
3. **Adaptive TTLs**: Adjust TTLs based on data change frequency
4. **Regional Caching**: Multi-region cache replication for global performance

## Related Documentation

- &lt;mention-page url=&quot;...&quot;&gt;System Architecture Overview&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Redis Implementation Guide&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;API Caching Decision Record&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Performance Optimization - Q3 2024&lt;/mention-page&gt;

## Appendix: Configuration Examples

### Redis Configuration
```yaml
maxmemory: 8gb
maxmemory-policy: allkeys-lru
tcp-keepalive: 60
```

### Common Cache Operations
```python
# Set with TTL
cache.set(key, value, ttl=300)

# Get with fallback
value = cache.get(key) or fetch_from_db(key)

# Invalidate pattern
cache.delete_pattern(&quot;api:v1:users:*&quot;)
```
```

## Key Success Factors

1. **Multiple source integration**: Combined architecture docs, implementation guides, and decision records
2. **Technical depth**: Included configuration, code examples, metrics
3. **Decision context**: Explained why choices were made, not just what
4. **Practical focus**: Real performance numbers and known issues
5. **Future-looking**: Noted areas for improvement
6. **Well-cited**: Every major point links back to source material

## Workflow Pattern Demonstrated

This example shows the complete research workflow:
- **Scoped search** (teamspace filter for engineering)
- **Multi-page synthesis** (4 different sources)
- **Technical template** (architecture-focused format)
- **Proper placement** (under engineering docs)
- **Comprehensive citations** (links to all sources)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/technical_investigation/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/examples/technical-investigation.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="template_selection_guide Imported skill template_selection_guide from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-meeting-intelligence/reference/template-selection-guide.md Unknown LICENSE.txt sources/openai/template_selection_guide/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">template_selection_guide</div>
                <button class="copy-btn" onclick="copyToClipboard('template_selection_guide')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill template_selection_guide from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Meeting Template Selection Guide

Choose the right template for your meeting type.

## Template Overview

| Meeting Type | Use This Template | When to Use |
|--------------|-------------------|-------------|
| Make a decision | [Decision Meeting](decision-meeting-template.md) | Need to evaluate options and reach a decision |
| Project update | [Status Update](status-update-template.md) | Regular check-ins, progress reviews |
| Generate ideas | [Brainstorming](brainstorming-template.md) | Creative ideation, problem-solving |
| Sprint planning | [Sprint Planning](sprint-planning-template.md) | Planning agile sprint work |
| Sprint retro | [Retrospective](retrospective-template.md) | Reflecting on completed work |
| Manager/report | [1:1 Meeting](one-on-one-template.md) | Regular one-on-one check-ins |
| Weekly team sync | [Status Update](status-update-template.md) (simplified) | Routine team synchronization |

## Quick Decision Tree

```
What&#x27;s the primary purpose?

 Make a decision
   Use: Decision Meeting Template

 Update on progress
   Use: Status Update Template

 Generate ideas
   Use: Brainstorming Template

 Plan sprint work
   Use: Sprint Planning Template

 Reflect on past work
   Use: Retrospective Template

 Manager/report check-in
    Use: 1:1 Meeting Template
```

## Template Customization

All templates can be customized:
- **Simplify** for shorter meetings
- **Add sections** for specific needs
- **Combine elements** from multiple templates
- **Adapt language** for your team culture

## Best Practices

1. **Choose template first**: Select before gathering context
2. **Gather Notion content**: Search and fetch relevant pages
3. **Enrich with research**: Add Codex insights where valuable
4. **Customize as needed**: Adapt template to specific situation
5. **Share early**: Give attendees time to review</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/template_selection_guide/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/reference/template-selection-guide.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-meeting-intelligence/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="trip_planning Imported skill trip_planning from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-research-documentation/examples/trip-planning.md Unknown LICENSE.txt sources/openai/trip_planning/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">trip_planning</div>
                <button class="copy-btn" onclick="copyToClipboard('trip_planning')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill trip_planning from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: Group Trip Research &amp; Planning

**User Request**: &quot;Research and plan our friends&#x27; trip to Japan in March - we&#x27;re 6 people looking for 10 days&quot;

## Workflow

### 1. Search Existing Notes
```
Notion:notion-search
query: &quot;Japan travel&quot;
```
Found: Japan Travel Guide (from friend), Tokyo Restaurants, Kyoto Temple Guide

### 2. Fetch &amp; Extract Tips
```
Notion:notion-fetch (3x)
```
**Key info from previous travelers:**
- Best time: March-April (cherry blossoms)
- Must-see: Tokyo, Kyoto, Osaka
- Budget: $200-300/day (mid-range)
- Book accommodations 3 months ahead
- Get JR Pass before arrival
- Top restaurants: Sushi Dai, Ichiran Ramen, Tsunahachi Tempura

### 3. Research &amp; Synthesize
Combined previous traveler insights with:
- Flight options and prices
- Accommodation types (hotels/ryokans/Airbnb)
- Transportation (JR Pass essential)
- 10-day itinerary structure
- Budget breakdown

### 4. Create Comprehensive Plan
```
Notion:notion-create-pages
parent: { page_id: &quot;travel-plans-parent-id&quot; }
pages: [{
  properties: {
    title: &quot;Japan Trip 2026 - March 15-25 (10 Days)&quot;
  },
  content: &quot;[Full trip plan with itinerary, budget, tips...]&quot;
}]
```

## Output Sample

```markdown
# Japan Trip 2026 - March 15-25 (10 Days)

## Trip Overview
**Dates**: March 15-25, 2026 (Cherry Blossom Season )
**Group**: 6 people | **Budget**: $3,000-4,000/person

## Itinerary Summary

**Days 1-3: Tokyo**
- Arrive, explore Shibuya, Harajuku, Shinjuku
- Visit Tsukiji Market, Imperial Palace, Sensoji Temple
- Experience Tokyo nightlife, teamLab Borderless

**Days 4-5: Hakone**  
- Day trip from Tokyo
- Hot springs, Mt. Fuji views, Lake Ashi cruise

**Days 6-8: Kyoto**
- Bullet train from Tokyo
- Fushimi Inari, Kinkaku-ji, Arashiyama Bamboo Grove
- Geisha district (Gion), traditional tea ceremony

**Days 9-10: Osaka + Depart**
- Osaka Castle, Dotonbori food district
- Nara day trip (deer park, Todai-ji Temple)
- Return flight from Osaka (KIX)

## Budget Breakdown (per person)
- **Flights**: $900-1,200 (round-trip)
- **Accommodations**: $700-1,000 (9 nights)
- **JR Pass**: $280 (7-day pass)
- **Food**: $500-700 ($50-70/day)
- **Activities**: $300-400
- **Local transport**: $100
**Total**: $2,780-3,680

## Key Bookings
- **Flights**: Book 3-4 months ahead
- **Hotels**: Book now (cherry blossom season)
  - Tokyo: Shinjuku area (2 nights) + Asakusa (1 night)
  - Kyoto: Gion area (3 nights)
  - Osaka: Namba area (2 nights)
- **JR Pass**: Order 2-3 weeks before travel
- **Restaurants**: Reserve 1 week ahead (Sushi Dai, high-end spots)

## Essential Tips
Source: &lt;mention-page url=&quot;...&quot;&gt;Japan Travel Guide&lt;/mention-page&gt;
- Get pocket WiFi or eSIM on arrival
- Download: Google Translate, Hyperdia (train routes), Tabelog (restaurants)
- Cash-heavy country - withdraw at 7-Eleven ATMs
- Shoes off in temples, ryokans, some restaurants
- Trains extremely punctual - don&#x27;t be late
- Learn basic phrases: arigatou, sumimasen, itadakimasu

## Packing List
- Comfortable walking shoes (10k+ steps/day)
- Light jacket (March 55-65F)
- Backpack for day trips
- Cash pouch
- Portable charger

## Next Steps
- [ ] Book flights (target: &lt;$1,100/person)
- [ ] Order JR Passes
- [ ] Book hotels (Tokyo  Kyoto  Osaka)
- [ ] Create shared expense tracker
- [ ] Schedule group planning call

## Sources
- &lt;mention-page url=&quot;...&quot;&gt;Japan Travel Guide&lt;/mention-page&gt; (Sarah&#x27;s 2024 trip)
- &lt;mention-page url=&quot;...&quot;&gt;Tokyo Restaurant Recommendations&lt;/mention-page&gt;
- &lt;mention-page url=&quot;...&quot;&gt;Kyoto Temple Guide&lt;/mention-page&gt;
```

## Key Takeaways
- Leveraged previous traveler notes from Notion
- Combined personal insights with research
- Created actionable itinerary with budget breakdown
- Included practical tips from experienced travelers
- Set clear next steps for group coordination</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/trip_planning/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/examples/trip-planning.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-research-documentation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="ui_component Imported skill ui_component from openai openai /a0/tmp/skills_research/openai/skills/.curated/notion-spec-to-implementation/examples/ui-component.md Unknown LICENSE.txt sources/openai/ui_component/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">ui_component</div>
                <button class="copy-btn" onclick="copyToClipboard('ui_component')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">openai</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: LICENSE.txt</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill ui_component from openai</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Example: UI Component Implementation

**User Request**: &quot;Implement the new search component from the design spec&quot;

## Workflow

### 1. Find Spec
```
Notion:notion-search
query: &quot;search component design spec&quot;
```
Found: &quot;Global Search Redesign Spec&quot;

### 2. Fetch &amp; Parse Spec
```
Notion:notion-fetch
```

**Requirements**:
- Instant search with debounced API calls
- Keyboard navigation ( arrows, Enter, Esc)
- Recent searches history
- Result categories (pages, people, files)
- Mobile responsive
- Accessibility (ARIA labels, screen reader)

### 3. Create Implementation Plan
```
Notion:notion-create-pages
```

**Plan phases**:
- Phase 1: Base component structure
- Phase 2: API integration &amp; debouncing
- Phase 3: Keyboard navigation
- Phase 4: Recent searches
- Phase 5: Polish &amp; accessibility

### 4. Create Tasks
```
Notion:notion-create-pages (7 tasks)
```

**Tasks**:
1. Create SearchInput component
2. Implement useDebounce hook
3. Add keyboard navigation
4. LocalStorage for recent searches
5. Result categorization UI
6. Accessibility audit
7. Mobile responsive styling

### 5. Implement &amp; Track
As each task completed, updated status and added progress notes with screenshots and implementation details.

## Key Outputs

**Implementation Plan** (linked to design spec)
**7 Component Tasks** (in Engineering Tasks database)
**Progress Updates** (with code snippets and demo links)

## Success Factors
- Clear component breakdown
- Separated concerns (logic, UI, accessibility)
- Each task had acceptance criteria
- Referenced design spec throughout
- Included accessibility from start, not afterthought
- Tracked progress with visual updates</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/openai/ui_component/SKILL.md" class="source-link">Registry File</a>
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/examples/ui-component.md" class="source-link" target="_blank" rel="noopener">Upstream File</a>
                    
                    <a href="https://github.com/openai/skills/blob/main/skills/.curated/notion-spec-to-implementation/LICENSE.txt" class="source-link" target="_blank" rel="noopener">License: LICENSE.txt</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="_sections Imported skill _sections from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/_sections.md Unknown See repository sources/vercel/_sections/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">_sections</div>
                <button class="copy-btn" onclick="copyToClipboard('_sections')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill _sections from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># Sections

This file defines all sections, their ordering, impact levels, and descriptions.
The section ID (in parentheses) is the filename prefix used to group rules.

---

## 1. Eliminating Waterfalls (async)

**Impact:** CRITICAL  
**Description:** Waterfalls are the #1 performance killer. Each sequential await adds full network latency. Eliminating them yields the largest gains.

## 2. Bundle Size Optimization (bundle)

**Impact:** CRITICAL  
**Description:** Reducing initial bundle size improves Time to Interactive and Largest Contentful Paint.

## 3. Server-Side Performance (server)

**Impact:** HIGH  
**Description:** Optimizing server-side rendering and data fetching eliminates server-side waterfalls and reduces response times.

## 4. Client-Side Data Fetching (client)

**Impact:** MEDIUM-HIGH  
**Description:** Automatic deduplication and efficient data fetching patterns reduce redundant network requests.

## 5. Re-render Optimization (rerender)

**Impact:** MEDIUM  
**Description:** Reducing unnecessary re-renders minimizes wasted computation and improves UI responsiveness.

## 6. Rendering Performance (rendering)

**Impact:** MEDIUM  
**Description:** Optimizing the rendering process reduces the work the browser needs to do.

## 7. JavaScript Performance (js)

**Impact:** LOW-MEDIUM  
**Description:** Micro-optimizations for hot paths can add up to meaningful improvements.

## 8. Advanced Patterns (advanced)

**Impact:** LOW  
**Description:** Advanced patterns for specific cases that require careful implementation.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/_sections/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="_template Imported skill _template from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/_template.md Unknown See repository sources/vercel/_template/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">_template</div>
                <button class="copy-btn" onclick="copyToClipboard('_template')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill _template from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Rule Title Here
impact: MEDIUM
impactDescription: Optional description of impact (e.g., &quot;20-50% improvement&quot;)
tags: tag1, tag2
---

## Rule Title Here

**Impact: MEDIUM (optional impact description)**

Brief explanation of the rule and why it matters. This should be clear and concise, explaining the performance implications.

**Incorrect (description of what&#x27;s wrong):**

```typescript
// Bad code example here
const bad = example()
```

**Correct (description of what&#x27;s right):**

```typescript
// Good code example here
const good = example()
```

Reference: [Link to documentation or resource](https://example.com)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/_template/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="advanced_event_handler_refs Imported skill advanced_event_handler_refs from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/advanced-event-handler-refs.md Unknown See repository sources/vercel/advanced_event_handler_refs/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">advanced_event_handler_refs</div>
                <button class="copy-btn" onclick="copyToClipboard('advanced_event_handler_refs')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill advanced_event_handler_refs from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Store Event Handlers in Refs
impact: LOW
impactDescription: stable subscriptions
tags: advanced, hooks, refs, event-handlers, optimization
---

## Store Event Handlers in Refs

Store callbacks in refs when used in effects that shouldn&#x27;t re-subscribe on callback changes.

**Incorrect (re-subscribes on every render):**

```tsx
function useWindowEvent(event: string, handler: (e) =&gt; void) {
  useEffect(() =&gt; {
    window.addEventListener(event, handler)
    return () =&gt; window.removeEventListener(event, handler)
  }, [event, handler])
}
```

**Correct (stable subscription):**

```tsx
function useWindowEvent(event: string, handler: (e) =&gt; void) {
  const handlerRef = useRef(handler)
  useEffect(() =&gt; {
    handlerRef.current = handler
  }, [handler])

  useEffect(() =&gt; {
    const listener = (e) =&gt; handlerRef.current(e)
    window.addEventListener(event, listener)
    return () =&gt; window.removeEventListener(event, listener)
  }, [event])
}
```

**Alternative: use `useEffectEvent` if you&#x27;re on latest React:**

```tsx
import { useEffectEvent } from &#x27;react&#x27;

function useWindowEvent(event: string, handler: (e) =&gt; void) {
  const onEvent = useEffectEvent(handler)

  useEffect(() =&gt; {
    window.addEventListener(event, onEvent)
    return () =&gt; window.removeEventListener(event, onEvent)
  }, [event])
}
```

`useEffectEvent` provides a cleaner API for the same pattern: it creates a stable function reference that always calls the latest version of the handler.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/advanced_event_handler_refs/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="agents Imported skill agents from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/AGENTS.md Unknown See repository sources/vercel/agents/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">agents</div>
                <button class="copy-btn" onclick="copyToClipboard('agents')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill agents from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># React Best Practices

**Version 1.0.0**  
Vercel Engineering  
January 2026

&gt; **Note:**  
&gt; This document is mainly for agents and LLMs to follow when maintaining,  
&gt; generating, or refactoring React and Next.js codebases at Vercel. Humans  
&gt; may also find it useful, but guidance here is optimized for automation  
&gt; and consistency by AI-assisted workflows.

---

## Abstract

Comprehensive performance optimization guide for React and Next.js applications, designed for AI agents and LLMs. Contains 40+ rules across 8 categories, prioritized by impact from critical (eliminating waterfalls, reducing bundle size) to incremental (advanced patterns). Each rule includes detailed explanations, real-world examples comparing incorrect vs. correct implementations, and specific impact metrics to guide automated refactoring and code generation.

---

## Table of Contents

1. [Eliminating Waterfalls](#1-eliminating-waterfalls)  **CRITICAL**
   - 1.1 [Defer Await Until Needed](#11-defer-await-until-needed)
   - 1.2 [Dependency-Based Parallelization](#12-dependency-based-parallelization)
   - 1.3 [Prevent Waterfall Chains in API Routes](#13-prevent-waterfall-chains-in-api-routes)
   - 1.4 [Promise.all() for Independent Operations](#14-promiseall-for-independent-operations)
   - 1.5 [Strategic Suspense Boundaries](#15-strategic-suspense-boundaries)
2. [Bundle Size Optimization](#2-bundle-size-optimization)  **CRITICAL**
   - 2.1 [Avoid Barrel File Imports](#21-avoid-barrel-file-imports)
   - 2.2 [Conditional Module Loading](#22-conditional-module-loading)
   - 2.3 [Defer Non-Critical Third-Party Libraries](#23-defer-non-critical-third-party-libraries)
   - 2.4 [Dynamic Imports for Heavy Components](#24-dynamic-imports-for-heavy-components)
   - 2.5 [Preload Based on User Intent](#25-preload-based-on-user-intent)
3. [Server-Side Performance](#3-server-side-performance)  **HIGH**
   - 3.1 [Cross-Request LRU Caching](#31-cross-request-lru-caching)
   - 3.2 [Minimize Serialization at RSC Boundaries](#32-minimize-serialization-at-rsc-boundaries)
   - 3.3 [Parallel Data Fetching with Component Composition](#33-parallel-data-fetching-with-component-composition)
   - 3.4 [Per-Request Deduplication with React.cache()](#34-per-request-deduplication-with-reactcache)
   - 3.5 [Use after() for Non-Blocking Operations](#35-use-after-for-non-blocking-operations)
4. [Client-Side Data Fetching](#4-client-side-data-fetching)  **MEDIUM-HIGH**
   - 4.1 [Deduplicate Global Event Listeners](#41-deduplicate-global-event-listeners)
   - 4.2 [Use Passive Event Listeners for Scrolling Performance](#42-use-passive-event-listeners-for-scrolling-performance)
   - 4.3 [Use SWR for Automatic Deduplication](#43-use-swr-for-automatic-deduplication)
   - 4.4 [Version and Minimize localStorage Data](#44-version-and-minimize-localstorage-data)
5. [Re-render Optimization](#5-re-render-optimization)  **MEDIUM**
   - 5.1 [Defer State Reads to Usage Point](#51-defer-state-reads-to-usage-point)
   - 5.2 [Extract to Memoized Components](#52-extract-to-memoized-components)
   - 5.3 [Narrow Effect Dependencies](#53-narrow-effect-dependencies)
   - 5.4 [Subscribe to Derived State](#54-subscribe-to-derived-state)
   - 5.5 [Use Functional setState Updates](#55-use-functional-setstate-updates)
   - 5.6 [Use Lazy State Initialization](#56-use-lazy-state-initialization)
   - 5.7 [Use Transitions for Non-Urgent Updates](#57-use-transitions-for-non-urgent-updates)
6. [Rendering Performance](#6-rendering-performance)  **MEDIUM**
   - 6.1 [Animate SVG Wrapper Instead of SVG Element](#61-animate-svg-wrapper-instead-of-svg-element)
   - 6.2 [CSS content-visibility for Long Lists](#62-css-content-visibility-for-long-lists)
   - 6.3 [Hoist Static JSX Elements](#63-hoist-static-jsx-elements)
   - 6.4 [Optimize SVG Precision](#64-optimize-svg-precision)
   - 6.5 [Prevent Hydration Mismatch Without Flickering](#65-prevent-hydration-mismatch-without-flickering)
   - 6.6 [Use Activity Component for Show/Hide](#66-use-activity-component-for-showhide)
   - 6.7 [Use Explicit Conditional Rendering](#67-use-explicit-conditional-rendering)
7. [JavaScript Performance](#7-javascript-performance)  **LOW-MEDIUM**
   - 7.1 [Batch DOM CSS Changes](#71-batch-dom-css-changes)
   - 7.2 [Build Index Maps for Repeated Lookups](#72-build-index-maps-for-repeated-lookups)
   - 7.3 [Cache Property Access in Loops](#73-cache-property-access-in-loops)
   - 7.4 [Cache Repeated Function Calls](#74-cache-repeated-function-calls)
   - 7.5 [Cache Storage API Calls](#75-cache-storage-api-calls)
   - 7.6 [Combine Multiple Array Iterations](#76-combine-multiple-array-iterations)
   - 7.7 [Early Length Check for Array Comparisons](#77-early-length-check-for-array-comparisons)
   - 7.8 [Early Return from Functions](#78-early-return-from-functions)
   - 7.9 [Hoist RegExp Creation](#79-hoist-regexp-creation)
   - 7.10 [Use Loop for Min/Max Instead of Sort](#710-use-loop-for-minmax-instead-of-sort)
   - 7.11 [Use Set/Map for O(1) Lookups](#711-use-setmap-for-o1-lookups)
   - 7.12 [Use toSorted() Instead of sort() for Immutability](#712-use-tosorted-instead-of-sort-for-immutability)
8. [Advanced Patterns](#8-advanced-patterns)  **LOW**
   - 8.1 [Store Event Handlers in Refs](#81-store-event-handlers-in-refs)
   - 8.2 [useLatest for Stable Callback Refs](#82-uselatest-for-stable-callback-refs)

---

## 1. Eliminating Waterfalls

**Impact: CRITICAL**

Waterfalls are the #1 performance killer. Each sequential await adds full network latency. Eliminating them yields the largest gains.

### 1.1 Defer Await Until Needed

**Impact: HIGH (avoids blocking unused code paths)**

Move `await` operations into the branches where they&#x27;re actually used to avoid blocking code paths that don&#x27;t need them.

**Incorrect: blocks both branches**

```typescript
async function handleRequest(userId: string, skipProcessing: boolean) {
  const userData = await fetchUserData(userId)
  
  if (skipProcessing) {
    // Returns immediately but still waited for userData
    return { skipped: true }
  }
  
  // Only this branch uses userData
  return processUserData(userData)
}
```

**Correct: only blocks when needed**

```typescript
async function handleRequest(userId: string, skipProcessing: boolean) {
  if (skipProcessing) {
    // Returns immediately without waiting
    return { skipped: true }
  }
  
  // Fetch only when needed
  const userData = await fetchUserData(userId)
  return processUserData(userData)
}
```

**Another example: early return optimization**

```typescript
// Incorrect: always fetches permissions
async function updateResource(resourceId: string, userId: string) {
  const permissions = await fetchPermissions(userId)
  const resource = await getResource(resourceId)
  
  if (!resource) {
    return { error: &#x27;Not found&#x27; }
  }
  
  if (!permissions.canEdit) {
    return { error: &#x27;Forbidden&#x27; }
  }
  
  return await updateResourceData(resource, permissions)
}

// Correct: fetches only when needed
async function updateResource(resourceId: string, userId: string) {
  const resource = await getResource(resourceId)
  
  if (!resource) {
    return { error: &#x27;Not found&#x27; }
  }
  
  const permissions = await fetchPermissions(userId)
  
  if (!permissions.canEdit) {
    return { error: &#x27;Forbidden&#x27; }
  }
  
  return await updateResourceData(resource, permissions)
}
```

This optimization is especially valuable when the skipped branch is frequently taken, or when the deferred operation is expensive.

### 1.2 Dependency-Based Parallelization

**Impact: CRITICAL (2-10 improvement)**

For operations with partial dependencies, use `better-all` to maximize parallelism. It automatically starts each task at the earliest possible moment.

**Incorrect: profile waits for config unnecessarily**

```typescript
const [user, config] = await Promise.all([
  fetchUser(),
  fetchConfig()
])
const profile = await fetchProfile(user.id)
```

**Correct: config and profile run in parallel**

```typescript
import { all } from &#x27;better-all&#x27;

const { user, config, profile } = await all({
  async user() { return fetchUser() },
  async config() { return fetchConfig() },
  async profile() {
    return fetchProfile((await this.$.user).id)
  }
})
```

Reference: [https://github.com/shuding/better-all](https://github.com/shuding/better-all)

### 1.3 Prevent Waterfall Chains in API Routes

**Impact: CRITICAL (2-10 improvement)**

In API routes and Server Actions, start independent operations immediately, even if you don&#x27;t await them yet.

**Incorrect: config waits for auth, data waits for both**

```typescript
export async function GET(request: Request) {
  const session = await auth()
  const config = await fetchConfig()
  const data = await fetchData(session.user.id)
  return Response.json({ data, config })
}
```

**Correct: auth and config start immediately**

```typescript
export async function GET(request: Request) {
  const sessionPromise = auth()
  const configPromise = fetchConfig()
  const session = await sessionPromise
  const [config, data] = await Promise.all([
    configPromise,
    fetchData(session.user.id)
  ])
  return Response.json({ data, config })
}
```

For operations with more complex dependency chains, use `better-all` to automatically maximize parallelism (see Dependency-Based Parallelization).

### 1.4 Promise.all() for Independent Operations

**Impact: CRITICAL (2-10 improvement)**

When async operations have no interdependencies, execute them concurrently using `Promise.all()`.

**Incorrect: sequential execution, 3 round trips**

```typescript
const user = await fetchUser()
const posts = await fetchPosts()
const comments = await fetchComments()
```

**Correct: parallel execution, 1 round trip**

```typescript
const [user, posts, comments] = await Promise.all([
  fetchUser(),
  fetchPosts(),
  fetchComments()
])
```

### 1.5 Strategic Suspense Boundaries

**Impact: HIGH (faster initial paint)**

Instead of awaiting data in async components before returning JSX, use Suspense boundaries to show the wrapper UI faster while data loads.

**Incorrect: wrapper blocked by data fetching**

```tsx
async function Page() {
  const data = await fetchData() // Blocks entire page
  
  return (
    &lt;div&gt;
      &lt;div&gt;Sidebar&lt;/div&gt;
      &lt;div&gt;Header&lt;/div&gt;
      &lt;div&gt;
        &lt;DataDisplay data={data} /&gt;
      &lt;/div&gt;
      &lt;div&gt;Footer&lt;/div&gt;
    &lt;/div&gt;
  )
}
```

The entire layout waits for data even though only the middle section needs it.

**Correct: wrapper shows immediately, data streams in**

```tsx
function Page() {
  return (
    &lt;div&gt;
      &lt;div&gt;Sidebar&lt;/div&gt;
      &lt;div&gt;Header&lt;/div&gt;
      &lt;div&gt;
        &lt;Suspense fallback={&lt;Skeleton /&gt;}&gt;
          &lt;DataDisplay /&gt;
        &lt;/Suspense&gt;
      &lt;/div&gt;
      &lt;div&gt;Footer&lt;/div&gt;
    &lt;/div&gt;
  )
}

async function DataDisplay() {
  const data = await fetchData() // Only blocks this component
  return &lt;div&gt;{data.content}&lt;/div&gt;
}
```

Sidebar, Header, and Footer render immediately. Only DataDisplay waits for data.

**Alternative: share promise across components**

```tsx
function Page() {
  // Start fetch immediately, but don&#x27;t await
  const dataPromise = fetchData()
  
  return (
    &lt;div&gt;
      &lt;div&gt;Sidebar&lt;/div&gt;
      &lt;div&gt;Header&lt;/div&gt;
      &lt;Suspense fallback={&lt;Skeleton /&gt;}&gt;
        &lt;DataDisplay dataPromise={dataPromise} /&gt;
        &lt;DataSummary dataPromise={dataPromise} /&gt;
      &lt;/Suspense&gt;
      &lt;div&gt;Footer&lt;/div&gt;
    &lt;/div&gt;
  )
}

function DataDisplay({ dataPromise }: { dataPromise: Promise&lt;Data&gt; }) {
  const data = use(dataPromise) // Unwraps the promise
  return &lt;div&gt;{data.content}&lt;/div&gt;
}

function DataSummary({ dataPromise }: { dataPromise: Promise&lt;Data&gt; }) {
  const data = use(dataPromise) // Reuses the same promise
  return &lt;div&gt;{data.summary}&lt;/div&gt;
}
```

Both components share the same promise, so only one fetch occurs. Layout renders immediately while both components wait together.

**When NOT to use this pattern:**

- Critical data needed for layout decisions (affects positioning)

- SEO-critical content above the fold

- Small, fast queries where suspense overhead isn&#x27;t worth it

- When you want to avoid layout shift (loading  content jump)

**Trade-off:** Faster initial paint vs potential layout shift. Choose based on your UX priorities.

---

## 2. Bundle Size Optimization

**Impact: CRITICAL**

Reducing initial bundle size improves Time to Interactive and Largest Contentful Paint.

### 2.1 Avoid Barrel File Imports

**Impact: CRITICAL (200-800ms import cost, slow builds)**

Import directly from source files instead of barrel files to avoid loading thousands of unused modules. **Barrel files** are entry points that re-export multiple modules (e.g., `index.js` that does `export * from &#x27;./module&#x27;`).

Popular icon and component libraries can have **up to 10,000 re-exports** in their entry file. For many React packages, **it takes 200-800ms just to import them**, affecting both development speed and production cold starts.

**Why tree-shaking doesn&#x27;t help:** When a library is marked as external (not bundled), the bundler can&#x27;t optimize it. If you bundle it to enable tree-shaking, builds become substantially slower analyzing the entire module graph.

**Incorrect: imports entire library**

```tsx
import { Check, X, Menu } from &#x27;lucide-react&#x27;
// Loads 1,583 modules, takes ~2.8s extra in dev
// Runtime cost: 200-800ms on every cold start

import { Button, TextField } from &#x27;@mui/material&#x27;
// Loads 2,225 modules, takes ~4.2s extra in dev
```

**Correct: imports only what you need**

```tsx
import Check from &#x27;lucide-react/dist/esm/icons/check&#x27;
import X from &#x27;lucide-react/dist/esm/icons/x&#x27;
import Menu from &#x27;lucide-react/dist/esm/icons/menu&#x27;
// Loads only 3 modules (~2KB vs ~1MB)

import Button from &#x27;@mui/material/Button&#x27;
import TextField from &#x27;@mui/material/TextField&#x27;
// Loads only what you use
```

**Alternative: Next.js 13.5+**

```js
// next.config.js - use optimizePackageImports
module.exports = {
  experimental: {
    optimizePackageImports: [&#x27;lucide-react&#x27;, &#x27;@mui/material&#x27;]
  }
}

// Then you can keep the ergonomic barrel imports:
import { Check, X, Menu } from &#x27;lucide-react&#x27;
// Automatically transformed to direct imports at build time
```

Direct imports provide 15-70% faster dev boot, 28% faster builds, 40% faster cold starts, and significantly faster HMR.

Libraries commonly affected: `lucide-react`, `@mui/material`, `@mui/icons-material`, `@tabler/icons-react`, `react-icons`, `@headlessui/react`, `@radix-ui/react-*`, `lodash`, `ramda`, `date-fns`, `rxjs`, `react-use`.

Reference: [https://vercel.com/blog/how-we-optimized-package-imports-in-next-js](https://vercel.com/blog/how-we-optimized-package-imports-in-next-js)

### 2.2 Conditional Module Loading

**Impact: HIGH (loads large data only when needed)**

Load large data or modules only when a feature is activated.

**Example: lazy-load animation frames**

```tsx
function AnimationPlayer({ enabled, setEnabled }: { enabled: boolean; setEnabled: React.Dispatch&lt;React.SetStateAction&lt;boolean&gt;&gt; }) {
  const [frames, setFrames] = useState&lt;Frame[] | null&gt;(null)

  useEffect(() =&gt; {
    if (enabled &amp;&amp; !frames &amp;&amp; typeof window !== &#x27;undefined&#x27;) {
      import(&#x27;./animation-frames.js&#x27;)
        .then(mod =&gt; setFrames(mod.frames))
        .catch(() =&gt; setEnabled(false))
    }
  }, [enabled, frames, setEnabled])

  if (!frames) return &lt;Skeleton /&gt;
  return &lt;Canvas frames={frames} /&gt;
}
```

The `typeof window !== &#x27;undefined&#x27;` check prevents bundling this module for SSR, optimizing server bundle size and build speed.

### 2.3 Defer Non-Critical Third-Party Libraries

**Impact: MEDIUM (loads after hydration)**

Analytics, logging, and error tracking don&#x27;t block user interaction. Load them after hydration.

**Incorrect: blocks initial bundle**

```tsx
import { Analytics } from &#x27;@vercel/analytics/react&#x27;

export default function RootLayout({ children }) {
  return (
    &lt;html&gt;
      &lt;body&gt;
        {children}
        &lt;Analytics /&gt;
      &lt;/body&gt;
    &lt;/html&gt;
  )
}
```

**Correct: loads after hydration**

```tsx
import dynamic from &#x27;next/dynamic&#x27;

const Analytics = dynamic(
  () =&gt; import(&#x27;@vercel/analytics/react&#x27;).then(m =&gt; m.Analytics),
  { ssr: false }
)

export default function RootLayout({ children }) {
  return (
    &lt;html&gt;
      &lt;body&gt;
        {children}
        &lt;Analytics /&gt;
      &lt;/body&gt;
    &lt;/html&gt;
  )
}
```

### 2.4 Dynamic Imports for Heavy Components

**Impact: CRITICAL (directly affects TTI and LCP)**

Use `next/dynamic` to lazy-load large components not needed on initial render.

**Incorrect: Monaco bundles with main chunk ~300KB**

```tsx
import { MonacoEditor } from &#x27;./monaco-editor&#x27;

function CodePanel({ code }: { code: string }) {
  return &lt;MonacoEditor value={code} /&gt;
}
```

**Correct: Monaco loads on demand**

```tsx
import dynamic from &#x27;next/dynamic&#x27;

const MonacoEditor = dynamic(
  () =&gt; import(&#x27;./monaco-editor&#x27;).then(m =&gt; m.MonacoEditor),
  { ssr: false }
)

function CodePanel({ code }: { code: string }) {
  return &lt;MonacoEditor value={code} /&gt;
}
```

### 2.5 Preload Based on User Intent

**Impact: MEDIUM (reduces perceived latency)**

Preload heavy bundles before they&#x27;re needed to reduce perceived latency.

**Example: preload on hover/focus**

```tsx
function EditorButton({ onClick }: { onClick: () =&gt; void }) {
  const preload = () =&gt; {
    if (typeof window !== &#x27;undefined&#x27;) {
      void import(&#x27;./monaco-editor&#x27;)
    }
  }

  return (
    &lt;button
      onMouseEnter={preload}
      onFocus={preload}
      onClick={onClick}
    &gt;
      Open Editor
    &lt;/button&gt;
  )
}
```

**Example: preload when feature flag is enabled**

```tsx
function FlagsProvider({ children, flags }: Props) {
  useEffect(() =&gt; {
    if (flags.editorEnabled &amp;&amp; typeof window !== &#x27;undefined&#x27;) {
      void import(&#x27;./monaco-editor&#x27;).then(mod =&gt; mod.init())
    }
  }, [flags.editorEnabled])

  return &lt;FlagsContext.Provider value={flags}&gt;
    {children}
  &lt;/FlagsContext.Provider&gt;
}
```

The `typeof window !== &#x27;undefined&#x27;` check prevents bundling preloaded modules for SSR, optimizing server bundle size and build speed.

---

## 3. Server-Side Performance

**Impact: HIGH**

Optimizing server-side rendering and data fetching eliminates server-side waterfalls and reduces response times.

### 3.1 Cross-Request LRU Caching

**Impact: HIGH (caches across requests)**

`React.cache()` only works within one request. For data shared across sequential requests (user clicks button A then button B), use an LRU cache.

**Implementation:**

```typescript
import { LRUCache } from &#x27;lru-cache&#x27;

const cache = new LRUCache&lt;string, any&gt;({
  max: 1000,
  ttl: 5 * 60 * 1000  // 5 minutes
})

export async function getUser(id: string) {
  const cached = cache.get(id)
  if (cached) return cached

  const user = await db.user.findUnique({ where: { id } })
  cache.set(id, user)
  return user
}

// Request 1: DB query, result cached
// Request 2: cache hit, no DB query
```

Use when sequential user actions hit multiple endpoints needing the same data within seconds.

**With Vercel&#x27;s [Fluid Compute](https://vercel.com/docs/fluid-compute):** LRU caching is especially effective because multiple concurrent requests can share the same function instance and cache. This means the cache persists across requests without needing external storage like Redis.

**In traditional serverless:** Each invocation runs in isolation, so consider Redis for cross-process caching.

Reference: [https://github.com/isaacs/node-lru-cache](https://github.com/isaacs/node-lru-cache)

### 3.2 Minimize Serialization at RSC Boundaries

**Impact: HIGH (reduces data transfer size)**

The React Server/Client boundary serializes all object properties into strings and embeds them in the HTML response and subsequent RSC requests. This serialized data directly impacts page weight and load time, so **size matters a lot**. Only pass fields that the client actually uses.

**Incorrect: serializes all 50 fields**

```tsx
async function Page() {
  const user = await fetchUser()  // 50 fields
  return &lt;Profile user={user} /&gt;
}

&#x27;use client&#x27;
function Profile({ user }: { user: User }) {
  return &lt;div&gt;{user.name}&lt;/div&gt;  // uses 1 field
}
```

**Correct: serializes only 1 field**

```tsx
async function Page() {
  const user = await fetchUser()
  return &lt;Profile name={user.name} /&gt;
}

&#x27;use client&#x27;
function Profile({ name }: { name: string }) {
  return &lt;div&gt;{name}&lt;/div&gt;
}
```

### 3.3 Parallel Data Fetching with Component Composition

**Impact: CRITICAL (eliminates server-side waterfalls)**

React Server Components execute sequentially within a tree. Restructure with composition to parallelize data fetching.

**Incorrect: Sidebar waits for Page&#x27;s fetch to complete**

```tsx
export default async function Page() {
  const header = await fetchHeader()
  return (
    &lt;div&gt;
      &lt;div&gt;{header}&lt;/div&gt;
      &lt;Sidebar /&gt;
    &lt;/div&gt;
  )
}

async function Sidebar() {
  const items = await fetchSidebarItems()
  return &lt;nav&gt;{items.map(renderItem)}&lt;/nav&gt;
}
```

**Correct: both fetch simultaneously**

```tsx
async function Header() {
  const data = await fetchHeader()
  return &lt;div&gt;{data}&lt;/div&gt;
}

async function Sidebar() {
  const items = await fetchSidebarItems()
  return &lt;nav&gt;{items.map(renderItem)}&lt;/nav&gt;
}

export default function Page() {
  return (
    &lt;div&gt;
      &lt;Header /&gt;
      &lt;Sidebar /&gt;
    &lt;/div&gt;
  )
}
```

**Alternative with children prop:**

```tsx
async function Header() {
  const data = await fetchHeader()
  return &lt;div&gt;{data}&lt;/div&gt;
}

async function Sidebar() {
  const items = await fetchSidebarItems()
  return &lt;nav&gt;{items.map(renderItem)}&lt;/nav&gt;
}

function Layout({ children }: { children: ReactNode }) {
  return (
    &lt;div&gt;
      &lt;Header /&gt;
      {children}
    &lt;/div&gt;
  )
}

export default function Page() {
  return (
    &lt;Layout&gt;
      &lt;Sidebar /&gt;
    &lt;/Layout&gt;
  )
}
```

### 3.4 Per-Request Deduplication with React.cache()

**Impact: MEDIUM (deduplicates within request)**

Use `React.cache()` for server-side request deduplication. Authentication and database queries benefit most.

**Usage:**

```typescript
import { cache } from &#x27;react&#x27;

export const getCurrentUser = cache(async () =&gt; {
  const session = await auth()
  if (!session?.user?.id) return null
  return await db.user.findUnique({
    where: { id: session.user.id }
  })
})
```

Within a single request, multiple calls to `getCurrentUser()` execute the query only once.

**Avoid inline objects as arguments:**

`React.cache()` uses shallow equality (`Object.is`) to determine cache hits. Inline objects create new references each call, preventing cache hits.

**Incorrect: always cache miss**

```typescript
const getUser = cache(async (params: { uid: number }) =&gt; {
  return await db.user.findUnique({ where: { id: params.uid } })
})

// Each call creates new object, never hits cache
getUser({ uid: 1 })
getUser({ uid: 1 })  // Cache miss, runs query again
```

**Correct: cache hit**

```typescript
const params = { uid: 1 }
getUser(params)  // Query runs
getUser(params)  // Cache hit (same reference)
```

If you must pass objects, pass the same reference:

**Next.js-Specific Note:**

In Next.js, the `fetch` API is automatically extended with request memoization. Requests with the same URL and options are automatically deduplicated within a single request, so you don&#x27;t need `React.cache()` for `fetch` calls. However, `React.cache()` is still essential for other async tasks:

- Database queries (Prisma, Drizzle, etc.)

- Heavy computations

- Authentication checks

- File system operations

- Any non-fetch async work

Use `React.cache()` to deduplicate these operations across your component tree.

Reference: [https://react.dev/reference/react/cache](https://react.dev/reference/react/cache)

### 3.5 Use after() for Non-Blocking Operations

**Impact: MEDIUM (faster response times)**

Use Next.js&#x27;s `after()` to schedule work that should execute after a response is sent. This prevents logging, analytics, and other side effects from blocking the response.

**Incorrect: blocks response**

```tsx
import { logUserAction } from &#x27;@/app/utils&#x27;

export async function POST(request: Request) {
  // Perform mutation
  await updateDatabase(request)
  
  // Logging blocks the response
  const userAgent = request.headers.get(&#x27;user-agent&#x27;) || &#x27;unknown&#x27;
  await logUserAction({ userAgent })
  
  return new Response(JSON.stringify({ status: &#x27;success&#x27; }), {
    status: 200,
    headers: { &#x27;Content-Type&#x27;: &#x27;application/json&#x27; }
  })
}
```

**Correct: non-blocking**

```tsx
import { after } from &#x27;next/server&#x27;
import { headers, cookies } from &#x27;next/headers&#x27;
import { logUserAction } from &#x27;@/app/utils&#x27;

export async function POST(request: Request) {
  // Perform mutation
  await updateDatabase(request)
  
  // Log after response is sent
  after(async () =&gt; {
    const userAgent = (await headers()).get(&#x27;user-agent&#x27;) || &#x27;unknown&#x27;
    const sessionCookie = (await cookies()).get(&#x27;session-id&#x27;)?.value || &#x27;anonymous&#x27;
    
    logUserAction({ sessionCookie, userAgent })
  })
  
  return new Response(JSON.stringify({ status: &#x27;success&#x27; }), {
    status: 200,
    headers: { &#x27;Content-Type&#x27;: &#x27;application/json&#x27; }
  })
}
```

The response is sent immediately while logging happens in the background.

**Common use cases:**

- Analytics tracking

- Audit logging

- Sending notifications

- Cache invalidation

- Cleanup tasks

**Important notes:**

- `after()` runs even if the response fails or redirects

- Works in Server Actions, Route Handlers, and Server Components

Reference: [https://nextjs.org/docs/app/api-reference/functions/after](https://nextjs.org/docs/app/api-reference/functions/after)

---

## 4. Client-Side Data Fetching

**Impact: MEDIUM-HIGH**

Automatic deduplication and efficient data fetching patterns reduce redundant network requests.

### 4.1 Deduplicate Global Event Listeners

**Impact: LOW (single listener for N components)**

Use `useSWRSubscription()` to share global event listeners across component instances.

**Incorrect: N instances = N listeners**

```tsx
function useKeyboardShortcut(key: string, callback: () =&gt; void) {
  useEffect(() =&gt; {
    const handler = (e: KeyboardEvent) =&gt; {
      if (e.metaKey &amp;&amp; e.key === key) {
        callback()
      }
    }
    window.addEventListener(&#x27;keydown&#x27;, handler)
    return () =&gt; window.removeEventListener(&#x27;keydown&#x27;, handler)
  }, [key, callback])
}
```

When using the `useKeyboardShortcut` hook multiple times, each instance will register a new listener.

**Correct: N instances = 1 listener**

```tsx
import useSWRSubscription from &#x27;swr/subscription&#x27;

// Module-level Map to track callbacks per key
const keyCallbacks = new Map&lt;string, Set&lt;() =&gt; void&gt;&gt;()

function useKeyboardShortcut(key: string, callback: () =&gt; void) {
  // Register this callback in the Map
  useEffect(() =&gt; {
    if (!keyCallbacks.has(key)) {
      keyCallbacks.set(key, new Set())
    }
    keyCallbacks.get(key)!.add(callback)

    return () =&gt; {
      const set = keyCallbacks.get(key)
      if (set) {
        set.delete(callback)
        if (set.size === 0) {
          keyCallbacks.delete(key)
        }
      }
    }
  }, [key, callback])

  useSWRSubscription(&#x27;global-keydown&#x27;, () =&gt; {
    const handler = (e: KeyboardEvent) =&gt; {
      if (e.metaKey &amp;&amp; keyCallbacks.has(e.key)) {
        keyCallbacks.get(e.key)!.forEach(cb =&gt; cb())
      }
    }
    window.addEventListener(&#x27;keydown&#x27;, handler)
    return () =&gt; window.removeEventListener(&#x27;keydown&#x27;, handler)
  })
}

function Profile() {
  // Multiple shortcuts will share the same listener
  useKeyboardShortcut(&#x27;p&#x27;, () =&gt; { /* ... */ }) 
  useKeyboardShortcut(&#x27;k&#x27;, () =&gt; { /* ... */ })
  // ...
}
```

### 4.2 Use Passive Event Listeners for Scrolling Performance

**Impact: MEDIUM (eliminates scroll delay caused by event listeners)**

Add `{ passive: true }` to touch and wheel event listeners to enable immediate scrolling. Browsers normally wait for listeners to finish to check if `preventDefault()` is called, causing scroll delay.

**Incorrect:**

```typescript
useEffect(() =&gt; {
  const handleTouch = (e: TouchEvent) =&gt; console.log(e.touches[0].clientX)
  const handleWheel = (e: WheelEvent) =&gt; console.log(e.deltaY)
  
  document.addEventListener(&#x27;touchstart&#x27;, handleTouch)
  document.addEventListener(&#x27;wheel&#x27;, handleWheel)
  
  return () =&gt; {
    document.removeEventListener(&#x27;touchstart&#x27;, handleTouch)
    document.removeEventListener(&#x27;wheel&#x27;, handleWheel)
  }
}, [])
```

**Correct:**

```typescript
useEffect(() =&gt; {
  const handleTouch = (e: TouchEvent) =&gt; console.log(e.touches[0].clientX)
  const handleWheel = (e: WheelEvent) =&gt; console.log(e.deltaY)
  
  document.addEventListener(&#x27;touchstart&#x27;, handleTouch, { passive: true })
  document.addEventListener(&#x27;wheel&#x27;, handleWheel, { passive: true })
  
  return () =&gt; {
    document.removeEventListener(&#x27;touchstart&#x27;, handleTouch)
    document.removeEventListener(&#x27;wheel&#x27;, handleWheel)
  }
}, [])
```

**Use passive when:** tracking/analytics, logging, any listener that doesn&#x27;t call `preventDefault()`.

**Don&#x27;t use passive when:** implementing custom swipe gestures, custom zoom controls, or any listener that needs `preventDefault()`.

### 4.3 Use SWR for Automatic Deduplication

**Impact: MEDIUM-HIGH (automatic deduplication)**

SWR enables request deduplication, caching, and revalidation across component instances.

**Incorrect: no deduplication, each instance fetches**

```tsx
function UserList() {
  const [users, setUsers] = useState([])
  useEffect(() =&gt; {
    fetch(&#x27;/api/users&#x27;)
      .then(r =&gt; r.json())
      .then(setUsers)
  }, [])
}
```

**Correct: multiple instances share one request**

```tsx
import useSWR from &#x27;swr&#x27;

function UserList() {
  const { data: users } = useSWR(&#x27;/api/users&#x27;, fetcher)
}
```

**For immutable data:**

```tsx
import { useImmutableSWR } from &#x27;@/lib/swr&#x27;

function StaticContent() {
  const { data } = useImmutableSWR(&#x27;/api/config&#x27;, fetcher)
}
```

**For mutations:**

```tsx
import { useSWRMutation } from &#x27;swr/mutation&#x27;

function UpdateButton() {
  const { trigger } = useSWRMutation(&#x27;/api/user&#x27;, updateUser)
  return &lt;button onClick={() =&gt; trigger()}&gt;Update&lt;/button&gt;
}
```

Reference: [https://swr.vercel.app](https://swr.vercel.app)

### 4.4 Version and Minimize localStorage Data

**Impact: MEDIUM (prevents schema conflicts, reduces storage size)**

Add version prefix to keys and store only needed fields. Prevents schema conflicts and accidental storage of sensitive data.

**Incorrect:**

```typescript
// No version, stores everything, no error handling
localStorage.setItem(&#x27;userConfig&#x27;, JSON.stringify(fullUserObject))
const data = localStorage.getItem(&#x27;userConfig&#x27;)
```

**Correct:**

```typescript
const VERSION = &#x27;v2&#x27;

function saveConfig(config: { theme: string; language: string }) {
  try {
    localStorage.setItem(`userConfig:${VERSION}`, JSON.stringify(config))
  } catch {
    // Throws in incognito/private browsing, quota exceeded, or disabled
  }
}

function loadConfig() {
  try {
    const data = localStorage.getItem(`userConfig:${VERSION}`)
    return data ? JSON.parse(data) : null
  } catch {
    return null
  }
}

// Migration from v1 to v2
function migrate() {
  try {
    const v1 = localStorage.getItem(&#x27;userConfig:v1&#x27;)
    if (v1) {
      const old = JSON.parse(v1)
      saveConfig({ theme: old.darkMode ? &#x27;dark&#x27; : &#x27;light&#x27;, language: old.lang })
      localStorage.removeItem(&#x27;userConfig:v1&#x27;)
    }
  } catch {}
}
```

**Store minimal fields from server responses:**

```typescript
// User object has 20+ fields, only store what UI needs
function cachePrefs(user: FullUser) {
  try {
    localStorage.setItem(&#x27;prefs:v1&#x27;, JSON.stringify({
      theme: user.preferences.theme,
      notifications: user.preferences.notifications
    }))
  } catch {}
}
```

**Always wrap in try-catch:** `getItem()` and `setItem()` throw in incognito/private browsing (Safari, Firefox), when quota exceeded, or when disabled.

**Benefits:** Schema evolution via versioning, reduced storage size, prevents storing tokens/PII/internal flags.

---

## 5. Re-render Optimization

**Impact: MEDIUM**

Reducing unnecessary re-renders minimizes wasted computation and improves UI responsiveness.

### 5.1 Defer State Reads to Usage Point

**Impact: MEDIUM (avoids unnecessary subscriptions)**

Don&#x27;t subscribe to dynamic state (searchParams, localStorage) if you only read it inside callbacks.

**Incorrect: subscribes to all searchParams changes**

```tsx
function ShareButton({ chatId }: { chatId: string }) {
  const searchParams = useSearchParams()

  const handleShare = () =&gt; {
    const ref = searchParams.get(&#x27;ref&#x27;)
    shareChat(chatId, { ref })
  }

  return &lt;button onClick={handleShare}&gt;Share&lt;/button&gt;
}
```

**Correct: reads on demand, no subscription**

```tsx
function ShareButton({ chatId }: { chatId: string }) {
  const handleShare = () =&gt; {
    const params = new URLSearchParams(window.location.search)
    const ref = params.get(&#x27;ref&#x27;)
    shareChat(chatId, { ref })
  }

  return &lt;button onClick={handleShare}&gt;Share&lt;/button&gt;
}
```

### 5.2 Extract to Memoized Components

**Impact: MEDIUM (enables early returns)**

Extract expensive work into memoized components to enable early returns before computation.

**Incorrect: computes avatar even when loading**

```tsx
function Profile({ user, loading }: Props) {
  const avatar = useMemo(() =&gt; {
    const id = computeAvatarId(user)
    return &lt;Avatar id={id} /&gt;
  }, [user])

  if (loading) return &lt;Skeleton /&gt;
  return &lt;div&gt;{avatar}&lt;/div&gt;
}
```

**Correct: skips computation when loading**

```tsx
const UserAvatar = memo(function UserAvatar({ user }: { user: User }) {
  const id = useMemo(() =&gt; computeAvatarId(user), [user])
  return &lt;Avatar id={id} /&gt;
})

function Profile({ user, loading }: Props) {
  if (loading) return &lt;Skeleton /&gt;
  return (
    &lt;div&gt;
      &lt;UserAvatar user={user} /&gt;
    &lt;/div&gt;
  )
}
```

**Note:** If your project has [React Compiler](https://react.dev/learn/react-compiler) enabled, manual memoization with `memo()` and `useMemo()` is not necessary. The compiler automatically optimizes re-renders.

### 5.3 Narrow Effect Dependencies

**Impact: LOW (minimizes effect re-runs)**

Specify primitive dependencies instead of objects to minimize effect re-runs.

**Incorrect: re-runs on any user field change**

```tsx
useEffect(() =&gt; {
  console.log(user.id)
}, [user])
```

**Correct: re-runs only when id changes**

```tsx
useEffect(() =&gt; {
  console.log(user.id)
}, [user.id])
```

**For derived state, compute outside effect:**

```tsx
// Incorrect: runs on width=767, 766, 765...
useEffect(() =&gt; {
  if (width &lt; 768) {
    enableMobileMode()
  }
}, [width])

// Correct: runs only on boolean transition
const isMobile = width &lt; 768
useEffect(() =&gt; {
  if (isMobile) {
    enableMobileMode()
  }
}, [isMobile])
```

### 5.4 Subscribe to Derived State

**Impact: MEDIUM (reduces re-render frequency)**

Subscribe to derived boolean state instead of continuous values to reduce re-render frequency.

**Incorrect: re-renders on every pixel change**

```tsx
function Sidebar() {
  const width = useWindowWidth()  // updates continuously
  const isMobile = width &lt; 768
  return &lt;nav className={isMobile ? &#x27;mobile&#x27; : &#x27;desktop&#x27;} /&gt;
}
```

**Correct: re-renders only when boolean changes**

```tsx
function Sidebar() {
  const isMobile = useMediaQuery(&#x27;(max-width: 767px)&#x27;)
  return &lt;nav className={isMobile ? &#x27;mobile&#x27; : &#x27;desktop&#x27;} /&gt;
}
```

### 5.5 Use Functional setState Updates

**Impact: MEDIUM (prevents stale closures and unnecessary callback recreations)**

When updating state based on the current state value, use the functional update form of setState instead of directly referencing the state variable. This prevents stale closures, eliminates unnecessary dependencies, and creates stable callback references.

**Incorrect: requires state as dependency**

```tsx
function TodoList() {
  const [items, setItems] = useState(initialItems)
  
  // Callback must depend on items, recreated on every items change
  const addItems = useCallback((newItems: Item[]) =&gt; {
    setItems([...items, ...newItems])
  }, [items])  //  items dependency causes recreations
  
  // Risk of stale closure if dependency is forgotten
  const removeItem = useCallback((id: string) =&gt; {
    setItems(items.filter(item =&gt; item.id !== id))
  }, [])  //  Missing items dependency - will use stale items!
  
  return &lt;ItemsEditor items={items} onAdd={addItems} onRemove={removeItem} /&gt;
}
```

The first callback is recreated every time `items` changes, which can cause child components to re-render unnecessarily. The second callback has a stale closure bugit will always reference the initial `items` value.

**Correct: stable callbacks, no stale closures**

```tsx
function TodoList() {
  const [items, setItems] = useState(initialItems)
  
  // Stable callback, never recreated
  const addItems = useCallback((newItems: Item[]) =&gt; {
    setItems(curr =&gt; [...curr, ...newItems])
  }, [])  //  No dependencies needed
  
  // Always uses latest state, no stale closure risk
  const removeItem = useCallback((id: string) =&gt; {
    setItems(curr =&gt; curr.filter(item =&gt; item.id !== id))
  }, [])  //  Safe and stable
  
  return &lt;ItemsEditor items={items} onAdd={addItems} onRemove={removeItem} /&gt;
}
```

**Benefits:**

1. **Stable callback references** - Callbacks don&#x27;t need to be recreated when state changes

2. **No stale closures** - Always operates on the latest state value

3. **Fewer dependencies** - Simplifies dependency arrays and reduces memory leaks

4. **Prevents bugs** - Eliminates the most common source of React closure bugs

**When to use functional updates:**

- Any setState that depends on the current state value

- Inside useCallback/useMemo when state is needed

- Event handlers that reference state

- Async operations that update state

**When direct updates are fine:**

- Setting state to a static value: `setCount(0)`

- Setting state from props/arguments only: `setName(newName)`

- State doesn&#x27;t depend on previous value

**Note:** If your project has [React Compiler](https://react.dev/learn/react-compiler) enabled, the compiler can automatically optimize some cases, but functional updates are still recommended for correctness and to prevent stale closure bugs.

### 5.6 Use Lazy State Initialization

**Impact: MEDIUM (wasted computation on every render)**

Pass a function to `useState` for expensive initial values. Without the function form, the initializer runs on every render even though the value is only used once.

**Incorrect: runs on every render**

```tsx
function FilteredList({ items }: { items: Item[] }) {
  // buildSearchIndex() runs on EVERY render, even after initialization
  const [searchIndex, setSearchIndex] = useState(buildSearchIndex(items))
  const [query, setQuery] = useState(&#x27;&#x27;)
  
  // When query changes, buildSearchIndex runs again unnecessarily
  return &lt;SearchResults index={searchIndex} query={query} /&gt;
}

function UserProfile() {
  // JSON.parse runs on every render
  const [settings, setSettings] = useState(
    JSON.parse(localStorage.getItem(&#x27;settings&#x27;) || &#x27;{}&#x27;)
  )
  
  return &lt;SettingsForm settings={settings} onChange={setSettings} /&gt;
}
```

**Correct: runs only once**

```tsx
function FilteredList({ items }: { items: Item[] }) {
  // buildSearchIndex() runs ONLY on initial render
  const [searchIndex, setSearchIndex] = useState(() =&gt; buildSearchIndex(items))
  const [query, setQuery] = useState(&#x27;&#x27;)
  
  return &lt;SearchResults index={searchIndex} query={query} /&gt;
}

function UserProfile() {
  // JSON.parse runs only on initial render
  const [settings, setSettings] = useState(() =&gt; {
    const stored = localStorage.getItem(&#x27;settings&#x27;)
    return stored ? JSON.parse(stored) : {}
  })
  
  return &lt;SettingsForm settings={settings} onChange={setSettings} /&gt;
}
```

Use lazy initialization when computing initial values from localStorage/sessionStorage, building data structures (indexes, maps), reading from the DOM, or performing heavy transformations.

For simple primitives (`useState(0)`), direct references (`useState(props.value)`), or cheap literals (`useState({})`), the function form is unnecessary.

### 5.7 Use Transitions for Non-Urgent Updates

**Impact: MEDIUM (maintains UI responsiveness)**

Mark frequent, non-urgent state updates as transitions to maintain UI responsiveness.

**Incorrect: blocks UI on every scroll**

```tsx
function ScrollTracker() {
  const [scrollY, setScrollY] = useState(0)
  useEffect(() =&gt; {
    const handler = () =&gt; setScrollY(window.scrollY)
    window.addEventListener(&#x27;scroll&#x27;, handler, { passive: true })
    return () =&gt; window.removeEventListener(&#x27;scroll&#x27;, handler)
  }, [])
}
```

**Correct: non-blocking updates**

```tsx
import { startTransition } from &#x27;react&#x27;

function ScrollTracker() {
  const [scrollY, setScrollY] = useState(0)
  useEffect(() =&gt; {
    const handler = () =&gt; {
      startTransition(() =&gt; setScrollY(window.scrollY))
    }
    window.addEventListener(&#x27;scroll&#x27;, handler, { passive: true })
    return () =&gt; window.removeEventListener(&#x27;scroll&#x27;, handler)
  }, [])
}
```

---

## 6. Rendering Performance

**Impact: MEDIUM**

Optimizing the rendering process reduces the work the browser needs to do.

### 6.1 Animate SVG Wrapper Instead of SVG Element

**Impact: LOW (enables hardware acceleration)**

Many browsers don&#x27;t have hardware acceleration for CSS3 animations on SVG elements. Wrap SVG in a `&lt;div&gt;` and animate the wrapper instead.

**Incorrect: animating SVG directly - no hardware acceleration**

```tsx
function LoadingSpinner() {
  return (
    &lt;svg 
      className=&quot;animate-spin&quot;
      width=&quot;24&quot; 
      height=&quot;24&quot; 
      viewBox=&quot;0 0 24 24&quot;
    &gt;
      &lt;circle cx=&quot;12&quot; cy=&quot;12&quot; r=&quot;10&quot; stroke=&quot;currentColor&quot; /&gt;
    &lt;/svg&gt;
  )
}
```

**Correct: animating wrapper div - hardware accelerated**

```tsx
function LoadingSpinner() {
  return (
    &lt;div className=&quot;animate-spin&quot;&gt;
      &lt;svg 
        width=&quot;24&quot; 
        height=&quot;24&quot; 
        viewBox=&quot;0 0 24 24&quot;
      &gt;
        &lt;circle cx=&quot;12&quot; cy=&quot;12&quot; r=&quot;10&quot; stroke=&quot;currentColor&quot; /&gt;
      &lt;/svg&gt;
    &lt;/div&gt;
  )
}
```

This applies to all CSS transforms and transitions (`transform`, `opacity`, `translate`, `scale`, `rotate`). The wrapper div allows browsers to use GPU acceleration for smoother animations.

### 6.2 CSS content-visibility for Long Lists

**Impact: HIGH (faster initial render)**

Apply `content-visibility: auto` to defer off-screen rendering.

**CSS:**

```css
.message-item {
  content-visibility: auto;
  contain-intrinsic-size: 0 80px;
}
```

**Example:**

```tsx
function MessageList({ messages }: { messages: Message[] }) {
  return (
    &lt;div className=&quot;overflow-y-auto h-screen&quot;&gt;
      {messages.map(msg =&gt; (
        &lt;div key={msg.id} className=&quot;message-item&quot;&gt;
          &lt;Avatar user={msg.author} /&gt;
          &lt;div&gt;{msg.content}&lt;/div&gt;
        &lt;/div&gt;
      ))}
    &lt;/div&gt;
  )
}
```

For 1000 messages, browser skips layout/paint for ~990 off-screen items (10 faster initial render).

### 6.3 Hoist Static JSX Elements

**Impact: LOW (avoids re-creation)**

Extract static JSX outside components to avoid re-creation.

**Incorrect: recreates element every render**

```tsx
function LoadingSkeleton() {
  return &lt;div className=&quot;animate-pulse h-20 bg-gray-200&quot; /&gt;
}

function Container() {
  return (
    &lt;div&gt;
      {loading &amp;&amp; &lt;LoadingSkeleton /&gt;}
    &lt;/div&gt;
  )
}
```

**Correct: reuses same element**

```tsx
const loadingSkeleton = (
  &lt;div className=&quot;animate-pulse h-20 bg-gray-200&quot; /&gt;
)

function Container() {
  return (
    &lt;div&gt;
      {loading &amp;&amp; loadingSkeleton}
    &lt;/div&gt;
  )
}
```

This is especially helpful for large and static SVG nodes, which can be expensive to recreate on every render.

**Note:** If your project has [React Compiler](https://react.dev/learn/react-compiler) enabled, the compiler automatically hoists static JSX elements and optimizes component re-renders, making manual hoisting unnecessary.

### 6.4 Optimize SVG Precision

**Impact: LOW (reduces file size)**

Reduce SVG coordinate precision to decrease file size. The optimal precision depends on the viewBox size, but in general reducing precision should be considered.

**Incorrect: excessive precision**

```svg
&lt;path d=&quot;M 10.293847 20.847362 L 30.938472 40.192837&quot; /&gt;
```

**Correct: 1 decimal place**

```svg
&lt;path d=&quot;M 10.3 20.8 L 30.9 40.2&quot; /&gt;
```

**Automate with SVGO:**

```bash
npx svgo --precision=1 --multipass icon.svg
```

### 6.5 Prevent Hydration Mismatch Without Flickering

**Impact: MEDIUM (avoids visual flicker and hydration errors)**

When rendering content that depends on client-side storage (localStorage, cookies), avoid both SSR breakage and post-hydration flickering by injecting a synchronous script that updates the DOM before React hydrates.

**Incorrect: breaks SSR**

```tsx
function ThemeWrapper({ children }: { children: ReactNode }) {
  // localStorage is not available on server - throws error
  const theme = localStorage.getItem(&#x27;theme&#x27;) || &#x27;light&#x27;
  
  return (
    &lt;div className={theme}&gt;
      {children}
    &lt;/div&gt;
  )
}
```

Server-side rendering will fail because `localStorage` is undefined.

**Incorrect: visual flickering**

```tsx
function ThemeWrapper({ children }: { children: ReactNode }) {
  const [theme, setTheme] = useState(&#x27;light&#x27;)
  
  useEffect(() =&gt; {
    // Runs after hydration - causes visible flash
    const stored = localStorage.getItem(&#x27;theme&#x27;)
    if (stored) {
      setTheme(stored)
    }
  }, [])
  
  return (
    &lt;div className={theme}&gt;
      {children}
    &lt;/div&gt;
  )
}
```

Component first renders with default value (`light`), then updates after hydration, causing a visible flash of incorrect content.

**Correct: no flicker, no hydration mismatch**

```tsx
function ThemeWrapper({ children }: { children: ReactNode }) {
  return (
    &lt;&gt;
      &lt;div id=&quot;theme-wrapper&quot;&gt;
        {children}
      &lt;/div&gt;
      &lt;script
        dangerouslySetInnerHTML={{
          __html: `
            (function() {
              try {
                var theme = localStorage.getItem(&#x27;theme&#x27;) || &#x27;light&#x27;;
                var el = document.getElementById(&#x27;theme-wrapper&#x27;);
                if (el) el.className = theme;
              } catch (e) {}
            })();
          `,
        }}
      /&gt;
    &lt;/&gt;
  )
}
```

The inline script executes synchronously before showing the element, ensuring the DOM already has the correct value. No flickering, no hydration mismatch.

This pattern is especially useful for theme toggles, user preferences, authentication states, and any client-only data that should render immediately without flashing default values.

### 6.6 Use Activity Component for Show/Hide

**Impact: MEDIUM (preserves state/DOM)**

Use React&#x27;s `&lt;Activity&gt;` to preserve state/DOM for expensive components that frequently toggle visibility.

**Usage:**

```tsx
import { Activity } from &#x27;react&#x27;

function Dropdown({ isOpen }: Props) {
  return (
    &lt;Activity mode={isOpen ? &#x27;visible&#x27; : &#x27;hidden&#x27;}&gt;
      &lt;ExpensiveMenu /&gt;
    &lt;/Activity&gt;
  )
}
```

Avoids expensive re-renders and state loss.

### 6.7 Use Explicit Conditional Rendering

**Impact: LOW (prevents rendering 0 or NaN)**

Use explicit ternary operators (`? :`) instead of `&amp;&amp;` for conditional rendering when the condition can be `0`, `NaN`, or other falsy values that render.

**Incorrect: renders &quot;0&quot; when count is 0**

```tsx
function Badge({ count }: { count: number }) {
  return (
    &lt;div&gt;
      {count &amp;&amp; &lt;span className=&quot;badge&quot;&gt;{count}&lt;/span&gt;}
    &lt;/div&gt;
  )
}

// When count = 0, renders: &lt;div&gt;0&lt;/div&gt;
// When count = 5, renders: &lt;div&gt;&lt;span class=&quot;badge&quot;&gt;5&lt;/span&gt;&lt;/div&gt;
```

**Correct: renders nothing when count is 0**

```tsx
function Badge({ count }: { count: number }) {
  return (
    &lt;div&gt;
      {count &gt; 0 ? &lt;span className=&quot;badge&quot;&gt;{count}&lt;/span&gt; : null}
    &lt;/div&gt;
  )
}

// When count = 0, renders: &lt;div&gt;&lt;/div&gt;
// When count = 5, renders: &lt;div&gt;&lt;span class=&quot;badge&quot;&gt;5&lt;/span&gt;&lt;/div&gt;
```

---

## 7. JavaScript Performance

**Impact: LOW-MEDIUM**

Micro-optimizations for hot paths can add up to meaningful improvements.

### 7.1 Batch DOM CSS Changes

**Impact: MEDIUM (reduces reflows/repaints)**

Avoid changing styles one property at a time. Group multiple CSS changes together via classes or `cssText` to minimize browser reflows.

**Incorrect: multiple reflows**

```typescript
function updateElementStyles(element: HTMLElement) {
  // Each line triggers a reflow
  element.style.width = &#x27;100px&#x27;
  element.style.height = &#x27;200px&#x27;
  element.style.backgroundColor = &#x27;blue&#x27;
  element.style.border = &#x27;1px solid black&#x27;
}
```

**Correct: add class - single reflow**

```typescript
// CSS file
.highlighted-box {
  width: 100px;
  height: 200px;
  background-color: blue;
  border: 1px solid black;
}

// JavaScript
function updateElementStyles(element: HTMLElement) {
  element.classList.add(&#x27;highlighted-box&#x27;)
}
```

**Correct: change cssText - single reflow**

```typescript
function updateElementStyles(element: HTMLElement) {
  element.style.cssText = `
    width: 100px;
    height: 200px;
    background-color: blue;
    border: 1px solid black;
  `
}
```

**React example:**

```tsx
// Incorrect: changing styles one by one
function Box({ isHighlighted }: { isHighlighted: boolean }) {
  const ref = useRef&lt;HTMLDivElement&gt;(null)
  
  useEffect(() =&gt; {
    if (ref.current &amp;&amp; isHighlighted) {
      ref.current.style.width = &#x27;100px&#x27;
      ref.current.style.height = &#x27;200px&#x27;
      ref.current.style.backgroundColor = &#x27;blue&#x27;
    }
  }, [isHighlighted])
  
  return &lt;div ref={ref}&gt;Content&lt;/div&gt;
}

// Correct: toggle class
function Box({ isHighlighted }: { isHighlighted: boolean }) {
  return (
    &lt;div className={isHighlighted ? &#x27;highlighted-box&#x27; : &#x27;&#x27;}&gt;
      Content
    &lt;/div&gt;
  )
}
```

Prefer CSS classes over inline styles when possible. Classes are cached by the browser and provide better separation of concerns.

### 7.2 Build Index Maps for Repeated Lookups

**Impact: LOW-MEDIUM (1M ops to 2K ops)**

Multiple `.find()` calls by the same key should use a Map.

**Incorrect (O(n) per lookup):**

```typescript
function processOrders(orders: Order[], users: User[]) {
  return orders.map(order =&gt; ({
    ...order,
    user: users.find(u =&gt; u.id === order.userId)
  }))
}
```

**Correct (O(1) per lookup):**

```typescript
function processOrders(orders: Order[], users: User[]) {
  const userById = new Map(users.map(u =&gt; [u.id, u]))

  return orders.map(order =&gt; ({
    ...order,
    user: userById.get(order.userId)
  }))
}
```

Build map once (O(n)), then all lookups are O(1).

For 1000 orders  1000 users: 1M ops  2K ops.

### 7.3 Cache Property Access in Loops

**Impact: LOW-MEDIUM (reduces lookups)**

Cache object property lookups in hot paths.

**Incorrect: 3 lookups  N iterations**

```typescript
for (let i = 0; i &lt; arr.length; i++) {
  process(obj.config.settings.value)
}
```

**Correct: 1 lookup total**

```typescript
const value = obj.config.settings.value
const len = arr.length
for (let i = 0; i &lt; len; i++) {
  process(value)
}
```

### 7.4 Cache Repeated Function Calls

**Impact: MEDIUM (avoid redundant computation)**

Use a module-level Map to cache function results when the same function is called repeatedly with the same inputs during render.

**Incorrect: redundant computation**

```typescript
function ProjectList({ projects }: { projects: Project[] }) {
  return (
    &lt;div&gt;
      {projects.map(project =&gt; {
        // slugify() called 100+ times for same project names
        const slug = slugify(project.name)
        
        return &lt;ProjectCard key={project.id} slug={slug} /&gt;
      })}
    &lt;/div&gt;
  )
}
```

**Correct: cached results**

```typescript
// Module-level cache
const slugifyCache = new Map&lt;string, string&gt;()

function cachedSlugify(text: string): string {
  if (slugifyCache.has(text)) {
    return slugifyCache.get(text)!
  }
  const result = slugify(text)
  slugifyCache.set(text, result)
  return result
}

function ProjectList({ projects }: { projects: Project[] }) {
  return (
    &lt;div&gt;
      {projects.map(project =&gt; {
        // Computed only once per unique project name
        const slug = cachedSlugify(project.name)
        
        return &lt;ProjectCard key={project.id} slug={slug} /&gt;
      })}
    &lt;/div&gt;
  )
}
```

**Simpler pattern for single-value functions:**

```typescript
let isLoggedInCache: boolean | null = null

function isLoggedIn(): boolean {
  if (isLoggedInCache !== null) {
    return isLoggedInCache
  }
  
  isLoggedInCache = document.cookie.includes(&#x27;auth=&#x27;)
  return isLoggedInCache
}

// Clear cache when auth changes
function onAuthChange() {
  isLoggedInCache = null
}
```

Use a Map (not a hook) so it works everywhere: utilities, event handlers, not just React components.

Reference: [https://vercel.com/blog/how-we-made-the-vercel-dashboard-twice-as-fast](https://vercel.com/blog/how-we-made-the-vercel-dashboard-twice-as-fast)

### 7.5 Cache Storage API Calls

**Impact: LOW-MEDIUM (reduces expensive I/O)**

`localStorage`, `sessionStorage`, and `document.cookie` are synchronous and expensive. Cache reads in memory.

**Incorrect: reads storage on every call**

```typescript
function getTheme() {
  return localStorage.getItem(&#x27;theme&#x27;) ?? &#x27;light&#x27;
}
// Called 10 times = 10 storage reads
```

**Correct: Map cache**

```typescript
const storageCache = new Map&lt;string, string | null&gt;()

function getLocalStorage(key: string) {
  if (!storageCache.has(key)) {
    storageCache.set(key, localStorage.getItem(key))
  }
  return storageCache.get(key)
}

function setLocalStorage(key: string, value: string) {
  localStorage.setItem(key, value)
  storageCache.set(key, value)  // keep cache in sync
}
```

Use a Map (not a hook) so it works everywhere: utilities, event handlers, not just React components.

**Cookie caching:**

```typescript
let cookieCache: Record&lt;string, string&gt; | null = null

function getCookie(name: string) {
  if (!cookieCache) {
    cookieCache = Object.fromEntries(
      document.cookie.split(&#x27;; &#x27;).map(c =&gt; c.split(&#x27;=&#x27;))
    )
  }
  return cookieCache[name]
}
```

**Important: invalidate on external changes**

```typescript
window.addEventListener(&#x27;storage&#x27;, (e) =&gt; {
  if (e.key) storageCache.delete(e.key)
})

document.addEventListener(&#x27;visibilitychange&#x27;, () =&gt; {
  if (document.visibilityState === &#x27;visible&#x27;) {
    storageCache.clear()
  }
})
```

If storage can change externally (another tab, server-set cookies), invalidate cache:

### 7.6 Combine Multiple Array Iterations

**Impact: LOW-MEDIUM (reduces iterations)**

Multiple `.filter()` or `.map()` calls iterate the array multiple times. Combine into one loop.

**Incorrect: 3 iterations**

```typescript
const admins = users.filter(u =&gt; u.isAdmin)
const testers = users.filter(u =&gt; u.isTester)
const inactive = users.filter(u =&gt; !u.isActive)
```

**Correct: 1 iteration**

```typescript
const admins: User[] = []
const testers: User[] = []
const inactive: User[] = []

for (const user of users) {
  if (user.isAdmin) admins.push(user)
  if (user.isTester) testers.push(user)
  if (!user.isActive) inactive.push(user)
}
```

### 7.7 Early Length Check for Array Comparisons

**Impact: MEDIUM-HIGH (avoids expensive operations when lengths differ)**

When comparing arrays with expensive operations (sorting, deep equality, serialization), check lengths first. If lengths differ, the arrays cannot be equal.

In real-world applications, this optimization is especially valuable when the comparison runs in hot paths (event handlers, render loops).

**Incorrect: always runs expensive comparison**

```typescript
function hasChanges(current: string[], original: string[]) {
  // Always sorts and joins, even when lengths differ
  return current.sort().join() !== original.sort().join()
}
```

Two O(n log n) sorts run even when `current.length` is 5 and `original.length` is 100. There is also overhead of joining the arrays and comparing the strings.

**Correct (O(1) length check first):**

```typescript
function hasChanges(current: string[], original: string[]) {
  // Early return if lengths differ
  if (current.length !== original.length) {
    return true
  }
  // Only sort/join when lengths match
  const currentSorted = current.toSorted()
  const originalSorted = original.toSorted()
  for (let i = 0; i &lt; currentSorted.length; i++) {
    if (currentSorted[i] !== originalSorted[i]) {
      return true
    }
  }
  return false
}
```

This new approach is more efficient because:

- It avoids the overhead of sorting and joining the arrays when lengths differ

- It avoids consuming memory for the joined strings (especially important for large arrays)

- It avoids mutating the original arrays

- It returns early when a difference is found

### 7.8 Early Return from Functions

**Impact: LOW-MEDIUM (avoids unnecessary computation)**

Return early when result is determined to skip unnecessary processing.

**Incorrect: processes all items even after finding answer**

```typescript
function validateUsers(users: User[]) {
  let hasError = false
  let errorMessage = &#x27;&#x27;
  
  for (const user of users) {
    if (!user.email) {
      hasError = true
      errorMessage = &#x27;Email required&#x27;
    }
    if (!user.name) {
      hasError = true
      errorMessage = &#x27;Name required&#x27;
    }
    // Continues checking all users even after error found
  }
  
  return hasError ? { valid: false, error: errorMessage } : { valid: true }
}
```

**Correct: returns immediately on first error**

```typescript
function validateUsers(users: User[]) {
  for (const user of users) {
    if (!user.email) {
      return { valid: false, error: &#x27;Email required&#x27; }
    }
    if (!user.name) {
      return { valid: false, error: &#x27;Name required&#x27; }
    }
  }

  return { valid: true }
}
```

### 7.9 Hoist RegExp Creation

**Impact: LOW-MEDIUM (avoids recreation)**

Don&#x27;t create RegExp inside render. Hoist to module scope or memoize with `useMemo()`.

**Incorrect: new RegExp every render**

```tsx
function Highlighter({ text, query }: Props) {
  const regex = new RegExp(`(${query})`, &#x27;gi&#x27;)
  const parts = text.split(regex)
  return &lt;&gt;{parts.map((part, i) =&gt; ...)}&lt;/&gt;
}
```

**Correct: memoize or hoist**

```tsx
const EMAIL_REGEX = /^[^\s@]+@[^\s@]+\.[^\s@]+$/

function Highlighter({ text, query }: Props) {
  const regex = useMemo(
    () =&gt; new RegExp(`(${escapeRegex(query)})`, &#x27;gi&#x27;),
    [query]
  )
  const parts = text.split(regex)
  return &lt;&gt;{parts.map((part, i) =&gt; ...)}&lt;/&gt;
}
```

**Warning: global regex has mutable state**

```typescript
const regex = /foo/g
regex.test(&#x27;foo&#x27;)  // true, lastIndex = 3
regex.test(&#x27;foo&#x27;)  // false, lastIndex = 0
```

Global regex (`/g`) has mutable `lastIndex` state:

### 7.10 Use Loop for Min/Max Instead of Sort

**Impact: LOW (O(n) instead of O(n log n))**

Finding the smallest or largest element only requires a single pass through the array. Sorting is wasteful and slower.

**Incorrect (O(n log n) - sort to find latest):**

```typescript
interface Project {
  id: string
  name: string
  updatedAt: number
}

function getLatestProject(projects: Project[]) {
  const sorted = [...projects].sort((a, b) =&gt; b.updatedAt - a.updatedAt)
  return sorted[0]
}
```

Sorts the entire array just to find the maximum value.

**Incorrect (O(n log n) - sort for oldest and newest):**

```typescript
function getOldestAndNewest(projects: Project[]) {
  const sorted = [...projects].sort((a, b) =&gt; a.updatedAt - b.updatedAt)
  return { oldest: sorted[0], newest: sorted[sorted.length - 1] }
}
```

Still sorts unnecessarily when only min/max are needed.

**Correct (O(n) - single loop):**

```typescript
function getLatestProject(projects: Project[]) {
  if (projects.length === 0) return null
  
  let latest = projects[0]
  
  for (let i = 1; i &lt; projects.length; i++) {
    if (projects[i].updatedAt &gt; latest.updatedAt) {
      latest = projects[i]
    }
  }
  
  return latest
}

function getOldestAndNewest(projects: Project[]) {
  if (projects.length === 0) return { oldest: null, newest: null }
  
  let oldest = projects[0]
  let newest = projects[0]
  
  for (let i = 1; i &lt; projects.length; i++) {
    if (projects[i].updatedAt &lt; oldest.updatedAt) oldest = projects[i]
    if (projects[i].updatedAt &gt; newest.updatedAt) newest = projects[i]
  }
  
  return { oldest, newest }
}
```

Single pass through the array, no copying, no sorting.

**Alternative: Math.min/Math.max for small arrays**

```typescript
const numbers = [5, 2, 8, 1, 9]
const min = Math.min(...numbers)
const max = Math.max(...numbers)
```

This works for small arrays but can be slower for very large arrays due to spread operator limitations. Use the loop approach for reliability.

### 7.11 Use Set/Map for O(1) Lookups

**Impact: LOW-MEDIUM (O(n) to O(1))**

Convert arrays to Set/Map for repeated membership checks.

**Incorrect (O(n) per check):**

```typescript
const allowedIds = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, ...]
items.filter(item =&gt; allowedIds.includes(item.id))
```

**Correct (O(1) per check):**

```typescript
const allowedIds = new Set([&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, ...])
items.filter(item =&gt; allowedIds.has(item.id))
```

### 7.12 Use toSorted() Instead of sort() for Immutability

**Impact: MEDIUM-HIGH (prevents mutation bugs in React state)**

`.sort()` mutates the array in place, which can cause bugs with React state and props. Use `.toSorted()` to create a new sorted array without mutation.

**Incorrect: mutates original array**

```typescript
function UserList({ users }: { users: User[] }) {
  // Mutates the users prop array!
  const sorted = useMemo(
    () =&gt; users.sort((a, b) =&gt; a.name.localeCompare(b.name)),
    [users]
  )
  return &lt;div&gt;{sorted.map(renderUser)}&lt;/div&gt;
}
```

**Correct: creates new array**

```typescript
function UserList({ users }: { users: User[] }) {
  // Creates new sorted array, original unchanged
  const sorted = useMemo(
    () =&gt; users.toSorted((a, b) =&gt; a.name.localeCompare(b.name)),
    [users]
  )
  return &lt;div&gt;{sorted.map(renderUser)}&lt;/div&gt;
}
```

**Why this matters in React:**

1. Props/state mutations break React&#x27;s immutability model - React expects props and state to be treated as read-only

2. Causes stale closure bugs - Mutating arrays inside closures (callbacks, effects) can lead to unexpected behavior

**Browser support: fallback for older browsers**

```typescript
// Fallback for older browsers
const sorted = [...items].sort((a, b) =&gt; a.value - b.value)
```

`.toSorted()` is available in all modern browsers (Chrome 110+, Safari 16+, Firefox 115+, Node.js 20+). For older environments, use spread operator:

**Other immutable array methods:**

- `.toSorted()` - immutable sort

- `.toReversed()` - immutable reverse

- `.toSpliced()` - immutable splice

- `.with()` - immutable element replacement

---

## 8. Advanced Patterns

**Impact: LOW**

Advanced patterns for specific cases that require careful implementation.

### 8.1 Store Event Handlers in Refs

**Impact: LOW (stable subscriptions)**

Store callbacks in refs when used in effects that shouldn&#x27;t re-subscribe on callback changes.

**Incorrect: re-subscribes on every render**

```tsx
function useWindowEvent(event: string, handler: () =&gt; void) {
  useEffect(() =&gt; {
    window.addEventListener(event, handler)
    return () =&gt; window.removeEventListener(event, handler)
  }, [event, handler])
}
```

**Correct: stable subscription**

```tsx
import { useEffectEvent } from &#x27;react&#x27;

function useWindowEvent(event: string, handler: () =&gt; void) {
  const onEvent = useEffectEvent(handler)

  useEffect(() =&gt; {
    window.addEventListener(event, onEvent)
    return () =&gt; window.removeEventListener(event, onEvent)
  }, [event])
}
```

**Alternative: use `useEffectEvent` if you&#x27;re on latest React:**

`useEffectEvent` provides a cleaner API for the same pattern: it creates a stable function reference that always calls the latest version of the handler.

### 8.2 useLatest for Stable Callback Refs

**Impact: LOW (prevents effect re-runs)**

Access latest values in callbacks without adding them to dependency arrays. Prevents effect re-runs while avoiding stale closures.

**Implementation:**

```typescript
function useLatest&lt;T&gt;(value: T) {
  const ref = useRef(value)
  useEffect(() =&gt; {
    ref.current = value
  }, [value])
  return ref
}
```

**Incorrect: effect re-runs on every callback change**

```tsx
function SearchInput({ onSearch }: { onSearch: (q: string) =&gt; void }) {
  const [query, setQuery] = useState(&#x27;&#x27;)

  useEffect(() =&gt; {
    const timeout = setTimeout(() =&gt; onSearch(query), 300)
    return () =&gt; clearTimeout(timeout)
  }, [query, onSearch])
}
```

**Correct: stable effect, fresh callback**

```tsx
function SearchInput({ onSearch }: { onSearch: (q: string) =&gt; void }) {
  const [query, setQuery] = useState(&#x27;&#x27;)
  const onSearchRef = useLatest(onSearch)

  useEffect(() =&gt; {
    const timeout = setTimeout(() =&gt; onSearchRef.current(query), 300)
    return () =&gt; clearTimeout(timeout)
  }, [query])
}
```

---

## References

1. [https://react.dev](https://react.dev)
2. [https://nextjs.org](https://nextjs.org)
3. [https://swr.vercel.app](https://swr.vercel.app)
4. [https://github.com/shuding/better-all](https://github.com/shuding/better-all)
5. [https://github.com/isaacs/node-lru-cache](https://github.com/isaacs/node-lru-cache)
6. [https://vercel.com/blog/how-we-optimized-package-imports-in-next-js](https://vercel.com/blog/how-we-optimized-package-imports-in-next-js)
7. [https://vercel.com/blog/how-we-made-the-vercel-dashboard-twice-as-fast](https://vercel.com/blog/how-we-made-the-vercel-dashboard-twice-as-fast)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/agents/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="async_api_routes Imported skill async_api_routes from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/async-api-routes.md Unknown See repository sources/vercel/async_api_routes/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">async_api_routes</div>
                <button class="copy-btn" onclick="copyToClipboard('async_api_routes')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill async_api_routes from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Prevent Waterfall Chains in API Routes
impact: CRITICAL
impactDescription: 2-10 improvement
tags: api-routes, server-actions, waterfalls, parallelization
---

## Prevent Waterfall Chains in API Routes

In API routes and Server Actions, start independent operations immediately, even if you don&#x27;t await them yet.

**Incorrect (config waits for auth, data waits for both):**

```typescript
export async function GET(request: Request) {
  const session = await auth()
  const config = await fetchConfig()
  const data = await fetchData(session.user.id)
  return Response.json({ data, config })
}
```

**Correct (auth and config start immediately):**

```typescript
export async function GET(request: Request) {
  const sessionPromise = auth()
  const configPromise = fetchConfig()
  const session = await sessionPromise
  const [config, data] = await Promise.all([
    configPromise,
    fetchData(session.user.id)
  ])
  return Response.json({ data, config })
}
```

For operations with more complex dependency chains, use `better-all` to automatically maximize parallelism (see Dependency-Based Parallelization).</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/async_api_routes/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="async_defer_await Imported skill async_defer_await from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/async-defer-await.md Unknown See repository sources/vercel/async_defer_await/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">async_defer_await</div>
                <button class="copy-btn" onclick="copyToClipboard('async_defer_await')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill async_defer_await from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Defer Await Until Needed
impact: HIGH
impactDescription: avoids blocking unused code paths
tags: async, await, conditional, optimization
---

## Defer Await Until Needed

Move `await` operations into the branches where they&#x27;re actually used to avoid blocking code paths that don&#x27;t need them.

**Incorrect (blocks both branches):**

```typescript
async function handleRequest(userId: string, skipProcessing: boolean) {
  const userData = await fetchUserData(userId)
  
  if (skipProcessing) {
    // Returns immediately but still waited for userData
    return { skipped: true }
  }
  
  // Only this branch uses userData
  return processUserData(userData)
}
```

**Correct (only blocks when needed):**

```typescript
async function handleRequest(userId: string, skipProcessing: boolean) {
  if (skipProcessing) {
    // Returns immediately without waiting
    return { skipped: true }
  }
  
  // Fetch only when needed
  const userData = await fetchUserData(userId)
  return processUserData(userData)
}
```

**Another example (early return optimization):**

```typescript
// Incorrect: always fetches permissions
async function updateResource(resourceId: string, userId: string) {
  const permissions = await fetchPermissions(userId)
  const resource = await getResource(resourceId)
  
  if (!resource) {
    return { error: &#x27;Not found&#x27; }
  }
  
  if (!permissions.canEdit) {
    return { error: &#x27;Forbidden&#x27; }
  }
  
  return await updateResourceData(resource, permissions)
}

// Correct: fetches only when needed
async function updateResource(resourceId: string, userId: string) {
  const resource = await getResource(resourceId)
  
  if (!resource) {
    return { error: &#x27;Not found&#x27; }
  }
  
  const permissions = await fetchPermissions(userId)
  
  if (!permissions.canEdit) {
    return { error: &#x27;Forbidden&#x27; }
  }
  
  return await updateResourceData(resource, permissions)
}
```

This optimization is especially valuable when the skipped branch is frequently taken, or when the deferred operation is expensive.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/async_defer_await/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="async_dependencies Imported skill async_dependencies from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/async-dependencies.md Unknown See repository sources/vercel/async_dependencies/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">async_dependencies</div>
                <button class="copy-btn" onclick="copyToClipboard('async_dependencies')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill async_dependencies from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Dependency-Based Parallelization
impact: CRITICAL
impactDescription: 2-10 improvement
tags: async, parallelization, dependencies, better-all
---

## Dependency-Based Parallelization

For operations with partial dependencies, use `better-all` to maximize parallelism. It automatically starts each task at the earliest possible moment.

**Incorrect (profile waits for config unnecessarily):**

```typescript
const [user, config] = await Promise.all([
  fetchUser(),
  fetchConfig()
])
const profile = await fetchProfile(user.id)
```

**Correct (config and profile run in parallel):**

```typescript
import { all } from &#x27;better-all&#x27;

const { user, config, profile } = await all({
  async user() { return fetchUser() },
  async config() { return fetchConfig() },
  async profile() {
    return fetchProfile((await this.$.user).id)
  }
})
```

Reference: [https://github.com/shuding/better-all](https://github.com/shuding/better-all)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/async_dependencies/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="async_parallel Imported skill async_parallel from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/async-parallel.md Unknown See repository sources/vercel/async_parallel/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">async_parallel</div>
                <button class="copy-btn" onclick="copyToClipboard('async_parallel')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill async_parallel from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Promise.all() for Independent Operations
impact: CRITICAL
impactDescription: 2-10 improvement
tags: async, parallelization, promises, waterfalls
---

## Promise.all() for Independent Operations

When async operations have no interdependencies, execute them concurrently using `Promise.all()`.

**Incorrect (sequential execution, 3 round trips):**

```typescript
const user = await fetchUser()
const posts = await fetchPosts()
const comments = await fetchComments()
```

**Correct (parallel execution, 1 round trip):**

```typescript
const [user, posts, comments] = await Promise.all([
  fetchUser(),
  fetchPosts(),
  fetchComments()
])
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/async_parallel/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="async_suspense_boundaries Imported skill async_suspense_boundaries from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/async-suspense-boundaries.md Unknown See repository sources/vercel/async_suspense_boundaries/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">async_suspense_boundaries</div>
                <button class="copy-btn" onclick="copyToClipboard('async_suspense_boundaries')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill async_suspense_boundaries from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Strategic Suspense Boundaries
impact: HIGH
impactDescription: faster initial paint
tags: async, suspense, streaming, layout-shift
---

## Strategic Suspense Boundaries

Instead of awaiting data in async components before returning JSX, use Suspense boundaries to show the wrapper UI faster while data loads.

**Incorrect (wrapper blocked by data fetching):**

```tsx
async function Page() {
  const data = await fetchData() // Blocks entire page
  
  return (
    &lt;div&gt;
      &lt;div&gt;Sidebar&lt;/div&gt;
      &lt;div&gt;Header&lt;/div&gt;
      &lt;div&gt;
        &lt;DataDisplay data={data} /&gt;
      &lt;/div&gt;
      &lt;div&gt;Footer&lt;/div&gt;
    &lt;/div&gt;
  )
}
```

The entire layout waits for data even though only the middle section needs it.

**Correct (wrapper shows immediately, data streams in):**

```tsx
function Page() {
  return (
    &lt;div&gt;
      &lt;div&gt;Sidebar&lt;/div&gt;
      &lt;div&gt;Header&lt;/div&gt;
      &lt;div&gt;
        &lt;Suspense fallback={&lt;Skeleton /&gt;}&gt;
          &lt;DataDisplay /&gt;
        &lt;/Suspense&gt;
      &lt;/div&gt;
      &lt;div&gt;Footer&lt;/div&gt;
    &lt;/div&gt;
  )
}

async function DataDisplay() {
  const data = await fetchData() // Only blocks this component
  return &lt;div&gt;{data.content}&lt;/div&gt;
}
```

Sidebar, Header, and Footer render immediately. Only DataDisplay waits for data.

**Alternative (share promise across components):**

```tsx
function Page() {
  // Start fetch immediately, but don&#x27;t await
  const dataPromise = fetchData()
  
  return (
    &lt;div&gt;
      &lt;div&gt;Sidebar&lt;/div&gt;
      &lt;div&gt;Header&lt;/div&gt;
      &lt;Suspense fallback={&lt;Skeleton /&gt;}&gt;
        &lt;DataDisplay dataPromise={dataPromise} /&gt;
        &lt;DataSummary dataPromise={dataPromise} /&gt;
      &lt;/Suspense&gt;
      &lt;div&gt;Footer&lt;/div&gt;
    &lt;/div&gt;
  )
}

function DataDisplay({ dataPromise }: { dataPromise: Promise&lt;Data&gt; }) {
  const data = use(dataPromise) // Unwraps the promise
  return &lt;div&gt;{data.content}&lt;/div&gt;
}

function DataSummary({ dataPromise }: { dataPromise: Promise&lt;Data&gt; }) {
  const data = use(dataPromise) // Reuses the same promise
  return &lt;div&gt;{data.summary}&lt;/div&gt;
}
```

Both components share the same promise, so only one fetch occurs. Layout renders immediately while both components wait together.

**When NOT to use this pattern:**

- Critical data needed for layout decisions (affects positioning)
- SEO-critical content above the fold
- Small, fast queries where suspense overhead isn&#x27;t worth it
- When you want to avoid layout shift (loading  content jump)

**Trade-off:** Faster initial paint vs potential layout shift. Choose based on your UX priorities.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/async_suspense_boundaries/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="build Imported skill build from vercel vercel /a0/tmp/skills_research/vercel/packages/react-best-practices-build/src/build.ts Unknown See repository sources/vercel/build/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">build</div>
                <button class="copy-btn" onclick="copyToClipboard('build')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill build from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env node
/**
 * Build script to compile individual rule files into AGENTS.md
 */

import { readdir, readFile, writeFile } from &#x27;fs/promises&#x27;
import { join } from &#x27;path&#x27;
import { Rule, Section, GuidelinesDocument, ImpactLevel } from &#x27;./types.js&#x27;
import { parseRuleFile, RuleFile } from &#x27;./parser.js&#x27;
import { RULES_DIR, METADATA_FILE, OUTPUT_FILE, SKILL_DIR } from &#x27;./config.js&#x27;

// Parse command line arguments
const args = process.argv.slice(2)
const upgradeVersion = args.includes(&#x27;--upgrade-version&#x27;)

/**
 * Increment a semver-style version string (e.g., &quot;0.1.0&quot; -&gt; &quot;0.1.1&quot;, &quot;1.0&quot; -&gt; &quot;1.1&quot;)
 */
function incrementVersion(version: string): string {
  const parts = version.split(&#x27;.&#x27;).map(Number)
  // Increment the last part
  parts[parts.length - 1]++
  return parts.join(&#x27;.&#x27;)
}

/**
 * Generate markdown from rules
 */
function generateMarkdown(
  sections: Section[],
  metadata: {
    version: string
    organization: string
    date: string
    abstract: string
    references?: string[]
  }
): string {
  let md = `# React Best Practices\n\n`
  md += `**Version ${metadata.version}**  \n`
  md += `${metadata.organization}  \n`
  md += `${metadata.date}\n\n`
  md += `&gt; **Note:**  \n`
  md += `&gt; This document is mainly for agents and LLMs to follow when maintaining,  \n`
  md += `&gt; generating, or refactoring React and Next.js codebases at Vercel. Humans  \n`
  md += `&gt; may also find it useful, but guidance here is optimized for automation  \n`
  md += `&gt; and consistency by AI-assisted workflows.\n\n`
  md += `---\n\n`
  md += `## Abstract\n\n`
  md += `${metadata.abstract}\n\n`
  md += `---\n\n`
  md += `## Table of Contents\n\n`

  // Generate TOC
  sections.forEach((section) =&gt; {
    md += `${section.number}. [${section.title}](#${
      section.number
    }-${section.title.toLowerCase().replace(/\s+/g, &#x27;-&#x27;)})  **${
      section.impact
    }**\n`
    section.rules.forEach((rule) =&gt; {
      // GitHub generates anchors from the full heading text: &quot;1.1 Title&quot; -&gt; &quot;#11-title&quot;
      const anchor = `${rule.id} ${rule.title}`
        .toLowerCase()
        .replace(/\s+/g, &#x27;-&#x27;)
        .replace(/[^\w-]/g, &#x27;&#x27;) // Remove special characters except hyphens
      md += `   - ${rule.id} [${rule.title}](#${anchor})\n`
    })
  })

  md += `\n---\n\n`

  // Generate sections
  sections.forEach((section) =&gt; {
    md += `## ${section.number}. ${section.title}\n\n`
    md += `**Impact: ${section.impact}${
      section.impactDescription ? ` (${section.impactDescription})` : &#x27;&#x27;
    }**\n\n`
    if (section.introduction) {
      md += `${section.introduction}\n\n`
    }

    section.rules.forEach((rule) =&gt; {
      md += `### ${rule.id} ${rule.title}\n\n`
      md += `**Impact: ${rule.impact}${
        rule.impactDescription ? ` (${rule.impactDescription})` : &#x27;&#x27;
      }**\n\n`
      md += `${rule.explanation}\n\n`

      rule.examples.forEach((example) =&gt; {
        if (example.description) {
          md += `**${example.label}: ${example.description}**\n\n`
        } else {
          md += `**${example.label}:**\n\n`
        }
        // Only generate code block if there&#x27;s actual code
        if (example.code &amp;&amp; example.code.trim()) {
          md += `\`\`\`${example.language || &#x27;typescript&#x27;}\n`
          md += `${example.code}\n`
          md += `\`\`\`\n\n`
        }
        if (example.additionalText) {
          md += `${example.additionalText}\n\n`
        }
      })

      if (rule.references &amp;&amp; rule.references.length &gt; 0) {
        md += `Reference: ${rule.references
          .map((ref) =&gt; `[${ref}](${ref})`)
          .join(&#x27;, &#x27;)}\n\n`
      }
    })

    md += `---\n\n`
  })

  // Add references section
  if (metadata.references &amp;&amp; metadata.references.length &gt; 0) {
    md += `## References\n\n`
    metadata.references.forEach((ref, i) =&gt; {
      md += `${i + 1}. [${ref}](${ref})\n`
    })
  }

  return md
}

/**
 * Main build function
 */
async function build() {
  try {
    console.log(&#x27;Building AGENTS.md from rules...&#x27;)
    console.log(`Rules directory: ${RULES_DIR}`)
    console.log(`Output file: ${OUTPUT_FILE}`)

    // Read all rule files (exclude files starting with _ and README.md)
    const files = await readdir(RULES_DIR)
    const ruleFiles = files
      .filter(
        (f) =&gt; f.endsWith(&#x27;.md&#x27;) &amp;&amp; !f.startsWith(&#x27;_&#x27;) &amp;&amp; f !== &#x27;README.md&#x27;
      )
      .sort() // Sort filenames for consistent ordering across systems

    const ruleData: RuleFile[] = []
    for (const file of ruleFiles) {
      const filePath = join(RULES_DIR, file)
      try {
        const parsed = await parseRuleFile(filePath)
        ruleData.push(parsed)
      } catch (error) {
        console.error(`Error parsing ${file}:`, error)
      }
    }

    // Group rules by section
    const sectionsMap = new Map&lt;number, Section&gt;()

    ruleData.forEach(({ section, rule }) =&gt; {
      if (!sectionsMap.has(section)) {
        sectionsMap.set(section, {
          number: section,
          title: `Section ${section}`, // Will be overridden by section metadata
          impact: rule.impact,
          rules: [],
        })
      }
      sectionsMap.get(section)!.rules.push(rule)
    })

    // Sort rules within each section by title (using en-US locale for consistency across environments)
    sectionsMap.forEach((section) =&gt; {
      section.rules.sort((a, b) =&gt;
        a.title.localeCompare(b.title, &#x27;en-US&#x27;, { sensitivity: &#x27;base&#x27; })
      )

      // Assign IDs based on sorted order
      section.rules.forEach((rule, index) =&gt; {
        rule.id = `${section.number}.${index + 1}`
        rule.subsection = index + 1
      })
    })

    // Convert to array and sort
    const sections = Array.from(sectionsMap.values()).sort(
      (a, b) =&gt; a.number - b.number
    )

    // Read section metadata from consolidated _sections.md file
    const sectionsFile = join(RULES_DIR, &#x27;_sections.md&#x27;)
    try {
      const sectionsContent = await readFile(sectionsFile, &#x27;utf-8&#x27;)

      // Parse sections using regex to match each section block
      const sectionBlocks = sectionsContent
        .split(/(?=^## \d+\. )/m)
        .filter(Boolean)

      for (const block of sectionBlocks) {
        // Extract section number and title, removing section ID in parentheses
        const headerMatch = block.match(
          /^## (\d+)\.\s+(.+?)(?:\s+\([^)]+\))?$/m
        )
        if (!headerMatch) continue

        const sectionNumber = parseInt(headerMatch[1])
        const sectionTitle = headerMatch[2].trim() // Strip (id) for output

        // Extract impact (format: **Impact:** CRITICAL)
        const impactMatch = block.match(/\*\*Impact:\*\*\s+(\w+(?:-\w+)?)/i)
        const impactLevel = impactMatch
          ? (impactMatch[1].toUpperCase().replace(/-/g, &#x27;-&#x27;) as ImpactLevel)
          : &#x27;MEDIUM&#x27;

        // Extract description (format: **Description:** text)
        const descMatch = block.match(
          /\*\*Description:\*\*\s+(.+?)(?=\n\n##|$)/s
        )
        const description = descMatch ? descMatch[1].trim() : &#x27;&#x27;

        // Update section if it exists
        const section = sections.find((s) =&gt; s.number === sectionNumber)
        if (section) {
          section.title = sectionTitle
          section.impact = impactLevel
          section.introduction = description
        }
      }
    } catch (error) {
      console.warn(
        &#x27;Warning: Could not read _sections.md, using defaults&#x27;,
        error
      )
    }

    // Read metadata
    let metadata
    try {
      const metadataContent = await readFile(METADATA_FILE, &#x27;utf-8&#x27;)
      metadata = JSON.parse(metadataContent)
    } catch {
      metadata = {
        version: &#x27;1.0&#x27;,
        organization: &#x27;Vercel Engineering&#x27;,
        date: new Date().toLocaleDateString(&#x27;en-US&#x27;, {
          month: &#x27;long&#x27;,
          year: &#x27;numeric&#x27;,
        }),
        abstract:
          &#x27;Performance optimization guide for React and Next.js applications, ordered by impact.&#x27;,
      }
    }

    // Upgrade version if flag is passed
    if (upgradeVersion) {
      const oldVersion = metadata.version
      metadata.version = incrementVersion(oldVersion)
      console.log(`Upgrading version: ${oldVersion} -&gt; ${metadata.version}`)

      // Write updated metadata.json
      await writeFile(METADATA_FILE, JSON.stringify(metadata, null, 2) + &#x27;\n&#x27;, &#x27;utf-8&#x27;)
      console.log(` Updated metadata.json`)

      // Update SKILL.md frontmatter
      const skillFile = join(SKILL_DIR, &#x27;SKILL.md&#x27;)
      const skillContent = await readFile(skillFile, &#x27;utf-8&#x27;)
      const updatedSkillContent = skillContent.replace(
        /^(---[\s\S]*?version:\s*)&quot;[^&quot;]*&quot;([\s\S]*?---)$/m,
        `$1&quot;${metadata.version}&quot;$2`
      )
      await writeFile(skillFile, updatedSkillContent, &#x27;utf-8&#x27;)
      console.log(` Updated SKILL.md`)
    }

    // Generate markdown
    const markdown = generateMarkdown(sections, metadata)

    // Write output
    await writeFile(OUTPUT_FILE, markdown, &#x27;utf-8&#x27;)

    console.log(
      ` Built AGENTS.md with ${sections.length} sections and ${ruleData.length} rules`
    )
  } catch (error) {
    console.error(&#x27;Build failed:&#x27;, error)
    process.exit(1)
  }
}

build()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/build/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="bundle_barrel_imports Imported skill bundle_barrel_imports from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/bundle-barrel-imports.md Unknown See repository sources/vercel/bundle_barrel_imports/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">bundle_barrel_imports</div>
                <button class="copy-btn" onclick="copyToClipboard('bundle_barrel_imports')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill bundle_barrel_imports from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Avoid Barrel File Imports
impact: CRITICAL
impactDescription: 200-800ms import cost, slow builds
tags: bundle, imports, tree-shaking, barrel-files, performance
---

## Avoid Barrel File Imports

Import directly from source files instead of barrel files to avoid loading thousands of unused modules. **Barrel files** are entry points that re-export multiple modules (e.g., `index.js` that does `export * from &#x27;./module&#x27;`).

Popular icon and component libraries can have **up to 10,000 re-exports** in their entry file. For many React packages, **it takes 200-800ms just to import them**, affecting both development speed and production cold starts.

**Why tree-shaking doesn&#x27;t help:** When a library is marked as external (not bundled), the bundler can&#x27;t optimize it. If you bundle it to enable tree-shaking, builds become substantially slower analyzing the entire module graph.

**Incorrect (imports entire library):**

```tsx
import { Check, X, Menu } from &#x27;lucide-react&#x27;
// Loads 1,583 modules, takes ~2.8s extra in dev
// Runtime cost: 200-800ms on every cold start

import { Button, TextField } from &#x27;@mui/material&#x27;
// Loads 2,225 modules, takes ~4.2s extra in dev
```

**Correct (imports only what you need):**

```tsx
import Check from &#x27;lucide-react/dist/esm/icons/check&#x27;
import X from &#x27;lucide-react/dist/esm/icons/x&#x27;
import Menu from &#x27;lucide-react/dist/esm/icons/menu&#x27;
// Loads only 3 modules (~2KB vs ~1MB)

import Button from &#x27;@mui/material/Button&#x27;
import TextField from &#x27;@mui/material/TextField&#x27;
// Loads only what you use
```

**Alternative (Next.js 13.5+):**

```js
// next.config.js - use optimizePackageImports
module.exports = {
  experimental: {
    optimizePackageImports: [&#x27;lucide-react&#x27;, &#x27;@mui/material&#x27;]
  }
}

// Then you can keep the ergonomic barrel imports:
import { Check, X, Menu } from &#x27;lucide-react&#x27;
// Automatically transformed to direct imports at build time
```

Direct imports provide 15-70% faster dev boot, 28% faster builds, 40% faster cold starts, and significantly faster HMR.

Libraries commonly affected: `lucide-react`, `@mui/material`, `@mui/icons-material`, `@tabler/icons-react`, `react-icons`, `@headlessui/react`, `@radix-ui/react-*`, `lodash`, `ramda`, `date-fns`, `rxjs`, `react-use`.

Reference: [How we optimized package imports in Next.js](https://vercel.com/blog/how-we-optimized-package-imports-in-next-js)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/bundle_barrel_imports/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="bundle_conditional Imported skill bundle_conditional from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/bundle-conditional.md Unknown See repository sources/vercel/bundle_conditional/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">bundle_conditional</div>
                <button class="copy-btn" onclick="copyToClipboard('bundle_conditional')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill bundle_conditional from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Conditional Module Loading
impact: HIGH
impactDescription: loads large data only when needed
tags: bundle, conditional-loading, lazy-loading
---

## Conditional Module Loading

Load large data or modules only when a feature is activated.

**Example (lazy-load animation frames):**

```tsx
function AnimationPlayer({ enabled, setEnabled }: { enabled: boolean; setEnabled: React.Dispatch&lt;React.SetStateAction&lt;boolean&gt;&gt; }) {
  const [frames, setFrames] = useState&lt;Frame[] | null&gt;(null)

  useEffect(() =&gt; {
    if (enabled &amp;&amp; !frames &amp;&amp; typeof window !== &#x27;undefined&#x27;) {
      import(&#x27;./animation-frames.js&#x27;)
        .then(mod =&gt; setFrames(mod.frames))
        .catch(() =&gt; setEnabled(false))
    }
  }, [enabled, frames, setEnabled])

  if (!frames) return &lt;Skeleton /&gt;
  return &lt;Canvas frames={frames} /&gt;
}
```

The `typeof window !== &#x27;undefined&#x27;` check prevents bundling this module for SSR, optimizing server bundle size and build speed.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/bundle_conditional/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="bundle_defer_third_party Imported skill bundle_defer_third_party from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/bundle-defer-third-party.md Unknown See repository sources/vercel/bundle_defer_third_party/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">bundle_defer_third_party</div>
                <button class="copy-btn" onclick="copyToClipboard('bundle_defer_third_party')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill bundle_defer_third_party from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Defer Non-Critical Third-Party Libraries
impact: MEDIUM
impactDescription: loads after hydration
tags: bundle, third-party, analytics, defer
---

## Defer Non-Critical Third-Party Libraries

Analytics, logging, and error tracking don&#x27;t block user interaction. Load them after hydration.

**Incorrect (blocks initial bundle):**

```tsx
import { Analytics } from &#x27;@vercel/analytics/react&#x27;

export default function RootLayout({ children }) {
  return (
    &lt;html&gt;
      &lt;body&gt;
        {children}
        &lt;Analytics /&gt;
      &lt;/body&gt;
    &lt;/html&gt;
  )
}
```

**Correct (loads after hydration):**

```tsx
import dynamic from &#x27;next/dynamic&#x27;

const Analytics = dynamic(
  () =&gt; import(&#x27;@vercel/analytics/react&#x27;).then(m =&gt; m.Analytics),
  { ssr: false }
)

export default function RootLayout({ children }) {
  return (
    &lt;html&gt;
      &lt;body&gt;
        {children}
        &lt;Analytics /&gt;
      &lt;/body&gt;
    &lt;/html&gt;
  )
}
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/bundle_defer_third_party/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="bundle_dynamic_imports Imported skill bundle_dynamic_imports from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/bundle-dynamic-imports.md Unknown See repository sources/vercel/bundle_dynamic_imports/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">bundle_dynamic_imports</div>
                <button class="copy-btn" onclick="copyToClipboard('bundle_dynamic_imports')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill bundle_dynamic_imports from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Dynamic Imports for Heavy Components
impact: CRITICAL
impactDescription: directly affects TTI and LCP
tags: bundle, dynamic-import, code-splitting, next-dynamic
---

## Dynamic Imports for Heavy Components

Use `next/dynamic` to lazy-load large components not needed on initial render.

**Incorrect (Monaco bundles with main chunk ~300KB):**

```tsx
import { MonacoEditor } from &#x27;./monaco-editor&#x27;

function CodePanel({ code }: { code: string }) {
  return &lt;MonacoEditor value={code} /&gt;
}
```

**Correct (Monaco loads on demand):**

```tsx
import dynamic from &#x27;next/dynamic&#x27;

const MonacoEditor = dynamic(
  () =&gt; import(&#x27;./monaco-editor&#x27;).then(m =&gt; m.MonacoEditor),
  { ssr: false }
)

function CodePanel({ code }: { code: string }) {
  return &lt;MonacoEditor value={code} /&gt;
}
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/bundle_dynamic_imports/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="bundle_preload Imported skill bundle_preload from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/bundle-preload.md Unknown See repository sources/vercel/bundle_preload/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">bundle_preload</div>
                <button class="copy-btn" onclick="copyToClipboard('bundle_preload')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill bundle_preload from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Preload Based on User Intent
impact: MEDIUM
impactDescription: reduces perceived latency
tags: bundle, preload, user-intent, hover
---

## Preload Based on User Intent

Preload heavy bundles before they&#x27;re needed to reduce perceived latency.

**Example (preload on hover/focus):**

```tsx
function EditorButton({ onClick }: { onClick: () =&gt; void }) {
  const preload = () =&gt; {
    if (typeof window !== &#x27;undefined&#x27;) {
      void import(&#x27;./monaco-editor&#x27;)
    }
  }

  return (
    &lt;button
      onMouseEnter={preload}
      onFocus={preload}
      onClick={onClick}
    &gt;
      Open Editor
    &lt;/button&gt;
  )
}
```

**Example (preload when feature flag is enabled):**

```tsx
function FlagsProvider({ children, flags }: Props) {
  useEffect(() =&gt; {
    if (flags.editorEnabled &amp;&amp; typeof window !== &#x27;undefined&#x27;) {
      void import(&#x27;./monaco-editor&#x27;).then(mod =&gt; mod.init())
    }
  }, [flags.editorEnabled])

  return &lt;FlagsContext.Provider value={flags}&gt;
    {children}
  &lt;/FlagsContext.Provider&gt;
}
```

The `typeof window !== &#x27;undefined&#x27;` check prevents bundling preloaded modules for SSR, optimizing server bundle size and build speed.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/bundle_preload/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="claude Imported skill claude from vercel vercel /a0/tmp/skills_research/vercel/CLAUDE.md Unknown See repository sources/vercel/claude/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">claude</div>
                <button class="copy-btn" onclick="copyToClipboard('claude')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill claude from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># AGENTS.md

This file provides guidance to AI coding agents (Claude Code, Cursor, Copilot, etc.) when working with code in this repository.

## Repository Overview

A collection of skills for Claude.ai and Claude Code for working with Vercel deployments. Skills are packaged instructions and scripts that extend Claude&#x27;s capabilities.

## Creating a New Skill

### Directory Structure

```
skills/
  {skill-name}/           # kebab-case directory name
    SKILL.md              # Required: skill definition
    scripts/              # Required: executable scripts
      {script-name}.sh    # Bash scripts (preferred)
  {skill-name}.zip        # Required: packaged for distribution
```

### Naming Conventions

- **Skill directory**: `kebab-case` (e.g., `vercel-deploy`, `log-monitor`)
- **SKILL.md**: Always uppercase, always this exact filename
- **Scripts**: `kebab-case.sh` (e.g., `deploy.sh`, `fetch-logs.sh`)
- **Zip file**: Must match directory name exactly: `{skill-name}.zip`

### SKILL.md Format

```markdown
---
name: {skill-name}
description: {One sentence describing when to use this skill. Include trigger phrases like &quot;Deploy my app&quot;, &quot;Check logs&quot;, etc.}
---

# {Skill Title}

{Brief description of what the skill does.}

## How It Works

{Numbered list explaining the skill&#x27;s workflow}

## Usage

```bash
bash /mnt/skills/user/{skill-name}/scripts/{script}.sh [args]
```

**Arguments:**
- `arg1` - Description (defaults to X)

**Examples:**
{Show 2-3 common usage patterns}

## Output

{Show example output users will see}

## Present Results to User

{Template for how Claude should format results when presenting to users}

## Troubleshooting

{Common issues and solutions, especially network/permissions errors}
```

### Best Practices for Context Efficiency

Skills are loaded on-demand  only the skill name and description are loaded at startup. The full `SKILL.md` loads into context only when the agent decides the skill is relevant. To minimize context usage:

- **Keep SKILL.md under 500 lines**  put detailed reference material in separate files
- **Write specific descriptions**  helps the agent know exactly when to activate the skill
- **Use progressive disclosure**  reference supporting files that get read only when needed
- **Prefer scripts over inline code**  script execution doesn&#x27;t consume context (only output does)
- **File references work one level deep**  link directly from SKILL.md to supporting files

### Script Requirements

- Use `#!/bin/bash` shebang
- Use `set -e` for fail-fast behavior
- Write status messages to stderr: `echo &quot;Message&quot; &gt;&amp;2`
- Write machine-readable output (JSON) to stdout
- Include a cleanup trap for temp files
- Reference the script path as `/mnt/skills/user/{skill-name}/scripts/{script}.sh`

### Creating the Zip Package

After creating or updating a skill:

```bash
cd skills
zip -r {skill-name}.zip {skill-name}/
```

### End-User Installation

Document these two installation methods for users:

**Claude Code:**
```bash
cp -r skills/{skill-name} ~/.claude/skills/
```

**claude.ai:**
Add the skill to project knowledge or paste SKILL.md contents into the conversation.

If the skill requires network access, instruct users to add required domains at `claude.ai/settings/capabilities`.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/claude/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="client_event_listeners Imported skill client_event_listeners from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/client-event-listeners.md Unknown See repository sources/vercel/client_event_listeners/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">client_event_listeners</div>
                <button class="copy-btn" onclick="copyToClipboard('client_event_listeners')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill client_event_listeners from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Deduplicate Global Event Listeners
impact: LOW
impactDescription: single listener for N components
tags: client, swr, event-listeners, subscription
---

## Deduplicate Global Event Listeners

Use `useSWRSubscription()` to share global event listeners across component instances.

**Incorrect (N instances = N listeners):**

```tsx
function useKeyboardShortcut(key: string, callback: () =&gt; void) {
  useEffect(() =&gt; {
    const handler = (e: KeyboardEvent) =&gt; {
      if (e.metaKey &amp;&amp; e.key === key) {
        callback()
      }
    }
    window.addEventListener(&#x27;keydown&#x27;, handler)
    return () =&gt; window.removeEventListener(&#x27;keydown&#x27;, handler)
  }, [key, callback])
}
```

When using the `useKeyboardShortcut` hook multiple times, each instance will register a new listener.

**Correct (N instances = 1 listener):**

```tsx
import useSWRSubscription from &#x27;swr/subscription&#x27;

// Module-level Map to track callbacks per key
const keyCallbacks = new Map&lt;string, Set&lt;() =&gt; void&gt;&gt;()

function useKeyboardShortcut(key: string, callback: () =&gt; void) {
  // Register this callback in the Map
  useEffect(() =&gt; {
    if (!keyCallbacks.has(key)) {
      keyCallbacks.set(key, new Set())
    }
    keyCallbacks.get(key)!.add(callback)

    return () =&gt; {
      const set = keyCallbacks.get(key)
      if (set) {
        set.delete(callback)
        if (set.size === 0) {
          keyCallbacks.delete(key)
        }
      }
    }
  }, [key, callback])

  useSWRSubscription(&#x27;global-keydown&#x27;, () =&gt; {
    const handler = (e: KeyboardEvent) =&gt; {
      if (e.metaKey &amp;&amp; keyCallbacks.has(e.key)) {
        keyCallbacks.get(e.key)!.forEach(cb =&gt; cb())
      }
    }
    window.addEventListener(&#x27;keydown&#x27;, handler)
    return () =&gt; window.removeEventListener(&#x27;keydown&#x27;, handler)
  })
}

function Profile() {
  // Multiple shortcuts will share the same listener
  useKeyboardShortcut(&#x27;p&#x27;, () =&gt; { /* ... */ }) 
  useKeyboardShortcut(&#x27;k&#x27;, () =&gt; { /* ... */ })
  // ...
}
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/client_event_listeners/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="client_localstorage_schema Imported skill client_localstorage_schema from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/client-localstorage-schema.md Unknown See repository sources/vercel/client_localstorage_schema/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">client_localstorage_schema</div>
                <button class="copy-btn" onclick="copyToClipboard('client_localstorage_schema')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill client_localstorage_schema from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Version and Minimize localStorage Data
impact: MEDIUM
impactDescription: prevents schema conflicts, reduces storage size
tags: client, localStorage, storage, versioning, data-minimization
---

## Version and Minimize localStorage Data

Add version prefix to keys and store only needed fields. Prevents schema conflicts and accidental storage of sensitive data.

**Incorrect:**

```typescript
// No version, stores everything, no error handling
localStorage.setItem(&#x27;userConfig&#x27;, JSON.stringify(fullUserObject))
const data = localStorage.getItem(&#x27;userConfig&#x27;)
```

**Correct:**

```typescript
const VERSION = &#x27;v2&#x27;

function saveConfig(config: { theme: string; language: string }) {
  try {
    localStorage.setItem(`userConfig:${VERSION}`, JSON.stringify(config))
  } catch {
    // Throws in incognito/private browsing, quota exceeded, or disabled
  }
}

function loadConfig() {
  try {
    const data = localStorage.getItem(`userConfig:${VERSION}`)
    return data ? JSON.parse(data) : null
  } catch {
    return null
  }
}

// Migration from v1 to v2
function migrate() {
  try {
    const v1 = localStorage.getItem(&#x27;userConfig:v1&#x27;)
    if (v1) {
      const old = JSON.parse(v1)
      saveConfig({ theme: old.darkMode ? &#x27;dark&#x27; : &#x27;light&#x27;, language: old.lang })
      localStorage.removeItem(&#x27;userConfig:v1&#x27;)
    }
  } catch {}
}
```

**Store minimal fields from server responses:**

```typescript
// User object has 20+ fields, only store what UI needs
function cachePrefs(user: FullUser) {
  try {
    localStorage.setItem(&#x27;prefs:v1&#x27;, JSON.stringify({
      theme: user.preferences.theme,
      notifications: user.preferences.notifications
    }))
  } catch {}
}
```

**Always wrap in try-catch:** `getItem()` and `setItem()` throw in incognito/private browsing (Safari, Firefox), when quota exceeded, or when disabled.

**Benefits:** Schema evolution via versioning, reduced storage size, prevents storing tokens/PII/internal flags.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/client_localstorage_schema/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="client_passive_event_listeners Imported skill client_passive_event_listeners from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/client-passive-event-listeners.md Unknown See repository sources/vercel/client_passive_event_listeners/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">client_passive_event_listeners</div>
                <button class="copy-btn" onclick="copyToClipboard('client_passive_event_listeners')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill client_passive_event_listeners from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Use Passive Event Listeners for Scrolling Performance
impact: MEDIUM
impactDescription: eliminates scroll delay caused by event listeners
tags: client, event-listeners, scrolling, performance, touch, wheel
---

## Use Passive Event Listeners for Scrolling Performance

Add `{ passive: true }` to touch and wheel event listeners to enable immediate scrolling. Browsers normally wait for listeners to finish to check if `preventDefault()` is called, causing scroll delay.

**Incorrect:**

```typescript
useEffect(() =&gt; {
  const handleTouch = (e: TouchEvent) =&gt; console.log(e.touches[0].clientX)
  const handleWheel = (e: WheelEvent) =&gt; console.log(e.deltaY)
  
  document.addEventListener(&#x27;touchstart&#x27;, handleTouch)
  document.addEventListener(&#x27;wheel&#x27;, handleWheel)
  
  return () =&gt; {
    document.removeEventListener(&#x27;touchstart&#x27;, handleTouch)
    document.removeEventListener(&#x27;wheel&#x27;, handleWheel)
  }
}, [])
```

**Correct:**

```typescript
useEffect(() =&gt; {
  const handleTouch = (e: TouchEvent) =&gt; console.log(e.touches[0].clientX)
  const handleWheel = (e: WheelEvent) =&gt; console.log(e.deltaY)
  
  document.addEventListener(&#x27;touchstart&#x27;, handleTouch, { passive: true })
  document.addEventListener(&#x27;wheel&#x27;, handleWheel, { passive: true })
  
  return () =&gt; {
    document.removeEventListener(&#x27;touchstart&#x27;, handleTouch)
    document.removeEventListener(&#x27;wheel&#x27;, handleWheel)
  }
}, [])
```

**Use passive when:** tracking/analytics, logging, any listener that doesn&#x27;t call `preventDefault()`.

**Don&#x27;t use passive when:** implementing custom swipe gestures, custom zoom controls, or any listener that needs `preventDefault()`.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/client_passive_event_listeners/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="client_swr_dedup Imported skill client_swr_dedup from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/client-swr-dedup.md Unknown See repository sources/vercel/client_swr_dedup/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">client_swr_dedup</div>
                <button class="copy-btn" onclick="copyToClipboard('client_swr_dedup')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill client_swr_dedup from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Use SWR for Automatic Deduplication
impact: MEDIUM-HIGH
impactDescription: automatic deduplication
tags: client, swr, deduplication, data-fetching
---

## Use SWR for Automatic Deduplication

SWR enables request deduplication, caching, and revalidation across component instances.

**Incorrect (no deduplication, each instance fetches):**

```tsx
function UserList() {
  const [users, setUsers] = useState([])
  useEffect(() =&gt; {
    fetch(&#x27;/api/users&#x27;)
      .then(r =&gt; r.json())
      .then(setUsers)
  }, [])
}
```

**Correct (multiple instances share one request):**

```tsx
import useSWR from &#x27;swr&#x27;

function UserList() {
  const { data: users } = useSWR(&#x27;/api/users&#x27;, fetcher)
}
```

**For immutable data:**

```tsx
import { useImmutableSWR } from &#x27;@/lib/swr&#x27;

function StaticContent() {
  const { data } = useImmutableSWR(&#x27;/api/config&#x27;, fetcher)
}
```

**For mutations:**

```tsx
import { useSWRMutation } from &#x27;swr/mutation&#x27;

function UpdateButton() {
  const { trigger } = useSWRMutation(&#x27;/api/user&#x27;, updateUser)
  return &lt;button onClick={() =&gt; trigger()}&gt;Update&lt;/button&gt;
}
```

Reference: [https://swr.vercel.app](https://swr.vercel.app)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/client_swr_dedup/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="config Imported skill config from vercel vercel /a0/tmp/skills_research/vercel/packages/react-best-practices-build/src/config.ts Unknown See repository sources/vercel/config/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">config</div>
                <button class="copy-btn" onclick="copyToClipboard('config')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill config from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">/**
 * Configuration for the build tooling
 */

import { join, dirname } from &#x27;path&#x27;
import { fileURLToPath } from &#x27;url&#x27;

const __dirname = dirname(fileURLToPath(import.meta.url))

// Path to the skill directory (relative to this package)
export const SKILL_DIR = join(__dirname, &#x27;../../..&#x27;, &#x27;skills/react-best-practices&#x27;)
export const BUILD_DIR = join(__dirname, &#x27;..&#x27;)
export const RULES_DIR = join(SKILL_DIR, &#x27;rules&#x27;)
export const METADATA_FILE = join(SKILL_DIR, &#x27;metadata.json&#x27;)
export const OUTPUT_FILE = join(SKILL_DIR, &#x27;AGENTS.md&#x27;)
// Test cases are build artifacts, not part of the skill
export const TEST_CASES_FILE = join(BUILD_DIR, &#x27;test-cases.json&#x27;)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/config/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="js_batch_dom_css Imported skill js_batch_dom_css from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/js-batch-dom-css.md Unknown See repository sources/vercel/js_batch_dom_css/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">js_batch_dom_css</div>
                <button class="copy-btn" onclick="copyToClipboard('js_batch_dom_css')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill js_batch_dom_css from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Batch DOM CSS Changes
impact: MEDIUM
impactDescription: reduces reflows/repaints
tags: javascript, dom, css, performance, reflow
---

## Batch DOM CSS Changes

Avoid interleaving style writes with layout reads. When you read a layout property (like `offsetWidth`, `getBoundingClientRect()`, or `getComputedStyle()`) between style changes, the browser is forced to trigger a synchronous reflow.

**Incorrect (interleaved reads and writes force reflows):**

```typescript
function updateElementStyles(element: HTMLElement) {
  element.style.width = &#x27;100px&#x27;
  const width = element.offsetWidth  // Forces reflow
  element.style.height = &#x27;200px&#x27;
  const height = element.offsetHeight  // Forces another reflow
}
```

**Correct (batch writes, then read once):**

```typescript
function updateElementStyles(element: HTMLElement) {
  // Batch all writes together
  element.style.width = &#x27;100px&#x27;
  element.style.height = &#x27;200px&#x27;
  element.style.backgroundColor = &#x27;blue&#x27;
  element.style.border = &#x27;1px solid black&#x27;
  
  // Read after all writes are done (single reflow)
  const { width, height } = element.getBoundingClientRect()
}
```

**Better: use CSS classes**

```css
.highlighted-box {
  width: 100px;
  height: 200px;
  background-color: blue;
  border: 1px solid black;
}
```

```typescript
function updateElementStyles(element: HTMLElement) {
  element.classList.add(&#x27;highlighted-box&#x27;)

  const { width, height } = element.getBoundingClientRect()
}
```

Prefer CSS classes over inline styles when possible. CSS files are cached by the browser, and classes provide better separation of concerns and are easier to maintain.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/js_batch_dom_css/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="js_cache_function_results Imported skill js_cache_function_results from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/js-cache-function-results.md Unknown See repository sources/vercel/js_cache_function_results/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">js_cache_function_results</div>
                <button class="copy-btn" onclick="copyToClipboard('js_cache_function_results')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill js_cache_function_results from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Cache Repeated Function Calls
impact: MEDIUM
impactDescription: avoid redundant computation
tags: javascript, cache, memoization, performance
---

## Cache Repeated Function Calls

Use a module-level Map to cache function results when the same function is called repeatedly with the same inputs during render.

**Incorrect (redundant computation):**

```typescript
function ProjectList({ projects }: { projects: Project[] }) {
  return (
    &lt;div&gt;
      {projects.map(project =&gt; {
        // slugify() called 100+ times for same project names
        const slug = slugify(project.name)
        
        return &lt;ProjectCard key={project.id} slug={slug} /&gt;
      })}
    &lt;/div&gt;
  )
}
```

**Correct (cached results):**

```typescript
// Module-level cache
const slugifyCache = new Map&lt;string, string&gt;()

function cachedSlugify(text: string): string {
  if (slugifyCache.has(text)) {
    return slugifyCache.get(text)!
  }
  const result = slugify(text)
  slugifyCache.set(text, result)
  return result
}

function ProjectList({ projects }: { projects: Project[] }) {
  return (
    &lt;div&gt;
      {projects.map(project =&gt; {
        // Computed only once per unique project name
        const slug = cachedSlugify(project.name)
        
        return &lt;ProjectCard key={project.id} slug={slug} /&gt;
      })}
    &lt;/div&gt;
  )
}
```

**Simpler pattern for single-value functions:**

```typescript
let isLoggedInCache: boolean | null = null

function isLoggedIn(): boolean {
  if (isLoggedInCache !== null) {
    return isLoggedInCache
  }
  
  isLoggedInCache = document.cookie.includes(&#x27;auth=&#x27;)
  return isLoggedInCache
}

// Clear cache when auth changes
function onAuthChange() {
  isLoggedInCache = null
}
```

Use a Map (not a hook) so it works everywhere: utilities, event handlers, not just React components.

Reference: [How we made the Vercel Dashboard twice as fast](https://vercel.com/blog/how-we-made-the-vercel-dashboard-twice-as-fast)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/js_cache_function_results/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="js_cache_property_access Imported skill js_cache_property_access from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/js-cache-property-access.md Unknown See repository sources/vercel/js_cache_property_access/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">js_cache_property_access</div>
                <button class="copy-btn" onclick="copyToClipboard('js_cache_property_access')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill js_cache_property_access from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Cache Property Access in Loops
impact: LOW-MEDIUM
impactDescription: reduces lookups
tags: javascript, loops, optimization, caching
---

## Cache Property Access in Loops

Cache object property lookups in hot paths.

**Incorrect (3 lookups  N iterations):**

```typescript
for (let i = 0; i &lt; arr.length; i++) {
  process(obj.config.settings.value)
}
```

**Correct (1 lookup total):**

```typescript
const value = obj.config.settings.value
const len = arr.length
for (let i = 0; i &lt; len; i++) {
  process(value)
}
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/js_cache_property_access/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="js_cache_storage Imported skill js_cache_storage from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/js-cache-storage.md Unknown See repository sources/vercel/js_cache_storage/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">js_cache_storage</div>
                <button class="copy-btn" onclick="copyToClipboard('js_cache_storage')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill js_cache_storage from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Cache Storage API Calls
impact: LOW-MEDIUM
impactDescription: reduces expensive I/O
tags: javascript, localStorage, storage, caching, performance
---

## Cache Storage API Calls

`localStorage`, `sessionStorage`, and `document.cookie` are synchronous and expensive. Cache reads in memory.

**Incorrect (reads storage on every call):**

```typescript
function getTheme() {
  return localStorage.getItem(&#x27;theme&#x27;) ?? &#x27;light&#x27;
}
// Called 10 times = 10 storage reads
```

**Correct (Map cache):**

```typescript
const storageCache = new Map&lt;string, string | null&gt;()

function getLocalStorage(key: string) {
  if (!storageCache.has(key)) {
    storageCache.set(key, localStorage.getItem(key))
  }
  return storageCache.get(key)
}

function setLocalStorage(key: string, value: string) {
  localStorage.setItem(key, value)
  storageCache.set(key, value)  // keep cache in sync
}
```

Use a Map (not a hook) so it works everywhere: utilities, event handlers, not just React components.

**Cookie caching:**

```typescript
let cookieCache: Record&lt;string, string&gt; | null = null

function getCookie(name: string) {
  if (!cookieCache) {
    cookieCache = Object.fromEntries(
      document.cookie.split(&#x27;; &#x27;).map(c =&gt; c.split(&#x27;=&#x27;))
    )
  }
  return cookieCache[name]
}
```

**Important (invalidate on external changes):**

If storage can change externally (another tab, server-set cookies), invalidate cache:

```typescript
window.addEventListener(&#x27;storage&#x27;, (e) =&gt; {
  if (e.key) storageCache.delete(e.key)
})

document.addEventListener(&#x27;visibilitychange&#x27;, () =&gt; {
  if (document.visibilityState === &#x27;visible&#x27;) {
    storageCache.clear()
  }
})
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/js_cache_storage/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="js_combine_iterations Imported skill js_combine_iterations from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/js-combine-iterations.md Unknown See repository sources/vercel/js_combine_iterations/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">js_combine_iterations</div>
                <button class="copy-btn" onclick="copyToClipboard('js_combine_iterations')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill js_combine_iterations from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Combine Multiple Array Iterations
impact: LOW-MEDIUM
impactDescription: reduces iterations
tags: javascript, arrays, loops, performance
---

## Combine Multiple Array Iterations

Multiple `.filter()` or `.map()` calls iterate the array multiple times. Combine into one loop.

**Incorrect (3 iterations):**

```typescript
const admins = users.filter(u =&gt; u.isAdmin)
const testers = users.filter(u =&gt; u.isTester)
const inactive = users.filter(u =&gt; !u.isActive)
```

**Correct (1 iteration):**

```typescript
const admins: User[] = []
const testers: User[] = []
const inactive: User[] = []

for (const user of users) {
  if (user.isAdmin) admins.push(user)
  if (user.isTester) testers.push(user)
  if (!user.isActive) inactive.push(user)
}
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/js_combine_iterations/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="js_early_exit Imported skill js_early_exit from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/js-early-exit.md Unknown See repository sources/vercel/js_early_exit/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">js_early_exit</div>
                <button class="copy-btn" onclick="copyToClipboard('js_early_exit')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill js_early_exit from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Early Return from Functions
impact: LOW-MEDIUM
impactDescription: avoids unnecessary computation
tags: javascript, functions, optimization, early-return
---

## Early Return from Functions

Return early when result is determined to skip unnecessary processing.

**Incorrect (processes all items even after finding answer):**

```typescript
function validateUsers(users: User[]) {
  let hasError = false
  let errorMessage = &#x27;&#x27;
  
  for (const user of users) {
    if (!user.email) {
      hasError = true
      errorMessage = &#x27;Email required&#x27;
    }
    if (!user.name) {
      hasError = true
      errorMessage = &#x27;Name required&#x27;
    }
    // Continues checking all users even after error found
  }
  
  return hasError ? { valid: false, error: errorMessage } : { valid: true }
}
```

**Correct (returns immediately on first error):**

```typescript
function validateUsers(users: User[]) {
  for (const user of users) {
    if (!user.email) {
      return { valid: false, error: &#x27;Email required&#x27; }
    }
    if (!user.name) {
      return { valid: false, error: &#x27;Name required&#x27; }
    }
  }

  return { valid: true }
}
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/js_early_exit/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="js_hoist_regexp Imported skill js_hoist_regexp from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/js-hoist-regexp.md Unknown See repository sources/vercel/js_hoist_regexp/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">js_hoist_regexp</div>
                <button class="copy-btn" onclick="copyToClipboard('js_hoist_regexp')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill js_hoist_regexp from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Hoist RegExp Creation
impact: LOW-MEDIUM
impactDescription: avoids recreation
tags: javascript, regexp, optimization, memoization
---

## Hoist RegExp Creation

Don&#x27;t create RegExp inside render. Hoist to module scope or memoize with `useMemo()`.

**Incorrect (new RegExp every render):**

```tsx
function Highlighter({ text, query }: Props) {
  const regex = new RegExp(`(${query})`, &#x27;gi&#x27;)
  const parts = text.split(regex)
  return &lt;&gt;{parts.map((part, i) =&gt; ...)}&lt;/&gt;
}
```

**Correct (memoize or hoist):**

```tsx
const EMAIL_REGEX = /^[^\s@]+@[^\s@]+\.[^\s@]+$/

function Highlighter({ text, query }: Props) {
  const regex = useMemo(
    () =&gt; new RegExp(`(${escapeRegex(query)})`, &#x27;gi&#x27;),
    [query]
  )
  const parts = text.split(regex)
  return &lt;&gt;{parts.map((part, i) =&gt; ...)}&lt;/&gt;
}
```

**Warning (global regex has mutable state):**

Global regex (`/g`) has mutable `lastIndex` state:

```typescript
const regex = /foo/g
regex.test(&#x27;foo&#x27;)  // true, lastIndex = 3
regex.test(&#x27;foo&#x27;)  // false, lastIndex = 0
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/js_hoist_regexp/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="js_index_maps Imported skill js_index_maps from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/js-index-maps.md Unknown See repository sources/vercel/js_index_maps/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">js_index_maps</div>
                <button class="copy-btn" onclick="copyToClipboard('js_index_maps')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill js_index_maps from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Build Index Maps for Repeated Lookups
impact: LOW-MEDIUM
impactDescription: 1M ops to 2K ops
tags: javascript, map, indexing, optimization, performance
---

## Build Index Maps for Repeated Lookups

Multiple `.find()` calls by the same key should use a Map.

**Incorrect (O(n) per lookup):**

```typescript
function processOrders(orders: Order[], users: User[]) {
  return orders.map(order =&gt; ({
    ...order,
    user: users.find(u =&gt; u.id === order.userId)
  }))
}
```

**Correct (O(1) per lookup):**

```typescript
function processOrders(orders: Order[], users: User[]) {
  const userById = new Map(users.map(u =&gt; [u.id, u]))

  return orders.map(order =&gt; ({
    ...order,
    user: userById.get(order.userId)
  }))
}
```

Build map once (O(n)), then all lookups are O(1).
For 1000 orders  1000 users: 1M ops  2K ops.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/js_index_maps/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="js_length_check_first Imported skill js_length_check_first from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/js-length-check-first.md Unknown See repository sources/vercel/js_length_check_first/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">js_length_check_first</div>
                <button class="copy-btn" onclick="copyToClipboard('js_length_check_first')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill js_length_check_first from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Early Length Check for Array Comparisons
impact: MEDIUM-HIGH
impactDescription: avoids expensive operations when lengths differ
tags: javascript, arrays, performance, optimization, comparison
---

## Early Length Check for Array Comparisons

When comparing arrays with expensive operations (sorting, deep equality, serialization), check lengths first. If lengths differ, the arrays cannot be equal.

In real-world applications, this optimization is especially valuable when the comparison runs in hot paths (event handlers, render loops).

**Incorrect (always runs expensive comparison):**

```typescript
function hasChanges(current: string[], original: string[]) {
  // Always sorts and joins, even when lengths differ
  return current.sort().join() !== original.sort().join()
}
```

Two O(n log n) sorts run even when `current.length` is 5 and `original.length` is 100. There is also overhead of joining the arrays and comparing the strings.

**Correct (O(1) length check first):**

```typescript
function hasChanges(current: string[], original: string[]) {
  // Early return if lengths differ
  if (current.length !== original.length) {
    return true
  }
  // Only sort when lengths match
  const currentSorted = current.toSorted()
  const originalSorted = original.toSorted()
  for (let i = 0; i &lt; currentSorted.length; i++) {
    if (currentSorted[i] !== originalSorted[i]) {
      return true
    }
  }
  return false
}
```

This new approach is more efficient because:
- It avoids the overhead of sorting and joining the arrays when lengths differ
- It avoids consuming memory for the joined strings (especially important for large arrays)
- It avoids mutating the original arrays
- It returns early when a difference is found</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/js_length_check_first/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="js_min_max_loop Imported skill js_min_max_loop from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/js-min-max-loop.md Unknown See repository sources/vercel/js_min_max_loop/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">js_min_max_loop</div>
                <button class="copy-btn" onclick="copyToClipboard('js_min_max_loop')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill js_min_max_loop from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Use Loop for Min/Max Instead of Sort
impact: LOW
impactDescription: O(n) instead of O(n log n)
tags: javascript, arrays, performance, sorting, algorithms
---

## Use Loop for Min/Max Instead of Sort

Finding the smallest or largest element only requires a single pass through the array. Sorting is wasteful and slower.

**Incorrect (O(n log n) - sort to find latest):**

```typescript
interface Project {
  id: string
  name: string
  updatedAt: number
}

function getLatestProject(projects: Project[]) {
  const sorted = [...projects].sort((a, b) =&gt; b.updatedAt - a.updatedAt)
  return sorted[0]
}
```

Sorts the entire array just to find the maximum value.

**Incorrect (O(n log n) - sort for oldest and newest):**

```typescript
function getOldestAndNewest(projects: Project[]) {
  const sorted = [...projects].sort((a, b) =&gt; a.updatedAt - b.updatedAt)
  return { oldest: sorted[0], newest: sorted[sorted.length - 1] }
}
```

Still sorts unnecessarily when only min/max are needed.

**Correct (O(n) - single loop):**

```typescript
function getLatestProject(projects: Project[]) {
  if (projects.length === 0) return null
  
  let latest = projects[0]
  
  for (let i = 1; i &lt; projects.length; i++) {
    if (projects[i].updatedAt &gt; latest.updatedAt) {
      latest = projects[i]
    }
  }
  
  return latest
}

function getOldestAndNewest(projects: Project[]) {
  if (projects.length === 0) return { oldest: null, newest: null }
  
  let oldest = projects[0]
  let newest = projects[0]
  
  for (let i = 1; i &lt; projects.length; i++) {
    if (projects[i].updatedAt &lt; oldest.updatedAt) oldest = projects[i]
    if (projects[i].updatedAt &gt; newest.updatedAt) newest = projects[i]
  }
  
  return { oldest, newest }
}
```

Single pass through the array, no copying, no sorting.

**Alternative (Math.min/Math.max for small arrays):**

```typescript
const numbers = [5, 2, 8, 1, 9]
const min = Math.min(...numbers)
const max = Math.max(...numbers)
```

This works for small arrays, but can be slower or just throw an error for very large arrays due to spread operator limitations. Maximal array length is approximately 124000 in Chrome 143 and 638000 in Safari 18; exact numbers may vary - see [the fiddle](https://jsfiddle.net/qw1jabsx/4/). Use the loop approach for reliability.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/js_min_max_loop/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="js_set_map_lookups Imported skill js_set_map_lookups from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/js-set-map-lookups.md Unknown See repository sources/vercel/js_set_map_lookups/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">js_set_map_lookups</div>
                <button class="copy-btn" onclick="copyToClipboard('js_set_map_lookups')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill js_set_map_lookups from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Use Set/Map for O(1) Lookups
impact: LOW-MEDIUM
impactDescription: O(n) to O(1)
tags: javascript, set, map, data-structures, performance
---

## Use Set/Map for O(1) Lookups

Convert arrays to Set/Map for repeated membership checks.

**Incorrect (O(n) per check):**

```typescript
const allowedIds = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, ...]
items.filter(item =&gt; allowedIds.includes(item.id))
```

**Correct (O(1) per check):**

```typescript
const allowedIds = new Set([&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, ...])
items.filter(item =&gt; allowedIds.has(item.id))
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/js_set_map_lookups/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="js_tosorted_immutable Imported skill js_tosorted_immutable from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/js-tosorted-immutable.md Unknown See repository sources/vercel/js_tosorted_immutable/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">js_tosorted_immutable</div>
                <button class="copy-btn" onclick="copyToClipboard('js_tosorted_immutable')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill js_tosorted_immutable from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Use toSorted() Instead of sort() for Immutability
impact: MEDIUM-HIGH
impactDescription: prevents mutation bugs in React state
tags: javascript, arrays, immutability, react, state, mutation
---

## Use toSorted() Instead of sort() for Immutability

`.sort()` mutates the array in place, which can cause bugs with React state and props. Use `.toSorted()` to create a new sorted array without mutation.

**Incorrect (mutates original array):**

```typescript
function UserList({ users }: { users: User[] }) {
  // Mutates the users prop array!
  const sorted = useMemo(
    () =&gt; users.sort((a, b) =&gt; a.name.localeCompare(b.name)),
    [users]
  )
  return &lt;div&gt;{sorted.map(renderUser)}&lt;/div&gt;
}
```

**Correct (creates new array):**

```typescript
function UserList({ users }: { users: User[] }) {
  // Creates new sorted array, original unchanged
  const sorted = useMemo(
    () =&gt; users.toSorted((a, b) =&gt; a.name.localeCompare(b.name)),
    [users]
  )
  return &lt;div&gt;{sorted.map(renderUser)}&lt;/div&gt;
}
```

**Why this matters in React:**

1. Props/state mutations break React&#x27;s immutability model - React expects props and state to be treated as read-only
2. Causes stale closure bugs - Mutating arrays inside closures (callbacks, effects) can lead to unexpected behavior

**Browser support (fallback for older browsers):**

`.toSorted()` is available in all modern browsers (Chrome 110+, Safari 16+, Firefox 115+, Node.js 20+). For older environments, use spread operator:

```typescript
// Fallback for older browsers
const sorted = [...items].sort((a, b) =&gt; a.value - b.value)
```

**Other immutable array methods:**

- `.toSorted()` - immutable sort
- `.toReversed()` - immutable reverse
- `.toSpliced()` - immutable splice
- `.with()` - immutable element replacement</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/js_tosorted_immutable/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="metadata Imported skill metadata from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/metadata.json Unknown See repository sources/vercel/metadata/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">metadata</div>
                <button class="copy-btn" onclick="copyToClipboard('metadata')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill metadata from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;organization&quot;: &quot;Vercel Engineering&quot;,
  &quot;date&quot;: &quot;January 2026&quot;,
  &quot;abstract&quot;: &quot;Comprehensive performance optimization guide for React and Next.js applications, designed for AI agents and LLMs. Contains 40+ rules across 8 categories, prioritized by impact from critical (eliminating waterfalls, reducing bundle size) to incremental (advanced patterns). Each rule includes detailed explanations, real-world examples comparing incorrect vs. correct implementations, and specific impact metrics to guide automated refactoring and code generation.&quot;,
  &quot;references&quot;: [
    &quot;https://react.dev&quot;,
    &quot;https://nextjs.org&quot;,
    &quot;https://swr.vercel.app&quot;,
    &quot;https://github.com/shuding/better-all&quot;,
    &quot;https://github.com/isaacs/node-lru-cache&quot;,
    &quot;https://vercel.com/blog/how-we-optimized-package-imports-in-next-js&quot;,
    &quot;https://vercel.com/blog/how-we-made-the-vercel-dashboard-twice-as-fast&quot;
  ]
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/metadata/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="migrate Imported skill migrate from vercel vercel /a0/tmp/skills_research/vercel/packages/react-best-practices-build/src/migrate.ts Unknown See repository sources/vercel/migrate/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">migrate</div>
                <button class="copy-btn" onclick="copyToClipboard('migrate')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill migrate from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env node
/**
 * Migration script to split RPG.md into individual rule files
 * This is a one-time script to help migrate existing content
 */

import { readFile, writeFile, mkdir } from &#x27;fs/promises&#x27;
import { join } from &#x27;path&#x27;
import { existsSync } from &#x27;fs&#x27;
import { SKILL_DIR, RULES_DIR } from &#x27;./config.js&#x27;

const RPG_FILE = join(SKILL_DIR, &#x27;RPG.md&#x27;)

/**
 * Extract section number and title from heading
 */
function parseSectionHeading(line: string): { number: number; title: string } | null {
  const match = line.match(/^##\s+(\d+)\.\s+(.+)$/)
  if (match) {
    return {
      number: parseInt(match[1]),
      title: match[2].trim()
    }
  }
  return null
}

/**
 * Extract rule number and title from heading
 */
function parseRuleHeading(line: string): { section: number; subsection: number; title: string } | null {
  const match = line.match(/^###\s+(\d+)\.(\d+)\s+(.+)$/)
  if (match) {
    return {
      section: parseInt(match[1]),
      subsection: parseInt(match[2]),
      title: match[3].trim()
    }
  }
  return null
}

/**
 * Extract impact from line
 */
function extractImpact(line: string): { impact: string; description?: string } | null {
  const match = line.match(/\*\*Impact:\s*(\w+(?:-\w+)?)\s*(?:\(([^)]+)\))?/i)
  if (match) {
    return {
      impact: match[1].toUpperCase().replace(/-/g, &#x27;-&#x27;),
      description: match[2]
    }
  }
  return null
}

async function migrate() {
  try {
    console.log(&#x27;Migrating RPG.md to individual rule files...&#x27;)
    
    if (!existsSync(RPG_FILE)) {
      console.error(`RPG.md not found at ${RPG_FILE}`)
      process.exit(1)
    }
    
    // Ensure rules directory exists
    if (!existsSync(RULES_DIR)) {
      await mkdir(RULES_DIR, { recursive: true })
    }
    
    const content = await readFile(RPG_FILE, &#x27;utf-8&#x27;)
    const lines = content.split(&#x27;\n&#x27;)
    
    let currentSection: { number: number; title: string; impact?: string; introduction?: string } | null = null
    let currentRule: { section: number; subsection: number; title: string; content: string[] } | null = null
    let inCodeBlock = false
    
    for (let i = 0; i &lt; lines.length; i++) {
      const line = lines[i]
      
      // Check for section heading
      const sectionInfo = parseSectionHeading(line)
      if (sectionInfo) {
        // Save previous section if exists
        if (currentSection) {
          const sectionFile = join(RULES_DIR, `section-${currentSection.number}.md`)
          let sectionContent = `# ${currentSection.number}. ${currentSection.title}\n\n`
          if (currentSection.impact) {
            sectionContent += `**Impact: ${currentSection.impact}**\n\n`
          }
          if (currentSection.introduction) {
            sectionContent += `## Introduction\n\n${currentSection.introduction}\n`
          }
          await writeFile(sectionFile, sectionContent, &#x27;utf-8&#x27;)
        }
        
        currentSection = sectionInfo
        currentRule = null
        
        // Look for impact on next few lines
        for (let j = i + 1; j &lt; Math.min(i + 5, lines.length); j++) {
          const impactInfo = extractImpact(lines[j])
          if (impactInfo) {
            currentSection.impact = impactInfo.impact
            break
          }
        }
        
        // Collect introduction text until first rule
        let introduction: string[] = []
        for (let j = i + 1; j &lt; lines.length; j++) {
          if (parseRuleHeading(lines[j])) {
            break
          }
          if (!lines[j].match(/^###/)) {
            introduction.push(lines[j])
          }
        }
        currentSection.introduction = introduction.join(&#x27;\n&#x27;).trim()
        continue
      }
      
      // Check for rule heading
      const ruleInfo = parseRuleHeading(line)
      if (ruleInfo) {
        // Save previous rule if exists
        if (currentRule &amp;&amp; currentSection) {
          const ruleFile = join(RULES_DIR, `section-${currentRule.section}-rule-${currentRule.subsection}.md`)
          const ruleContent = currentRule.content.join(&#x27;\n&#x27;)
          await writeFile(ruleFile, ruleContent, &#x27;utf-8&#x27;)
          console.log(`Created ${ruleFile}`)
        }
        
        currentRule = {
          ...ruleInfo,
          content: [line]
        }
        continue
      }
      
      // Accumulate content for current rule
      if (currentRule) {
        currentRule.content.push(line)
      }
    }
    
    // Save last rule
    if (currentRule &amp;&amp; currentSection) {
      const ruleFile = join(RULES_DIR, `section-${currentRule.section}-rule-${currentRule.subsection}.md`)
      const ruleContent = currentRule.content.join(&#x27;\n&#x27;)
      await writeFile(ruleFile, ruleContent, &#x27;utf-8&#x27;)
      console.log(`Created ${ruleFile}`)
    }
    
    // Save last section
    if (currentSection) {
      const sectionFile = join(RULES_DIR, `section-${currentSection.number}.md`)
      let sectionContent = `# ${currentSection.number}. ${currentSection.title}\n\n`
      if (currentSection.impact) {
        sectionContent += `**Impact: ${currentSection.impact}**\n\n`
      }
      if (currentSection.introduction) {
        sectionContent += `## Introduction\n\n${currentSection.introduction}\n`
      }
      await writeFile(sectionFile, sectionContent, &#x27;utf-8&#x27;)
      console.log(`Created ${sectionFile}`)
    }
    
    console.log(&#x27;\n Migration complete!&#x27;)
    console.log(&#x27;Note: You may need to manually add frontmatter to rule files.&#x27;)
  } catch (error) {
    console.error(&#x27;Migration failed:&#x27;, error)
    process.exit(1)
  }
}

migrate()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/migrate/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="package Imported skill package from vercel vercel /a0/tmp/skills_research/vercel/packages/react-best-practices-build/package.json Unknown See repository sources/vercel/package/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">package</div>
                <button class="copy-btn" onclick="copyToClipboard('package')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill package from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;name&quot;: &quot;react-best-practices-build&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;description&quot;: &quot;Build tooling for React Best Practices skill&quot;,
  &quot;type&quot;: &quot;module&quot;,
  &quot;scripts&quot;: {
    &quot;build&quot;: &quot;pnpm build-agents &amp;&amp; pnpm extract-tests&quot;,
    &quot;build-agents&quot;: &quot;tsx src/build.ts&quot;,
    &quot;validate&quot;: &quot;tsx src/validate.ts&quot;,
    &quot;extract-tests&quot;: &quot;tsx src/extract-tests.ts&quot;,
    &quot;migrate&quot;: &quot;tsx src/migrate.ts&quot;,
    &quot;dev&quot;: &quot;pnpm build &amp;&amp; pnpm validate&quot;
  },
  &quot;keywords&quot;: [
    &quot;react&quot;,
    &quot;performance&quot;,
    &quot;guidelines&quot;,
    &quot;llm&quot;,
    &quot;agents&quot;
  ],
  &quot;license&quot;: &quot;MIT&quot;,
  &quot;devDependencies&quot;: {
    &quot;@types/node&quot;: &quot;^20.0.0&quot;,
    &quot;tsx&quot;: &quot;^4.7.0&quot;,
    &quot;typescript&quot;: &quot;^5.3.0&quot;
  }
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/package/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="parser Imported skill parser from vercel vercel /a0/tmp/skills_research/vercel/packages/react-best-practices-build/src/parser.ts Unknown See repository sources/vercel/parser/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">parser</div>
                <button class="copy-btn" onclick="copyToClipboard('parser')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill parser from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">/**
 * Parser for rule markdown files
 */

import { readFile } from &#x27;fs/promises&#x27;
import { Rule, ImpactLevel } from &#x27;./types.js&#x27;

export interface RuleFile {
  section: number
  subsection?: number
  rule: Rule
}

/**
 * Parse a rule markdown file into a Rule object
 */
export async function parseRuleFile(filePath: string): Promise&lt;RuleFile&gt; {
  const content = await readFile(filePath, &#x27;utf-8&#x27;)
  const lines = content.split(&#x27;\n&#x27;)

  // Extract frontmatter if present
  let frontmatter: Record&lt;string, any&gt; = {}
  let contentStart = 0

  if (content.startsWith(&#x27;---&#x27;)) {
    const frontmatterEnd = content.indexOf(&#x27;---&#x27;, 3)
    if (frontmatterEnd !== -1) {
      const frontmatterText = content.slice(3, frontmatterEnd).trim()
      frontmatterText.split(&#x27;\n&#x27;).forEach((line) =&gt; {
        const [key, ...valueParts] = line.split(&#x27;:&#x27;)
        if (key &amp;&amp; valueParts.length) {
          const value = valueParts.join(&#x27;:&#x27;).trim()
          frontmatter[key.trim()] = value.replace(/^[&quot;&#x27;]|[&quot;&#x27;]$/g, &#x27;&#x27;)
        }
      })
      contentStart = frontmatterEnd + 3
    }
  }

  // Parse the rule content
  const ruleContent = content.slice(contentStart).trim()
  const ruleLines = ruleContent.split(&#x27;\n&#x27;)

  // Extract title (first # or ## heading)
  let title = &#x27;&#x27;
  let titleLine = 0
  for (let i = 0; i &lt; ruleLines.length; i++) {
    if (ruleLines[i].startsWith(&#x27;##&#x27;)) {
      title = ruleLines[i].replace(/^##+\s*/, &#x27;&#x27;).trim()
      titleLine = i
      break
    }
  }

  // Extract impact
  let impact: Rule[&#x27;impact&#x27;] = &#x27;MEDIUM&#x27;
  let impactDescription = &#x27;&#x27;
  let explanation = &#x27;&#x27;
  let examples: Rule[&#x27;examples&#x27;] = []
  let references: string[] = []

  // Parse content after title
  let currentExample: {
    label: string
    description?: string
    code: string
    language?: string
    additionalText?: string
  } | null = null
  let inCodeBlock = false
  let codeBlockLanguage = &#x27;typescript&#x27;
  let codeBlockContent: string[] = []
  let afterCodeBlock = false
  let additionalText: string[] = []
  let hasCodeBlockForCurrentExample = false

  for (let i = titleLine + 1; i &lt; ruleLines.length; i++) {
    const line = ruleLines[i]

    // Impact line
    if (line.includes(&#x27;**Impact:&#x27;)) {
      const match = line.match(
        /\*\*Impact:\s*(\w+(?:-\w+)?)\s*(?:\(([^)]+)\))?/i
      )
      if (match) {
        impact = match[1].toUpperCase().replace(/-/g, &#x27;-&#x27;) as ImpactLevel
        impactDescription = match[2] || &#x27;&#x27;
      }
      continue
    }

    // Code block start
    if (line.startsWith(&#x27;```&#x27;)) {
      if (inCodeBlock) {
        // End of code block
        if (currentExample) {
          currentExample.code = codeBlockContent.join(&#x27;\n&#x27;)
          currentExample.language = codeBlockLanguage
        }
        codeBlockContent = []
        inCodeBlock = false
        afterCodeBlock = true
      } else {
        // Start of code block
        inCodeBlock = true
        hasCodeBlockForCurrentExample = true
        codeBlockLanguage = line.slice(3).trim() || &#x27;typescript&#x27;
        codeBlockContent = []
        afterCodeBlock = false
      }
      continue
    }

    if (inCodeBlock) {
      codeBlockContent.push(line)
      continue
    }

    // Example label (Incorrect, Correct, Example, Usage, Implementation, etc.)
    // Match pattern: **Label:** or **Label (description):** at end of line
    // This distinguishes example labels from inline bold text like &quot;**Trade-off:** some text&quot;
    const labelMatch = line.match(/^\*\*([^:]+?):\*?\*?$/)
    if (labelMatch) {
      // Save previous example if it exists
      if (currentExample) {
        if (additionalText.length &gt; 0) {
          currentExample.additionalText = additionalText.join(&#x27;\n\n&#x27;)
          additionalText = []
        }
        examples.push(currentExample)
      }
      afterCodeBlock = false
      hasCodeBlockForCurrentExample = false

      const fullLabel = labelMatch[1].trim()
      // Try to extract description from parentheses if present (handles simple cases)
      // For nested parentheses like &quot;Incorrect (O(n) per lookup)&quot;, we keep the full label
      const descMatch = fullLabel.match(
        /^([A-Za-z]+(?:\s+[A-Za-z]+)*)\s*\(([^()]+)\)$/
      )
      currentExample = {
        label: descMatch ? descMatch[1].trim() : fullLabel,
        description: descMatch ? descMatch[2].trim() : undefined,
        code: &#x27;&#x27;,
        language: codeBlockLanguage,
      }
      continue
    }

    // Reference links
    if (line.startsWith(&#x27;Reference:&#x27;) || line.startsWith(&#x27;References:&#x27;)) {
      // Save current example before processing references
      if (currentExample) {
        if (additionalText.length &gt; 0) {
          currentExample.additionalText = additionalText.join(&#x27;\n\n&#x27;)
          additionalText = []
        }
        examples.push(currentExample)
        currentExample = null
      }

      const refMatch = line.match(/\[([^\]]+)\]\(([^)]+)\)/g)
      if (refMatch) {
        references.push(
          ...refMatch.map((ref) =&gt; {
            const m = ref.match(/\[([^\]]+)\]\(([^)]+)\)/)
            return m ? m[2] : ref
          })
        )
      }
      continue
    }

    // Regular text (explanation or additional context after examples)
    if (line.trim() &amp;&amp; !line.startsWith(&#x27;#&#x27;)) {
      if (!currentExample &amp;&amp; !inCodeBlock) {
        // Main explanation before any examples
        explanation += (explanation ? &#x27;\n\n&#x27; : &#x27;&#x27;) + line
      } else if (currentExample &amp;&amp; (afterCodeBlock || !hasCodeBlockForCurrentExample)) {
        // Text after a code block, or text in a section without a code block
        // (e.g., &quot;When NOT to use this pattern:&quot; with bullet points instead of code)
        additionalText.push(line)
      }
    }
  }

  // Handle last example if still open
  if (currentExample) {
    if (additionalText.length &gt; 0) {
      currentExample.additionalText = additionalText.join(&#x27;\n\n&#x27;)
    }
    examples.push(currentExample)
  }

  // Infer section from filename patterns
  // Pattern: area-description.md where area determines section
  const filename = filePath.split(&#x27;/&#x27;).pop() || &#x27;&#x27;
  const sectionMap: Record&lt;string, number&gt; = {
    async: 1,
    bundle: 2,
    server: 3,
    client: 4,
    rerender: 5,
    rendering: 6,
    js: 7,
    advanced: 8,
  }

  // Extract area from filename (first part before first dash)
  const area = filename.split(&#x27;-&#x27;)[0]
  const section = frontmatter.section || sectionMap[area] || 0

  const rule: Rule = {
    id: &#x27;&#x27;, // Will be assigned by build script based on sorted order
    title: frontmatter.title || title,
    section: section,
    subsection: undefined,
    impact: frontmatter.impact || impact,
    impactDescription: frontmatter.impactDescription || impactDescription,
    explanation: frontmatter.explanation || explanation.trim(),
    examples,
    references: frontmatter.references
      ? frontmatter.references.split(&#x27;,&#x27;).map((r: string) =&gt; r.trim())
      : references,
    tags: frontmatter.tags
      ? frontmatter.tags.split(&#x27;,&#x27;).map((t: string) =&gt; t.trim())
      : undefined,
  }

  return {
    section,
    subsection: 0,
    rule,
  }
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/parser/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="readme Imported skill readme from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/README.md Unknown See repository sources/vercel/readme/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">readme</div>
                <button class="copy-btn" onclick="copyToClipboard('readme')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill readme from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content"># React Best Practices

A structured repository for creating and maintaining React Best Practices optimized for agents and LLMs.

## Structure

- `rules/` - Individual rule files (one per rule)
  - `_sections.md` - Section metadata (titles, impacts, descriptions)
  - `_template.md` - Template for creating new rules
  - `area-description.md` - Individual rule files
- `src/` - Build scripts and utilities
- `metadata.json` - Document metadata (version, organization, abstract)
- __`AGENTS.md`__ - Compiled output (generated)
- __`test-cases.json`__ - Test cases for LLM evaluation (generated)

## Getting Started

1. Install dependencies:
   ```bash
   pnpm install
   ```

2. Build AGENTS.md from rules:
   ```bash
   pnpm build
   ```

3. Validate rule files:
   ```bash
   pnpm validate
   ```

4. Extract test cases:
   ```bash
   pnpm extract-tests
   ```

## Creating a New Rule

1. Copy `rules/_template.md` to `rules/area-description.md`
2. Choose the appropriate area prefix:
   - `async-` for Eliminating Waterfalls (Section 1)
   - `bundle-` for Bundle Size Optimization (Section 2)
   - `server-` for Server-Side Performance (Section 3)
   - `client-` for Client-Side Data Fetching (Section 4)
   - `rerender-` for Re-render Optimization (Section 5)
   - `rendering-` for Rendering Performance (Section 6)
   - `js-` for JavaScript Performance (Section 7)
   - `advanced-` for Advanced Patterns (Section 8)
3. Fill in the frontmatter and content
4. Ensure you have clear examples with explanations
5. Run `pnpm build` to regenerate AGENTS.md and test-cases.json

## Rule File Structure

Each rule file should follow this structure:

```markdown
---
title: Rule Title Here
impact: MEDIUM
impactDescription: Optional description
tags: tag1, tag2, tag3
---

## Rule Title Here

Brief explanation of the rule and why it matters.

**Incorrect (description of what&#x27;s wrong):**

```typescript
// Bad code example
```

**Correct (description of what&#x27;s right):**

```typescript
// Good code example
```

Optional explanatory text after examples.

Reference: [Link](https://example.com)

## File Naming Convention

- Files starting with `_` are special (excluded from build)
- Rule files: `area-description.md` (e.g., `async-parallel.md`)
- Section is automatically inferred from filename prefix
- Rules are sorted alphabetically by title within each section
- IDs (e.g., 1.1, 1.2) are auto-generated during build

## Impact Levels

- `CRITICAL` - Highest priority, major performance gains
- `HIGH` - Significant performance improvements
- `MEDIUM-HIGH` - Moderate-high gains
- `MEDIUM` - Moderate performance improvements
- `LOW-MEDIUM` - Low-medium gains
- `LOW` - Incremental improvements

## Scripts

- `pnpm build` - Compile rules into AGENTS.md
- `pnpm validate` - Validate all rule files
- `pnpm extract-tests` - Extract test cases for LLM evaluation
- `pnpm dev` - Build and validate

## Contributing

When adding or modifying rules:

1. Use the correct filename prefix for your section
2. Follow the `_template.md` structure
3. Include clear bad/good examples with explanations
4. Add appropriate tags
5. Run `pnpm build` to regenerate AGENTS.md and test-cases.json
6. Rules are automatically sorted by title - no need to manage numbers!

## Acknowledgments

Originally created by [@shuding](https://x.com/shuding) at [Vercel](https://vercel.com).</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/readme/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rendering_activity Imported skill rendering_activity from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rendering-activity.md Unknown See repository sources/vercel/rendering_activity/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rendering_activity</div>
                <button class="copy-btn" onclick="copyToClipboard('rendering_activity')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rendering_activity from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Use Activity Component for Show/Hide
impact: MEDIUM
impactDescription: preserves state/DOM
tags: rendering, activity, visibility, state-preservation
---

## Use Activity Component for Show/Hide

Use React&#x27;s `&lt;Activity&gt;` to preserve state/DOM for expensive components that frequently toggle visibility.

**Usage:**

```tsx
import { Activity } from &#x27;react&#x27;

function Dropdown({ isOpen }: Props) {
  return (
    &lt;Activity mode={isOpen ? &#x27;visible&#x27; : &#x27;hidden&#x27;}&gt;
      &lt;ExpensiveMenu /&gt;
    &lt;/Activity&gt;
  )
}
```

Avoids expensive re-renders and state loss.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rendering_activity/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rendering_animate_svg_wrapper Imported skill rendering_animate_svg_wrapper from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rendering-animate-svg-wrapper.md Unknown See repository sources/vercel/rendering_animate_svg_wrapper/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rendering_animate_svg_wrapper</div>
                <button class="copy-btn" onclick="copyToClipboard('rendering_animate_svg_wrapper')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rendering_animate_svg_wrapper from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Animate SVG Wrapper Instead of SVG Element
impact: LOW
impactDescription: enables hardware acceleration
tags: rendering, svg, css, animation, performance
---

## Animate SVG Wrapper Instead of SVG Element

Many browsers don&#x27;t have hardware acceleration for CSS3 animations on SVG elements. Wrap SVG in a `&lt;div&gt;` and animate the wrapper instead.

**Incorrect (animating SVG directly - no hardware acceleration):**

```tsx
function LoadingSpinner() {
  return (
    &lt;svg 
      className=&quot;animate-spin&quot;
      width=&quot;24&quot; 
      height=&quot;24&quot; 
      viewBox=&quot;0 0 24 24&quot;
    &gt;
      &lt;circle cx=&quot;12&quot; cy=&quot;12&quot; r=&quot;10&quot; stroke=&quot;currentColor&quot; /&gt;
    &lt;/svg&gt;
  )
}
```

**Correct (animating wrapper div - hardware accelerated):**

```tsx
function LoadingSpinner() {
  return (
    &lt;div className=&quot;animate-spin&quot;&gt;
      &lt;svg 
        width=&quot;24&quot; 
        height=&quot;24&quot; 
        viewBox=&quot;0 0 24 24&quot;
      &gt;
        &lt;circle cx=&quot;12&quot; cy=&quot;12&quot; r=&quot;10&quot; stroke=&quot;currentColor&quot; /&gt;
      &lt;/svg&gt;
    &lt;/div&gt;
  )
}
```

This applies to all CSS transforms and transitions (`transform`, `opacity`, `translate`, `scale`, `rotate`). The wrapper div allows browsers to use GPU acceleration for smoother animations.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rendering_animate_svg_wrapper/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rendering_conditional_render Imported skill rendering_conditional_render from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rendering-conditional-render.md Unknown See repository sources/vercel/rendering_conditional_render/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rendering_conditional_render</div>
                <button class="copy-btn" onclick="copyToClipboard('rendering_conditional_render')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rendering_conditional_render from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Use Explicit Conditional Rendering
impact: LOW
impactDescription: prevents rendering 0 or NaN
tags: rendering, conditional, jsx, falsy-values
---

## Use Explicit Conditional Rendering

Use explicit ternary operators (`? :`) instead of `&amp;&amp;` for conditional rendering when the condition can be `0`, `NaN`, or other falsy values that render.

**Incorrect (renders &quot;0&quot; when count is 0):**

```tsx
function Badge({ count }: { count: number }) {
  return (
    &lt;div&gt;
      {count &amp;&amp; &lt;span className=&quot;badge&quot;&gt;{count}&lt;/span&gt;}
    &lt;/div&gt;
  )
}

// When count = 0, renders: &lt;div&gt;0&lt;/div&gt;
// When count = 5, renders: &lt;div&gt;&lt;span class=&quot;badge&quot;&gt;5&lt;/span&gt;&lt;/div&gt;
```

**Correct (renders nothing when count is 0):**

```tsx
function Badge({ count }: { count: number }) {
  return (
    &lt;div&gt;
      {count &gt; 0 ? &lt;span className=&quot;badge&quot;&gt;{count}&lt;/span&gt; : null}
    &lt;/div&gt;
  )
}

// When count = 0, renders: &lt;div&gt;&lt;/div&gt;
// When count = 5, renders: &lt;div&gt;&lt;span class=&quot;badge&quot;&gt;5&lt;/span&gt;&lt;/div&gt;
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rendering_conditional_render/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rendering_content_visibility Imported skill rendering_content_visibility from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rendering-content-visibility.md Unknown See repository sources/vercel/rendering_content_visibility/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rendering_content_visibility</div>
                <button class="copy-btn" onclick="copyToClipboard('rendering_content_visibility')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rendering_content_visibility from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: CSS content-visibility for Long Lists
impact: HIGH
impactDescription: faster initial render
tags: rendering, css, content-visibility, long-lists
---

## CSS content-visibility for Long Lists

Apply `content-visibility: auto` to defer off-screen rendering.

**CSS:**

```css
.message-item {
  content-visibility: auto;
  contain-intrinsic-size: 0 80px;
}
```

**Example:**

```tsx
function MessageList({ messages }: { messages: Message[] }) {
  return (
    &lt;div className=&quot;overflow-y-auto h-screen&quot;&gt;
      {messages.map(msg =&gt; (
        &lt;div key={msg.id} className=&quot;message-item&quot;&gt;
          &lt;Avatar user={msg.author} /&gt;
          &lt;div&gt;{msg.content}&lt;/div&gt;
        &lt;/div&gt;
      ))}
    &lt;/div&gt;
  )
}
```

For 1000 messages, browser skips layout/paint for ~990 off-screen items (10 faster initial render).</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rendering_content_visibility/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rendering_hoist_jsx Imported skill rendering_hoist_jsx from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rendering-hoist-jsx.md Unknown See repository sources/vercel/rendering_hoist_jsx/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rendering_hoist_jsx</div>
                <button class="copy-btn" onclick="copyToClipboard('rendering_hoist_jsx')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rendering_hoist_jsx from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Hoist Static JSX Elements
impact: LOW
impactDescription: avoids re-creation
tags: rendering, jsx, static, optimization
---

## Hoist Static JSX Elements

Extract static JSX outside components to avoid re-creation.

**Incorrect (recreates element every render):**

```tsx
function LoadingSkeleton() {
  return &lt;div className=&quot;animate-pulse h-20 bg-gray-200&quot; /&gt;
}

function Container() {
  return (
    &lt;div&gt;
      {loading &amp;&amp; &lt;LoadingSkeleton /&gt;}
    &lt;/div&gt;
  )
}
```

**Correct (reuses same element):**

```tsx
const loadingSkeleton = (
  &lt;div className=&quot;animate-pulse h-20 bg-gray-200&quot; /&gt;
)

function Container() {
  return (
    &lt;div&gt;
      {loading &amp;&amp; loadingSkeleton}
    &lt;/div&gt;
  )
}
```

This is especially helpful for large and static SVG nodes, which can be expensive to recreate on every render.

**Note:** If your project has [React Compiler](https://react.dev/learn/react-compiler) enabled, the compiler automatically hoists static JSX elements and optimizes component re-renders, making manual hoisting unnecessary.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rendering_hoist_jsx/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rendering_hydration_no_flicker Imported skill rendering_hydration_no_flicker from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rendering-hydration-no-flicker.md Unknown See repository sources/vercel/rendering_hydration_no_flicker/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rendering_hydration_no_flicker</div>
                <button class="copy-btn" onclick="copyToClipboard('rendering_hydration_no_flicker')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rendering_hydration_no_flicker from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Prevent Hydration Mismatch Without Flickering
impact: MEDIUM
impactDescription: avoids visual flicker and hydration errors
tags: rendering, ssr, hydration, localStorage, flicker
---

## Prevent Hydration Mismatch Without Flickering

When rendering content that depends on client-side storage (localStorage, cookies), avoid both SSR breakage and post-hydration flickering by injecting a synchronous script that updates the DOM before React hydrates.

**Incorrect (breaks SSR):**

```tsx
function ThemeWrapper({ children }: { children: ReactNode }) {
  // localStorage is not available on server - throws error
  const theme = localStorage.getItem(&#x27;theme&#x27;) || &#x27;light&#x27;
  
  return (
    &lt;div className={theme}&gt;
      {children}
    &lt;/div&gt;
  )
}
```

Server-side rendering will fail because `localStorage` is undefined.

**Incorrect (visual flickering):**

```tsx
function ThemeWrapper({ children }: { children: ReactNode }) {
  const [theme, setTheme] = useState(&#x27;light&#x27;)
  
  useEffect(() =&gt; {
    // Runs after hydration - causes visible flash
    const stored = localStorage.getItem(&#x27;theme&#x27;)
    if (stored) {
      setTheme(stored)
    }
  }, [])
  
  return (
    &lt;div className={theme}&gt;
      {children}
    &lt;/div&gt;
  )
}
```

Component first renders with default value (`light`), then updates after hydration, causing a visible flash of incorrect content.

**Correct (no flicker, no hydration mismatch):**

```tsx
function ThemeWrapper({ children }: { children: ReactNode }) {
  return (
    &lt;&gt;
      &lt;div id=&quot;theme-wrapper&quot;&gt;
        {children}
      &lt;/div&gt;
      &lt;script
        dangerouslySetInnerHTML={{
          __html: `
            (function() {
              try {
                var theme = localStorage.getItem(&#x27;theme&#x27;) || &#x27;light&#x27;;
                var el = document.getElementById(&#x27;theme-wrapper&#x27;);
                if (el) el.className = theme;
              } catch (e) {}
            })();
          `,
        }}
      /&gt;
    &lt;/&gt;
  )
}
```

The inline script executes synchronously before showing the element, ensuring the DOM already has the correct value. No flickering, no hydration mismatch.

This pattern is especially useful for theme toggles, user preferences, authentication states, and any client-only data that should render immediately without flashing default values.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rendering_hydration_no_flicker/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rendering_svg_precision Imported skill rendering_svg_precision from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rendering-svg-precision.md Unknown See repository sources/vercel/rendering_svg_precision/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rendering_svg_precision</div>
                <button class="copy-btn" onclick="copyToClipboard('rendering_svg_precision')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rendering_svg_precision from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Optimize SVG Precision
impact: LOW
impactDescription: reduces file size
tags: rendering, svg, optimization, svgo
---

## Optimize SVG Precision

Reduce SVG coordinate precision to decrease file size. The optimal precision depends on the viewBox size, but in general reducing precision should be considered.

**Incorrect (excessive precision):**

```svg
&lt;path d=&quot;M 10.293847 20.847362 L 30.938472 40.192837&quot; /&gt;
```

**Correct (1 decimal place):**

```svg
&lt;path d=&quot;M 10.3 20.8 L 30.9 40.2&quot; /&gt;
```

**Automate with SVGO:**

```bash
npx svgo --precision=1 --multipass icon.svg
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rendering_svg_precision/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rerender_defer_reads Imported skill rerender_defer_reads from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rerender-defer-reads.md Unknown See repository sources/vercel/rerender_defer_reads/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rerender_defer_reads</div>
                <button class="copy-btn" onclick="copyToClipboard('rerender_defer_reads')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rerender_defer_reads from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Defer State Reads to Usage Point
impact: MEDIUM
impactDescription: avoids unnecessary subscriptions
tags: rerender, searchParams, localStorage, optimization
---

## Defer State Reads to Usage Point

Don&#x27;t subscribe to dynamic state (searchParams, localStorage) if you only read it inside callbacks.

**Incorrect (subscribes to all searchParams changes):**

```tsx
function ShareButton({ chatId }: { chatId: string }) {
  const searchParams = useSearchParams()

  const handleShare = () =&gt; {
    const ref = searchParams.get(&#x27;ref&#x27;)
    shareChat(chatId, { ref })
  }

  return &lt;button onClick={handleShare}&gt;Share&lt;/button&gt;
}
```

**Correct (reads on demand, no subscription):**

```tsx
function ShareButton({ chatId }: { chatId: string }) {
  const handleShare = () =&gt; {
    const params = new URLSearchParams(window.location.search)
    const ref = params.get(&#x27;ref&#x27;)
    shareChat(chatId, { ref })
  }

  return &lt;button onClick={handleShare}&gt;Share&lt;/button&gt;
}
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rerender_defer_reads/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rerender_dependencies Imported skill rerender_dependencies from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rerender-dependencies.md Unknown See repository sources/vercel/rerender_dependencies/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rerender_dependencies</div>
                <button class="copy-btn" onclick="copyToClipboard('rerender_dependencies')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rerender_dependencies from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Narrow Effect Dependencies
impact: LOW
impactDescription: minimizes effect re-runs
tags: rerender, useEffect, dependencies, optimization
---

## Narrow Effect Dependencies

Specify primitive dependencies instead of objects to minimize effect re-runs.

**Incorrect (re-runs on any user field change):**

```tsx
useEffect(() =&gt; {
  console.log(user.id)
}, [user])
```

**Correct (re-runs only when id changes):**

```tsx
useEffect(() =&gt; {
  console.log(user.id)
}, [user.id])
```

**For derived state, compute outside effect:**

```tsx
// Incorrect: runs on width=767, 766, 765...
useEffect(() =&gt; {
  if (width &lt; 768) {
    enableMobileMode()
  }
}, [width])

// Correct: runs only on boolean transition
const isMobile = width &lt; 768
useEffect(() =&gt; {
  if (isMobile) {
    enableMobileMode()
  }
}, [isMobile])
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rerender_dependencies/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rerender_derived_state Imported skill rerender_derived_state from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rerender-derived-state.md Unknown See repository sources/vercel/rerender_derived_state/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rerender_derived_state</div>
                <button class="copy-btn" onclick="copyToClipboard('rerender_derived_state')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rerender_derived_state from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Subscribe to Derived State
impact: MEDIUM
impactDescription: reduces re-render frequency
tags: rerender, derived-state, media-query, optimization
---

## Subscribe to Derived State

Subscribe to derived boolean state instead of continuous values to reduce re-render frequency.

**Incorrect (re-renders on every pixel change):**

```tsx
function Sidebar() {
  const width = useWindowWidth()  // updates continuously
  const isMobile = width &lt; 768
  return &lt;nav className={isMobile ? &#x27;mobile&#x27; : &#x27;desktop&#x27;} /&gt;
}
```

**Correct (re-renders only when boolean changes):**

```tsx
function Sidebar() {
  const isMobile = useMediaQuery(&#x27;(max-width: 767px)&#x27;)
  return &lt;nav className={isMobile ? &#x27;mobile&#x27; : &#x27;desktop&#x27;} /&gt;
}
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rerender_derived_state/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rerender_functional_setstate Imported skill rerender_functional_setstate from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rerender-functional-setstate.md Unknown See repository sources/vercel/rerender_functional_setstate/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rerender_functional_setstate</div>
                <button class="copy-btn" onclick="copyToClipboard('rerender_functional_setstate')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rerender_functional_setstate from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Use Functional setState Updates
impact: MEDIUM
impactDescription: prevents stale closures and unnecessary callback recreations
tags: react, hooks, useState, useCallback, callbacks, closures
---

## Use Functional setState Updates

When updating state based on the current state value, use the functional update form of setState instead of directly referencing the state variable. This prevents stale closures, eliminates unnecessary dependencies, and creates stable callback references.

**Incorrect (requires state as dependency):**

```tsx
function TodoList() {
  const [items, setItems] = useState(initialItems)
  
  // Callback must depend on items, recreated on every items change
  const addItems = useCallback((newItems: Item[]) =&gt; {
    setItems([...items, ...newItems])
  }, [items])  //  items dependency causes recreations
  
  // Risk of stale closure if dependency is forgotten
  const removeItem = useCallback((id: string) =&gt; {
    setItems(items.filter(item =&gt; item.id !== id))
  }, [])  //  Missing items dependency - will use stale items!
  
  return &lt;ItemsEditor items={items} onAdd={addItems} onRemove={removeItem} /&gt;
}
```

The first callback is recreated every time `items` changes, which can cause child components to re-render unnecessarily. The second callback has a stale closure bugit will always reference the initial `items` value.

**Correct (stable callbacks, no stale closures):**

```tsx
function TodoList() {
  const [items, setItems] = useState(initialItems)
  
  // Stable callback, never recreated
  const addItems = useCallback((newItems: Item[]) =&gt; {
    setItems(curr =&gt; [...curr, ...newItems])
  }, [])  //  No dependencies needed
  
  // Always uses latest state, no stale closure risk
  const removeItem = useCallback((id: string) =&gt; {
    setItems(curr =&gt; curr.filter(item =&gt; item.id !== id))
  }, [])  //  Safe and stable
  
  return &lt;ItemsEditor items={items} onAdd={addItems} onRemove={removeItem} /&gt;
}
```

**Benefits:**

1. **Stable callback references** - Callbacks don&#x27;t need to be recreated when state changes
2. **No stale closures** - Always operates on the latest state value
3. **Fewer dependencies** - Simplifies dependency arrays and reduces memory leaks
4. **Prevents bugs** - Eliminates the most common source of React closure bugs

**When to use functional updates:**

- Any setState that depends on the current state value
- Inside useCallback/useMemo when state is needed
- Event handlers that reference state
- Async operations that update state

**When direct updates are fine:**

- Setting state to a static value: `setCount(0)`
- Setting state from props/arguments only: `setName(newName)`
- State doesn&#x27;t depend on previous value

**Note:** If your project has [React Compiler](https://react.dev/learn/react-compiler) enabled, the compiler can automatically optimize some cases, but functional updates are still recommended for correctness and to prevent stale closure bugs.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rerender_functional_setstate/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rerender_lazy_state_init Imported skill rerender_lazy_state_init from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rerender-lazy-state-init.md Unknown See repository sources/vercel/rerender_lazy_state_init/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rerender_lazy_state_init</div>
                <button class="copy-btn" onclick="copyToClipboard('rerender_lazy_state_init')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rerender_lazy_state_init from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Use Lazy State Initialization
impact: MEDIUM
impactDescription: wasted computation on every render
tags: react, hooks, useState, performance, initialization
---

## Use Lazy State Initialization

Pass a function to `useState` for expensive initial values. Without the function form, the initializer runs on every render even though the value is only used once.

**Incorrect (runs on every render):**

```tsx
function FilteredList({ items }: { items: Item[] }) {
  // buildSearchIndex() runs on EVERY render, even after initialization
  const [searchIndex, setSearchIndex] = useState(buildSearchIndex(items))
  const [query, setQuery] = useState(&#x27;&#x27;)
  
  // When query changes, buildSearchIndex runs again unnecessarily
  return &lt;SearchResults index={searchIndex} query={query} /&gt;
}

function UserProfile() {
  // JSON.parse runs on every render
  const [settings, setSettings] = useState(
    JSON.parse(localStorage.getItem(&#x27;settings&#x27;) || &#x27;{}&#x27;)
  )
  
  return &lt;SettingsForm settings={settings} onChange={setSettings} /&gt;
}
```

**Correct (runs only once):**

```tsx
function FilteredList({ items }: { items: Item[] }) {
  // buildSearchIndex() runs ONLY on initial render
  const [searchIndex, setSearchIndex] = useState(() =&gt; buildSearchIndex(items))
  const [query, setQuery] = useState(&#x27;&#x27;)
  
  return &lt;SearchResults index={searchIndex} query={query} /&gt;
}

function UserProfile() {
  // JSON.parse runs only on initial render
  const [settings, setSettings] = useState(() =&gt; {
    const stored = localStorage.getItem(&#x27;settings&#x27;)
    return stored ? JSON.parse(stored) : {}
  })
  
  return &lt;SettingsForm settings={settings} onChange={setSettings} /&gt;
}
```

Use lazy initialization when computing initial values from localStorage/sessionStorage, building data structures (indexes, maps), reading from the DOM, or performing heavy transformations.

For simple primitives (`useState(0)`), direct references (`useState(props.value)`), or cheap literals (`useState({})`), the function form is unnecessary.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rerender_lazy_state_init/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rerender_memo Imported skill rerender_memo from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rerender-memo.md Unknown See repository sources/vercel/rerender_memo/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rerender_memo</div>
                <button class="copy-btn" onclick="copyToClipboard('rerender_memo')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rerender_memo from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Extract to Memoized Components
impact: MEDIUM
impactDescription: enables early returns
tags: rerender, memo, useMemo, optimization
---

## Extract to Memoized Components

Extract expensive work into memoized components to enable early returns before computation.

**Incorrect (computes avatar even when loading):**

```tsx
function Profile({ user, loading }: Props) {
  const avatar = useMemo(() =&gt; {
    const id = computeAvatarId(user)
    return &lt;Avatar id={id} /&gt;
  }, [user])

  if (loading) return &lt;Skeleton /&gt;
  return &lt;div&gt;{avatar}&lt;/div&gt;
}
```

**Correct (skips computation when loading):**

```tsx
const UserAvatar = memo(function UserAvatar({ user }: { user: User }) {
  const id = useMemo(() =&gt; computeAvatarId(user), [user])
  return &lt;Avatar id={id} /&gt;
})

function Profile({ user, loading }: Props) {
  if (loading) return &lt;Skeleton /&gt;
  return (
    &lt;div&gt;
      &lt;UserAvatar user={user} /&gt;
    &lt;/div&gt;
  )
}
```

**Note:** If your project has [React Compiler](https://react.dev/learn/react-compiler) enabled, manual memoization with `memo()` and `useMemo()` is not necessary. The compiler automatically optimizes re-renders.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rerender_memo/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="rerender_transitions Imported skill rerender_transitions from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/rerender-transitions.md Unknown See repository sources/vercel/rerender_transitions/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">rerender_transitions</div>
                <button class="copy-btn" onclick="copyToClipboard('rerender_transitions')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill rerender_transitions from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Use Transitions for Non-Urgent Updates
impact: MEDIUM
impactDescription: maintains UI responsiveness
tags: rerender, transitions, startTransition, performance
---

## Use Transitions for Non-Urgent Updates

Mark frequent, non-urgent state updates as transitions to maintain UI responsiveness.

**Incorrect (blocks UI on every scroll):**

```tsx
function ScrollTracker() {
  const [scrollY, setScrollY] = useState(0)
  useEffect(() =&gt; {
    const handler = () =&gt; setScrollY(window.scrollY)
    window.addEventListener(&#x27;scroll&#x27;, handler, { passive: true })
    return () =&gt; window.removeEventListener(&#x27;scroll&#x27;, handler)
  }, [])
}
```

**Correct (non-blocking updates):**

```tsx
import { startTransition } from &#x27;react&#x27;

function ScrollTracker() {
  const [scrollY, setScrollY] = useState(0)
  useEffect(() =&gt; {
    const handler = () =&gt; {
      startTransition(() =&gt; setScrollY(window.scrollY))
    }
    window.addEventListener(&#x27;scroll&#x27;, handler, { passive: true })
    return () =&gt; window.removeEventListener(&#x27;scroll&#x27;, handler)
  }, [])
}
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/rerender_transitions/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="server_after_nonblocking Imported skill server_after_nonblocking from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/server-after-nonblocking.md Unknown See repository sources/vercel/server_after_nonblocking/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">server_after_nonblocking</div>
                <button class="copy-btn" onclick="copyToClipboard('server_after_nonblocking')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill server_after_nonblocking from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Use after() for Non-Blocking Operations
impact: MEDIUM
impactDescription: faster response times
tags: server, async, logging, analytics, side-effects
---

## Use after() for Non-Blocking Operations

Use Next.js&#x27;s `after()` to schedule work that should execute after a response is sent. This prevents logging, analytics, and other side effects from blocking the response.

**Incorrect (blocks response):**

```tsx
import { logUserAction } from &#x27;@/app/utils&#x27;

export async function POST(request: Request) {
  // Perform mutation
  await updateDatabase(request)
  
  // Logging blocks the response
  const userAgent = request.headers.get(&#x27;user-agent&#x27;) || &#x27;unknown&#x27;
  await logUserAction({ userAgent })
  
  return new Response(JSON.stringify({ status: &#x27;success&#x27; }), {
    status: 200,
    headers: { &#x27;Content-Type&#x27;: &#x27;application/json&#x27; }
  })
}
```

**Correct (non-blocking):**

```tsx
import { after } from &#x27;next/server&#x27;
import { headers, cookies } from &#x27;next/headers&#x27;
import { logUserAction } from &#x27;@/app/utils&#x27;

export async function POST(request: Request) {
  // Perform mutation
  await updateDatabase(request)
  
  // Log after response is sent
  after(async () =&gt; {
    const userAgent = (await headers()).get(&#x27;user-agent&#x27;) || &#x27;unknown&#x27;
    const sessionCookie = (await cookies()).get(&#x27;session-id&#x27;)?.value || &#x27;anonymous&#x27;
    
    logUserAction({ sessionCookie, userAgent })
  })
  
  return new Response(JSON.stringify({ status: &#x27;success&#x27; }), {
    status: 200,
    headers: { &#x27;Content-Type&#x27;: &#x27;application/json&#x27; }
  })
}
```

The response is sent immediately while logging happens in the background.

**Common use cases:**

- Analytics tracking
- Audit logging
- Sending notifications
- Cache invalidation
- Cleanup tasks

**Important notes:**

- `after()` runs even if the response fails or redirects
- Works in Server Actions, Route Handlers, and Server Components

Reference: [https://nextjs.org/docs/app/api-reference/functions/after](https://nextjs.org/docs/app/api-reference/functions/after)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/server_after_nonblocking/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="server_cache_lru Imported skill server_cache_lru from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/server-cache-lru.md Unknown See repository sources/vercel/server_cache_lru/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">server_cache_lru</div>
                <button class="copy-btn" onclick="copyToClipboard('server_cache_lru')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill server_cache_lru from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Cross-Request LRU Caching
impact: HIGH
impactDescription: caches across requests
tags: server, cache, lru, cross-request
---

## Cross-Request LRU Caching

`React.cache()` only works within one request. For data shared across sequential requests (user clicks button A then button B), use an LRU cache.

**Implementation:**

```typescript
import { LRUCache } from &#x27;lru-cache&#x27;

const cache = new LRUCache&lt;string, any&gt;({
  max: 1000,
  ttl: 5 * 60 * 1000  // 5 minutes
})

export async function getUser(id: string) {
  const cached = cache.get(id)
  if (cached) return cached

  const user = await db.user.findUnique({ where: { id } })
  cache.set(id, user)
  return user
}

// Request 1: DB query, result cached
// Request 2: cache hit, no DB query
```

Use when sequential user actions hit multiple endpoints needing the same data within seconds.

**With Vercel&#x27;s [Fluid Compute](https://vercel.com/docs/fluid-compute):** LRU caching is especially effective because multiple concurrent requests can share the same function instance and cache. This means the cache persists across requests without needing external storage like Redis.

**In traditional serverless:** Each invocation runs in isolation, so consider Redis for cross-process caching.

Reference: [https://github.com/isaacs/node-lru-cache](https://github.com/isaacs/node-lru-cache)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/server_cache_lru/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="server_cache_react Imported skill server_cache_react from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/server-cache-react.md Unknown See repository sources/vercel/server_cache_react/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">server_cache_react</div>
                <button class="copy-btn" onclick="copyToClipboard('server_cache_react')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill server_cache_react from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Per-Request Deduplication with React.cache()
impact: MEDIUM
impactDescription: deduplicates within request
tags: server, cache, react-cache, deduplication
---

## Per-Request Deduplication with React.cache()

Use `React.cache()` for server-side request deduplication. Authentication and database queries benefit most.

**Usage:**

```typescript
import { cache } from &#x27;react&#x27;

export const getCurrentUser = cache(async () =&gt; {
  const session = await auth()
  if (!session?.user?.id) return null
  return await db.user.findUnique({
    where: { id: session.user.id }
  })
})
```

Within a single request, multiple calls to `getCurrentUser()` execute the query only once.

**Avoid inline objects as arguments:**

`React.cache()` uses shallow equality (`Object.is`) to determine cache hits. Inline objects create new references each call, preventing cache hits.

**Incorrect (always cache miss):**

```typescript
const getUser = cache(async (params: { uid: number }) =&gt; {
  return await db.user.findUnique({ where: { id: params.uid } })
})

// Each call creates new object, never hits cache
getUser({ uid: 1 })
getUser({ uid: 1 })  // Cache miss, runs query again
```

**Correct (cache hit):**

```typescript
const getUser = cache(async (uid: number) =&gt; {
  return await db.user.findUnique({ where: { id: uid } })
})

// Primitive args use value equality
getUser(1)
getUser(1)  // Cache hit, returns cached result
```

If you must pass objects, pass the same reference:

```typescript
const params = { uid: 1 }
getUser(params)  // Query runs
getUser(params)  // Cache hit (same reference)
```

**Next.js-Specific Note:**

In Next.js, the `fetch` API is automatically extended with request memoization. Requests with the same URL and options are automatically deduplicated within a single request, so you don&#x27;t need `React.cache()` for `fetch` calls. However, `React.cache()` is still essential for other async tasks:

- Database queries (Prisma, Drizzle, etc.)
- Heavy computations
- Authentication checks
- File system operations
- Any non-fetch async work

Use `React.cache()` to deduplicate these operations across your component tree.

Reference: [React.cache documentation](https://react.dev/reference/react/cache)</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/server_cache_react/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="server_parallel_fetching Imported skill server_parallel_fetching from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/server-parallel-fetching.md Unknown See repository sources/vercel/server_parallel_fetching/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">server_parallel_fetching</div>
                <button class="copy-btn" onclick="copyToClipboard('server_parallel_fetching')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill server_parallel_fetching from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Parallel Data Fetching with Component Composition
impact: CRITICAL
impactDescription: eliminates server-side waterfalls
tags: server, rsc, parallel-fetching, composition
---

## Parallel Data Fetching with Component Composition

React Server Components execute sequentially within a tree. Restructure with composition to parallelize data fetching.

**Incorrect (Sidebar waits for Page&#x27;s fetch to complete):**

```tsx
export default async function Page() {
  const header = await fetchHeader()
  return (
    &lt;div&gt;
      &lt;div&gt;{header}&lt;/div&gt;
      &lt;Sidebar /&gt;
    &lt;/div&gt;
  )
}

async function Sidebar() {
  const items = await fetchSidebarItems()
  return &lt;nav&gt;{items.map(renderItem)}&lt;/nav&gt;
}
```

**Correct (both fetch simultaneously):**

```tsx
async function Header() {
  const data = await fetchHeader()
  return &lt;div&gt;{data}&lt;/div&gt;
}

async function Sidebar() {
  const items = await fetchSidebarItems()
  return &lt;nav&gt;{items.map(renderItem)}&lt;/nav&gt;
}

export default function Page() {
  return (
    &lt;div&gt;
      &lt;Header /&gt;
      &lt;Sidebar /&gt;
    &lt;/div&gt;
  )
}
```

**Alternative with children prop:**

```tsx
async function Header() {
  const data = await fetchHeader()
  return &lt;div&gt;{data}&lt;/div&gt;
}

async function Sidebar() {
  const items = await fetchSidebarItems()
  return &lt;nav&gt;{items.map(renderItem)}&lt;/nav&gt;
}

function Layout({ children }: { children: ReactNode }) {
  return (
    &lt;div&gt;
      &lt;Header /&gt;
      {children}
    &lt;/div&gt;
  )
}

export default function Page() {
  return (
    &lt;Layout&gt;
      &lt;Sidebar /&gt;
    &lt;/Layout&gt;
  )
}
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/server_parallel_fetching/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="server_serialization Imported skill server_serialization from vercel vercel /a0/tmp/skills_research/vercel/skills/react-best-practices/rules/server-serialization.md Unknown See repository sources/vercel/server_serialization/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">server_serialization</div>
                <button class="copy-btn" onclick="copyToClipboard('server_serialization')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill server_serialization from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
title: Minimize Serialization at RSC Boundaries
impact: HIGH
impactDescription: reduces data transfer size
tags: server, rsc, serialization, props
---

## Minimize Serialization at RSC Boundaries

The React Server/Client boundary serializes all object properties into strings and embeds them in the HTML response and subsequent RSC requests. This serialized data directly impacts page weight and load time, so **size matters a lot**. Only pass fields that the client actually uses.

**Incorrect (serializes all 50 fields):**

```tsx
async function Page() {
  const user = await fetchUser()  // 50 fields
  return &lt;Profile user={user} /&gt;
}

&#x27;use client&#x27;
function Profile({ user }: { user: User }) {
  return &lt;div&gt;{user.name}&lt;/div&gt;  // uses 1 field
}
```

**Correct (serializes only 1 field):**

```tsx
async function Page() {
  const user = await fetchUser()
  return &lt;Profile name={user.name} /&gt;
}

&#x27;use client&#x27;
function Profile({ name }: { name: string }) {
  return &lt;div&gt;{name}&lt;/div&gt;
}
```</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/server_serialization/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="skill Imported skill skill from vercel vercel /a0/tmp/skills_research/vercel/skills/web-design-guidelines/SKILL.md Unknown See repository sources/vercel/skill/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">skill</div>
                <button class="copy-btn" onclick="copyToClipboard('skill')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill skill from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">---
name: web-design-guidelines
description: Review UI code for Web Interface Guidelines compliance. Use when asked to &quot;review my UI&quot;, &quot;check accessibility&quot;, &quot;audit design&quot;, &quot;review UX&quot;, or &quot;check my site against best practices&quot;.
metadata:
  author: vercel
  version: &quot;1.0.0&quot;
  argument-hint: &lt;file-or-pattern&gt;
---

# Web Interface Guidelines

Review files for compliance with Web Interface Guidelines.

## How It Works

1. Fetch the latest guidelines from the source URL below
2. Read the specified files (or prompt user for files/pattern)
3. Check against all rules in the fetched guidelines
4. Output findings in the terse `file:line` format

## Guidelines Source

Fetch fresh guidelines before each review:

```
https://raw.githubusercontent.com/vercel-labs/web-interface-guidelines/main/command.md
```

Use WebFetch to retrieve the latest rules. The fetched content contains all the rules and output format instructions.

## Usage

When a user provides a file or pattern argument:
1. Fetch guidelines from the source URL above
2. Read the specified files
3. Apply all rules from the fetched guidelines
4. Output findings using the format specified in the guidelines

If no files specified, ask the user which files to review.</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/skill/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="tsconfig Imported skill tsconfig from vercel vercel /a0/tmp/skills_research/vercel/packages/react-best-practices-build/tsconfig.json Unknown See repository sources/vercel/tsconfig/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">tsconfig</div>
                <button class="copy-btn" onclick="copyToClipboard('tsconfig')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill tsconfig from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">{
  &quot;compilerOptions&quot;: {
    &quot;target&quot;: &quot;ES2022&quot;,
    &quot;module&quot;: &quot;ESNext&quot;,
    &quot;lib&quot;: [&quot;ES2022&quot;],
    &quot;moduleResolution&quot;: &quot;node&quot;,
    &quot;esModuleInterop&quot;: true,
    &quot;strict&quot;: true,
    &quot;skipLibCheck&quot;: true,
    &quot;forceConsistentCasingInFileNames&quot;: true,
    &quot;resolveJsonModule&quot;: true,
    &quot;outDir&quot;: &quot;./dist&quot;,
    &quot;rootDir&quot;: &quot;./src&quot;
  },
  &quot;include&quot;: [&quot;src/**/*&quot;],
  &quot;exclude&quot;: [&quot;node_modules&quot;, &quot;dist&quot;]
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/tsconfig/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="types Imported skill types from vercel vercel /a0/tmp/skills_research/vercel/packages/react-best-practices-build/src/types.ts Unknown See repository sources/vercel/types/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">types</div>
                <button class="copy-btn" onclick="copyToClipboard('types')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill types from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">/**
 * Type definitions for React Performance Guidelines rules
 */

export type ImpactLevel = &#x27;CRITICAL&#x27; | &#x27;HIGH&#x27; | &#x27;MEDIUM-HIGH&#x27; | &#x27;MEDIUM&#x27; | &#x27;LOW-MEDIUM&#x27; | &#x27;LOW&#x27;

export interface CodeExample {
  label: string // e.g., &quot;Incorrect&quot;, &quot;Correct&quot;, &quot;Example&quot;
  description?: string // Optional description before code
  code: string
  language?: string // Default: &#x27;typescript&#x27; or &#x27;tsx&#x27;
  additionalText?: string // Optional text after code block (explanations, reasons)
}

export interface Rule {
  id: string // e.g., &quot;1.1&quot;, &quot;2.3&quot;
  title: string
  section: number // Main section number (1-8)
  subsection?: number // Subsection number within section
  impact: ImpactLevel
  impactDescription?: string // e.g., &quot;2-10 improvement&quot;
  explanation: string
  examples: CodeExample[]
  references?: string[] // URLs or citations
  tags?: string[] // For categorization/search
}

export interface Section {
  number: number
  title: string
  impact: ImpactLevel
  impactDescription?: string
  introduction?: string
  rules: Rule[]
}

export interface GuidelinesDocument {
  version: string
  organization: string
  date: string
  abstract: string
  sections: Section[]
  references?: string[]
}

export interface TestCase {
  ruleId: string
  ruleTitle: string
  type: &#x27;bad&#x27; | &#x27;good&#x27;
  code: string
  language: string
  description?: string
}</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/types/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
        <article class="card" data-search="validate Imported skill validate from vercel vercel /a0/tmp/skills_research/vercel/packages/react-best-practices-build/src/validate.ts Unknown See repository sources/vercel/validate/SKILL.md SKILL.md">
            <div class="card-header">
                <div class="skill-title">validate</div>
                <button class="copy-btn" onclick="copyToClipboard('validate')" title="Copy Skill ID">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </button>
            </div>
            <div class="info-row">
                <span class="badge">vercel</span>
                <span class="pill">SKILL.md</span>
                <span class="badge muted">License: See repository</span>
                <span class="badge muted">Version: Unknown</span>
            </div>
            <div class="card-body">Imported skill validate from vercel</div>
            <details>
                <summary>View skill</summary>
                <pre class="skill-content">#!/usr/bin/env node
/**
 * Validate rule files follow the correct structure
 */

import { readdir } from &#x27;fs/promises&#x27;
import { join } from &#x27;path&#x27;
import { Rule } from &#x27;./types.js&#x27;
import { parseRuleFile } from &#x27;./parser.js&#x27;
import { RULES_DIR } from &#x27;./config.js&#x27;

interface ValidationError {
  file: string
  ruleId?: string
  message: string
}

/**
 * Validate a rule
 */
function validateRule(rule: Rule, file: string): ValidationError[] {
  const errors: ValidationError[] = []
  
  // Note: rule.id is auto-generated during build, not required in source files
  
  if (!rule.title || rule.title.trim().length === 0) {
    errors.push({ file, ruleId: rule.id, message: &#x27;Missing or empty title&#x27; })
  }
  
  if (!rule.explanation || rule.explanation.trim().length === 0) {
    errors.push({ file, ruleId: rule.id, message: &#x27;Missing or empty explanation&#x27; })
  }
  
  if (!rule.examples || rule.examples.length === 0) {
    errors.push({ file, ruleId: rule.id, message: &#x27;Missing examples (need at least one bad and one good example)&#x27; })
  } else {
    // Filter out informational examples (notes, trade-offs, etc.) that don&#x27;t have code
    const codeExamples = rule.examples.filter(e =&gt; e.code &amp;&amp; e.code.trim().length &gt; 0)
    
    const hasBad = codeExamples.some(e =&gt; 
      e.label.toLowerCase().includes(&#x27;incorrect&#x27;) || 
      e.label.toLowerCase().includes(&#x27;wrong&#x27;) ||
      e.label.toLowerCase().includes(&#x27;bad&#x27;)
    )
    const hasGood = codeExamples.some(e =&gt; 
      e.label.toLowerCase().includes(&#x27;correct&#x27;) || 
      e.label.toLowerCase().includes(&#x27;good&#x27;) ||
      e.label.toLowerCase().includes(&#x27;usage&#x27;) ||
      e.label.toLowerCase().includes(&#x27;implementation&#x27;) ||
      e.label.toLowerCase().includes(&#x27;example&#x27;)
    )
    
    if (codeExamples.length === 0) {
      errors.push({ file, ruleId: rule.id, message: &#x27;Missing code examples&#x27; })
    } else if (!hasBad &amp;&amp; !hasGood) {
      errors.push({ file, ruleId: rule.id, message: &#x27;Missing bad/incorrect or good/correct examples&#x27; })
    }
  }
  
  const validImpacts: Rule[&#x27;impact&#x27;][] = [&#x27;CRITICAL&#x27;, &#x27;HIGH&#x27;, &#x27;MEDIUM-HIGH&#x27;, &#x27;MEDIUM&#x27;, &#x27;LOW-MEDIUM&#x27;, &#x27;LOW&#x27;]
  if (!validImpacts.includes(rule.impact)) {
    errors.push({ file, ruleId: rule.id, message: `Invalid impact level: ${rule.impact}. Must be one of: ${validImpacts.join(&#x27;, &#x27;)}` })
  }
  
  return errors
}

/**
 * Main validation function
 */
async function validate() {
  try {
    console.log(&#x27;Validating rule files...&#x27;)
    console.log(`Rules directory: ${RULES_DIR}`)
    
    const files = await readdir(RULES_DIR)
    const ruleFiles = files.filter(f =&gt; f.endsWith(&#x27;.md&#x27;) &amp;&amp; !f.startsWith(&#x27;_&#x27;))
    
    const allErrors: ValidationError[] = []
    
    for (const file of ruleFiles) {
      const filePath = join(RULES_DIR, file)
      try {
        const { rule } = await parseRuleFile(filePath)
        const errors = validateRule(rule, file)
        allErrors.push(...errors)
      } catch (error) {
        allErrors.push({ 
          file, 
          message: `Failed to parse: ${error instanceof Error ? error.message : String(error)}` 
        })
      }
    }
    
    if (allErrors.length &gt; 0) {
      console.error(&#x27;\n Validation failed:\n&#x27;)
      allErrors.forEach(error =&gt; {
        console.error(`  ${error.file}${error.ruleId ? ` (${error.ruleId})` : &#x27;&#x27;}: ${error.message}`)
      })
      process.exit(1)
    } else {
      console.log(` All ${ruleFiles.length} rule files are valid`)
    }
  } catch (error) {
    console.error(&#x27;Validation failed:&#x27;, error)
    process.exit(1)
  }
}

validate()</pre>
            </details>
            <div class="card-footer">
                <div class="link-group">
                    <a data-path="sources/vercel/validate/SKILL.md" class="source-link">Registry File</a>
                    
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">Provider Repo</a>
                    <a href="https://github.com/vercel-labs/agent-skills" class="source-link" target="_blank" rel="noopener">License: See repository</a>
                    <button class="copy-btn" onclick="copySkill(this)" title="Copy Skill Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </article>
        
    </main>
    <div id="toast" class="toast">Copied to clipboard!</div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('search-input');
            const cards = document.querySelectorAll('.card');
            const count = document.getElementById('skills-count');
            count.textContent = `${cards.length} skills indexed`;
            searchInput.addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                cards.forEach(card => {
                    const content = card.querySelector('.skill-content');
                    const haystack = (card.dataset.search + ' ' + (content ? content.textContent : '')).toLowerCase();
                    if (haystack.includes(term)) {
                        card.classList.remove('hidden');
                    } else {
                        card.classList.add('hidden');
                    }
                });
            });
            const banner = document.getElementById('registry-banner');
            const host = window.location.host;
            if (host.includes('bitcoreos.github.io')) {
                banner.innerHTML = 'Dev registry: bitcoreos/skills.md. Public registry: <a href="https://bitwikiorg.github.io/skills.md/">bitwikiorg.github.io/skills.md</a>';
            } else if (host.includes('bitwikiorg.github.io')) {
                banner.innerHTML = 'Public registry: bitwikiorg/skills.md. Dev registry: <a href="https://bitcoreos.github.io/skills.md/">bitcoreos.github.io/skills.md</a>';
            } else {
                banner.textContent = 'Skills registry mirror';
            }
        });
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => { showToast(); });
        }
        function copySkill(button) {
            const card = button.closest('.card');
            const content = card.querySelector('.skill-content');
            if (content) {
                navigator.clipboard.writeText(content.textContent).then(() => { showToast(); });
            }
        }
        function hydrateLinks() {
            const host = window.location.host;
            let repoBase = 'https://github.com/bitcoreos/skills.md';
            if (host.includes('bitwikiorg.github.io')) {
                repoBase = 'https://github.com/bitwikiorg/skills.md';
            }
            document.querySelectorAll('[data-path]').forEach(link => {
                const path = link.getAttribute('data-path');
                link.setAttribute('href', `${repoBase}/blob/main/${path}`);
            });
        }
        document.addEventListener('DOMContentLoaded', hydrateLinks);
        function showToast() {
            const toast = document.getElementById('toast');
            toast.classList.add('show');
            setTimeout(() => { toast.classList.remove('show'); }, 2000);
        }
    </script>
</body>
</html>